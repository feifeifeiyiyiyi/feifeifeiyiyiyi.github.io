/*! For license information please see daodaochaotian.56e68b38.js.LICENSE.txt */
(()=>{"use strict";var e={383:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.step-wrapper[data-v-23a2a838] {\n  height: 100%;\n}\n.creation-container[data-v-23a2a838] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  overflow: hidden;\n  padding: 0; /* 移除内边距，充满屏幕 */\n  box-sizing: border-box;\n}\n.creation-scroll[data-v-23a2a838] {\n  width: 95%; /* 增加宽度利用率 */\n  max-width: 1400px; /* 增加最大宽度 */\n  height: 90vh;\n  max-height: 90vh; /* 使用视口高度 */\n  background: var(--color-surface-transparent);\n  border: 1px solid var(--color-border);\n  border-radius: 15px;\n  box-shadow: 0 0 40px rgba(var(--color-primary-rgb), 0.3);\n  display: flex;\n  flex-direction: column;\n  padding: 2rem;\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  position: relative;\n  z-index: 1;\n  overflow: hidden; /* 容器本身不滚动 */\n}\n.header-container[data-v-23a2a838] {\n  /* This container no longer needs flex properties */\n  margin-bottom: 2rem;\n  flex-shrink: 0; /* 防止被压缩 */\n}\n.header-top[data-v-23a2a838] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.mode-indicator[data-v-23a2a838] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  padding: 0.25rem 0.75rem;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border: 1px solid var(--color-primary);\n  border-radius: 15px;\n  white-space: nowrap;\n}\n.cloud-sync-container[data-v-23a2a838] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n.progress-steps[data-v-23a2a838] {\n  display: flex;\n  justify-content: space-between; /* 电脑端两端对齐 */\n  width: 100%; /* Ensure the container spans the full width */\n  overflow-x: auto;\n  overflow-y: hidden;\n  gap: 1rem;\n  padding: 0.5rem 0;\n  /* 隐藏滚动条但保留滚动功能 */\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE and Edge */\n}\n.progress-steps[data-v-23a2a838]::-webkit-scrollbar {\n  display: none; /* Chrome, Safari */\n}\n.step[data-v-23a2a838] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  opacity: 0.5;\n  transition: opacity 0.3s ease;\n  flex-shrink: 0; /* 防止步骤被压缩 */\n  min-width: 60px; /* 确保最小宽度 */\n}\n.step.active[data-v-23a2a838] {\n  opacity: 1;\n}\n.step-circle[data-v-23a2a838] {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: #333;\n  border: 2px solid #555;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 1.2rem;\n  font-weight: bold;\n  transition: all 0.3s ease;\n}\n.step.active .step-circle[data-v-23a2a838] {\n  background: var(--color-accent);\n  color: var(--color-background);\n  border-color: var(--color-accent);\n  box-shadow: 0 0 10px rgba(var(--color-primary-rgb), 0.5);\n}\n.step-label[data-v-23a2a838] {\n  margin-top: 0.5rem;\n  font-size: 0.8rem;\n}\n.step-content[data-v-23a2a838] {\n  flex: 1 1 0;\n  min-height: 0; /* 允许flex子元素缩小 */\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 2rem 1rem; /* 增加内边距，内容更舒适 */\n  margin: 0; /* 移除margin避免多余空间 */\n  border-top: 1px solid var(--color-border);\n  border-bottom: 1px solid var(--color-border);\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE and Edge */\n}\n\n/* Chrome, Safari and Opera */\n.step-content[data-v-23a2a838]::-webkit-scrollbar {\n  display: none;\n}\n.navigation-buttons[data-v-23a2a838] {\n  display: grid;\n  grid-template-columns: 1fr auto 1fr;\n  align-items: center;\n  padding: 1rem;\n  gap: 1rem;\n  flex-shrink: 0;\n  background: var(--color-surface-transparent);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border-top: 1px solid var(--color-border);\n  position: sticky;\n  bottom: 0;\n  z-index: 10;\n}\n.navigation-buttons > button[data-v-23a2a838]:first-child {\n  justify-self: start;\n}\n.navigation-buttons > button[data-v-23a2a838]:last-child {\n  justify-self: end;\n  grid-column: 3;\n}\n.points-display[data-v-23a2a838] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 2rem;\n  grid-column: 2;\n}\n.destiny-points[data-v-23a2a838],\n.attribute-points[data-v-23a2a838] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border: 1px solid var(--color-primary);\n  border-radius: 20px;\n}\n.points-label[data-v-23a2a838] {\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n}\n.points-value[data-v-23a2a838] {\n  font-size: 1.2rem;\n  font-weight: bold;\n  color: var(--color-accent);\n}\n.points-value.low[data-v-23a2a838] {\n  color: var(--color-danger);\n  animation: pulse-23a2a838 1s ease-in-out infinite;\n}\n@keyframes pulse-23a2a838 {\n0%,\n  100% {\n    opacity: 1;\n}\n50% {\n    opacity: 0.6;\n}\n}\n.code-redeem-fab[data-v-23a2a838] {\n  position: absolute;\n  bottom: 2rem;\n  left: 2rem;\n  z-index: 10;\n}\n\n/* 移动端适配 */\n@media (max-width: 768px) {\n.creation-scroll[data-v-23a2a838] {\n    width: 98%;\n    height: 95vh;\n    max-height: 95vh;\n    padding: 1rem;\n    border-radius: 10px;\n}\n.header-container[data-v-23a2a838] {\n    margin-bottom: 1rem;\n    flex-shrink: 0;\n}\n.header-top[data-v-23a2a838] {\n    gap: 0.75rem;\n}\n.mode-indicator[data-v-23a2a838] {\n    font-size: 0.8rem;\n    padding: 0.2rem 0.6rem;\n}\n.cloud-sync-container[data-v-23a2a838] {\n    gap: 0.5rem;\n}\n.progress-steps[data-v-23a2a838] {\n    justify-content: flex-start; /* 平板端左对齐，便于横向滚动 */\n    gap: 0.5rem;\n    padding: 0 0.25rem;\n}\n.step[data-v-23a2a838] {\n    min-width: 60px;\n}\n.step-circle[data-v-23a2a838] {\n    width: 32px;\n    height: 32px;\n    font-size: 1rem;\n}\n.step-label[data-v-23a2a838] {\n    font-size: 0.7rem;\n    margin-top: 0.3rem;\n}\n.step-content[data-v-23a2a838] {\n    padding: 1.5rem 0.5rem;\n    flex: 1 1 0;\n    min-height: 0;\n}\n.navigation-buttons[data-v-23a2a838] {\n    padding: 1rem 0;\n    gap: 0.5rem;\n    flex-wrap: wrap;\n    flex-shrink: 0;\n}\n.points-display[data-v-23a2a838] {\n    flex-basis: 100%;\n    order: -1;\n    margin-bottom: 0.5rem;\n}\n.destiny-points[data-v-23a2a838],\n  .attribute-points[data-v-23a2a838] {\n    padding: 0.4rem 0.8rem;\n    font-size: 0.85rem;\n}\n.points-label[data-v-23a2a838] {\n    font-size: 0.8rem;\n}\n.points-value[data-v-23a2a838] {\n    font-size: 1rem;\n}\n.navigation-buttons button[data-v-23a2a838] {\n    flex: 1;\n    min-width: 100px;\n    font-size: 0.9rem;\n    padding: 0.6rem 1rem;\n}\n}\n@media (max-width: 480px) {\n.creation-scroll[data-v-23a2a838] {\n    width: 100%;\n    height: 100vh;\n    max-height: 100vh;\n    padding: 0.75rem;\n    padding-bottom: max(0.75rem, env(safe-area-inset-bottom)); /* 适配刘海屏底部安全区域 */\n    border-radius: 0;\n}\n.header-container[data-v-23a2a838] {\n    flex-shrink: 0;\n}\n.header-top[data-v-23a2a838] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.mode-indicator[data-v-23a2a838] {\n    text-align: center;\n}\n.cloud-sync-container[data-v-23a2a838] {\n    justify-content: center;\n}\n.progress-steps[data-v-23a2a838] {\n    justify-content: flex-start; /* 移动端左对齐，便于横向滚动 */\n    gap: 0.75rem;\n}\n.step[data-v-23a2a838] {\n    min-width: 55px;\n}\n.step-circle[data-v-23a2a838] {\n    width: 28px;\n    height: 28px;\n    font-size: 0.9rem;\n}\n.step-label[data-v-23a2a838] {\n    font-size: 0.65rem;\n}\n.step-content[data-v-23a2a838] {\n    padding: 1rem 0.25rem;\n    flex: 1 1 0;\n    min-height: 0;\n}\n.navigation-buttons[data-v-23a2a838] {\n    flex-direction: column;\n    gap: 0.5rem;\n    padding: 1rem 0 0.5rem 0;\n    flex-shrink: 0;\n}\n.points-display[data-v-23a2a838] {\n    order: 0;\n    margin-bottom: 0.75rem;\n}\n.navigation-buttons button[data-v-23a2a838] {\n    width: 100%;\n    min-width: auto;\n    padding: 0.8rem 1rem; /* 增加按钮高度，更易点击 */\n    font-size: 1rem; /* 增大字体，更易阅读 */\n}\n}\n",""]);const i=l},414:(e,n,t)=>{t.r(n),t.d(n,{CORE_SYNC_RULES:()=>y.kp,DATA_STRUCTURE_DEFINITIONS:()=>y.uH,TECHNIQUE_ITEM_GENERATION_PROMPT:()=>y.$O,diagnoseAIResponse:()=>o.aY,generateInitialMessage:()=>h.x,generateItemWithTavernAI:()=>o.$7,generateOrigin:()=>g,generateSimpleResponse:()=>h.bA,generateSpiritRoot:()=>f,generateTalent:()=>b,generateTalentTier:()=>u,generateWorld:()=>v,getTavernHelper:()=>a.getTavernHelper});var a=t(8651),o=t(6972),r=t(5408),l=t(4270);const i={maxRetries:3,initialDelay:1e3,maxDelay:1e4,backoffFactor:2,showToast:!0,onRetry:()=>{},shouldRetry:()=>!0};function c(e){return new Promise(n=>setTimeout(n,e))}function s(e,n){const t=n.initialDelay*Math.pow(n.backoffFactor,e-1);return Math.min(t,n.maxDelay)}async function d(e,n={}){const t={...i,...n};let a=null;for(let n=1;n<=t.maxRetries;n++)try{console.log(`[重试助手] 尝试执行 (第${n}/${t.maxRetries}次)`);const a=await e();return n>1&&t.showToast&&l.o.success(`操作成功 (重试${n-1}次后)`),a}catch(e){if(a=e,console.error(`[重试助手] 第${n}次尝试失败:`,e),!t.shouldRetry(a)){console.log("[重试助手] 错误不可重试，停止");break}if(n<t.maxRetries){const e=s(n,t);console.log(`[重试助手] 将在${e}ms后重试...`),t.showToast&&l.o.warning(`操作失败，${e/1e3}秒后重试 (${n}/${t.maxRetries})`),t.onRetry(n,a),await c(e)}}throw console.error("[重试助手] 所有重试都失败了，最后错误:",a),t.showToast&&l.o.error(`操作失败: ${a?.message||"未知错误"}`),a||new Error("操作失败")}const m={networkError:e=>e.message.includes("网络")||e.message.includes("timeout")||e.message.includes("连接"),serverError:e=>e.message.includes("5")&&null!==e.message.match(/5\d{2}/),temporaryError:e=>{const n=e.message.toLowerCase();return["临时","繁忙","稍后","temporary","busy","throttle"].some(e=>n.includes(e))},aiGenerationError:e=>e.message.includes("JSON")||e.message.includes("解析")||e.message.includes("格式")||e.message.includes("响应为空"),any:(...e)=>n=>e.some(e=>e(n)),all:(...e)=>n=>e.every(e=>e(n))};function p(e,n,t){if(!e||"object"!=typeof e)return console.error(`[生成验证] ${t}: 不是有效对象`),!1;for(const a of n)if(!(a in e))return console.error(`[生成验证] ${t}: 缺少必需字段 "${a}"`),!1;return!0}async function v(){try{return await d(async()=>{const e=await(0,o.$7)(r.tQ,"世界设定");if(!e)throw new Error("生成结果为空");if(!p(e,["名称","描述"],"世界设定"))throw new Error("生成的世界设定缺少必需字段");return e},{maxRetries:3,showToast:!1,shouldRetry:m.aiGenerationError})}catch(e){return console.error("[生成器] 生成世界设定最终失败:",e),l.o.error("生成世界设定失败，请重试"),null}}async function u(){try{return await d(async()=>{const e=await(0,o.$7)(r.__,"天资等级");if(!e)throw new Error("生成结果为空");if(!p(e,["名称","描述"],"天资等级"))throw new Error("生成的天资等级缺少必需字段");return e},{maxRetries:3,showToast:!1,shouldRetry:m.aiGenerationError})}catch(e){return console.error("[生成器] 生成天资等级最终失败:",e),l.o.error("生成天资等级失败，请重试"),null}}async function g(){try{return await d(async()=>{const e=await(0,o.$7)(r.XN,"出身背景");if(!e)throw new Error("生成结果为空");if(!p(e,["名称","描述"],"出身背景"))throw new Error("生成的出身背景缺少必需字段");return e},{maxRetries:3,showToast:!1,shouldRetry:m.aiGenerationError})}catch(e){return console.error("[生成器] 生成出身背景最终失败:",e),l.o.error("生成出身背景失败，请重试"),null}}async function f(){try{return await d(async()=>{const e=await(0,o.$7)(r.x$,"灵根类型");if(!e)throw new Error("生成结果为空");if(!p(e,["名称","描述"],"灵根类型"))throw new Error("生成的灵根类型缺少必需字段");return e},{maxRetries:3,showToast:!1,shouldRetry:m.aiGenerationError})}catch(e){return console.error("[生成器] 生成灵根类型最终失败:",e),l.o.error("生成灵根类型失败，请重试"),null}}async function b(){try{return await d(async()=>{const e=await(0,o.$7)(r.BA,"天赋技能");if(!e)throw new Error("生成结果为空");if(!p(e,["名称","描述"],"天赋技能"))throw new Error("生成的天赋技能缺少必需字段");return e},{maxRetries:3,showToast:!1,shouldRetry:m.aiGenerationError})}catch(e){return console.error("[生成器] 生成天赋技能最终失败:",e),l.o.error("生成天赋技能失败，请重试"),null}}var h=t(7181),y=t(6912)},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},600:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.raw-data-section[data-v-0ef67458] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.section-header[data-v-0ef67458] {\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.section-title[data-v-0ef67458] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.raw-data-content[data-v-0ef67458] {\n  flex: 1;\n  overflow: hidden;\n}\n.data-display[data-v-0ef67458] {\n  height: 100%;\n  overflow: hidden;\n}\n.code-pre[data-v-0ef67458] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  height: 100%;\n  overflow: auto;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.8rem;\n  line-height: 1.4;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.empty-state[data-v-0ef67458] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.raw-data-section[data-v-0ef67458] {\n    padding: 0.75rem;\n}\n.section-title[data-v-0ef67458] {\n    font-size: 1rem;\n    text-align: center;\n}\n.code-pre[data-v-0ef67458] {\n    font-size: 0.75rem;\n    padding: 0.5rem;\n}\n.empty-state[data-v-0ef67458] {\n    padding: 2rem 0.5rem;\n}\n}\n@media (max-width: 480px) {\n.raw-data-section[data-v-0ef67458] {\n    padding: 0.5rem;\n}\n.section-title[data-v-0ef67458] {\n    font-size: 0.9rem;\n}\n.code-pre[data-v-0ef67458] {\n    font-size: 0.7rem;\n    padding: 0.4rem;\n}\n}\n",""]);const i=l},660:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%2712%27 viewBox=%270 0 12 12%27%3E%3Cpath fill=%27%23374151%27 d=%27M6 9L1 4h10z%27/%3E%3C/svg%3E"},859:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.toast-container[data-v-4e34161e] {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  z-index: 20000; /* 提高到比加载遮罩(10000)更高的层级 */\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  gap: 16px;\n}\n.toast[data-v-4e34161e] {\n  display: flex;\n  align-items: center;\n  padding: 12px 20px;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  color: var(--color-text);\n  background-color: var(--color-surface);\n  border: 1px solid var(--color-border);\n  min-width: 250px;\n  max-width: 400px;\n  margin-bottom: 8px;\n}\n.toast-icon[data-v-4e34161e] {\n  margin-right: 12px;\n  font-size: 1.2rem;\n  display: flex;\n  align-items: center;\n}\n.toast-message[data-v-4e34161e] {\n  word-break: break-word;\n  font-size: 0.95rem;\n  line-height: 1.4;\n}\n\n/* Toast Types */\n.toast-success[data-v-4e34161e] {\n  border-left: 5px solid var(--color-success);\n}\n.toast-error[data-v-4e34161e] {\n  border-left: 5px solid var(--color-error);\n}\n.toast-warning[data-v-4e34161e] {\n  border-left: 5px solid var(--color-warning);\n}\n.toast-info[data-v-4e34161e] {\n  border-left: 5px solid var(--color-info);\n}\n.toast-loading[data-v-4e34161e] {\n  border-left: 5px solid var(--color-primary);\n}\n\n/* Spinner for loading */\n.spinner[data-v-4e34161e] {\n  width: 20px;\n  height: 20px;\n  border: 3px solid rgba(128, 128, 128, 0.3);\n  border-top-color: var(--color-primary);\n  border-radius: 50%;\n  animation: spin-4e34161e 1s linear infinite;\n}\n@keyframes spin-4e34161e {\nto {\n    transform: rotate(360deg);\n}\n}\n\n/* Transitions */\n.toast-fade-enter-active[data-v-4e34161e],\n.toast-fade-leave-active[data-v-4e34161e] {\n  transition: all 0.5s ease;\n}\n.toast-fade-enter-from[data-v-4e34161e],\n.toast-fade-leave-to[data-v-4e34161e] {\n  opacity: 0;\n  transform: translateX(100%);\n}\n",""]);const i=l},875:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.map-panel[data-v-3006c0a9] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n}\n\n/* 世界信息头部 */\n.world-info-header[data-v-3006c0a9] {\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.9);\n  border-bottom: 1px solid #e2e8f0;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  backdrop-filter: blur(8px);\n}\n.world-name[data-v-3006c0a9] {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: #1e40af;\n  text-shadow: 0 1px 2px rgba(30, 64, 175, 0.1);\n}\n.world-background[data-v-3006c0a9] {\n  font-size: 0.85rem;\n  color: #64748b;\n  max-width: 400px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n/* 地图内控制按钮 (左侧) */\n.map-controls-left[data-v-3006c0a9] {\n  position: absolute;\n  top: 12px;\n  left: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  z-index: 1000;\n}\n.control-btn[data-v-3006c0a9] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.95);\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: #64748b;\n}\n.control-btn[data-v-3006c0a9]:hover {\n  background: white;\n  border-color: #3b82f6;\n  color: #3b82f6;\n  transform: translateX(2px);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);\n}\n.control-btn[data-v-3006c0a9]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.map-status-mini[data-v-3006c0a9] {\n  padding: 4px 8px;\n  background: rgba(255, 255, 255, 0.95);\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  font-size: 0.7rem;\n  color: #64748b;\n  font-weight: 500;\n  white-space: nowrap;\n  writing-mode: vertical-rl;\n}\n\n/* 地图容器 */\n.custom-map-container[data-v-3006c0a9] {\n  flex: 1;\n  position: relative;\n  overflow: hidden;\n  border-radius: 8px;\n  border: 2px solid #e2e8f0;\n  background: linear-gradient(145deg, #f8fafc 0%, #e2e8f0 100%);\n}\n\n/* SVG地图样式 */\n.world-map-svg[data-v-3006c0a9] {\n  width: 100%;\n  height: 100%;\n  cursor: grab;\n}\n.world-map-svg[data-v-3006c0a9]:active {\n  cursor: grabbing;\n}\n\n/* 大洲层样式 - 针对紧密分布优化 */\n.continent-layer .continent-polygon[data-v-3006c0a9] {\n  cursor: pointer;\n  transition: fill-opacity 0.3s ease, stroke-width 0.3s ease, stroke-opacity 0.3s ease;\n}\n.continent-layer .continent-polygon[data-v-3006c0a9]:hover {\n  fill-opacity: 0.18; /* 稍微提高以更好地显示紧密分布的大陆 */\n  stroke-width: 3;\n  stroke-opacity: 1.0;\n  stroke-dasharray: 6,2; /* 缩短虚线间距以更好地显示边界 */\n}\n.continent-name-label[data-v-3006c0a9] {\n  font-family: '微软雅黑', 'SimHei', sans-serif;\n  pointer-events: none;\n  user-select: none;\n  font-size: 16px; /* 稍微增大字体以更好地显示紧密大陆名称 */\n  font-weight: bold;\n}\n\n/* 势力范围样式 */\n.territory-bounds-layer .territory-polygon[data-v-3006c0a9] {\n  cursor: pointer;\n  transition: fill-opacity 0.2s ease, stroke-width 0.2s ease;\n}\n.territory-bounds-layer .territory-polygon[data-v-3006c0a9]:hover {\n  fill-opacity: 0.25;\n  stroke-width: 3;\n}\n.territory-name-label[data-v-3006c0a9] {\n  font-size: 14px;\n  font-weight: bold;\n  font-family: '微软雅黑', 'SimHei', sans-serif;\n  pointer-events: none;\n}\n.headquarters-marker[data-v-3006c0a9] {\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n/* 地点标记样式 - 修复抽搐问题 */\n.location-marker[data-v-3006c0a9] {\n  cursor: pointer;\n  transition: none; /* 移除transition避免抽搐 */\n}\n.location-marker:hover .location-icon-group[data-v-3006c0a9] {\n  transform: scale(1.1);\n  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));\n}\n.location-icon-group[data-v-3006c0a9] {\n  transition: transform 0.15s ease, filter 0.15s ease;\n}\n\n/* 选中详情显示面板 (动态位置在地点顶部) */\n.selected-info-overlay[data-v-3006c0a9] {\n  position: absolute;\n  z-index: 1001;\n  pointer-events: none; /* 允许点击穿透到地图 */\n}\n.selected-info[data-v-3006c0a9] {\n  background: rgba(255, 255, 255, 0.98);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(59, 130, 246, 0.2);\n  border-radius: 12px;\n  padding: 16px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n  min-width: 300px;\n  max-width: 400px;\n  pointer-events: auto; /* 弹窗内容可以交互 */\n}\n.info-header[data-v-3006c0a9] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.info-header h4[data-v-3006c0a9] {\n  margin: 0;\n  color: #1e40af;\n  font-size: 1rem;\n  font-weight: 600;\n}\n.close-info[data-v-3006c0a9] {\n  width: 24px;\n  height: 24px;\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  color: #64748b;\n  font-size: 1.2rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n.close-info[data-v-3006c0a9]:hover {\n  background: rgba(220, 38, 38, 0.1);\n  color: #dc2626;\n}\n.info-content[data-v-3006c0a9] {\n  font-size: 0.875rem;\n  line-height: 1.5;\n}\n.info-type[data-v-3006c0a9] {\n  color: #6366f1;\n  font-weight: 600;\n  margin: 0 0 8px 0;\n}\n.info-desc[data-v-3006c0a9] {\n  color: #4b5563;\n  margin: 0 0 12px 0;\n}\n.info-detail[data-v-3006c0a9] {\n  color: #6b7280;\n  margin: 6px 0;\n  font-size: 0.8rem;\n}\n\n/* 地图图例 (右下角) */\n.map-legend[data-v-3006c0a9] {\n  position: absolute;\n  bottom: 20px;\n  right: 20px;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(8px);\n  border-radius: 8px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  padding: 12px;\n  z-index: 1000;\n  min-width: 140px;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n}\n.legend-title[data-v-3006c0a9] {\n  font-weight: 600;\n  color: #374151;\n  margin-bottom: 8px;\n  font-size: 0.875rem;\n  text-align: center;\n  border-bottom: 1px solid #e2e8f0;\n  padding-bottom: 4px;\n}\n.legend-items[data-v-3006c0a9] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.legend-item[data-v-3006c0a9] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.75rem;\n  color: #6b7280;\n  padding: 2px;\n}\n.legend-icon[data-v-3006c0a9] {\n  width: 16px;\n  height: 16px;\n  border-radius: 2px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 10px;\n  flex-shrink: 0;\n}\n\n/* 动画效果 */\n.animate-spin[data-v-3006c0a9] {\n  animation: spin-3006c0a9 1s linear infinite;\n}\n@keyframes spin-3006c0a9 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n\n/* SVG元素样式 */\n.location-name-label[data-v-3006c0a9] {\n  font-size: 11px;\n  font-weight: 600;\n  font-family: '微软雅黑', 'SimHei', sans-serif;\n  pointer-events: none; /* 防止标签干扰鼠标事件 */\n}\n.location-icon-text[data-v-3006c0a9] {\n  font-size: 9px;\n  font-weight: bold;\n  font-family: '微软雅黑', sans-serif;\n  pointer-events: none;\n}\n.player-name-label[data-v-3006c0a9] {\n  font-size: 12px;\n  font-weight: 700;\n  font-family: '微软雅黑', sans-serif;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.map-legend[data-v-3006c0a9] {\n    bottom: 10px;\n    right: 10px;\n    padding: 8px;\n    min-width: 120px;\n}\n.map-controls-left[data-v-3006c0a9] {\n    top: 8px;\n    left: 8px;\n    gap: 4px;\n}\n.control-btn[data-v-3006c0a9] {\n    width: 28px;\n    height: 28px;\n}\n.selected-info-overlay[data-v-3006c0a9] {\n    top: 10px;\n    left: 10px;\n    right: 10px;\n    transform: none;\n}\n.selected-info[data-v-3006c0a9] {\n    min-width: auto;\n    max-width: none;\n}\n}\n\n/* 全屏模式优化 */\n.map-panel[data-v-3006c0a9]:fullscreen {\n  background: #1a1a2e;\n  z-index: 999999; /* 确保全屏容器在最高层 */\n}\n.map-panel:fullscreen .custom-map-container[data-v-3006c0a9] {\n  border: none;\n  border-radius: 0;\n}\n.map-panel:fullscreen .map-legend[data-v-3006c0a9] {\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  z-index: 999998;\n}\n.map-panel:fullscreen .selected-info[data-v-3006c0a9] {\n  background: rgba(0, 0, 0, 0.9) !important;\n  color: white !important;\n  pointer-events: auto !important;\n  z-index: 999999 !important;\n  border: 1px solid rgba(255, 255, 255, 0.3) !important;\n  position: fixed !important; /* 确保在全屏模式下使用fixed定位 */\n}\n.map-panel:fullscreen .selected-info-overlay[data-v-3006c0a9] {\n  z-index: 999999 !important;\n  pointer-events: none !important;\n  position: fixed !important; /* 全屏模式下使用fixed定位 */\n}\n.map-panel:fullscreen .selected-info-overlay .selected-info[data-v-3006c0a9] {\n  pointer-events: auto !important;\n  position: relative !important; /* 内部弹窗使用relative定位 */\n}\n.map-panel:fullscreen .close-info[data-v-3006c0a9] {\n  color: white !important;\n}\n.map-panel:fullscreen .close-info[data-v-3006c0a9]:hover {\n  background: rgba(255, 255, 255, 0.2) !important;\n  color: #ff6b6b !important;\n}\n\n/* 全屏模式下确保弹窗文本可见 */\n.map-panel:fullscreen .selected-info[data-v-3006c0a9] * {\n  color: white !important;\n}\n.map-panel:fullscreen .selected-info .info-header h4[data-v-3006c0a9] {\n  color: #60a5fa !important; /* 蓝色标题在黑色背景下更明显 */\n}\n",""]);const i=l},908:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.modal-overlay[data-v-57fafbc4] {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n.modal-content[data-v-57fafbc4] {\n  background: var(--color-background);\n  border-radius: 12px;\n  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.modal-content.stats-modal[data-v-57fafbc4] {\n  max-width: 600px;\n}\n.modal-header[data-v-57fafbc4] {\n  padding: 1.5rem 1.5rem 1rem 1.5rem;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.modal-header h3[data-v-57fafbc4] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.close-btn[data-v-57fafbc4] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 6px;\n  transition: all 0.2s;\n}\n.close-btn[data-v-57fafbc4]:hover {\n  background: var(--color-hover);\n  color: var(--color-text);\n}\n.modal-body[data-v-57fafbc4] {\n  padding: 1.5rem;\n  overflow-y: auto;\n  flex: 1;\n}\n.stats-grid[data-v-57fafbc4] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1rem;\n  margin-bottom: 2rem;\n}\n.stat-card[data-v-57fafbc4] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  transition: all 0.2s;\n}\n.stat-card[data-v-57fafbc4]:hover {\n  background: var(--color-hover);\n  border-color: var(--color-primary);\n}\n.stat-icon[data-v-57fafbc4] {\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.stat-icon.chat[data-v-57fafbc4] {\n  background: rgba(59, 130, 246, 0.1);\n  color: #3b82f6;\n}\n.stat-icon.global[data-v-57fafbc4] {\n  background: rgba(34, 197, 94, 0.1);\n  color: #22c55e;\n}\n.stat-icon.memory[data-v-57fafbc4] {\n  background: rgba(168, 85, 247, 0.1);\n  color: #a855f7;\n}\n.stat-icon.world[data-v-57fafbc4] {\n  background: rgba(245, 158, 11, 0.1);\n  color: #f59e0b;\n}\n.stat-info[data-v-57fafbc4] {\n  flex: 1;\n}\n.stat-value[data-v-57fafbc4] {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--color-text);\n  margin-bottom: 0.25rem;\n}\n.stat-label[data-v-57fafbc4] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.data-size-info[data-v-57fafbc4] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n}\n.data-size-info h4[data-v-57fafbc4] {\n  margin: 0 0 0.75rem 0;\n  font-size: 0.95rem;\n  color: var(--color-text);\n}\n.size-list[data-v-57fafbc4] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.size-item[data-v-57fafbc4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem 0;\n  border-bottom: 1px solid var(--color-border);\n}\n.size-item[data-v-57fafbc4]:last-child {\n  border-bottom: none;\n}\n.size-item span[data-v-57fafbc4]:first-child {\n  color: var(--color-text-secondary);\n  font-size: 0.875rem;\n}\n.size-item span[data-v-57fafbc4]:last-child {\n  color: var(--color-text);\n  font-weight: 500;\n  font-size: 0.875rem;\n}\n",""]);const i=l},948:(e,n,t)=>{t.d(n,{useCharacterStore:()=>T});var a=t(4061),o=t(1774),r=t(2224),l=t(4270),i=t(3302),c=t(9173),s=t(1211);const d="saves",m="root_data";let p=null;function v(){return new Promise((e,n)=>{if(p)return void e(p);const t=indexedDB.open("DAD_SAVES_DB",1);t.onerror=()=>{console.error("【乾坤宝库-IDB】数据库打开失败:",t.error),n(t.error)},t.onsuccess=()=>{p=t.result,console.log("【乾坤宝库-IDB】数据库已打开"),e(t.result)},t.onupgradeneeded=e=>{const n=e.target.result;n.objectStoreNames.contains(d)||(n.createObjectStore(d,{keyPath:"id"}),console.log("【乾坤宝库-IDB】对象存储已创建:",d))}})}async function u(){try{const e=await v();return new Promise((n,t)=>{const a=e.transaction([d],"readonly").objectStore(d).get(m);a.onsuccess=()=>{if(a.result&&a.result.data){console.log("【乾坤宝库-IDB】根数据加载成功");const e=a.result.data;n({当前激活存档:e.当前激活存档||null,角色列表:e.角色列表||{}})}else console.log("【乾坤宝库-IDB】无存档数据，返回空结构"),n({当前激活存档:null,角色列表:{}})},a.onerror=()=>{console.error("【乾坤宝库-IDB】读取失败:",a.error),t(a.error)}})}catch(e){return console.error("【乾坤宝库-IDB】加载根数据时出错:",e),{当前激活存档:null,角色列表:{}}}}async function g(e){try{const n=await v();return new Promise((t,a)=>{const o=n.transaction([d],"readwrite"),r=o.objectStore(d);let l;try{l=JSON.parse(JSON.stringify(e))}catch(e){return console.error("【乾坤宝库-IDB】数据序列化失败:",e),void a(new Error(`数据包含不可序列化的内容: ${e}`))}const i=r.put({id:m,data:l,timestamp:(new Date).toISOString()});i.onsuccess=()=>{console.log("【乾坤宝库-IDB】根数据保存成功"),t()},i.onerror=()=>{console.error("【乾坤宝库-IDB】保存失败:",i.error),a(i.error)},o.oncomplete=()=>{console.log("【乾坤宝库-IDB】事务完成")}})}catch(e){throw console.error("【乾坤宝库-IDB】保存根数据时出错:",e),e}}var f=t(8651),b=t(414),h=t(8587),y=t(4775),x=t(3098);class k{static buildPrompt(e){const n=e.factionCount,t=e.totalLocations,a=e.continentCount,o=Math.min(e.secretRealms,t),r=n,l=t-r,i=Math.max(1,Math.floor(.2*l)),c=Math.max(1,Math.floor(.2*l)),s=Math.max(1,Math.floor(.1*l)),d=Math.max(0,l-i-c-s),m=Math.floor(o*(.3+.3*Math.random())),p=Math.floor(o*(.2+.3*Math.random())),v=Math.max(0,o-m-p),u=e.characterBackground?`\n角色出身: ${e.characterBackground}`:"",g=e.worldBackground?`\n世界背景(参考): ${e.worldBackground}`:"",f=e.worldEra?`\n世界时代(参考): ${e.worldEra}`:"",b=e.worldName?`\n世界名称(参考): ${e.worldName}`:"";let h,y,x,k;if(e.mapConfig)h=e.mapConfig.minLng,y=e.mapConfig.maxLng,x=e.mapConfig.minLat,k=e.mapConfig.maxLat;else{const e=100+20*Math.random(),n=e+5+10*Math.random(),t=25+15*Math.random(),a=t+3+8*Math.random();h=Math.round(10*e)/10,y=Math.round(10*n)/10,x=Math.round(10*t)/10,k=Math.round(10*a)/10}const w=[["破晓","星河","玄冥","洪荒","无极","太初","九幽","苍穹"],["神剑","仙门","道宫","灵山","秘境","圣地","仙岛","宝阁"],["真武","天机","混元","太乙","无量","玄天","紫霄","金光"]],N=w[0][Math.floor(Math.random()*w[0].length)],E=w[1][Math.floor(Math.random()*w[1].length)],V=w[2][Math.floor(Math.random()*w[2].length)],C=Date.now()+Math.floor(1e6*Math.random()),z=Math.random().toString(36).substring(7),S=["狭长型（如南北向的长条形）","椭圆型（东西向的宽椭圆）","不规则多角形（8-12个随机分布的顶点）","群岛型（多个连接的岛屿）","半月型（弯曲的月牙形状）","三角形（大致呈三角形分布）","葫芦型（两个圆形区域连接）","星形（从中心向外延伸的多个尖角）"].sort(()=>Math.random()-.5).slice(0,4),B=`${e.worldName||""} ${e.worldBackground||""}`,D=e=>e.test(B),A=D(/洪荒|上古|巫妖|盘古|女娲|三皇五帝/),_=D(/地球|现实|现代|都市|蓝星|人间/),$=D(/星际|太空|科幻|联邦|宇宙/),I=D(/仙侠|玄幻|修仙|道门|宗门/);let T="\n## 世界风格适配指引（根据背景自动调整）\n";return T+=A?"\n- **灵气浓度**: 极高 (先天灵气充沛)\n- **最高境界**: 可达仙人、圣人层次\n- **地理格局**: 参考“九州四海/洪荒大陆”式宏观板块，边界呈巨型自然断裂（神山、天海、天堑）。\n- **势力类型**: 减少现代宗门套路，增加“天庭/地府/部族/圣地/妖族祖庭”等神话势力；仍需保持 leadership/memberCount 等结构字段。\n- **地点类型**: 神山、仙岛、天河、祖脉、上古战场、封神遗迹、剑阵遗址等。\n- **资源与危险**: 灵脉密布，远古禁区/凶地危险等级更高。\n":_?"\n- **灵气浓度**: 极低 (末法时代，灵气稀薄)\n- **最高境界**: 严格限制在“筑基期”及以下，宗主、最强者修为普遍为“练气后期”或“练气圆满”。绝对禁止出现金丹期及以上的修士！\n- **地理格局**: 抽象化现实大洲/国家；用“结界/秘境/地脉节点”连接超自然地点。\n- **势力类型**: 隐世的古武门派、古老世家、修行者协会、超自然现象研究院、特殊安保机构等。字段结构不变但语境贴近现代，例如“宗主”可称为“门主”、“会长”。\n- **地点类型**: 都市中的隐秘道场、古迹遗址、灵气复苏的自然保护区、地下遗迹、深海秘境等。\n- **隐蔽性**: 所有超凡力量和地点都高度隐蔽，通过结界或现代科技手段与普通社会隔绝。\n":$?"\n- **灵气浓度**: 可变 (根据星球环境而定，可能存在高灵能星球和科技星球)\n- **最高境界**: 可与科技结合，形成独特的“基因锁”、“灵能等级”等体系\n- **地理格局**: 多星系/行星板块，用“扇区/环带/引力井”描述边界；多边形严禁重叠。\n- **势力类型**: 联邦/星盟/舰队修会/遗迹看护所/环轨道门派，保留组织字段。\n- **地点类型**: 母港、环轨道城、星门、遗迹舰坟、恒星观测站、暗物质脉点等。\n":I?"\n- **灵气浓度**: 中到高 (标准修仙世界)\n- **最高境界**: 通常可达渡劫期、大乘期\n- **地理格局**: 传统仙侠大陆与群山河谷结合，灵脉走向决定势力边界；禁区与圣地相间分布。\n- **势力类型**: 宗门/世家/魔道/商会/散修联盟/妖族部落等多元并存。\n- **地点类型**: 宗门山门、坊市、炼丹谷、秘境入口、古战场、洞天福地、试炼地等。\n":"\n- **灵气浓度**: 中等\n- **最高境界**: 默认为渡劫期\n- **风格**: 保持多样与独特性，根据背景自由发挥，同时遵守数量与边界不重叠的硬性约束。\n",console.log("[增强世界生成器] 最终数量 - 势力:",n,"地点:",t,"特殊属性:",o),console.log("[增强世界生成器] 随机坐标范围:",`经度${h}-${y}, 纬度${x}-${k}`),console.log("[增强世界生成器] 生成种子:",C,"会话ID:",z),console.log("[增强世界生成器] 选择的大洲形状:",S),`# 诸天万界势力地图生成任务\n\n**生成会话ID**: ${z}\n**随机种子**: ${C}\n**坐标范围**: 经度${h}-${y}, 纬度${x}-${k}\n**关键要求**: 创造独特多样的修仙世界，每次生成必须显著不同，避免重复固化的势力和地名\n**边界随机性**: 严格要求每个大洲和势力的边界形状都必须随机生成，绝不能重复之前的多边形形状！\n**数量限制**: 严格按照配置生成，势力${n}个、地点${t}个，绝不可超出此数量\n\n## ⚠️ 创意命名核心要求 - 严格执行\n\n**命名创新原则**:\n- **本次创意引导**: 使用${N}、${E}、${V}等词汇为创意基础\n- **世界背景决定**: 融合世界背景和修仙理念\n- **自然地理融合**: 融入山川、星辰、五行等自然元素\n- **独特性保证**: 每个名称都必须原创，避免常见套路组合\n- **随机种子${C}**: 确保本次生成完全不同于以往\n\n**积极的命名策略** (推荐模式):\n- **自然景观** + **修行理念**: 如"望星"+"悟道" = 望星悟道宗\n- **五行元素** + **宗门特色**: 如"烈火"+"炼体" = 烈火炼体门\n- **地貌特征** + **传承历史**: 如"断崖"+"古传" = 断崖古传派\n- **哲学思想** + **组织结构**: 如"无为"+"真门" = 无为真门\n\n**命名风格要求**:\n- 宗门名称：3-5字，体现传承与理念\n- 世家名称：姓氏+地域/特色\n- 魔道势力：偏向霸气或神秘\n- 商会组织：体现商业特色\n\n## 世界设定信息（仅供参考，不要在JSON输出中重复这些元数据）\n${u}${g}${f}${b}\n${T}\n\n重要：\n- 只生成地图相关数据（大洲边界、多边形、势力范围、地点坐标与类型）。\n- 严禁在JSON中输出 world_name / world_background / world_era / generation_info / player_spawn 等非地图字段。\n\n注意：以下词根及其同义/变体严禁出现在任何势力或地名中：\n本心、问心、见性、归一、太玄、太虚、紫薇、天机、青霞、无量、昊天、玄天、太清、太上、无极、九天。\n\n## 🎯 核心生成原则\n\n### 1. 【修仙世界基础】\n\n核心要求：\n- **核心体系**: 修仙、境界、功法、丹药、法宝等传统修仙元素\n- **权力结构**: 强者为尊的修仙世界等级秩序\n\n### 2. 【多样性第一】- 避免固化模式\n- **势力多样化**: 每次生成不同类型的势力组合。\n- **地名创新**: 完全避免使用模板化地名，每个名称都要有特色且独一无二\n- **规模平衡**: 修仙世界中宗门为主，但要根据背景调整表现形式\n\n### 3. 【势力规模】- 符合修仙体系设定\n根据修仙世界的基本规律和世界背景调整势力分布：\n\n**修仙世界的合理势力分布**:\n- 🏔️ **各大宗门** (40-50%): 修仙世界的主体势力\n- 🏛️ **修仙世家** (20-30%): 血脉传承，底蕴深厚\n- ⚔️ **魔道势力** (10-20%): 与正道对立的黑暗力量\n- 🏮 **散修联盟** (10-15%): 自由修士的松散组织\n- 💰 **商会组织** (5-15%): 贸易流通，中立势力\n- 🌿 **妖族部落** (5-10%): 非人种族，自然势力\n\n**重要**: 根据世界背景调整具体表现形式，但保持修仙体系的核心！\n\n## 🌍 地理层级结构\n\n### 大洲级别区域\n为了营造更宏大的世界观，需要创造${a}个大洲级别的地理区域来包裹各个势力：\n\n**大洲创造要求**：\n- **数量控制**: 必须创造${a}个大洲，将整个世界地图完全分割\n- **填满地图**: 🔥**关键要求**🔥 所有大洲边界加起来必须覆盖整个地图区域，不能有空白区域，相当于现实世界的七大洲四大洋概念\n- **命名创新**: 创造独特的大洲名称，避免使用"东西南北"等方位词\n- **地理特色**: 每个大洲要有独特的地理特征（如：雪域、沙漠、森林、海岛等）\n- **势力分布**: 大洲数量为${a}，每个大洲包含1-3个主要势力，形成更细致的地缘政治格局\n- **边界设计**: 大洲边界用简单规则多边形表示（4-8个坐标点），避免过于复杂的形状\n- **完整覆盖**: 🔥**核心要求**🔥 ${a}个大洲的边界多边形必须完全覆盖经度${h}-${y}，纬度${x}-${k}的整个区域\n- **🚫 重叠与空隙**: 大洲边界不能重叠，也不能留有空隙，必须像拼图一样完美拼接\n- **🚨 严格禁止重叠**: 这是最重要的要求！任何大洲的边界多边形都不能与其他大洲重叠，即使1个像素也不行\n- **📐 技术要求**: 生成前必须检查每个大洲的多边形是否与其他大洲有交集，如有交集必须调整边界\n- **🔍 自查机制**: 完成生成后，AI必须自检所有大洲边界是否有重叠，如发现重叠必须重新生成\n- **📏 边界共享**: 相邻大洲可以共享边界线，形成连续的世界地图\n- **🗺️ 分布策略**:\n  * 将整个经度${h}-${y}，纬度${x}-${k}区域按${a}个大洲均匀分割\n  * 每个大洲都是一个完整的地理板块，有自己的"大陆架"概念\n  * 大洲之间用自然边界分隔（如山脉、海峡、河流等概念上的分界线）\n  * 确保整个世界地图被完全分割，无遗漏区域\n  * 🔥**形状要求**🔥：使用简单的矩形、梯形或简单多边形，不要复杂的锯齿状边界\n- **📐 边界生成规则**:\n  * 每个大洲的经度跨度不超过${Math.round((y-h)/Math.ceil(Math.sqrt(a))*10)/10}度\n  * 每个大洲的纬度跨度不超过${Math.round((k-x)/Math.ceil(Math.sqrt(a))*10)/10}度\n  * 边界坐标必须在指定的经纬度范围内\n\n**本次大洲形状指导**（每个大洲选择不同的形状类型）:\n${S.map((e,n)=>`- 大洲${n+1}: ${e}`).join("\n")}\n\n**重要**: 每次生成时，每个大洲的边界形状都必须有显著差异，不能生成相似的多边形！\n\n## ⚠️ 数据结构完整性要求 - 必须严格遵守\n\n**势力数据必需字段检查单**:\n- ✓ **位置**: 必须是对象格式 {"longitude": 数值, "latitude": 数值}\n- ✓ **势力范围**: ⚠️**严禁空数组**⚠️ 必须是坐标点数组，至少4个点形成封闭多边形，每个势力都必须有势力范围！**尺寸要求：势力范围应占大洲面积的5%-15%，跨度0.5-1.5经纬度**\n- ✓ **leadership**: 必须包含宗主姓名和修为等完整信息\n- ✓ **memberCount**: 必须包含total、byRealm、byPosition完整统计\n\n**地点数据必需字段检查单**:\n- ✓ **coordinates**: 必须是对象格式 {"longitude": 数值, "latitude": 数值}\n- ✓ **name**: 必须是具体地点名称，不能为空\n- ✓ **type**: 必须是7种标准类型之一\n- ✓ **description**: 必须包含地点描述\n\n**严禁输出的错误格式**:\n- ✗ 空数组: "势力范围": [] ⚠️**这是绝对禁止的！每个势力必须有具体的势力范围坐标！**\n- ✗ 空数组: "大洲边界": [] ⚠️**这是绝对禁止的！每个大洲必须有具体的边界坐标！**\n- ✗ 空数组: "地理特征": [] ⚠️**这是绝对禁止的！每个大洲必须有具体的地理特征！**\n- ✗ 空数组: "天然屏障": [] ⚠️**这是绝对禁止的！每个大洲必须有具体的天然屏障！**\n- ✗ 无效坐标: "位置": "初始地"\n- ✗ 缺失字段: 任何必需字段为null或undefined\n- ✗ 势力范围少于4个点: 至少需要4个坐标点形成封闭区域\n- ✗ 大洲边界少于4个点: 至少需要4个坐标点形成简单多边形（推荐4-6个点）\n- ✗ 大洲边界过于复杂: 避免超过8个坐标点的复杂锯齿形状\n\n## 📊 本次生成参数 (严格按照配置)\n- **势力总数**: 必须精确生成${n}个势力，不多不少\n- **地点总数**: 必须精确生成${t}个地点，不多不少\n- **特殊属性**: 从${t}个地点中选择${o}个添加特殊属性\n\n**重要**: factions数组必须包含${n}个对象，locations数组必须包含${t}个对象！\n\n### 🏛️ 势力生成要求 (${n}个) - 完整组织架构\n\n**势力范围尺寸要求** - 🚫**绝对不能与大洲同等规模**:\n- **大洲 vs 势力范围关系**:\n  * **大洲**: 像现实世界的亚洲、欧洲那样的超大地理板块，覆盖地图的大片区域，**绝对不能重叠**\n  * **势力范围**: 像一个省份或大型城市群那样的区域，是大洲内的一块控制区域\n- **面积比例**: 势力范围应该占所在大洲面积的8%-25%，可以比较大但不能占据整个大洲\n- **具体尺寸对比**:\n  * **大洲边界**: 跨度5-10经纬度，覆盖地图的主要部分，**严禁重叠**\n  * **势力范围**: 跨度0.5-1.5经纬度，是大洲内的控制区域\n- **地理逻辑**:\n  * **大洲**: 相当于"大陆架"，是地理和文化的大区域，**必须完全不重叠**\n  * **势力**: 控制宗门总部、附属城市、资源产地、修炼秘境等区域\n- **❌ 错误示例**:\n  * 大洲边界重叠或有空隙（这是最严重的错误！）\n  * 两个大洲的多边形有任何交集或重叠区域\n  * 势力范围覆盖整个大洲或占据大洲80%以上面积\n  * 大洲边界不规整，无法形成完整覆盖\n- **✅ 正确示例**:\n  * 大洲像拼图一样完美拼接，无重叠无空隙\n  * 一个大洲内有1-3个势力，每个势力范围都是大洲内的较大多边形区域\n\n**宗门完整数据结构要求**:\n每个宗门势力都必须生成完整的组织架构信息，包括：\n\n**1. 基础信息**:\n- 宗门名称、类型、等级（超级/一流/二流/三流）\n- 宗门等级以一流/二流/三流/末流区分（不需要数值化实力）\n- 宗门描述和历史背景\n- 宗门特色和专长（必须是数组格式）\n\n**2. 领导层信息** (leadership字段) - **必须完整生成，前端会直接显示**:\n\`\`\`json\n"leadership": {\n  "宗主": "具体姓名（必填，如：欧阳烈风）",\n  "宗主修为": "具体境界（必填，如：化神中期、炼虚后期、合体初期、渡劫圆满等）",\n  "最强修为": "宗门内最高修为境界（必填，可能是太上长老或宗主的修为）",\n  "综合战力": 数字1-100（必填，如：85），\n  "核心弟子数": 具体数字（可选，如：50），\n  "内门弟子数": 具体数字（可选，如：300），\n  "外门弟子数": 具体数字（可选，如：1200）\n}\n\`\`\`\n\n**⚠️ 太上长老说明：**\n- 太上长老是可选职位，不是所有宗门都有\n- 通常出现在历史悠久的超级或一流宗门中\n- 太上长老一般不参与日常管理，但在重大决策时有发言权\n- 太上长老的修为可能高于现任宗主，也可能相当\n- 如果设置了太上长老，其修为应体现在"最强修为"字段中\n\n**⚠️ 重要：leadership字段是前端显示的核心数据，绝对不能省略或留空！**\n\n**⚠️ 人名生成要求（严格执行）：**\n- 宗主姓名：必须是具体的中式姓名（如：欧阳烈风、司徒云雅、独孤剑心）\n- 副宗主姓名：如果设置，必须是具体姓名（如：南宫月华、赵无极、白素贞）\n- 太上长老姓名：如果设置，必须是具体姓名（如：云中子、太极真人、无量道君）\n- 每个人名都必须是唯一的，不能重复\n- 人名格式要求：2-3个汉字，符合中华传统命名习惯\n\n**3. 成员统计信息** (memberCount字段) - **必须完整生成，前端宗门页面会显示**:\n\`\`\`json\n"memberCount": {\n  "total": 总人数（必填数字，如：1565），\n  "byRealm": {\n    // 境界分布必须与最强修为一致，只包含不高于最强修为的境界\n    "练气期": 数量,\n    "筑基期": 数量,\n    "金丹期": 数量,\n    "元婴期": 数量\n  },\n  "byPosition": {\n    "散修": 0,\n    "外门弟子": 数量（必填），\n    "内门弟子": 数量（必填），\n    "核心弟子": 数量（必填），\n    "传承弟子": 数量（必填，如：10），\n    "执事": 数量（必填，如：20），\n    "长老": 数量（必填，如：15），\n    "太上长老": 数量（可选，数量极少，根据宗门势力和规模决定，小势力没有，大势力也只有几个），\n    "副掌门": 数量（必填，如：1，一般只有一个），\n    "掌门": 1\n  }\n}\n\`\`\`\n\n**⚠️ 数据一致性要求：**\n- memberCount.total 必须等于 byPosition 所有职位的总和\n- byRealm 各境界总和必须等于 total\n- 所有数值必须是数字类型，不能是字符串\n- **前端会根据这些数据显示境界分布图表和成员统计！**\n\n### 🗺️ 地点生成要求 (${t}个) - 灵活分布\n\n**地点分布原则**:\n- **不强制每势力有地点**: 势力内可以有0-3个具体地点，不是每个势力都必须有地点\n- **地点类型多样化**: 总部、城市、秘境、危险区域、商业枢纽、修炼圣地、资源点等\n- **地理合理性**: 地点位置要在对应大洲范围内，可以在势力范围内外\n- **重要性分级**:\n  * 势力总部：通常是势力最重要的地点\n  * 重要城市：经济、政治中心\n  * 修炼圣地：特殊修炼环境\n  * 资源点：矿脉、药圃等\n  * 危险区域：试炼地、禁区等\n\n**地点与势力关系**:\n- 有些势力可能只有总部，没有其他具体地点\n- 大势力可能控制多个重要地点\n- 中立地点可能不属于任何势力\n- 危险区域通常无人控制或有特殊势力\n\n**地点分布**:\n- 🏯 **势力总部**: ${r}个 (对应各势力)\n- 🏘️ **城镇坊市**: ${i}个\n- ⚡ **特殊地点**: ${c}个\n- ⚠️ **危险区域**: ${s}个\n- 🌄 **自然景观**: ${d}个\n\n**地点类型** (必须使用以下7种标准类型):\n1. **natural_landmark** - 🏔️ 自然地标 (符合背景的自然景观)\n2. **sect_power** - 🏯 势力总部 (各修仙势力的总部)\n3. **city_town** - 🏘️ 城镇聚居地 (符合背景风格的城镇)\n4. **blessed_land** - ⛩️ 修炼圣地 (适合修仙的灵气充沛之地)\n5. **treasure_land** - 💎 资源宝地 (天材地宝、灵石矿脉等)\n6. **dangerous_area** - ⚔️ 危险区域 (凶兽巢穴、魔域险地等)\n7. **special_other** - 🌟 特殊地点 (传送阵、秘境入口等)\n\n### ✨ 特殊属性增强 (${o}个地点)\n\n从基础地点中选择${o}个添加特殊属性:\n- 🎯 **机遇之地**: ${m}个\n- 📜 **传承遗迹**: ${p}个\n- ☠️ **危险禁地**: ${v}个\n\n## 📋 JSON输出格式 (严格数量控制, 仅地图字段)\n\n**数量检查清单**:\n- ✅ continents数组包含${a}个大洲对象，彼此边界不重叠\n- ✅ 每个大洲的"大洲边界"数组包含4-8个坐标点，绝不为空\n- ✅ 每个大洲的"地理特征"数组包含至少3个特征，绝不为空\n- ✅ 每个大洲的"天然屏障"数组包含至少2个屏障，绝不为空\n- ✅ factions数组包含${n}个势力对象\n- ✅ 每个势力的"势力范围"数组包含至少4个坐标点，绝不为空\n- ✅ locations数组包含${t}个地点对象\n- ✅ 其中${o}个地点有special_attributes\n- ✅ 每个势力都分配到某个大洲\n\n**重要提醒**:\n- ⚠️ 所有坐标字段必须为数字：longitude/latitude 均为 number 类型，严禁使用诸如 "105.3-110.2" 这样的范围字符串或文本。\n- 仅输出 continents/factions/locations 三个顶级字段！\n- factions数组必须恰好包含${n}个元素，locations数组必须恰好包含${t}个元素！\n- 大陆边界绝对不能重叠，必须相互独立且保持安全距离\n\n\`\`\`json\n{\n  "continents": [\n    {\n      "id": "continent_1",\n      "名称": "大洲名称",\n      "描述": "大洲地理特征和文化描述",\n      "气候": "气候类型",\n      "地理特征": ["主要地貌特征1", "主要地貌特征2", "主要地貌特征3"],\n      "天然屏障": ["与其他大洲的天然屏障1", "天然屏障2"],\n      "大洲边界": [\n        // ⚠️ 大洲边界必须覆盖一个很大的区域，例如占整个地图的1/${a}\n        // 🔥 重要：使用简单形状，如矩形或简单多边形，不要复杂锯齿边界\n        // 这个示例大洲覆盖地图的一个大块区域（简单矩形）\n        {"longitude": ${h}, "latitude": ${x}},\n        {"longitude": ${h+Math.round((y-h)/2*10)/10}, "latitude": ${x}},\n        {"longitude": ${h+Math.round((y-h)/2*10)/10}, "latitude": ${k}},\n        {"longitude": ${h}, "latitude": ${k}}\n      ],\n      "主要势力": ["在此大洲的主要势力ID列表"]\n    }\n  ],\n  "factions": [\n    {\n      "id": "faction_1",\n      "名称": "势力名称",\n      "类型": "势力类型（修仙宗门/修仙世家/魔道势力等）",\n      "等级": "宗门等级（超级/一流/二流/三流）",\n      "描述": "势力背景描述，体现独特文化",\n      "特色": ["独特专长1", "独特专长2"],\n      "与玩家关系": "中立",\n      "声望值": "程序自动计算，无需填写",\n      "位置": {"longitude": ${h+2.5}, "latitude": ${x+1.5}},\n      "势力范围": [\n        // ⚠️ 关键要求：每个势力都必须有具体的势力范围，绝对不能是空数组！\n        // 至少需要4个坐标点形成一个封闭的多边形区域\n        // ⚠️ 重要：势力范围占大洲面积的5%-15%，跨度0.5-1.5经纬度\n        {"longitude": ${h+2}, "latitude": ${x+1}},\n        {"longitude": ${h+3.5}, "latitude": ${x+1.2}},\n        {"longitude": ${h+3.2}, "latitude": ${x+2.5}},\n        {"longitude": ${h+1.8}, "latitude": ${x+2}}\n      ],\n      "leadership": {\n        "宗主": "具体姓名（必填，如：欧阳烈风）",\n        "宗主修为": "具体境界（必填，如：化神中期、炼虚后期、合体初期、渡劫圆满等）",\n        "副宗主": "姓名（可选，如：王明月或null）",\n        "最强修为": "宗门内最高修为境界（必填，如：化神大圆满、炼虚极境、合体后期、渡劫圆满等）",\n        "综合战力": 数字1-100（必填，如：85），\n        "核心弟子数": 具体数字（可选），\n        "内门弟子数": 具体数字（可选），\n        "外门弟子数": 具体数字（可选）\n      },\n      "memberCount": {\n        "total": 总人数（必填数字，如：1565），\n        "byRealm": {\n          // 重要：根据上面的"最强修为"动态调整境界分布！\n          // 如果最强修为是化神期 → 只能有练气期到化神期\n          // 如果最强修为是渡劫期 → 可以有练气期到渡劫期\n          // 如果最强修为是炼虚期 → 只能有练气期到炼虚期\n          "练气期": 数量,\n          "筑基期": 数量,\n          "金丹期": 数量,\n          "元婴期": 数量\n        },\n        "byPosition": {\n          "散修": 0,\n          "外门弟子": 数量（必填，如：1200），\n          "内门弟子": 数量（必填，如：300），\n          "核心弟子": 数量（必填，如：50），\n          "传承弟子": 数量（必填，如：10），\n          "执事": 数量（必填，如：20），\n          "长老": 数量（必填，如：15），\n          "太上长老": 数量（可选，如：0或1），\n          "副掌门": 1，\n          "掌门": 1\n        }\n      },\n      "continent_id": "所属大洲的ID"\n    }\n  ],\n  "locations": [\n    {\n      "id": "loc_1",\n      "name": "地点名称",\n      "type": "7种标准类型之一",\n      "coordinates": {"longitude": ${h+2}, "latitude": ${x+1}},\n      "description": "地点详细描述",\n      "danger_level": "安全/普通/危险/极危险",\n      "suitable_for": ["适合群体"],\n      "controlled_by": "控制势力(可选)",\n      "special_features": ["地点特色"],\n      "special_attributes": ["特殊属性(可选)"]\n    }\n  ]\n}\n\`\`\`\n\n## ⚠️ 最终检查要求\n- ✅ 避免重复或相似的势力/地点名称\n- ✅ 保持修仙体系核心，强者为尊\n- ✅ 势力类型和专长符合修仙背景\n- ✅ JSON格式完整，坐标在指定范围内 (经度${h}-${y}，纬度${x}-${k})\n- ✅ **必须生成完整的leadership字段** - 包含宗主、宗主修为、最强修为、弟子数量等\n- ✅ **必须生成完整的memberCount字段** - 包含total、byRealm、byPosition等完整统计信息\n- ✅ **数据类型正确** - 所有数量字段必须是数字，不能是字符串\n- ✅ **数据一致性** - memberCount.total必须等于byPosition各职位总和\n\n**🚨 前端显示依赖警告：**\n势力宗门页面会直接使用leadership和memberCount字段显示宗门信息！\n缺少这些字段将导致页面显示"暂无宗门信息"！\n\n**核心目标**: 创造一个独一无二的修仙世界，包含完整的宗门组织架构信息！\n`}}const w={修仙宗门:1,正道宗门:1,魔道宗门:1.1,魔道势力:1.1,修仙世家:.9,世家:.9,商会:.7,商会组织:.7,中立宗门:.85,散修联盟:.75};function N(e){let n=0;const t=e.最强修为||e.宗主修为||"";n=t.includes("练气")?5:t.includes("筑基")?15:t.includes("金丹")?25:t.includes("元婴")?35:t.includes("化神")?45:t.includes("炼虚")?55:t.includes("合体")?65:t.includes("渡劫")?75:20;const a=e.长老数量||0,o=(e.核心弟子数||0)+(e.内门弟子数||0)+(e.外门弟子数||0);let r=0;r+=a>=50?15:a>=30?12:a>=20?10:a>=10?7:a>=5?4:Math.max(0,a),r+=o>=1e4?10:o>=5e3?8:o>=2e3?6:o>=1e3?4:o>=500?2:Math.max(0,Math.floor(o/250));let l=0;switch(e.等级){case"超级":case"超级宗门":l=10;break;case"一流":case"一流宗门":l=7;break;case"二流":case"二流宗门":l=4;break;case"三流":case"三流宗门":l=2;break;default:l=0}let i=0;switch(e.类型){case"魔道宗门":case"魔道势力":i=3;break;case"正道宗门":case"修仙宗门":i=1;break;case"修仙世家":case"世家":i=-1;break;case"商会":case"商会组织":i=-3;break;case"散修联盟":i=-2;break;default:i=0}let c=n+r+l+i;return t.includes("渡劫")?c=Math.max(c,85):t.includes("合体")?c=Math.max(c,75):t.includes("炼虚")?c=Math.max(c,65):t.includes("化神")&&(c=Math.max(c,55)),Math.min(100,Math.max(1,Math.round(c)))}function E(e){let n=5;switch(e.等级){case"超级":case"超级宗门":n=25;break;case"一流":case"一流宗门":n=20;break;case"二流":case"二流宗门":n=15;break;case"三流":case"三流宗门":n=10;break;default:n=5}const t=w[e.类型]||1;let a=0;const o=e.长老数量||0;o>=10?a+=3:o>=5?a+=2:o>=3&&(a+=1);const r=.8+.4*Math.random(),l=Math.round((n*t+a)*r);return Math.min(30,Math.max(0,l))}class V{config;previousErrors=[];originalConfig;constructor(e){this.config=e,this.originalConfig={factionCount:e.factionCount,locationCount:e.locationCount,secretRealmsCount:e.secretRealmsCount,continentCount:e.continentCount}}async generateValidatedWorld(){console.log("[增强世界生成器] 开始生成验证过的世界数据...");for(let e=0;e<=this.config.maxRetries;e++)try{e>0&&(console.log(`[增强世界生成器] 第 ${e} 次重试...`),await new Promise(n=>setTimeout(n,this.config.retryDelay*e)),this.reduceCountsForRetry(e));const n=await this.generateWorldData(),t=this.validateWorldData(n);if(t.isValid)return console.log("[增强世界生成器] 世界生成并验证成功！"),{success:!0,worldInfo:n};this.previousErrors=t.errors.map(e=>e.message),console.warn(`[增强世界生成器] 第 ${e} 次尝试验证失败:`,this.previousErrors)}catch(n){const t=n instanceof Error?n.message:String(n);console.error(`[增强世界生成器] 第 ${e} 次尝试生成失败:`,t),this.previousErrors=[t]}return console.error("[增强世界生成器] 世界生成失败，已达最大重试次数。"),{success:!1,errors:this.previousErrors}}reduceCountsForRetry(e){const n=Math.pow(.8,e);this.config.factionCount=Math.max(3,Math.floor(this.originalConfig.factionCount*n)),this.config.locationCount=Math.max(5,Math.floor(this.originalConfig.locationCount*n)),this.config.secretRealmsCount=Math.max(2,Math.floor(this.originalConfig.secretRealmsCount*n)),this.config.continentCount=Math.max(2,Math.floor(this.originalConfig.continentCount*n)),console.log(`[增强世界生成器] 重试 ${e} 次后调整数量参数（基于原始配置: faction=${this.originalConfig.factionCount}, location=${this.originalConfig.locationCount}）:`,{factionCount:this.config.factionCount,locationCount:this.config.locationCount,secretRealmsCount:this.config.secretRealmsCount,continentCount:this.config.continentCount})}async generateWorldData(){const e=(0,f.getTavernHelper)();if(!e)throw new Error("酒馆系统不可用");const n=this.buildPromptWithErrors();console.log("[增强世界生成器] 发送AI请求..."),console.log("[增强世界生成器] 提示词长度:",n.length);try{const t=[{role:"system",content:n}],a=await e.generateRaw({ordered_prompts:t,should_stream:!1});console.log("[增强世界生成器] AI响应长度:",String(a).length);const o=this.parseAIResponse(String(a));return this.convertToWorldInfo(o)}catch(e){console.error("[增强世界生成器] AI请求失败:",e);const n=e instanceof Error?e.message:String(e);throw new Error(`AI生成失败: ${n}`)}}buildPromptWithErrors(){const e=this.buildPrompt();return this.previousErrors.length>0?`${e}\n---\n请修正以下错误后重新生成:\n${this.previousErrors.join("\n")}\n---\n`:e}buildPrompt(){const{factionCount:e,locationCount:n,secretRealmsCount:t,continentCount:a,mapConfig:o}=this.config,r={factionCount:e,totalLocations:n,secretRealms:t,continentCount:a,characterBackground:this.config.characterBackground,worldBackground:this.config.worldBackground,worldEra:this.config.worldEra,worldName:this.config.worldName,mapConfig:o};return k.buildPrompt(r)}parseAIResponse(e){console.log("[增强世界生成器] 开始解析AI响应..."),console.log("[增强世界生成器] 响应前500字符:",e.substring(0,500));try{let n=null,t="";if(n=e.match(/```json\s*(\{[\s\S]*?\})\s*```/),n&&(t=n[1],console.log("[增强世界生成器] 使用策略1提取JSON")),n||(n=e.match(/(\{[\s\S]*?"factions"\s*:\s*\[[\s\S]*?"locations"\s*:\s*\[[\s\S]*?\})/),n&&(t=n[1],console.log("[增强世界生成器] 使用策略2提取JSON"))),!n){const n=e.match(/\{[\s\S]*?\}/g);if(n)for(const e of n)try{const n=JSON.parse(e);if(n.factions||n.locations){t=e,console.log("[增强世界生成器] 使用策略3提取JSON");break}}catch{continue}}if(!t)throw console.error("[增强世界生成器] 无法从AI响应中提取JSON数据"),console.error("[增强世界生成器] 完整响应:",e),new Error("无法解析AI响应中的JSON数据");console.log("[增强世界生成器] 提取的JSON前200字符:",t.substring(0,200));const a=JSON.parse(t);console.log("[增强世界生成器] JSON解析成功"),console.log("[增强世界生成器] 解析出的数据结构:",{factions_count:a.factions?.length||0,locations_count:a.locations?.length||0,has_continents:!!a.continents});const o={continents:Array.isArray(a.continents)?a.continents:[],factions:Array.isArray(a.factions)?a.factions:[],locations:Array.isArray(a.locations)?a.locations:[]},r=Object.keys(a).filter(e=>!["continents","factions","locations"].includes(e));return r.length&&console.log("[增强世界生成器] 已丢弃非地图字段:",r),o}catch(n){console.error("[增强世界生成器] JSON解析失败:",n),console.error("[增强世界生成器] 响应内容:",e);const t=n instanceof Error?n.message:String(n);throw new Error(`JSON解析失败: ${t}`)}}convertToWorldInfo(e){return{世界名称:this.config.worldName||e.world_name||e.worldName||"修仙界",世界背景:e.world_background||e.worldBackground||this.config.worldBackground||"",大陆信息:(e.continents||[]).map(e=>({名称:e.名称||e.name||"未名大陆",描述:e.描述||e.description||"一片神秘的修仙大陆，灵气充沛，势力林立",地理特征:e.terrain_features||e.地理特征||[],修真环境:e.cultivation_environment||e.修真环境||"灵气充沛，适宜修行",气候:e.climate||e.气候||"四季分明，温和宜人",天然屏障:e.natural_barriers||e.天然屏障||[],大洲边界:e.continent_bounds||e.大洲边界||[]})),势力信息:(e.factions||[]).map(e=>{const n={声望值:E(t={名称:e.name||e.名称,类型:e.type||e.类型||"修仙宗门",等级:e.level||e.等级||"三流",宗主修为:e.leadership?.宗主修为,最强修为:e.leadership?.最强修为,长老数量:e.memberCount?.byPosition?.长老||0,核心弟子数:e.leadership?.核心弟子数,内门弟子数:e.leadership?.内门弟子数,外门弟子数:e.leadership?.外门弟子数}),综合战力:N(t)};var t;return{名称:e.name||e.名称,类型:e.type||e.类型,等级:e.level||e.等级,位置:e.location||e.headquarters||e.位置,势力范围:e.territory||e.territory_bounds||e.势力范围||[],描述:e.description||e.描述,特色:e.specialties||e.features||e.特色||[],与玩家关系:e.player_relationship||e.与玩家关系||"中立",声望值:n.声望值,leadership:e.leadership?{宗主:e.leadership.宗主,宗主修为:e.leadership.宗主修为,副宗主:e.leadership.副宗主??void 0,太上长老:e.leadership.太上长老??void 0,太上长老修为:e.leadership.太上长老修为??void 0,最强修为:e.leadership.最强修为||e.leadership.宗主修为,综合战力:n.综合战力,核心弟子数:e.leadership.核心弟子数,内门弟子数:e.leadership.内门弟子数,外门弟子数:e.leadership.外门弟子数}:void 0,memberCount:e.memberCount?{total:Number(e.memberCount.total)||0,byRealm:e.memberCount.byRealm||{},byPosition:e.memberCount.byPosition||{}}:void 0,territoryInfo:e.territoryInfo?{controlledAreas:e.territoryInfo.controlledAreas||[],influenceRange:e.territoryInfo.influenceRange,strategicValue:e.territoryInfo.strategicValue}:void 0,canJoin:void 0===e.canJoin||!!e.canJoin,joinRequirements:e.joinRequirements||[],benefits:e.benefits||[]}}),地点信息:(e.locations||[]).map(e=>({名称:e.name||e.名称,类型:e.type||e.类型,位置:e.position||e.location||e.位置,coordinates:e.coordinates,描述:e.description||e.描述,特色:e.features||e.特色,安全等级:e.safety_level||e.danger_level||e.安全等级||"较安全",开放状态:e.status||e.开放状态||"开放",相关势力:e.related_factions||e.相关势力||[],特殊功能:e.special_functions||e.特殊功能||[]})),生成时间:(new Date).toISOString(),世界纪元:e.world_era||this.config.worldEra||"修仙纪元",特殊设定:e.special_settings||[],版本:"2.0-Enhanced"}}validateWorldData(e){console.log("[增强世界生成器] 开始校验世界数据...");const n={isValid:!0,errors:[]};return this.performCustomValidation(e,n),n.isValid?console.log("[增强世界生成器] 数据校验通过"):(this.previousErrors=n.errors.map(e=>e.message),console.warn("[增强世界生成器] 数据校验失败:",n.errors)),n}performCustomValidation(e,n){e.势力信息.length!==this.config.factionCount&&n.errors.push({path:"势力信息",message:`势力数量不正确，期望${this.config.factionCount}个，实际${e.势力信息.length}个`,expected:this.config.factionCount,received:e.势力信息.length}),e.地点信息.length!==this.config.locationCount&&n.errors.push({path:"地点信息",message:`地点数量不正确，期望${this.config.locationCount}个，实际${e.地点信息.length}个`,expected:this.config.locationCount,received:e.地点信息.length});const t=e.势力信息.reduce((e,n)=>{const t=n.等级;return e[t]=(e[t]||0)+1,e},{});t["超级"]>1&&n.errors.push({path:"势力信息.等级",message:"超级势力不能超过1个",expected:"1个超级势力",received:`${t["超级"]}个超级势力`});const a=e.势力信息.map(e=>e.名称),o=new Set(a);a.length!==o.size&&n.errors.push({path:"势力信息.名称",message:"势力名称存在重复",expected:"所有名称唯一",received:"存在重复名称"});const r=e.地点信息.map(e=>e.名称),l=new Set(r);r.length!==l.size&&n.errors.push({path:"地点信息.名称",message:"地点名称存在重复",expected:"所有名称唯一",received:"存在重复名称"}),this.config.worldName&&e.世界名称!==this.config.worldName&&n.errors.push({path:"世界名称",message:"世界名称必须与玩家选择一致",expected:this.config.worldName,received:e.世界名称}),n.isValid=0===n.errors.length}}var C=t(7527);async function z(e,n){return new Promise(t=>{(0,c.useUIStore)().showRetryDialog({title:`${e}失败`,message:`${e}经过多次尝试后仍然失败。\n\n错误信息：${n}\n\n是否继续重试？\n选择"取消"将终止角色创建流程。`,onConfirm:()=>t(!0),onCancel:()=>t(!1)})})}function S(e,n){const{先天六司:t,天赋:a}=e,o=Number(t?.根骨??0),r=Number(t?.灵性??0),l=Number(t?.悟性??0),i=100+10*o,c=50+5*r,s=30+3*l,d=80+5*o;let m=0;return a&&Array.isArray(a)&&a.some(e=>"霸王血脉"===e.名称)&&(m=1,console.log(`[角色初始化] 检测到天赋 "霸王血脉"，初始天道点 +${m}`)),console.log(`[角色初始化] 属性计算: 气血=${i}, 灵气=${c}, 神识=${s}, 年龄=${n}/${d}`),console.log(`[角色初始化] 先天六司: 根骨=${o}, 灵性=${r}, 悟性=${l}`),{境界:{名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"},声望:0,位置:{描述:"位置生成失败"},气血:{当前:i,上限:i},灵气:{当前:c,上限:c},神识:{当前:s,上限:s},寿命:{当前:n,上限:d},状态效果:[],系统任务:{配置:{启用:!1,任务类型:"all",颁发数量:3},进行中任务:[],已完成任务名称:[]},天道点:m}}async function B(e,n,a,o){console.log("[初始化流程] ===== initializeCharacter 入口 ====="),console.log("[初始化流程] 接收到的 baseInfo.先天六司:",n.先天六司);const r=(0,c.useUIStore)();try{const{saveData:e,processedBaseInfo:l}=function(e,n){let t;console.log("[初始化流程] 1. 准备初始存档数据"),console.log("[初始化流程] prepareInitialData 接收到的 baseInfo.先天六司:",e.先天六司);try{t=JSON.parse(JSON.stringify(e)),console.log("[初始化流程] JSON 序列化后的 processedBaseInfo.先天六司:",t.先天六司)}catch(n){console.error("[角色初始化] JSON 序列化失败，使用原始对象",n),t=e}t.年龄||(t.年龄=n);var a;Math.floor(12*Math.random()),Math.floor(60*Math.random()),t.出生日期||(t.出生日期={年:1e3-n,月:1,日:1,小时:0,分钟:0},console.log(`[角色初始化] 设置出生日期: ${t.出生日期.年}年${t.出生日期.月}月${t.出生日期.日}日 (当前${n}岁)`)),t.后天六司||(t.后天六司={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0},console.log("[角色初始化] 初始化后天六司为全0")),"string"!=typeof(a=t.灵根)||"随机灵根"!==a&&!a.includes("随机")?console.log("[灵根生成] 检测到玩家已选择特定灵根，将直接使用该灵根，不进行随机化处理。"):console.log("[灵根生成] 检测到随机灵根，将由 AI 创造性生成"),"string"!=typeof t.出生||"随机出生"!==t.出生&&!t.出生.includes("随机")||console.log("[出生生成] 检测到随机出生，将由 AI 创造性生成");const o={角色基础信息:t,玩家角色状态:S(t,n),装备栏:{装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null},三千大道:{大道列表:{}},背包:{灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}},人物关系:{},宗门系统:{availableSects:[],sectRelationships:{},sectHistory:[]},记忆:{短期记忆:[],中期记忆:[],长期记忆:[]},游戏时间:{年:1e3,月:1,日:1,小时:Math.floor(12*Math.random())+6,分钟:Math.floor(60*Math.random())},修炼功法:null,掌握技能:[],系统:{规则:{属性上限:{先天六司:{每项上限:10}},装备系统:"装备栏存储引用{物品ID,名称}，完整数据在背包.物品中",品质控制:"严格遵守境界对应品质范围，仙品世界上几乎没有，每一个都是令世界动荡的存在，神品不存在"},提示:["⚠️ 先创建后修改：修改数据前必须确保数据已存在","装备栏字段：装备1-6"],nsfwMode:!0,nsfwGenderFilter:(()=>{try{const e=localStorage.getItem("dad_game_settings");if(e)return JSON.parse(e).nsfwGenderFilter||"all"}catch(e){console.error("[初始化] 读取NSFW性别过滤设置失败:",e)}return"all"})()}};return o.装备栏._AI重要提醒="⚠️ 引用的物品ID必须已经在背包.物品数组中存在",o.人物关系._AI重要提醒="⚠️ 每次与NPC对话或者在周围存在互动必须添加人物记忆",{saveData:o,processedBaseInfo:t}}(n,o),i=await async function(e,n){console.log("[初始化流程] 2. 生成世界数据");const t=(0,c.useUIStore)();t.updateLoadingText("🌍 世界生成: 准备配置...");const a=(0,s.N)(),o=a.worldGenerationConfig,r=a.selectedWorld,l={worldName:r?.name||n.name,worldBackground:r?.description||n.description,worldEra:r?.era||n.era,factionCount:o.majorFactionsCount||7,locationCount:o.totalLocations||25,secretRealmsCount:o.secretRealmsCount||8,continentCount:o.continentCount||Math.floor(5*Math.random())+3,maxRetries:3,retryDelay:2e3,characterBackground:(e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e&&"名称"in e){const n=e.名称;if("string"==typeof n)return n}return String(e??"")})(e.出生),mapConfig:o.mapConfig};console.log("[初始化流程] 开始调用世界生成器..."),t.updateLoadingText("🌍 世界生成: 调用AI生成世界架构...");const i=new V(l),d=Date.now(),m=await i.generateValidatedWorld(),p=Date.now()-d;if(console.log(`[初始化流程] 世界生成器返回,耗时: ${p}ms`),m.success&&m.worldInfo)return console.log("[初始化流程] 世界生成成功"),t.updateLoadingText("🌍 世界生成: 完成"),m.worldInfo;throw new Error(`世界生成失败：${m.errors?.join(", ")||"未知错误"}`)}(l,a);e.世界信息=i,console.log("[初始化流程] 2.5 将世界信息保存到酒馆变量..."),r.updateLoadingText("🌍 保存世界信息到酒馆...");try{const e=(0,f.getTavernHelper)();if(e){const{deepCleanForClone:n}=await Promise.resolve().then(t.bind(t,3098)),a=n({世界信息:i});await e.insertOrAssignVariables(a,{type:"chat"}),console.log("[初始化流程] ✅ 世界信息已保存到酒馆，包含",i.大陆信息?.length||0,"个大陆"),console.log("[初始化流程] 大陆列表:",i.大陆信息?.map(e=>e.名称||e.name).join("、"))}else console.warn("[初始化流程] ⚠️ 酒馆助手不可用，跳过世界信息保存")}catch(e){console.error("[初始化流程] ❌ 保存世界信息到酒馆失败:",e)}console.log("[初始化流程] 准备调用generateOpeningScene...");const{finalSaveData:d}=await async function(e,n,t,a){console.log("[初始化流程] 3. 生成开场剧情"),(0,c.useUIStore)().updateLoadingText("天道正在为你书写命运之章...");const o={name:n.名字,gender:n.性别,race:n.种族,age:a,world:t.name,talentTier:n.天资,origin:n.出生,spiritRoot:n.灵根,talents:n.天赋||[],attributes:n.先天六司||{}},r=(0,y.IJ)(o),l=e=>{if(!e)return"";if("string"==typeof e)return e;if("object"==typeof e){const n=e;if("string"==typeof n.名称)return n.名称;if("string"==typeof n.name)return n.name}return String(e)},i={baseInfo:n,saveData:e,world:{...t,description:`世界名: ${t.name}, 纪元: ${t.era}. 背景: ${t.description}`},creationDetails:{age:a,originName:l(n.出生),spiritRootName:l(n.灵根),talentTierName:l(n.天资),talentNames:Array.isArray(n.天赋)?n.天赋.map(e=>e?.name||e?.名称||String(e)).filter(Boolean):[]},worldInfo:e.世界信息,availableContinents:e.世界信息?.大陆信息?.map(e=>({名称:e.名称||e.name,描述:e.描述||e.description,大洲边界:e.大洲边界||e.continent_bounds}))||[],availableLocations:e.世界信息?.地点信息?.map(e=>({名称:e.名称||e.name,类型:e.类型||e.type,描述:e.描述||e.description,所属势力:e.所属势力||e.faction,coordinates:e.coordinates}))||[],mapConfig:e.世界信息?.地图配置,systemSettings:e.系统||{nsfwMode:!0,nsfwGenderFilter:"all"}};console.log(`[初始化] 准备生成开场剧情，角色: ${n.名字}`),console.log("[初始化] 可用大陆列表:",i.availableContinents.map(e=>e.名称)),console.log("[初始化] 可用地点数量:",i.availableLocations?.length||0);const s=await async function(e,n,t,a){const o=(0,c.useUIStore)();let r=null,l=0;for(;;){l++;try{l>1&&o.updateLoadingText(`${a} (第 ${l-1} 次重试)`),console.log(`[robustAICall] 正在尝试: ${a}, 第 ${l} 次`);const t=await e();if(console.log(`[robustAICall] 收到响应 for ${a}:`,t),n(t))return console.log(`[robustAICall] 响应验证成功 for ${a}`),t;throw new Error("AI响应格式无效或未通过验证")}catch(e){if(r=e instanceof Error?e:new Error(String(e)),console.warn(`[AI调用重试] 第 ${l} 次尝试失败:`,r.message),l>3){if(await z(a,r.message)){l=0;continue}throw new Error(`${a}失败，用户选择不继续重试: ${r.message}`)}await new Promise(e=>setTimeout(e,1e3*l))}}}(async()=>{console.log("[初始化] ===== 开始生成开场剧情 =====");const e=Date.now();try{const n=await(0,b.generateInitialMessage)(i,{},r),t=Date.now()-e;return console.log(`[初始化] ✅ AI生成完成,耗时: ${t}ms`),n}catch(e){throw console.error("[初始化] ❌ AI生成失败:",e),e}},e=>!e||!e.text||"string"!=typeof e.text||e.text.trim().length<200?(console.warn("[AI验证] 生成的文本太短或无效"),!1):e.text.includes("placeholder")||e.text.includes("TODO")||e.text.includes("待填充")?(console.warn("[AI验证] 生成的文本包含占位符"),!1):(console.log("[AI验证] ✅ 验证通过"),!0),0,"天道正在书写命运之章"),{saveData:d,stateChanges:m}=await(0,h.Dj)(s,e,!0);if(T().setInitialCreationStateChanges(m),!String(s.text||"").trim())throw new Error("AI生成的开场剧情为空");return console.log("[初始化] ✅ generateOpeningScene完成,返回数据"),{finalSaveData:d,aiResponse:s}}(e,l,a,o);console.log("[初始化流程] generateOpeningScene已返回"),console.log("[初始化流程] 核心属性校准：重新应用计算出的初始属性...");const m=S(n,o),p=d.玩家角色状态||{};d.玩家角色状态={...m,...p,寿命:m.寿命,气血:m.气血,灵气:m.灵气,神识:m.神识,境界:m.境界},console.log("[初始化流程] 核心属性校准完成。"),console.log("[初始化流程] 准备最终化并同步数据...");const v=await async function(e,n,a,o){console.log("[初始化流程] 4. 合并、验证并同步最终数据");const r=(0,c.useUIStore)();r.updateLoadingText(`正在同步数据，即将进入${n.名字}的修仙世界...`);const l=(0,f.getTavernHelper)();if(!l)throw new Error("无法连接到酒馆服务");const{deepCleanForClone:i}=await Promise.resolve().then(t.bind(t,3098)),d={...e.角色基础信息,...n,名字:n.名字,性别:n.性别,种族:n.种族,年龄:o,先天六司:n.先天六司,天赋:n.天赋},m=(0,s.N)(),p=m.selectedSpiritRoot;if(p)console.log(`[数据最终化] ✅ 用户选择特定灵根，使用用户选择: ${p.name}`),d.灵根={名称:p.name,品级:p.tier,描述:p.description,base_multiplier:p.base_multiplier,cultivation_speed:p.cultivation_speed,special_effects:p.special_effects};else{console.log("[数据最终化] 🎲 用户选择随机灵根，使用AI生成的数据");const t=e.角色基础信息?.灵根;if(console.log("[数据最终化] AI生成的灵根数据:",JSON.stringify(t)),d.灵根=t||"随机灵根","string"==typeof d.灵根&&d.灵根.includes("随机")){console.warn("[数据最终化] ⚠️ 警告：AI未能正确替换随机灵根，使用本地数据库生成");const e=n.天资;let t=C.Gr.filter(n=>"废柴"===e||"凡人"===e?"凡品"===n.tier||"下品"===n.tier:"俊杰"===e?"中品"===n.tier||"上品"===n.tier:"天骄"===e?"上品"===n.tier||"极品"===n.tier:"妖孽"===e?"极品"===n.tier||"神品"===n.tier:"凡品"===n.tier||"下品"===n.tier);0===t.length&&(t=C.Gr);const a=t[Math.floor(Math.random()*t.length)];d.灵根={名称:a.name,品级:a.tier,描述:a.description,base_multiplier:a.base_multiplier,cultivation_speed:a.cultivation_speed,special_effects:a.special_effects},console.log(`[数据最终化] ✅ 已从本地数据库生成随机灵根: ${a.name} (${a.tier})`)}}const v=m.selectedOrigin;if(v)console.log(`[数据最终化] ✅ 用户选择特定出身，使用用户选择: ${v.name}`),d.出生={名称:v.name,描述:v.description};else{console.log("[数据最终化] 🎲 用户选择随机出身，使用AI生成的数据");const n=e.角色基础信息?.出生;if(console.log("[数据最终化] AI生成的出身数据:",JSON.stringify(n)),d.出生=n||"随机出身","string"==typeof d.出生&&d.出生.includes("随机")){console.warn("[数据最终化] ⚠️ 警告：AI未能正确替换随机出身，使用本地数据库生成");const e=C.yM[Math.floor(Math.random()*C.yM.length)];d.出生={名称:e.name,描述:e.description},console.log(`[数据最终化] ✅ 已从本地数据库生成随机出身: ${e.name}`)}}const u=function(e,n){const t={...e},a=(0,s.N)();console.log("[数据校准] 开始从创角仓库同步所有权威数据..."),console.log("[数据校准] 【重要】所有用户手动选择的数据都将被保护，不被AI或代码修改"),t.世界=n;const o=a.selectedTalentTier;o?(console.log(`[数据校准] ✅ 同步用户选择的天资: ${o.name}`),t.天资={名称:o.name,描述:o.description}):console.warn("[数据校准] 警告: 无法找到权威的天资数据。");const r=a.selectedOrigin;r?(console.log(`[数据校准] ✅ 同步用户选择的出身: ${r.name}`),t.出生={名称:r.name,描述:r.description}):null===a.characterPayload.origin_id?"object"==typeof t.出生&&t.出生&&"名称"in t.出生&&!t.出生.名称.includes("随机")?console.log("[数据校准] ✅ 检测到AI已生成具体出身，保留AI结果:",t.出生.名称):(console.log("[数据校准] 🎲 用户选择随机出身，当前无有效值，标记为随机"),t.出生={名称:"随机出身",描述:"身世迷离，一切皆有可能。"}):console.warn("[数据校准] 警告: 无法找到权威的出身数据。");const l=a.selectedSpiritRoot;l?(console.log(`[数据校准] ✅ 同步用户选择的灵根: ${l.name} (${l.tier})`),t.灵根={名称:l.name,品级:l.tier||"凡品",描述:l.description||"基础灵根"}):null===a.characterPayload.spirit_root_id?"object"==typeof t.灵根&&t.灵根&&"名称"in t.灵根&&!t.灵根.名称.includes("随机")?console.log("[数据校准] ✅ 检测到AI已生成具体灵根，保留AI结果:",t.灵根.名称):(console.log("[数据校准] 🎲 用户选择随机灵根，当前无有效值，标记为随机"),t.灵根={名称:"随机灵根",品级:"凡品",描述:"大道五十，天衍四九，人遁其一"}):console.warn("[数据校准] 警告: 无法找到权威的灵根数据。");const i=a.selectedTalents;i&&i.length>0?(console.log(`[数据校准] ✅ 同步用户选择的天赋，共 ${i.length} 个`),t.天赋=i.map(e=>(console.log(`[数据校准]    -> 天赋: ${e.name}`),{名称:e.name,描述:e.description}))):(console.log("[数据校准] 用户未选择任何天赋，天赋字段设置为空数组。"),t.天赋=[]);const c=a.attributes;return console.log("[数据校准] ✅ 同步用户分配的先天六司:",c),t.先天六司={根骨:c.root_bone,灵性:c.spirituality,悟性:c.comprehension,气运:c.fortune,魅力:c.charm,心性:c.temperament},console.log("[数据校准] 权威数据同步完成。"),t}(d,a.name);e.角色基础信息=u,console.log("[数据最终化] 重新计算并校准核心玩家状态...");const g=S(n,o),b=e.玩家角色状态?.位置;if(e.玩家角色状态=g,b&&"string"==typeof b.描述&&"位置生成失败"!==b.描述?(e.玩家角色状态.位置=b,console.log(`[数据最终化] 已保留AI生成的位置信息: "${b.描述}"`)):console.warn("[数据最终化] AI未生成有效位置，将使用默认位置。"),console.log("[数据最终化] 核心玩家状态校准完成。"),e.游戏时间){const n={年:e.游戏时间.年-o,月:e.游戏时间.月,日:e.游戏时间.日,小时:0,分钟:0};e.角色基础信息.出生日期=n,console.log(`[数据最终化] 重新计算出生日期: ${n.年}年${n.月}月${n.日}日 (游戏时间${e.游戏时间.年}年 - 开局年龄${o}岁)`)}const h=e.玩家角色状态?.位置?.描述;if(!h||"string"!=typeof h||!h.includes("·")||h.includes("undefined"))throw new Error(`最终数据校验失败：位置信息无效或缺失。获取到的位置: "${h}"`);console.log(`[数据校准] 位置信息校验通过: "${h}"`);const y=(0,x.zB)(e,{角色基础信息:n,模式:"单机"},"creation");if(!y.isValid)throw new Error(`角色数据最终验证失败: ${y.errors.join(", ")}`);if(e.修炼功法){const n=e.修炼功法.名称;Object.values(e.背包?.物品||{}).find(e=>"功法"===e.类型&&e.名称===n&&e.已装备)?console.log(`[数据校准] 功法一致性校验通过: "${n}"`):(console.warn("[数据校准] 检测到无效的“幽灵功法”：修炼槽非空，但背包中无对应实体。正在清除无效修炼状态..."),e.修炼功法=null)}if(e.修炼功法&&e.修炼功法.功法技能){const n=e.修炼功法.功法技能;Object.entries(n).forEach(([n,t])=>{"object"!=typeof t||null===t||t.技能描述||(console.warn(`[数据校准] 功法 "${e.修炼功法?.名称}" 的技能 "${n}" 缺少描述，已添加默认描述。`),t.技能描述="此技能玄奥非凡，具体效果需在实战中领悟。")})}try{console.log("[初始化流程] 开始同步数据到酒馆..."),r.updateLoadingText("💾 正在保存角色数据...");const{shardSaveData:a,saveAllShards:o}=await Promise.resolve().then(t.bind(t,9808));console.log("[初始化流程] 正在深度清理存档数据以移除响应式代理...");const c=i(e);console.log("[初始化流程] 数据清理完成。");const s=a(c);console.log("[初始化流程] 准备保存",Object.keys(s).length,"个分片"),r.updateLoadingText(`💾 保存 ${Object.keys(s).length} 个数据分片到酒馆...`);const d=Date.now();await o(s,l);const m=Date.now()-d;console.log(`[初始化流程] ✅ 所有分片已保存，耗时: ${m}ms`);const p=i({"character.name":n.名字});r.updateLoadingText("💾 设置全局角色名称..."),await l.insertOrAssignVariables(p,{type:"global"}),console.log("[初始化流程] ✅ 已设置全局角色名称"),console.log("[初始化流程] ✅ 数据同步到Tavern成功"),r.updateLoadingText("✅ 角色创建完成！")}catch(e){console.error("[初始化流程] ❌ 保存游戏数据到酒馆失败:",e),console.error("[初始化流程] 错误详情:",e instanceof Error?e.stack:String(e)),console.warn("[初始化流程] 不影响本地游戏开始，将继续")}return console.log("[初始化流程] finalizeAndSyncData即将返回saveData"),e}(d,n,a,o);return console.log("[初始化流程] 最终化完成"),console.log("[初始化流程] ✅ 角色创建成功！准备返回completedSaveData"),console.log("[初始化流程] completedSaveData类型:",typeof v),console.log("[初始化流程] completedSaveData有效:",!!v),v}catch(e){throw console.error("[初始化流程] ❌ 角色初始化失败：",e),console.error("[初始化流程] 错误堆栈:",e instanceof Error?e.stack:"N/A"),e}finally{console.log("[初始化流程] initializeCharacter函数执行完毕")}}var D=t(9333),A=t(6939),_=t(8708),$=t(3943),I=t(9808);const T=(0,o.nY)("characterV3",()=>{const e=(0,a.ref)({当前激活存档:null,角色列表:{}}),n=(0,a.ref)(null),o=(0,a.ref)(!1),d=async()=>{if(!o.value)try{await async function(){try{const e="DAD_SAVES_V3",n=localStorage.getItem(e);if(!n)return console.log("【乾坤宝库-IDB】无需迁移，localStorage中无数据"),!1;console.log("【乾坤宝库-IDB】检测到localStorage数据，开始迁移...");const t=JSON.parse(n);return await g(t),localStorage.setItem("DAD_SAVES_V3_BACKUP",n),localStorage.removeItem(e),console.log("【乾坤宝库-IDB】✅ 数据迁移完成！已备份到 localStorage (DAD_SAVES_V3_BACKUP)"),!0}catch(e){return console.error("【乾坤宝库-IDB】❌ 数据迁移失败:",e),!1}}()&&i.Yz.log("角色商店","✅ 数据已从localStorage迁移到IndexedDB"),e.value=await u(),o.value=!0,i.Yz.log("角色商店","✅ Store初始化完成，数据已加载")}catch(n){i.Yz.error("角色商店","❌ Store初始化失败",n),e.value={当前激活存档:null,角色列表:{}},o.value=!0}};d();const m=(0,a.computed)(()=>Object.values(e.value.角色列表)),p=(0,a.computed)(()=>{const n=e.value.当前激活存档;return n&&e.value.角色列表[n.角色ID]||null}),v=(0,a.computed)(()=>{const n=e.value.当前激活存档,t=p.value;return n&&t?"单机"===t.模式&&t.存档列表?t.存档列表[n.存档槽位]||null:"联机"===t.模式&&t.存档?t.存档:null:null}),b=(0,a.computed)(()=>{const e=p.value;return e?"单机"===e.模式&&e.存档列表?Object.entries(e.存档列表).map(([n,t])=>({...t,id:n,角色名字:e.角色基础信息.名字,境界:t.存档数据?.玩家角色状态?.境界?.名称||"凡人",位置:t.存档数据?.玩家角色状态?.位置?.描述||"初始地",游戏时长:0,最后保存时间:t.最后保存时间||t.保存时间})):"联机"===e.模式&&e.存档?[{...e.存档,id:"online_save",角色名字:e.角色基础信息.名字,境界:e.存档.存档数据?.玩家角色状态?.境界?.名称||"凡人",位置:e.存档.存档数据?.玩家角色状态?.位置?.描述||"初始地",游戏时长:0,最后保存时间:e.存档.最后保存时间||e.存档.保存时间}]:[]:[]}),h=async()=>{try{await g(e.value),e.value={...e.value}}catch(e){throw i.Yz.error("角色商店","持久化到IndexedDB失败",e),e}},y=async n=>{const t=e.value.当前激活存档,o=p.value,r=v.value;if(t&&o&&r?.存档数据)try{try{const e=(0,A.updateLifespanFromGameTime)(r.存档数据);if(i.Yz.log("角色商店",`[同步] 自动更新玩家年龄: ${e}岁`),r.存档数据?.人物关系&&r.存档数据.游戏时间){let e=0;Object.entries(r.存档数据.人物关系).forEach(([n,t])=>{if(t&&"object"==typeof t)if(t.名字)try{r.存档数据&&((0,A.updateNpcLifespanFromGameTime)(t,r.存档数据.游戏时间),e++)}catch(e){i.Yz.warn("角色商店",`[同步] 更新NPC ${t.名字} 年龄失败:`,e)}else i.Yz.warn("角色商店",`[同步] 跳过缺少名字的NPC: ${n}`);else i.Yz.warn("角色商店",`[同步] 跳过无效的NPC数据: ${n}`)}),i.Yz.log("角色商店",`[同步] 自动更新${e}个NPC年龄`)}}catch(e){i.Yz.warn("角色商店","[同步] 自动更新年龄失败（非致命）:",e)}const l=(0,f.getTavernHelper)();if(l)try{const e=n?.fullSync??!1,t=n?.changedPaths;if(e||!t||0===t.length){const e=(0,I.shardSaveData)(r.存档数据);await(0,I.saveAllShards)(e,l),i.Yz.log("角色商店","[同步] ✅ 已将完整存档以分片模式同步到酒馆")}else{const e={},n=new Set;for(const e of t){const t=(0,I.Oq)(e);t?n.add(t.shardKey):i.Yz.warn("角色商店",`无法映射路径到分片: ${e}`)}for(const t of n){const n=(0,I.C4)(r.存档数据,t);null!=n&&(e[t]=n)}Object.keys(e).length>0&&(await(0,I.xG)(e,l),i.Yz.log("角色商店",`[同步] ✅ 已增量同步 ${Object.keys(e).length} 个分片`))}}catch(e){throw i.Yz.error("角色商店","[同步] 同步失败:",e),new Error(`同步酒馆失败: ${e instanceof Error?e.message:String(e)}`)}else i.Yz.warn("角色商店","[同步] helper 为空，无法同步到酒馆");r.最后保存时间=(new Date).toISOString(),r.角色名字=r.存档数据.角色基础信息?.名字;const c=r.存档数据.玩家角色状态;if(c&&(r.境界=c.境界?.名称||"凡人",r.位置=c.位置?.描述||"未知","object"==typeof c.境界&&null!==c.境界)){const e=c.境界;e.下一级所需>0&&(r.修为进度=Math.floor(e.当前进度/e.下一级所需*100))}if(r.存档数据.游戏时间){const e=r.存档数据.游戏时间;r.游戏内时间=`${e.年}年${e.月}月${e.日}日`}"单机"===o.模式&&o.存档列表?e.value.角色列表[t.角色ID].存档列表={...o.存档列表,[t.存档槽位]:{...r}}:"联机"===o.模式&&(e.value.角色列表[t.角色ID].存档={...r}),(0,a.triggerRef)(e),await h(),i.Yz.log("角色商店","[同步] 数据已同步到酒馆并保存到本地，元数据已更新")}catch(e){throw i.Yz.error("角色商店","[同步] 同步到酒馆并保存失败",e),e}else i.Yz.warn("角色商店","[同步] 没有激活的存档数据")},k=async()=>{e.value=await u(),i.Yz.log("角色商店","已从乾坤宝库重新同步所有数据")},w=async()=>(i.Yz.log("角色商店","syncRootStateToCloud called. (Placeholder - no backend implementation yet)"),Promise.resolve()),N=async(n,t)=>{i.Yz.log("角色商店",`开始加载游戏，角色ID: ${n}, 存档槽: ${t}`);const a=(0,c.useUIStore)(),o=e.value.角色列表[n];if(!o)return i.Yz.error("角色商店","找不到要加载的角色",n),l.o.error("找不到要加载的角色！"),!1;let r;if(r="单机"===o.模式?o.存档列表?.[t]:o.存档,!r)return i.Yz.error("角色商店","找不到指定的存档槽位",t),l.o.error("找不到指定的存档槽位！"),!1;if(r.存档数据){const e=(0,x.zB)(r.存档数据,o);if(!e.isValid)return i.Yz.error("角色商店","存档数据验证失败",e.errors),a.showDataValidationErrorDialog(e.errors,()=>{C(n,t)},"loading"),!1}try{return a.startLoading("开始加载存档..."),await(0,f.c$)(),a.updateLoadingText("天机重置完毕，正在加载存档..."),i.Yz.log("角色商店","设置当前激活存档"),e.value.当前激活存档={角色ID:n,存档槽位:t},await h(),i.Yz.log("角色商店","同步角色档案到酒馆"),await E(n),i.Yz.log("角色商店","加载完成"),l.o.success(`已成功加载【${o.角色基础信息.名字}】的存档: ${r.存档名||t}`),!0}catch(e){i.Yz.error("角色商店","加载过程出错",e);const n=e instanceof Error?e.message:"未知错误";return l.o.error(`存档加载失败：${n}`),!1}finally{a.stopLoading()}},E=async n=>{const t=e.value.角色列表[n];if(!t)throw new Error(`[存档核心] 无法找到ID为 ${n} 的角色档案`);const a=v.value;if(a&&a.存档数据)try{const e=(0,f.getTavernHelper)();if(!e)throw new Error("[存档核心] 酒馆连接尚未建立！");i.Yz.log("角色商店","使用分片存储模式同步存档到酒馆"),await(0,I.clearAllShards)(e);const n=(0,I.shardSaveData)(a.存档数据);await(0,I.saveAllShards)(n,e),i.Yz.log("角色商店",`✅ 已将【${t.角色基础信息.名字}】的存档以分片模式同步至酒馆`)}catch(e){throw i.Yz.error("角色商店","同步角色档案至酒馆失败",e),l.o.error("同步角色档案至酒馆失败，请检查控制台。"),e}else i.Yz.warn("角色商店",`角色 ${n} 没有可用的存档数据来同步到酒馆`)},V=async(n,t)=>{const a=e.value.角色列表[n];if(!a||"单机"!==a.模式||!a.存档列表)return void l.o.error("无法删除存档：角色不存在或非单机模式");if(Object.values(a.存档列表).filter(e=>e&&"上次对话"!==e.存档名&&e.存档数据).length<=1)return void l.o.error("最后一个存档不能删除");const o=a.存档列表?.[t]?.存档名||t;if(!a.存档列表?.[t])return void l.o.error(`存档【${o}】不存在`);const r=e.value.当前激活存档;if(r?.角色ID===n&&r?.存档槽位===t){try{await(0,f.c$)(),l.o.info("当前存档已激活，同步清理酒馆环境变量。")}catch(e){i.Yz.error("角色商店","删除激活存档时清理酒馆数据失败",e),l.o.error("清理酒馆环境变量失败，建议刷新页面。")}e.value.当前激活存档=null}delete a.存档列表[t],await h();try{await w(),i.Yz.log("角色商店","删除存档后已同步到云端")}catch(e){i.Yz.error("角色商店","删除存档后同步云端失败",e)}l.o.success(`存档【${o}】已删除`)},C=async(n,t)=>{const a=(0,c.useUIStore)(),o=e.value.角色列表[n];if(!o)return void l.o.error("修复失败：找不到角色");let r;if(r="单机"===o.模式?o.存档列表?.[t]:o.存档,r&&r.存档数据)try{a.startLoading("AI正在分析存档结构，请稍候...");const e=(s=r.存档数据,`\n# 任务：修复游戏数据\n\n你需要修复以下损坏的游戏数据，使其符合类型定义要求。\n\n## 类型定义\n${JSON.stringify({},null,2)}\n\n## 损坏的数据\n${JSON.stringify(s,null,2)}\n\n## 修复要求\n1. 补全缺失的必填字段\n2. 修正错误的数据类型\n3. 填充合理的默认值\n4. 保持现有正确数据不变\n\n## 输出格式\n返回修复后的完整JSON对象。\n`.trim()),c=(0,f.getTavernHelper)();if(!c)throw new Error("酒馆连接不可用");a.updateLoadingText("天道正在推演修复方案...");const d=await c.generate({user_input:e,overrides:{temperature:.7,max_context_length:8e3,max_length:2048}});if(!d)throw new Error("AI未能生成修复指令");let m=[];try{const e=d.replace(/```json/g,"").replace(/```/g,"").trim(),n=JSON.parse(e);if(!n.tavern_commands||!Array.isArray(n.tavern_commands))throw new Error("AI响应中缺少有效的 tavern_commands 数组");m=n.tavern_commands}catch(e){throw i.Yz.error("角色商店","解析AI修复指令失败",{error:e,response:d}),new Error("解析AI修复指令失败")}if(0===m.length)return l.o.info("AI分析认为当前存档无需修复。"),void await N(n,t);a.updateLoadingText(`AI已生成 ${m.length} 条修复指令，正在应用...`);const p=await(async(e,n,t)=>{const a=[],o=(e,n,t)=>{const a=n.split(".");let o=e;for(let e=0;e<a.length-1;e++)void 0!==o[a[e]]&&"object"==typeof o[a[e]]||(o[a[e]]={}),o=o[a[e]];o[a[a.length-1]]=t};for(const r of t)try{const{action:t,key:l,value:c}=r;if(!t||!l){a.push(`无效指令: ${JSON.stringify(r)}`);continue}let s,d;l.startsWith("character.profile.")?(s=n,d=l.substring(18)):(s=e,d=l),"set"===t?(o(s,d,c),i.Yz.log("AI修复",`执行 set: ${l} =`,c)):i.Yz.warn("AI修复",`暂不支持的指令 action: ${t}`)}catch(e){a.push(`执行指令失败: ${JSON.stringify(r)}`),i.Yz.error("AI修复","执行指令时出错",e)}return a})(r.存档数据,o,m);p.length>0&&(i.Yz.error("角色商店","执行AI修复指令时出错",p),l.o.error(`部分修复指令执行失败: ${p.join(", ")}`)),r.最后保存时间=(new Date).toISOString(),await h(),l.o.success("AI已完成存档修复！正在重新加载游戏..."),await new Promise(e=>setTimeout(e,500)),await N(n,t)}catch(e){i.Yz.error("角色商店","AI修复存档失败",e),l.o.error(`存档修复失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{a.stopLoading()}else l.o.error("修复失败：找不到存档数据");var s};return{rootState:e,initialized:o,allCharacterProfiles:m,activeCharacterProfile:p,activeSaveSlot:v,saveSlots:b,initializeStore:d,reloadFromStorage:k,createNewCharacter:async n=>{const t=(0,c.useUIStore)(),a=(0,s.N)(),{charId:o,baseInfo:r,world:d,mode:m,age:p}=n;if(e.value.角色列表[o])return void l.o.error(`角色ID ${o} 已存在，创建失败！`);const v={...r,世界:a.selectedWorld?.name||r.世界,天资:a.selectedTalentTier?.name||r.天资,出生:a.selectedOrigin?.name||"随机出身",灵根:a.selectedSpiritRoot?{名称:a.selectedSpiritRoot.name,品级:a.selectedSpiritRoot.tier,描述:a.selectedSpiritRoot.description}:"随机灵根",天赋:a.selectedTalents.map(e=>({名称:e.name,描述:e.description})),后天六司:r.后天六司||{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0}};i.Yz.log("角色商店","构建权威创角信息:",v);try{if(t.updateLoadingText("即将开始角色创建..."),await(0,f.c$)(),"联机"===m)try{t.updateLoadingText("正在向云端提交角色信息...");const e={char_id:o,base_info:v};i.Yz.log("角色商店","向后端提交的数据",e);const n=await(0,D.OW)(e);i.Yz.log("角色商店","后端返回结果",n),t.updateLoadingText("角色信息已成功提交至云端！")}catch(e){i.Yz.error("角色商店","向后端提交失败",e),l.o.warning("向云端提交角色信息失败，将继续本地创建流程")}console.log("[角色商店] 准备调用initializeCharacter...");let n,a=null;try{console.log("[角色商店] 调用initializeCharacter,参数:",{charId:o,baseInfo:v,world:d.name,age:p}),a=await B(0,v,d,p),console.log("[角色商店] ✅ initializeCharacter返回成功,数据有效:",!!a)}catch(e){if(console.error("[角色商店] ❌ initializeCharacter失败:",e),"单机"!==m)throw e;console.log("[角色商店] 单机模式,尝试离线初始化..."),a=await async function(e,n,t,a){console.log("[离线初始化] 开始执行本地角色创建..."),n.后天六司||(n.后天六司={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0},console.log("[离线初始化] 初始化后天六司为全0"));const o=S(n,a);o.位置={描述:"临时位置（等待AI初始化）",x:115,y:35},o.系统任务={配置:{启用:!1,任务类型:"all",颁发数量:3},进行中任务:[],已完成任务名称:[]};const r={角色基础信息:n,玩家角色状态:o,装备栏:{装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null},三千大道:{大道列表:{}},背包:{灵石:{下品:10,中品:0,上品:0,极品:0},物品:{consumable_xinshou_danyao_01:{物品ID:"consumable_xinshou_danyao_01",名称:"新手丹药",类型:"其他",数量:3,品质:{quality:"凡",grade:1},描述:"一颗普通的丹药，能恢复少量气血。"},equipment_cubuyi_01:{物品ID:"equipment_cubuyi_01",名称:"粗布衣",类型:"装备",数量:1,品质:{quality:"凡",grade:1},描述:"一件朴素的粗布衣服，能提供微不足道的防御。"}}},人物关系:{},宗门系统:{availableSects:[],sectRelationships:{},sectHistory:[]},记忆:{短期记忆:[],中期记忆:[],长期记忆:[]},游戏时间:{年:1,月:1,日:1,小时:8,分钟:0},修炼功法:null,掌握技能:[],系统:{初始年龄:a,开局时间:{年:1,月:1,日:1,小时:8,分钟:0},规则:{属性上限:{先天六司:{每项上限:10}}},提示:["系统规则：先天六司每项上限为10（NPC同样适用），如超限需裁剪至上限。","系统会根据游戏时间自动计算当前年龄，无需手动更新寿命.当前字段。"]},世界信息:{世界名称:t.name,大陆信息:[],势力信息:[],地点信息:[],生成时间:(new Date).toISOString(),世界背景:t.description,世界纪元:t.era||"未知纪元",特殊设定:[],版本:"offline-1.1"}};return console.log("[离线初始化] 本地角色创建完成:",r),r}(0,v,d,p)}if("单机"===m){const e=(new Date).toISOString();n={模式:"单机",角色基础信息:a.角色基础信息||v,存档列表:{存档1:{存档名:"存档1",保存时间:e,最后保存时间:e,游戏内时间:"修仙元年 春",角色名字:v.名字,境界:"凡人",位置:"未知",修为进度:0,存档数据:a},上次对话:{存档名:"上次对话",保存时间:null,最后保存时间:null,存档数据:null}}}}else n={模式:"联机",角色基础信息:a.角色基础信息||v,存档:{存档名:"云端修行",保存时间:(new Date).toISOString(),游戏内时间:"修仙元年 春",存档数据:a,云端同步信息:{最后同步:(new Date).toISOString(),版本:1,需要同步:!1}}};e.value.角色列表[o]=n;const r="单机"===m?"存档1":"存档";if(e.value.当前激活存档={角色ID:o,存档槽位:r},await h(),t.updateLoadingText("正在将角色档案同步至酒馆..."),await E(o),"联机"===m)try{t.updateLoadingText("正在同步完整存档到云端...");const e={save_data:a,world_map:{},game_time:"修仙元年 春"};i.Yz.log("角色商店","准备同步到云端的存档数据",e),await(0,D.Sj)(o,e),t.updateLoadingText("完整存档已成功同步到云端！")}catch(e){i.Yz.warn("角色商店","同步存档数据到云端失败",e);const n=e instanceof Error?e.message:"未知错误";l.o.warning(`存档同步失败: ${n}`)}return v}catch(e){i.Yz.error("角色商店","角色创建失败",e);const n=e instanceof Error?e.message:String(e);throw new Error(`角色创建失败: ${n}`)}},deleteCharacter:async n=>{if(!e.value.角色列表[n])return;const t=e.value.角色列表[n]?.角色基础信息.名字||n;if(e.value.当前激活存档?.角色ID===n){try{await(0,f.c$)(),l.o.info("已同步清理酒馆环境变量。")}catch(e){i.Yz.error("角色商店","删除角色时清理酒馆数据失败",e),l.o.error("清理酒馆环境变量失败，建议刷新页面。")}e.value.当前激活存档=null}delete e.value.角色列表[n],await h();try{await w(),i.Yz.log("角色商店","删除角色后已同步到云端")}catch(e){i.Yz.error("角色商店","删除角色后同步云端失败",e)}l.o.success(`角色【${t}】已彻底删除。`)},deleteNpc:async n=>{const t=e.value.当前激活存档,o=p.value,r=v.value;if(!t||!o||!r?.存档数据?.人物关系)return void l.o.error("无法删除NPC：没有激活的存档或人物关系数据。");const c=Object.keys(r.存档数据.人物关系).find(e=>r.存档数据.人物关系[e]?.名字===n);if(!c)return void l.o.error(`找不到名为 ${n} 的NPC。`);const s={...r.存档数据.人物关系[c]};try{delete r.存档数据.人物关系[c],i.Yz.log("角色商店",`已从存档数据中删除NPC: ${n} (key: ${c})`),r.存档数据.人物关系={...r.存档数据.人物关系},(0,a.triggerRef)(e),await y({fullSync:!0}),i.Yz.log("角色商店",`✅ NPC ${n} 已成功删除并同步到酒馆`),l.o.success(`NPC【${n}】已成功删除。`)}catch(t){throw i.Yz.error("角色商店",`删除NPC ${n} 后保存失败`,t),r.存档数据?.人物关系&&(r.存档数据.人物关系[c]=s,r.存档数据.人物关系={...r.存档数据.人物关系},(0,a.triggerRef)(e),i.Yz.log("角色商店",`已回滚NPC删除操作: ${n}`)),l.o.error(`删除NPC失败: ${t instanceof Error?t.message:"未知错误"}`),t}},deleteSave:V,deleteSaveById:async n=>{const t=e.value.当前激活存档?.角色ID;if(t)return V(t,n);l.o.error("无法确定角色ID")},createNewSave:async(n,t)=>{const a=e.value.角色列表[n];a&&"单机"===a.模式?(a.存档列表||(a.存档列表={}),a.存档列表[t]?l.o.error("存档名称已存在"):(a.存档列表[t]={存档名:t,保存时间:null,最后保存时间:null,存档数据:null},await h(),l.o.success(`存档【${t}】已创建`))):l.o.error("无法创建存档：角色不存在或非单机模式")},saveAsNewSlot:async n=>{const t=e.value.当前激活存档,a=p.value,o=v.value;if(!t||!a||!o?.存档数据)return l.o.error("没有激活的游戏进度"),null;if("单机"!==a.模式)return l.o.error("联机模式不支持多存档"),null;if(a.存档列表||(a.存档列表={}),a.存档列表[n])return l.o.error("存档名称已存在"),null;try{const e=(new Date).toISOString(),t={存档名:n,保存时间:e,最后保存时间:e,游戏内时间:o.游戏内时间,游戏时长:o.游戏时长,角色名字:o.角色名字,境界:o.境界,位置:o.位置,修为进度:o.修为进度,世界地图:o.世界地图,存档数据:JSON.parse(JSON.stringify(o.存档数据))};return a.存档列表[n]=t,await h(),l.o.success(`已另存为新存档：${n}`),i.Yz.log("角色商店",`已创建新存档槽位: ${n}`),n}catch(e){return i.Yz.error("角色商店","另存为新存档失败",e),l.o.error("另存为新存档失败"),null}},saveToSlot:async n=>{const t=e.value.当前激活存档,a=p.value;if(!t||!a){const e=`没有激活的角色，无法保存到 ${n}`;throw i.Yz.error("角色商店",`[saveToSlot] ${e}`),console.error(`[saveToSlot] ${e}`,{active:t,profile:a}),new Error(e)}if("单机"!==a.模式){const e=`联机模式不支持多存档，无法保存到 ${n}`;throw i.Yz.warn("角色商店",`[saveToSlot] ${e}`),console.warn(`[saveToSlot] ${e}`,{模式:a.模式}),new Error(e)}a.存档列表||(a.存档列表={});try{const e=(0,f.getTavernHelper)();if(!e)throw new Error("酒馆连接尚未建立！");const o=await(0,I.xc)(e),r=(0,I.assembleSaveData)(o);if(!r)throw new Error("无法从酒馆获取当前存档数据");try{(0,A.updateLifespanFromGameTime)(r),r.人物关系&&r.游戏时间&&Object.values(r.人物关系).forEach(e=>{e&&"object"==typeof e&&(0,A.updateNpcLifespanFromGameTime)(e,r.游戏时间)})}catch(e){i.Yz.warn("角色商店","[saveToSlot] 自动更新年龄失败（非致命）:",e)}const l=r.玩家角色状态,c=(new Date).toISOString(),s=a.存档列表,d=s[n];console.log(`[saveToSlot] 保存到槽位 "${n}"`,{角色ID:t.角色ID,角色名:a.角色基础信息?.名字,当前激活槽位:t.存档槽位,目标槽位:n,说明:"特殊存档不受当前激活存档影响，始终保存到角色级别"});const m={存档名:n,保存时间:d?.保存时间||c,最后保存时间:c,存档数据:r,角色名字:r.角色基础信息?.名字,境界:l?.境界?.名称||"凡人",位置:l?.位置?.描述||"未知",修为进度:0,游戏内时间:void 0};if(l?.境界&&l.境界.下一级所需>0&&(m.修为进度=Math.floor(l.境界.当前进度/l.境界.下一级所需*100)),r.游戏时间){const e=r.游戏时间;m.游戏内时间=`${e.年}年${e.月}月${e.日}日`}s[n]=m,await h(),i.Yz.log("角色商店",`✅ 已保存到存档槽位: ${n}`)}catch(e){throw i.Yz.error("角色商店",`保存到槽位 ${n} 失败`,e),e}},renameSave:async(n,t,a)=>{const o=e.value.角色列表[n];if(!o||"单机"!==o.模式||!o.存档列表)return void l.o.error("无法重命名存档：角色不存在或非单机模式");const r=o.存档列表[t];if(!r)return void l.o.error("要重命名的存档不存在");if(a===t)return r.存档名=a,await h(),void l.o.success("存档名称已更新");if(o.存档列表[a])return void l.o.error("新存档名称已存在");o.存档列表[a]={...r,存档名:a};const i=e.value.当前激活存档;i?.角色ID===n&&i?.存档槽位===t&&(e.value.当前激活存档={角色ID:n,存档槽位:a}),delete o.存档列表[t],await h(),l.o.success(`存档已重命名为【${a}】`)},loadGame:N,loadGameById:async n=>{const t=p.value;if(!t)return l.o.error("没有激活的角色"),!1;const a=e.value.当前激活存档?.角色ID;return a?"单机"===t.模式?await N(a,n):await N(a,"存档"):(l.o.error("无法确定角色ID"),!1)},saveCurrentGame:async()=>{const n=e.value.当前激活存档,t=p.value,a=v.value;if(!n||!t||!a)return void l.o.error("没有激活的存档，无法保存！");const o=`save-game-${Date.now()}`;try{l.o.loading("正在保存进度...",{id:o});const e=(0,f.getTavernHelper)();if(!e)throw new Error("酒馆连接尚未建立！");const r=await(0,I.xc)(e),c=(0,I.assembleSaveData)(r);if(!c)throw new Error("无法从酒馆获取当前存档数据，可能尚未初始化。");const s=a.存档数据?.叙事历史;s&&Array.isArray(s)&&s.length>0&&(c.叙事历史=s,i.Yz.log("角色商店",`[保存] 保留本地叙事历史数据 (${s.length}条)`));try{const e=(0,A.updateLifespanFromGameTime)(c);if(i.Yz.log("角色商店",`[保存] 自动更新玩家年龄: ${e}岁`),c.人物关系&&c.游戏时间){let e=0;Object.values(c.人物关系).forEach(n=>{n&&"object"==typeof n&&((0,A.updateNpcLifespanFromGameTime)(n,c.游戏时间),e++)}),i.Yz.log("角色商店",`[保存] 自动更新${e}个NPC年龄`)}}catch(e){i.Yz.warn("角色商店","[保存] 自动更新年龄失败（非致命）:",e)}try{const e=(0,_.F)(c);i.Yz.log("角色商店",`[保存] 已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){i.Yz.warn("角色商店","[保存] 自动计算掌握技能失败（非致命）:",e)}a.最后保存时间=(new Date).toISOString(),a.存档数据=c,a.角色名字=c.角色基础信息?.名字;const d=c.玩家角色状态;if(d&&(a.境界=d.境界?.名称||"凡人",a.位置=d.位置?.描述||"未知","object"==typeof d.境界&&null!==d.境界)){const e=d.境界;e.下一级所需>0&&(a.修为进度=Math.floor(e.当前进度/e.下一级所需*100))}if(c.游戏时间){const e=c.游戏时间;a.游戏内时间=`${e.年}年${e.月}月${e.日}日`}if("单机"===t.模式&&t.存档列表?t.存档列表[n.存档槽位]=a:"联机"===t.模式&&(t.存档=a),await h(),"联机"===t.模式)try{l.o.loading("正在同步存档到云端...",{id:o});const e={save_data:c,world_map:{},game_time:a.游戏内时间||"未知时间"};await(0,D.Sj)(n.角色ID,e),l.o.success("存档已成功同步到云端！",{id:o}),t.存档?.云端同步信息&&(t.存档.云端同步信息.最后同步=(new Date).toISOString(),t.存档.云端同步信息.需要同步=!1,t.存档.云端同步信息.版本++,await h())}catch(e){i.Yz.error("角色商店","云端同步-保存时同步失败",e);const n=e instanceof Error?e.message:"未知错误";l.o.error(`云端同步失败: ${n}`,{id:o}),t.存档?.云端同步信息&&(t.存档.云端同步信息.需要同步=!0,await h())}"联机"!==t.模式&&(l.o.hide(o),i.Yz.log("角色商店",`存档【${a.存档名}】已成功保存`))}catch(e){i.Yz.error("角色商店","存档保存过程出错",e);const n=e instanceof Error?e.message:"未知错误";l.o.error(`存档保存失败：${n}`,{id:o})}},updateSaveDataDirectly:async n=>{const t=e.value.当前激活存档,a=p.value,o=v.value;if(!(t&&a&&o&&n))return void i.Yz.warn("角色商店","[直接更新] 缺少必要参数，跳过更新");const r=t.角色ID,l=t.存档槽位;i.Yz.log("角色商店","[直接更新] 开始更新存档数据到Store...");const c=o.存档数据?.叙事历史;c&&Array.isArray(c)&&c.length>0&&(n.叙事历史=c,i.Yz.log("角色商店",`[直接更新] 保留本地叙事历史数据 (${c.length}条)`)),"单机"===a.模式&&a.存档列表?e.value.角色列表[r].存档列表={...a.存档列表,[l]:{...a.存档列表[l],存档数据:n,最后保存时间:(new Date).toISOString()}}:"联机"===a.模式&&a.存档&&(e.value.角色列表[r].存档={...a.存档,存档数据:n,最后保存时间:(new Date).toISOString()}),await h(),i.Yz.log("角色商店","✅ [直接更新] 存档数据已更新到Store并持久化")},updateCharacterData:async n=>{const t=e.value.当前激活存档,o=p.value,l=v.value;if(!l?.存档数据||!t||!o)return void i.Yz.warn("角色商店","没有激活的存档，无法更新角色数据");const c=[];if(n?.changes)for(const e of n.changes)c.push(e.key),(0,r.set)(l.存档数据,e.key,e.newValue);const s=t.角色ID,d=t.存档槽位;"单机"===o.模式&&o.存档列表?e.value.角色列表[s].存档列表={...o.存档列表,[d]:{...o.存档列表[d],存档数据:(0,r.cloneDeep)(l.存档数据),最后保存时间:(new Date).toISOString()}}:"联机"===o.模式&&o.存档&&(e.value.角色列表[s].存档={...o.存档,存档数据:(0,r.cloneDeep)(l.存档数据),最后保存时间:(new Date).toISOString()}),(0,a.triggerRef)(e),await h(),c.length>0&&(await y({changedPaths:c}),i.Yz.log("角色商店",`✅ 角色数据已更新并增量同步 ${c.length} 个字段`,c))},loadSaves:async()=>{k()},importSave:async n=>{const t=p.value,a=e.value.当前激活存档?.角色ID;if(!t||!a)return void l.o.error("没有激活的角色，无法导入存档");if("单机"!==t.模式)return void l.o.error("联机模式不支持存档导入");t.存档列表||(t.存档列表={});let o=n.存档名||"导入存档",r=1;for(;t.存档列表[o];)o=`${n.存档名||"导入存档"}_${r}`,r++;t.存档列表[o]={...n,存档名:o},await h(),l.o.success(`存档【${o}】导入成功`)},clearAllSaves:async()=>{const n=p.value,t=e.value.当前激活存档?.角色ID;n&&t?("单机"===n.模式&&n.存档列表?n.存档列表={}:"联机"===n.模式&&n.存档&&(n.存档.存档数据=null,n.存档.保存时间=null),e.value.当前激活存档=null,await h(),l.o.success("所有存档已清空")):l.o.error("没有激活的角色")},exitGameSession:async()=>{if(!e.value.当前激活存档)return;const n=(0,c.useUIStore)();try{n.startLoading("正在退出游戏..."),await(0,f.c$)(),e.value.当前激活存档=null,await h(),l.o.success("已成功退出游戏，酒馆环境已重置。")}catch(e){i.Yz.error("角色商店","退出游戏会话失败",e),l.o.error("退出游戏失败，建议刷新页面以确保环境纯净。")}finally{n.stopLoading()}},rollbackToLastConversation:async()=>{const n=p.value,t=e.value.当前激活存档;if(!n||!t||"单机"!==n.模式||!n.存档列表)throw new Error("无法执行回滚：无效的存档状态");const a=n.存档列表["上次对话"]?.存档数据;if(!a)throw new Error("没有可用于回滚的“上次对话”存档");const o=n.存档列表[t.存档槽位];if(!o)throw new Error(`找不到当前激活的存档槽位: ${t.存档槽位}`);o.存档数据=JSON.parse(JSON.stringify(a)),o.最后保存时间=(new Date).toISOString(),await h(),await E(t.角色ID),i.Yz.log("角色商店","✅ 已成功回滚到上次对话前的状态")},commitToStorage:h,syncToTavernAndSave:y,updateTavernField:async(e,n)=>{try{const a=(0,f.getTavernHelper)();if(!a)return void i.Yz.warn("角色商店","[增量更新] helper 为空，无法同步到酒馆");const{deepCleanForClone:o}=await Promise.resolve().then(t.bind(t,3098)),r=o({[e]:n});await a.insertOrAssignVariables(r,{type:"chat"}),i.Yz.log("角色商店",`[增量更新] 已更新酒馆字段: ${e}`)}catch(n){throw i.Yz.error("角色商店",`[增量更新] 更新字段 ${e} 失败:`,n),n}},updateTavernFields:async e=>{try{const n=(0,f.getTavernHelper)();if(!n)return void i.Yz.warn("角色商店","[批量增量更新] helper 为空，无法同步到酒馆");const{deepCleanForClone:a}=await Promise.resolve().then(t.bind(t,3098)),o=a(e);await n.insertOrAssignVariables(o,{type:"chat"}),i.Yz.log("角色商店",`[批量增量更新] 已更新 ${Object.keys(e).length} 个酒馆字段`)}catch(e){throw i.Yz.error("角色商店","[批量增量更新] 批量更新失败:",e),e}},setActiveCharacterInTavern:E,syncFromTavern:async()=>{const n=e.value.当前激活存档,t=p.value,a=v.value;if(n&&t&&a)try{const o=(0,f.getTavernHelper)();if(!o)throw new Error("酒馆连接尚未建立！");const r=await(0,I.xc)(o),l=(0,I.assembleSaveData)(r);if(l.三千大道){const e=l.三千大道;e.大道列表?Object.keys(e.大道列表).forEach(n=>{const t=e.大道列表[n];t&&(void 0!==t.当前经验&&null!==t.当前经验||(t.当前经验=0),void 0!==t.总经验&&null!==t.总经验||(t.总经验=0),void 0!==t.当前阶段&&null!==t.当前阶段||(t.当前阶段=0),void 0===t.是否解锁&&(t.是否解锁=!0),t.道名||(t.道名=n),t.阶段列表||(t.阶段列表=[]),t.描述||(t.描述="神秘的大道"))}):e.大道列表={}}try{const e=(0,A.updateLifespanFromGameTime)(l);if(i.Yz.log("角色商店",`[同步] 自动更新玩家年龄: ${e}岁`),l.人物关系&&l.游戏时间){let e=0;Object.values(l.人物关系).forEach(n=>{n&&"object"==typeof n&&((0,A.updateNpcLifespanFromGameTime)(n,l.游戏时间),e++)}),i.Yz.log("角色商店",`[同步] 自动更新${e}个NPC年龄`)}}catch(e){i.Yz.warn("角色商店","[同步] 自动更新年龄失败（非致命）:",e)}try{const e=(0,_.F)(l);i.Yz.log("角色商店",`[同步] 已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){i.Yz.warn("角色商店","[同步] 自动计算掌握技能失败（非致命）:",e)}let c=!1;try{(0,$.UZ)(l)&&(i.Yz.log("角色商店","[同步] 已自动移除过期的状态效果"),c=!0)}catch(e){i.Yz.warn("角色商店","[同步] 自动清理过期状态效果失败（非致命）:",e)}const s=a.存档数据?.记忆;s&&(l.记忆=s,i.Yz.log("角色商店","[同步] 保留本地记忆数据，避免被酒馆旧数据覆盖"));const d=a.存档数据?.叙事历史;d&&Array.isArray(d)&&d.length>0&&(l.叙事历史=d,i.Yz.log("角色商店",`[同步] 保留本地叙事历史数据 (${d.length}条)，避免被酒馆旧数据覆盖`));const m=n.角色ID,p=n.存档槽位;if("单机"===t.模式&&t.存档列表?e.value.角色列表[m].存档列表={...t.存档列表,[p]:{...t.存档列表[p],存档数据:l,最后保存时间:(new Date).toISOString()}}:"联机"===t.模式&&t.存档&&(e.value.角色列表[m].存档={...t.存档,存档数据:l,最后保存时间:(new Date).toISOString()}),await h(),i.Yz.log("角色商店","✅ 已从酒馆分片同步最新存档数据"),i.Yz.log("角色商店",`最终背包物品数量: ${Object.keys(l.背包?.物品||{}).length}`),i.Yz.log("角色商店",`是否有世界信息: ${!!l.世界信息}`),c)try{i.Yz.log("角色商店","[同步] 状态效果已清理，开始同步回酒馆...");const e=(0,f.getTavernHelper)();if(e){const n=(0,I.shardSaveData)(l);await(0,I.saveAllShards)(n,e),i.Yz.log("角色商店","[同步] ✅ 已将清理后的状态效果同步回酒馆")}}catch(e){i.Yz.warn("角色商店","[同步] 同步清理后的状态效果到酒馆失败（非致命）:",e)}}catch(e){i.Yz.error("角色商店","从酒馆同步数据失败",e)}else i.Yz.warn("角色商店","没有激活的存档，无法从酒馆同步数据")},repairCharacterDataWithAI:C,initialCreationStateChanges:n,setInitialCreationStateChanges:e=>{i.Yz.log("角色商店","暂存初始角色创建的状态变更",e),n.value=e},consumeInitialCreationStateChanges:()=>{const e=n.value;return e&&(i.Yz.log("角色商店","消费初始状态变更日志",e),n.value=null),e},equipTechnique:async e=>{const n=v.value;if(!n?.存档数据)return void l.o.error("存档数据不存在");const t=n.存档数据,a=t.背包?.物品?.[e];if(!a||"功法"!==a.类型)return void l.o.error("要装备的物品不是一个有效的功法");console.log("[角色商店-调试] 装备功法前的数据:",{功法名称:a.名称,品质字段存在:!!a.品质,品质内容:a.品质,完整物品数据:a}),Object.values(t.背包.物品).forEach(e=>{"功法"===e.类型&&(e.已装备=!1)}),a.已装备=!0,t.修炼功法={物品ID:a.物品ID,名称:a.名称,正在修炼:!0,修炼进度:("功法"===a.类型?a.修炼进度:void 0)||0,功法技能:"功法"===a.类型?a.功法技能:void 0},i.Yz.log("角色商店",`已装备功法: ${a.名称}，修炼进度: ${t.修炼功法?.修炼进度}%`);try{const e=(0,_.F)(t);i.Yz.log("角色商店",`装备功法后已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){i.Yz.error("角色商店","装备功法后自动计算掌握技能失败:",e)}await y({fullSync:!0});const o=t.背包?.物品?.[e];console.log("[角色商店-调试] 同步到酒馆后的功法数据:",{功法名称:o?.名称,品质字段存在:!!o?.品质,品质内容:o?.品质,完整物品数据:o}),l.o.success(`已开始修炼《${a.名称}》`)},unequipTechnique:async n=>{const t=v.value;if(!t?.存档数据)return void l.o.error("存档数据不存在");const o=t.存档数据,r=o.背包?.物品?.[n],c=o.修炼功法;if(!r||"功法"!==r.类型||!c||c.物品ID!==n)return void l.o.error("要卸下的功法与当前修炼的功法不匹配");const s=c.修炼进度||0;r.已装备=!1,r.修炼进度=s,o.修炼功法=null,i.Yz.log("角色商店",`已卸下功法: ${r.名称}，最终进度: ${s}%`);try{const e=(0,_.F)(o);i.Yz.log("角色商店",`卸下功法后已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){i.Yz.error("角色商店","卸下功法后自动计算掌握技能失败:",e)}(0,a.triggerRef)(e),await y({fullSync:!0}),l.o.info(`已停止修炼《${r.名称}》`)},importCharacter:async n=>{if(!n||!n.角色基础信息||!n.模式)throw new Error("无效的角色文件格式。");const t=`char_${Date.now()}`,a=n.角色基础信息.名字||"未知角色";if(Object.values(e.value.角色列表).some(e=>e.角色基础信息.名字===a))throw new Error(`角色 "${a}" 已存在，请先删除或重命名现有角色。`);e.value.角色列表[t]={...n},await h(),i.Yz.log("角色商店",`成功导入角色: ${a} (新ID: ${t})`)}}})},1021:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.character-section[data-v-6885fec6] {\n  border-radius: 8px;\n  padding: 1rem;\n}\n.section-header[data-v-6885fec6] {\n  margin-bottom: 1rem;\n}\n.section-title[data-v-6885fec6] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.info-grid[data-v-6885fec6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n.info-item[data-v-6885fec6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n}\n.info-label[data-v-6885fec6] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.info-value[data-v-6885fec6] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.data-detail[data-v-6885fec6] {\n  margin-top: 1rem;\n  border-top: 1px solid var(--color-border);\n  padding-top: 1rem;\n}\n.detail-title[data-v-6885fec6] {\n  margin: 0 0 1rem 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  border-bottom: 1px solid var(--color-border);\n  padding-bottom: 0.5rem;\n}\n.code-pre[data-v-6885fec6] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  max-height: 60vh;\n  overflow: auto;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.85rem;\n  line-height: 1.5;\n  word-wrap: break-word;\n  white-space: pre-wrap;\n}\n.empty-state[data-v-6885fec6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  padding: 3rem;\n  color: var(--color-text-secondary);\n}\n\n/* 手机端适配 */\n@media (max-width: 768px) {\n.code-pre[data-v-6885fec6] {\n    max-height: 50vh;\n    font-size: 0.8rem;\n    padding: 0.5rem;\n}\n.character-section[data-v-6885fec6] {\n    padding: 0.75rem;\n}\n.info-grid[data-v-6885fec6] {\n    grid-template-columns: 1fr;\n    gap: 0.75rem;\n}\n}\n@media (max-width: 480px) {\n.code-pre[data-v-6885fec6] {\n    max-height: 40vh;\n    font-size: 0.75rem;\n    padding: 0.4rem;\n}\n.character-section[data-v-6885fec6] {\n    padding: 0.5rem;\n}\n.empty-state[data-v-6885fec6] {\n    padding: 2rem;\n}\n}\n",""]);const i=l},1113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},1208:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"/* --- Design Tokens (The Alchemist's Formula) --- */\n:root {\n  /* --- Light Theme Colors --- */\n  --color-background: #e8e6e3;\n  --color-background-transparent: rgba(232, 230, 227, 0.85);\n  --color-surface: #f2f1ee; /* 温润的米白色，类似古宣纸 */\n  --color-surface-transparent: rgba(242, 241, 238, 0.75);\n  --color-surface-light: #ebe9e6; /* 更温润的浅色 */\n  /* Derived/interactive states (light) */\n  --color-surface-hover: #eeede9; /* 悬浮时的温润色 */\n  --color-primary: #2e5cb8;\n  --color-primary-rgb: 46, 92, 184;\n  --color-primary-hover: #274f9d;\n  --color-primary-active: #1f3f80;\n  /* Lighten variant used by some components */\n  --color-primary-light: rgba(46, 92, 184, 0.12);\n  --color-accent: #7c4dff;\n  --color-accent-hover: #6c3eff;\n  --color-accent-light: rgba(124, 77, 255, 0.15);\n  --color-text: #1a1a1a;\n  --color-text-secondary: #606060; /* 增强对比度 */\n  --color-text-muted: #757575; /* 增强对比度 */\n  --color-white-soft: #f2f1ee; /* 新增：温润的白色，替代纯白 */\n  --color-border: rgba(0, 0, 0, 0.1);\n  --color-border-hover: rgba(0, 0, 0, 0.2);\n  --color-success: #4caf50;\n  --color-success-hover: #43a047;\n  --color-warning: #ff9800;\n  --color-warning-hover: #fb8c00;\n  --color-error: #ff2929; /* 与气血统一，更红一些 */\n  --color-error-hover: #e6375a;\n  --color-info: #2196f3;\n  --color-info-hover: #1e88e5;\n  /* Keep danger alias for components that expect it */\n  --color-danger: var(--color-error);\n  --color-danger-hover: #e53935;\n  /* Generic hover background alias used in components */\n  --color-hover: var(--color-surface-hover);\n  /* Code block background used in data views */\n  --color-code-bg: #0f172a0f; /* subtle deep slate with opacity */\n  /* Global scrollbar tokens (light) – hide track, show only thumb */\n  --scrollbar-track-color: transparent;\n  --scrollbar-thumb-color: rgba(0, 0, 0, 0.35);\n  --scrollbar-thumb-hover-color: rgba(0, 0, 0, 0.5);\n\n  /* Vital colors (light theme) */\n  --vital-health: #ff2929;   /* 气血/健康（与 --color-error 保持一致） */\n  --vital-lingqi: #3b82f6;   /* 灵气(统一蓝) */\n  --vital-spirit: #ffeb00;   /* 神识(金色) */\n  --vital-lifespan: #c253ff; /* 寿元(紫色) */\n\n  /* Derived RGB triplets for rgba() usage (light) */\n  --color-background-rgb: 232, 230, 227;\n  --color-surface-rgb: 242, 241, 238;\n  --color-accent-rgb: 124, 77, 255;\n  --color-border-rgb: 0, 0, 0;\n  --color-success-rgb: 76, 175, 80;\n  --color-warning-rgb: 255, 152, 0;\n  --color-error-rgb: 255, 41, 41;\n  --color-info-rgb: 33, 150, 243;\n\n  /* UI缩放变量 */\n  --ui-scale: 1;\n  --base-font-size: 1rem;\n\n  /* 字体与过渡 */\n  --font-family-serif: 'SimSun', 'NSimSun', 'STSong', '宋体', 'Noto Serif SC', 'KaiTi', 'STKaiti', serif;\n  --font-family-sans-serif: 'SimSun', 'NSimSun', 'STSong', '宋体', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --transition-fast: all 0.2s ease-in-out;\n}\n\n/* --- 暗色主题灵脉: \"松烟玄墨\" (通过 data-theme 属性激活) --- */\n:root[data-theme='dark'] {\n  /* --- Dark Theme Colors --- */\n  --color-background: rgb(30, 41, 59);\n  --color-background-transparent: rgba(26, 27, 38, 0.85);\n  --color-surface: #232e40;\n  --color-surface-transparent: rgba(41, 51, 72, 0.6);\n  --color-surface-light: #414868;\n  /* Derived/interactive states (dark) */\n  --color-surface-hover: #33415f;\n  --color-primary: #82a3f5;\n  --color-primary-rgb: 130, 163, 245;\n  --color-primary-hover: #6f93f2;\n  --color-primary-active: #597ee6;\n  --color-primary-light: rgba(130, 163, 245, 0.18);\n  --color-accent: #c0caf5;\n  --color-accent-hover: #a9b8f2;\n  --color-accent-light: rgba(192, 202, 245, 0.15);\n  --color-text: #f7f7f5; /* 柔和的暖白色，不那么刺眼 */\n  --color-text-secondary: #d0d0d0;\n  --color-text-muted: #b9b9b9; /* 增强对比度 */\n  --color-white-soft: #f7f7f5; /* 暗色主题下的柔和白色 */\n  --color-border: rgba(173, 216, 230, 0.5);\n  --color-border-hover: rgba(173, 216, 230, 0.8);\n  --color-success: #9ece6a;\n  --color-success-hover: #88b85b;\n  --color-warning: #ffd500;\n  --color-warning-hover: #e6c200;\n  --color-error: #ff2f49; /* 暗色下更红一些 */\n  --color-error-hover: #e64470;\n  --color-info: #77cdfe;\n  --color-info-hover: #66bff4;\n  --color-danger: var(--color-error);\n  --color-danger-hover: #e66a81;\n  --color-hover: var(--color-surface-hover);\n  --color-code-bg: rgba(20, 26, 43, 0.6);\n  /* Global scrollbar tokens (dark) – hide track, show only thumb */\n  --scrollbar-track-color: transparent;\n  --scrollbar-thumb-color: rgba(255, 255, 255, 0.35);\n  --scrollbar-thumb-hover-color: rgba(255, 255, 255, 0.5);\n\n  /* Vital colors (dark theme) */\n  --vital-health: #ff2f49;   /* 气血/健康（暗色，与 --color-error 保持一致） */\n  --vital-lingqi: #3b82f6;   /* 灵气(统一蓝) */\n  --vital-spirit: #ffeb00;   /* 神识(金色) */\n  --vital-lifespan: #c253ff; /* 寿元(紫色) */\n\n  /* Derived RGB triplets for rgba() usage (dark) */\n  --color-background-rgb: 26, 27, 38;\n  --color-surface-rgb: 41, 51, 72;\n  --color-accent-rgb: 192, 202, 245;\n  --color-border-rgb: 173, 216, 230;\n  --color-success-rgb: 158, 206, 106;\n  --color-warning-rgb: 255, 213, 0;\n  --color-error-rgb: 255, 47, 73;\n  --color-info-rgb: 119, 205, 254;\n}\n\n/* --- Base Styles --- */\nhtml,\nbody {\n  /* 高度将由 App.vue 中的脚本动态设置，此处不应有 height 或 min-height */\n  margin: 0;\n  padding: 0;\n  /* 移除 overflow: hidden; 应用内滚动由 #app 控制 */\n  font-family: var(--font-family-serif);\n  background-color: transparent; /* 移除背景色，让视频透出 */\n  color: var(--color-text);\n  /* 遵道友法旨，去除所有文字阴影，返璞归真。 */\n  text-shadow: none;\n}\n\n#app {\n  position: absolute; /* 使用绝对定位强制撑满body */\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n  overflow: auto; /* 应用内的滚动由app自身管理 */\n  /* 应用UI缩放，使用zoom属性（Chrome, Safari等支持） */\n  zoom: var(--ui-scale);\n  /* 应用基础字体大小 */\n  font-size: var(--base-font-size);\n}\n\n/* --- Reusable Button Class (The Master's Touch) --- */\n.btn {\n  display: inline-block;\n  padding: 0.75rem 1.5rem;\n  border: 1px solid var(--color-primary);\n  border-radius: 8px;\n  background-color: transparent;\n  color: var(--color-primary);\n  font-family: var(--font-family-serif);\n  font-size: 1rem;\n  font-weight: bold;\n  text-align: center;\n  text-decoration: none;\n  cursor: pointer;\n  transition: var(--transition-fast);\n  user-select: none; /* Prevent text selection on click */\n  position: relative;\n  overflow: hidden;\n}\n\n/* --- Button States (Guaranteed Visual Feedback) --- */\n.btn:hover {\n  background-color: var(--color-primary);\n  color: var(--color-background);\n  box-shadow: 0 0 15px rgba(200, 160, 100, 0.5);\n}\n\n.btn:active {\n  transform: scale(0.98);\n  background-color: var(--color-primary-active);\n  border-color: var(--color-primary-active);\n  box-shadow: none;\n}\n\n.btn:focus-visible {\n  outline: 2px solid var(--color-primary-hover);\n  outline-offset: 2px;\n}\n\n/* --- Disabled Button State --- */\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background-color: transparent;\n  color: var(--color-border);\n  border-color: var(--color-border);\n  box-shadow: none;\n}\n\n/* --- 移除流光特效 --- */\n\n/* --- Button Variants --- */\n.btn.btn-secondary {\n  border-color: var(--color-border);\n  color: var(--color-text);\n}\n\n.btn.btn-secondary:hover {\n  background-color: var(--color-surface);\n  border-color: var(--color-text);\n}\n\n.btn.btn-complete {\n  border-color: var(--color-accent); /* 青玉色 */\n  color: var(--color-accent);\n  animation: pulse-glow 2s ease-in-out infinite;\n}\n\n.btn.btn-complete:hover {\n  background-color: var(--color-accent);\n  color: var(--color-background);\n  box-shadow: 0 0 20px rgba(111, 179, 184, 0.5);\n}\n\n@keyframes pulse-glow {\n  0%,\n  100% {\n    box-shadow: 0 0 10px rgba(111, 179, 184, 0.3);\n  }\n  50% {\n    box-shadow: 0 0 20px rgba(111, 179, 184, 0.6);\n  }\n}\n\n/* --- 全局滚动条美化 (兼容 WebKit & Firefox) --- */\n/* WebKit browsers (Chrome, Safari, Edge) */\n#app::-webkit-scrollbar {\n  width: 10px; /* 稍微加宽以获得更好的点击区域 */\n  height: 10px;\n}\n\n#app::-webkit-scrollbar-track {\n  background: var(--scrollbar-track-color);\n}\n\n#app::-webkit-scrollbar-thumb {\n  background-color: var(--scrollbar-thumb-color);\n  border-radius: 5px;\n  border: 2px solid transparent;\n  background-clip: content-box;\n  transition: background-color 0.3s ease-in-out;\n}\n\n#app::-webkit-scrollbar-thumb:hover {\n  background-color: var(--scrollbar-thumb-hover-color);\n}\n\n/* Firefox */\n#app {\n  scrollbar-width: thin;\n  scrollbar-color: var(--scrollbar-thumb-color) var(--scrollbar-track-color);\n}\n\n/* --- 通用法器样式：卡片/面板 (浮空术) --- */\n.card-panel {\n  background: var(--color-surface);\n  border: 2px solid var(--color-primary); /* 坚固、醒目的主色边框 */\n  border-radius: 12px;\n  box-shadow: none; /* 移除所有阴影 */\n  transition: border-color 0.3s ease;\n}\n\n.card-panel:hover {\n  border-color: var(--color-primary-hover); /* 悬浮时边框颜色变亮 */\n  transform: none; /* 移除悬浮时的位移 */\n}\n\n/* --- 新增样式：天机推演动画 (for Login Button) --- */\n.btn.is-loading .btn-text {\n  opacity: 0; /* Hide original text */\n}\n\n.btn.is-loading::before,\n.btn.is-loading::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 20px;\n  height: 20px;\n  margin-top: -10px;\n  margin-left: -10px;\n  border-radius: 50%;\n  border: 2px solid var(--color-primary);\n  animation-duration: 1.5s;\n  animation-iteration-count: infinite;\n  animation-timing-function: ease-in-out;\n}\n\n.btn.is-loading::before {\n  border-style: solid solid dashed dashed;\n  animation-name: spin-left;\n}\n\n.btn.is-loading::after {\n  border-style: dashed dashed solid solid;\n  animation-name: spin-right;\n}\n\n@keyframes spin-left {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes spin-right {\n  from { transform: rotate(360deg); }\n  to { transform: rotate(0deg); }\n}\n\n/* --- 新增样式：开天辟地 (for MainGame Empty State) --- */\n.genesis-prompt {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  padding: 2rem;\n  text-align: center;\n  background: radial-gradient(ellipse at center, var(--color-surface-light) 0%, var(--color-background) 70%);\n}\n\n.genesis-title {\n  font-family: var(--font-family-serif);\n  font-size: 2.5rem;\n  color: var(--color-primary);\n  margin-bottom: 1rem;\n  text-shadow: 0 0 10px rgba(var(--color-primary-rgb), 0.3);\n}\n\n.genesis-subtitle {\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n  max-width: 500px;\n  margin-bottom: 3rem;\n}\n\n.genesis-cta {\n  padding: 1.2rem 2.5rem;\n  font-size: 1.5rem;\n  border-width: 2px;\n  animation: pulse-glow 2.5s ease-in-out infinite;\n}\n\n/* --- 新增样式：道途选择界面 --- */\n.mode-selection-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  max-height: 800px; /* 限制最大高度适应iframe */\n  overflow-y: auto;\n  color: var(--color-text);\n  display: flex;\n  flex-direction: column;\n  align-items: center; /* 水平居中 */\n  justify-content: center; /* 垂直居中 */\n  padding: 1rem 0; /* 减小内部垂直边距 */\n  box-sizing: border-box; /* 确保 padding 不会导致溢出 */\n}\n\n.video-background {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transform: translate(-50%, -50%);\n  z-index: -2;\n}\n\n.video-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5); /* 默认遮罩，暗色主题下可调整 */\n  z-index: -1;\n}\n\n:root[data-theme='dark'] .video-overlay {\n    background-color: rgba(10, 15, 24, 0.4); /* 降低遮罩透明度，让背景更亮 */\n}\n\n.selection-content {\n  position: relative;\n  z-index: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 1.5rem;\n  background: var(--color-surface-light);\n  border-radius: 16px;\n  border: 1px solid var(--color-border);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  width: 90%;\n  max-width: 1000px;\n  max-height: calc(100% - 2rem); /* 确保不超出容器 */\n  overflow-y: auto; /* 允许内容滚动 */\n  /* 移除 margin，由父容器的 padding 控制间距 */\n}\n\n.main-title {\n  font-family: var(--font-family-serif);\n  font-size: 3rem;\n  font-weight: 500;\n  margin-bottom: 2.5rem;\n  letter-spacing: 0.2em;\n  text-shadow: 0 0 15px rgba(var(--color-primary-rgb), 0.4);\n}\n\n.paths-container {\n  display: flex;\n  justify-content: center;\n  gap: 3rem;\n  width: 100%;\n}\n\n.path-card {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 2rem;\n  border-radius: 1rem;\n  border: 2px solid var(--color-primary);\n  background: var(--color-surface);\n  cursor: pointer;\n  transition: all 0.3s ease-in-out;\n  position: relative;\n  overflow: hidden;\n}\n\n.path-card:hover {\n  transform: translateY(-10px);\n  background: rgba(var(--color-primary-rgb), 0.4);\n}\n\n.path-card .path-icon {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    color: var(--color-primary);\n    transition: var(--transition-fast);\n}\n\n.path-card:hover .path-icon {\n    color: var(--color-accent);\n    transform: scale(1.1);\n}\n\n.path-title {\n  font-family: var(--font-family-serif);\n  font-size: 1.75rem;\n  margin-bottom: 0.75rem;\n}\n\n.path-description {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  text-align: center;\n  max-width: 300px;\n}\n\n.bottom-actions {\n  position: fixed;\n  z-index: 100; /* Ensure it's on top of everything */\n  bottom: 2rem;\n  right: 2rem;\n  display: flex;\n  gap: 1rem;\n}\n\n.action-btn {\n  width: 48px;\n  height: 48px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 1.5rem;\n  border: 1px solid var(--color-border);\n  background-color: var(--color-surface);\n  color: var(--color-text-secondary);\n  border-radius: 50%;\n  cursor: pointer;\n  transition: var(--transition-fast);\n  backdrop-filter: blur(5px);\n}\n\n.action-btn:hover {\n  background-color: var(--color-surface-light);\n  color: var(--color-text);\n  border-color: var(--color-border-hover);\n  transform: scale(1.1);\n}\n\n/* --- 通用法器样式：模态对话框/弹窗 (须弥芥子) --- */\n.modal-dialog {\n  background-color: var(--color-surface);\n  color: var(--color-text); /* 显式设置文字颜色，防止继承问题 */\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  padding: 1.5rem;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n}\n\n:root[data-theme='dark'] .modal-dialog {\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n}\n\n/* --- 全局操作按钮样式 (新版) --- */\n.global-actions {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  z-index: 1000;\n  display: flex;\n  gap: 12px;\n  pointer-events: auto;\n}\n\n.theme-toggle,\n.fullscreen-toggle {\n  --color: #a5a5b0;\n  --size: 24px;\n  width: 48px;\n  height: 48px;\n  border: none;\n  border-radius: 12px;\n  background: rgba(242, 241, 238, 0.9); /* 使用更温润的背景色 */\n  backdrop-filter: blur(10px);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  transition: all 0.3s ease;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  color: var(--color);\n  font-size: var(--size);\n  user-select: none;\n  fill: var(--color);\n}\n\n.theme-toggle:hover,\n.fullscreen-toggle:hover {\n  transform: translateY(-2px) scale(1.05);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\n  background: rgba(242, 241, 238, 0.95); /* 悬浮时也使用温润背景色 */\n}\n\n.theme-toggle:active,\n.fullscreen-toggle:active {\n  transform: translateY(0);\n}\n\n/* 主题切换图标 */\n.theme-toggle .moon {\n  position: absolute;\n  animation: keyframes-fill .5s;\n  width: 24px;\n  height: 24px;\n}\n\n.theme-toggle .sun {\n  position: absolute;\n  display: none;\n  animation: keyframes-fill .5s;\n  width: 24px;\n  height: 24px;\n}\n\n.theme-toggle input:checked ~ .moon {\n  display: none;\n}\n\n.theme-toggle input:checked ~ .sun {\n  display: block;\n}\n\n/* 全屏切换图标 */\n.fullscreen-toggle .expand {\n  position: absolute;\n  animation: fullscreen-fill .5s;\n  width: 24px;\n  height: 24px;\n}\n\n.fullscreen-toggle .compress {\n  position: absolute;\n  display: none;\n  animation: fullscreen-fill .5s;\n  width: 24px;\n  height: 24px;\n}\n\n.fullscreen-toggle input:checked ~ .expand {\n  display: none;\n}\n\n.fullscreen-toggle input:checked ~ .compress {\n  display: block;\n}\n\n/* 隐藏checkbox */\n.theme-toggle input,\n.fullscreen-toggle input {\n  position: absolute;\n  opacity: 0;\n  cursor: pointer;\n  height: 0;\n  width: 0;\n}\n\n/* 动画效果 */\n@keyframes keyframes-fill {\n  0% {\n    transform: rotate(-360deg) scale(0);\n    opacity: 0;\n  }\n  75% {\n    transform: rotate(25deg);\n  }\n  100% {\n    transform: rotate(0deg) scale(1);\n    opacity: 1;\n  }\n}\n\n@keyframes fullscreen-fill {\n  0% {\n    transform: scale(0);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n/* 暗色主题适配 */\n[data-theme=\"dark\"] .theme-toggle,\n[data-theme=\"dark\"] .fullscreen-toggle {\n  background: rgba(41, 51, 72, 0.9);\n  --color: #82A3F5;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n[data-theme=\"dark\"] .theme-toggle:hover,\n[data-theme=\"dark\"] .fullscreen-toggle:hover {\n  background: rgba(41, 51, 72, 0.95);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);\n}\n\n/* --- App Root & Transitions --- */\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n\n#app-container {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow-x: hidden;\n  position: relative;\n}\n\n/* --- Author Modal Styles --- */\n.author-modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(5px);\n}\n\n.author-modal {\n  background: var(--color-surface);\n  padding: 1.5rem 2rem;\n  border-radius: 12px;\n  border: 1px solid var(--color-border);\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);\n  width: 90%;\n  max-width: 500px;\n  color: var(--color-text);\n}\n\n.author-modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid var(--color-border);\n  padding-bottom: 1rem;\n  margin-bottom: 1rem;\n}\n\n.author-modal-header h3 {\n  margin: 0;\n  font-size: 1.4rem;\n  font-family: var(--font-family-serif);\n}\n\n.author-modal-body p {\n  margin: 0.8rem 0;\n  font-size: 1rem;\n  line-height: 1.6;\n}\n\n.author-modal-body a {\n  color: var(--color-primary);\n  text-decoration: none;\n  word-break: break-all;\n}\n\n.author-modal-body a:hover {\n  text-decoration: underline;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  font-size: 2rem;\n  color: var(--color-text-muted);\n  cursor: pointer;\n  line-height: 1;\n  padding: 0;\n}\n\n.close-btn:hover {\n  color: var(--color-text);\n}\n",""]);const i=l},1211:(e,n,t)=>{t.d(n,{N:()=>s});var a=t(1774),o=t(4061),r=t(8651),l=t(9333),i=t(7527);function c(e){if(null===e||"object"!=typeof e)return!1;const n=e;return Array.isArray(n.worlds)&&Array.isArray(n.talentTiers)&&Array.isArray(n.origins)&&Array.isArray(n.spiritRoots)&&Array.isArray(n.talents)}const s=(0,a.nY)("characterCreation",()=>{const e=(0,o.ref)("single"),n=(0,o.ref)(!1),a=(0,o.ref)(null),s=(0,o.ref)({worlds:[],talentTiers:[],origins:[],spiritRoots:[],talents:[]}),d=(0,o.ref)({gender:"男",character_name:"",race:"人族",world_id:"",talent_tier_id:"",current_age:18,root_bone:0,spirituality:0,comprehension:0,fortune:0,charm:0,temperament:0,origin_id:null,spirit_root_id:null,selected_talent_ids:[]}),m=(0,o.ref)(1),p=(0,o.ref)(!0),v=(0,o.ref)(null),u=(0,o.ref)({majorFactionsCount:Math.floor(4*Math.random())+5,totalLocations:Math.floor(11*Math.random())+20,secretRealmsCount:Math.floor(6*Math.random())+6,continentCount:Math.floor(5*Math.random())+3,hasImmortalEmpires:!1,hasDemonicFactions:!0,hasAncientSects:!0,mapConfig:{width:3600,height:2400,minLng:100,maxLng:130,minLat:25,maxLat:45}}),g=(0,o.computed)(()=>7),f=(0,o.computed)(()=>({root_bone:d.value.root_bone,spirituality:d.value.spirituality,comprehension:d.value.comprehension,fortune:d.value.fortune,charm:d.value.charm,temperament:d.value.temperament})),b=(0,o.computed)(()=>s.value.worlds.find(e=>e.id===d.value.world_id)||null),h=(0,o.computed)(()=>s.value.talentTiers.find(e=>e.id===d.value.talent_tier_id)||null),y=(0,o.computed)(()=>s.value.origins.find(e=>e.id===d.value.origin_id)||null),x=(0,o.computed)(()=>s.value.spiritRoots.find(e=>e.id===d.value.spirit_root_id)||null),k=(0,o.computed)(()=>s.value.talents.filter(e=>d.value.selected_talent_ids.includes(e.id))),w=(0,o.computed)(()=>{let e=0;return k.value.some(e=>"霸王血脉"===e.name)&&(e+=1,console.log('[天道点计算] 检测到 "霸王血脉" 天赋, 增加 1 天道点')),e}),N=(0,o.computed)(()=>{if(!h.value)return 0;let e=h.value.total_points;console.log("[天道点计算] 初始天道点:",e),e+=w.value,y.value&&(console.log("[天道点计算] 出生消耗:",y.value.talent_cost),e-=y.value.talent_cost),x.value&&(console.log("[天道点计算] 灵根消耗:",x.value.talent_cost),e-=x.value.talent_cost);const n=k.value.reduce((e,n)=>e+n.talent_cost,0);console.log("[天道点计算] 已选天赋数量:",k.value.length),console.log("[天道点计算] 已选天赋列表:",k.value.map(e=>({名称:e.name,消耗:e.talent_cost}))),console.log("[天道点计算] 天赋总消耗:",n),e-=n;const t=Object.values(f.value).reduce((e,n)=>e+n,0);return console.log("[天道点计算] 先天六司总和:",t),e-=t,console.log("[天道点计算] 最终剩余:",e),e}),E=(0,o.computed)(()=>{if(!h.value)return 0;const e=h.value.total_points-N.value;return Math.max(0,e)});async function V(){const e=(0,r.getTavernHelper)();if(!e)return void console.error("【创世神殿】无法连接到酒馆助手，数据无法持久化！");const n={worlds:s.value.worlds.filter(e=>"cloud"===e.source),talentTiers:s.value.talentTiers.filter(e=>"cloud"===e.source),origins:s.value.origins.filter(e=>"cloud"===e.source),spiritRoots:s.value.spiritRoots.filter(e=>"cloud"===e.source),talents:s.value.talents.filter(e=>"cloud"===e.source)},{deepCleanForClone:a}=await Promise.resolve().then(t.bind(t,3098)),o=a({DAD_creationData:n});await e.insertOrAssignVariables(o,{type:"global"}),console.log("【创世神殿】云端创世数据已存入全局变量！")}function C(e){s.value.worlds.unshift({...e,source:"cloud"}),V()}function z(e){s.value.talentTiers.unshift({...e,source:"cloud"}),V()}function S(e){s.value.origins.unshift({...e,source:"cloud"}),V()}function B(e){s.value.spiritRoots.unshift({...e,source:"cloud"}),V()}function D(e){s.value.talents.unshift({...e,source:"cloud"}),V()}async function A(e,n){const a=s.value[e].findIndex(e=>e.id===n);if(a>-1){const o=s.value[e][a];if(s.value[e].splice(a,1),console.log(`【创世神殿】已删除 ${e} 项目，ID: ${n}，来源: ${o.source}`),await V(),"cloud"===o.source){console.log("【创世神殿】删除云端数据，强制同步酒馆全局变量");try{const a=(0,r.getTavernHelper)();if(a){console.log("【创世神殿】方案1：完全重置 DAD_creationData");const o={worlds:s.value.worlds.filter(e=>"cloud"===e.source),talentTiers:s.value.talentTiers.filter(e=>"cloud"===e.source),origins:s.value.origins.filter(e=>"cloud"===e.source),spiritRoots:s.value.spiritRoots.filter(e=>"cloud"===e.source),talents:s.value.talents.filter(e=>"cloud"===e.source)};console.log("【创世神殿】准备保存的新数据:",JSON.stringify(o,null,2));try{await a.deleteVariable("DAD_creationData",{type:"global"}),console.log("【创世神殿】已删除旧的 DAD_creationData")}catch(e){console.warn("【创世神殿】删除旧变量失败（可能不存在）:",e)}const{deepCleanForClone:r}=await Promise.resolve().then(t.bind(t,3098)),l=r({DAD_creationData:o});await a.insertOrAssignVariables(l,{type:"global"}),console.log("【创世神殿】已重新创建 DAD_creationData");const i=(await a.getVariables({type:"global"})).DAD_creationData;if(console.log("【创世神殿】验证：更新后的 DAD_creationData:",JSON.stringify(i,null,2)),i&&c(i)){const t=i[e].filter(e=>e.id===n);0===t.length?console.log(`【创世神殿】✅ 验证成功：${e} 项目 ID: ${n} 已从酒馆全局变量中删除`):(console.error(`【创世神殿】❌ 验证失败：${e} 项目 ID: ${n} 仍在酒馆全局变量中`),console.error("【创世神殿】剩余项目:",t))}else console.error("【创世神殿】❌ 验证失败：DAD_creationData 格式无效")}else console.error("【创世神殿】❌ 酒馆助手不可用")}catch(e){console.error("【创世神殿】❌ 同步酒馆全局变量失败:",e)}}}else console.warn(`【创世神殿】删除失败：未找到 ${e} 项目，ID: ${n}`)}function _(e,n,t){const a=s.value[e].findIndex(e=>e.id===n);if(a>-1){const o=s.value[e][a];return s.value[e][a]={...o,...t},console.log(`【创世神殿】已更新 ${e} 项目，ID: ${n}`),V(),!0}return!1}async function $(){const e=await async function(){let e="";try{e=await(0,r.wz)()||""}catch(n){console.warn("获取用户名字失败:",n),e=""}return{gender:"男",character_name:e,race:"人族",world_id:"",talent_tier_id:"",current_age:18,root_bone:0,spirituality:0,comprehension:0,fortune:0,charm:0,temperament:0,origin_id:null,spirit_root_id:null,selected_talent_ids:[]}}();d.value=e,m.value=1}return{mode:e,isLoading:n,error:a,creationData:s,characterPayload:d,currentStep:m,isLocalCreation:p,initialGameMessage:v,worldGenerationConfig:u,totalSteps:g,attributes:f,selectedWorld:b,selectedTalentTier:h,selectedOrigin:y,selectedSpiritRoot:x,selectedTalents:k,remainingTalentPoints:N,totalTalentCost:E,bonusTalentPoints:w,initializeStore:async function(t){n.value=!0,a.value=null,e.value=t;try{const e=await(0,r.wz)();e&&(d.value.character_name=e,console.log("【创世神殿】已获取用户道号:",e))}catch(e){console.warn("【创世神殿】获取用户道号失败",e)}try{if("single"===t){console.log("【创世神殿】初始化单机模式，加载本地数据和自定义数据！");const e=i.eQ.map(e=>({...e,source:"local"})),n=i.VQ.map(e=>({...e,source:"local"})),t=i.yM.map(e=>({...e,source:"local"})),a=i.Gr.map(e=>({...e,source:"local"})),o=i.qS.map(e=>({...e,source:"local"})),l=(0,r.getTavernHelper)();let d={worlds:[],talentTiers:[],origins:[],spiritRoots:[],talents:[]};if(l)try{const e=await l.getVariables({type:"global"}),n=e?.DAD_creationData;c(n)&&(d=n,console.log("【创世神殿】单机模式也成功加载了自定义数据:",{worlds:d.worlds.length,talentTiers:d.talentTiers.length,origins:d.origins.length,spiritRoots:d.spiritRoots.length,talents:d.talents.length}))}catch(e){console.warn("【创世神殿】单机模式加载自定义数据失败，仅使用本地数据:",e)}const m=d.worlds.map(e=>({...e,source:"cloud"})),p=d.talentTiers.map(e=>({...e,source:"cloud"})),v=d.origins.map(e=>({...e,source:"cloud"})),u=d.spiritRoots.map(e=>({...e,source:"cloud"})),g=d.talents.map(e=>({...e,source:"cloud"})),f=(e,n)=>{const t=new Map;return e.forEach(e=>t.set(e.id,e)),n.forEach(e=>t.set(e.id,e)),Array.from(t.values())};s.value.worlds=f(e,m),s.value.talentTiers=f(n,p),s.value.origins=f(t,v),s.value.spiritRoots=f(a,u),s.value.talents=f(o,g)}else{console.log("【创世神殿】初始化联机模式，加载本地及缓存的云端数据！");const e=(0,r.getTavernHelper)();let n={worlds:[],talentTiers:[],origins:[],spiritRoots:[],talents:[]};if(e){const t=await e.getVariables({type:"global"}),a=t?.DAD_creationData;c(a)&&(n=a,console.log("【创世神殿】从全局变量中加载了已缓存的云端创世数据！"))}const t=i.eQ.map(e=>({...e,source:"local"})),a=i.VQ.map(e=>({...e,source:"local"})),o=i.yM.map(e=>({...e,source:"local"})),l=i.Gr.map(e=>({...e,source:"local"})),d=i.qS.map(e=>({...e,source:"local"})),m=n.worlds.map(e=>({...e,source:"cloud"})),p=n.talentTiers.map(e=>({...e,source:"cloud"})),v=n.origins.map(e=>({...e,source:"cloud"})),u=n.spiritRoots.map(e=>({...e,source:"cloud"})),g=n.talents.map(e=>({...e,source:"cloud"})),f=(e,n)=>{const t=new Map;return e.forEach(e=>t.set(e.id,e)),n.forEach(e=>t.set(e.id,e)),Array.from(t.values())};s.value.worlds=f(t,m),s.value.talentTiers=f(a,p),s.value.origins=f(o,v),s.value.spiritRoots=f(l,u),s.value.talents=f(d,g)}}catch(e){console.error("加载数据失败:",e),a.value="加载数据失败",s.value.talentTiers=i.VQ.map(e=>({...e,source:"local"})),s.value.origins=i.yM.map(e=>({...e,source:"local"})),s.value.spiritRoots=i.Gr.map(e=>({...e,source:"local"})),s.value.talents=i.qS.map(e=>({...e,source:"local"}))}finally{n.value=!1}},fetchCloudWorlds:async function(){console.log("【创世神殿】正在从云端获取世界列表..."),n.value=!0,a.value=null;try{const e=await(0,l.w2)();console.log("【创世神殿】成功获取云端世界数据",e);const n=e.map(e=>({...e,source:"cloud"})),t=(i.eQ.map(e=>({...e,source:"local"})),new Map);n.forEach(e=>t.set(e.id,e)),s.value.worlds=Array.from(t.values()),console.log("【创世神殿】世界列表已更新:",s.value.worlds.length,"个世界"),console.log("【创世神殿】云端世界",s.value.worlds.filter(e=>"cloud"===e.source))}catch(e){console.error("【创世神殿】从云端获取世界列表失败:",e),a.value=`获取云端世界列表失败: ${e instanceof Error?e.message:"未知错误"}`;const n=i.eQ.map(e=>({...e,source:"local"}));s.value.worlds=n,console.warn("【创世神殿】云端数据获取失败，已提供本地备选数据")}finally{n.value=!1}},fetchAllCloudData:async function(){console.log("【创世神殿】正在从云端获取完整创世数据..."),n.value=!0,a.value=null;try{const[e,n,t,a,o]=await Promise.all([(0,l.w2)(),(0,l.yZ)(),(0,l.Uy)(),(0,l.xJ)(),(0,l.Qc)()]);console.log("【创世神殿】成功获取所有云端数据"),console.log("- 世界:",e.length,"个"),console.log("- 天资等级:",n.length,"个"),console.log("- 出身:",t.length,"个"),console.log("- 灵根:",a.length,"个"),console.log("- 天赋:",o.length,"个");const r={worlds:s.value.worlds.length,talentTiers:s.value.talentTiers.length,origins:s.value.origins.length,spiritRoots:s.value.spiritRoots.length,talents:s.value.talents.length},i=(e,n)=>(e||[]).filter(Boolean).map(e=>({...n,...e,source:"cloud"})),c=i(e,{id:0,name:"",era:"",description:""}),d=i(n,{id:0,name:"未知天资",description:"",total_points:20,rarity:1,color:"#FFFFFF"}),m=i(t,{id:0,name:"",description:"",talent_cost:0,attribute_modifiers:{},rarity:0}),p=i(a,{id:0,name:"",tier:"",description:"",base_multiplier:0,talent_cost:0}),v=i(o,{id:0,name:"",description:"",talent_cost:0,rarity:0}),u=s.value.worlds,g=s.value.talentTiers,f=s.value.origins,b=s.value.spiritRoots,h=s.value.talents,y=(e,n)=>{const t=[],a=new Set(e.map(e=>e.name));let o=Math.max(...e.map(e=>e.id),0);return n.forEach(e=>{if(!a.has(e.name)){o++;const n={...e,id:o};t.push(n),a.add(n.name)}}),t},x=(e,n)=>{n.length>0&&e.push(...n)};x(s.value.worlds,y(u,c)),x(s.value.talentTiers,y(g,d)),x(s.value.origins,y(f,m)),x(s.value.spiritRoots,y(b,p)),x(s.value.talents,y(h,v)),console.log("【创世神殿】所有云端数据合并完成"),console.log("【创世神殿】最终数据验证"),console.log("- 世界 (云端):",s.value.worlds.filter(e=>"cloud"===e.source).length),console.log("- 天资 (云端):",s.value.talentTiers.filter(e=>"cloud"===e.source).length),console.log("- 出身 (云端):",s.value.origins.filter(e=>"cloud"===e.source).length),console.log("- 灵根 (云端):",s.value.spiritRoots.filter(e=>"cloud"===e.source).length),console.log("- 天赋 (云端):",s.value.talents.filter(e=>"cloud"===e.source).length),console.log("【创世神殿】天资数据示例",s.value.talentTiers.slice(0,3).map(e=>({name:e.name,source:e.source})));const k={worlds:s.value.worlds.length,talentTiers:s.value.talentTiers.length,origins:s.value.origins.length,spiritRoots:s.value.spiritRoots.length,talents:s.value.talents.length},w=k.worlds-r.worlds+(k.talentTiers-r.talentTiers)+(k.origins-r.origins)+(k.spiritRoots-r.spiritRoots)+(k.talents-r.talents);return console.log(`【创世神殿】同步完成，新增 ${w} 项数据。`),await V(),w}catch(e){console.error("【创世神殿】获取云端创世数据失败",e),a.value=`获取云端创世数据失败: ${e instanceof Error?e.message:"未知错误"}`;const n=i.eQ.map(e=>({...e,source:"local"})),t=i.VQ.map(e=>({...e,source:"local"})),o=i.yM.map(e=>({...e,source:"local"})),r=i.Gr.map(e=>({...e,source:"local"})),l=i.qS.map(e=>({...e,source:"local"}));return s.value.worlds=n,s.value.talentTiers=t,s.value.origins=o,s.value.spiritRoots=r,s.value.talents=l,console.warn("【创世神殿】云端数据获取失败，已提供本地备选数据"),0}finally{n.value=!1}},addWorld:C,addTalentTier:z,addOrigin:S,addSpiritRoot:B,addTalent:D,addGeneratedData:function(e,n){switch(e){case"world":C(n);break;case"talent_tier":z(n);break;case"origin":S(n);break;case"spirit_root":B(n);break;case"talent":D(n);break;default:console.warn(`Unknown data type for addGeneratedData: ${e}`)}},removeWorld:async e=>await A("worlds",e),removeTalentTier:async e=>await A("talentTiers",e),removeOrigin:async e=>await A("origins",e),removeSpiritRoot:async e=>await A("spiritRoots",e),removeTalent:async e=>await A("talents",e),updateWorld:(e,n)=>_("worlds",e,n),updateTalentTier:(e,n)=>_("talentTiers",e,n),updateOrigin:(e,n)=>_("origins",e,n),updateSpiritRoot:(e,n)=>_("spiritRoots",e,n),updateTalent:(e,n)=>_("talents",e,n),getItemById:(e,n)=>s.value[e].find(e=>e.id===n)||null,selectWorld:function(e){d.value.world_id=e},selectTalentTier:function(e){d.value.talent_tier_id=e,d.value.origin_id=null,d.value.spirit_root_id=null,d.value.selected_talent_ids=[],d.value.root_bone=0,d.value.spirituality=0,d.value.comprehension=0,d.value.fortune=0,d.value.charm=0,d.value.temperament=0},selectOrigin:function(e){d.value.origin_id=e},selectSpiritRoot:function(e){d.value.spirit_root_id=e},toggleTalent:function(e){const n=d.value.selected_talent_ids.indexOf(e);n>-1?d.value.selected_talent_ids.splice(n,1):d.value.selected_talent_ids.push(e)},setAttribute:function(e,n){e in d.value&&(d.value[e]=n)},resetCharacter:$,nextStep:function(){m.value<7&&m.value++},prevStep:function(){m.value>1&&m.value--},goToStep:function(e){e>=1&&e<=7&&(m.value=e)},setMode:function(n){e.value=n,p.value="single"===n},toggleLocalCreation:function(){p.value=!p.value},setInitialGameMessage:function(e){v.value=e},setWorldGenerationConfig:function(e){u.value={...u.value,...e}},resetOnExit:async function(){await $(),e.value="single",p.value=!0},startLocalCreation:async function(){await $(),p.value=!0,e.value="single"},startCloudCreation:async function(){await $(),p.value=!1,e.value="cloud"},persistCustomData:V}})},1214:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n/* 命令日志弹窗样式 */\n.command-log-overlay[data-v-b63a96a6] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n}\n.command-log-modal[data-v-b63a96a6] {\n  background: var(--color-surface);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 500px;\n  max-height: 80vh;\n  overflow: hidden;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  border: 1px solid var(--color-border);\n  display: flex;\n  flex-direction: column;\n}\n\n/* 弹窗动画 */\n.command-log-modal-enter-active[data-v-b63a96a6],\n.command-log-modal-leave-active[data-v-b63a96a6] {\n  transition: all 0.3s ease;\n}\n.command-log-modal-enter-from[data-v-b63a96a6],\n.command-log-modal-leave-to[data-v-b63a96a6] {\n  opacity: 0;\n  transform: scale(0.9) translateY(20px);\n}\n.command-log-header[data-v-b63a96a6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  background: linear-gradient(135deg, var(--color-surface-light) 0%, var(--color-surface-hover) 100%);\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.command-log-header h3[data-v-b63a96a6] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.close-log-btn[data-v-b63a96a6] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 6px;\n  border-radius: 50%;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-log-btn[data-v-b63a96a6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  transform: rotate(90deg);\n}\n.command-log-content[data-v-b63a96a6] {\n  padding: 16px;\n  overflow-y: auto;\n  flex: 1;\n}\n.command-list[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.command-item[data-v-b63a96a6] {\n  display: flex;\n  gap: 12px;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  transition: all 0.2s ease;\n}\n.command-item[data-v-b63a96a6]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  border-color: var(--color-primary);\n}\n.command-icon-wrapper[data-v-b63a96a6] {\n  width: 40px;\n  height: 40px;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  background: var(--color-primary-light);\n  color: var(--color-primary);\n}\n.command-details[data-v-b63a96a6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.command-description[data-v-b63a96a6] {\n  margin: 0;\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: var(--color-text);\n  line-height: 1.4;\n}\n.command-values[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.85rem;\n  font-family: var(--font-family-mono);\n}\n.old-value[data-v-b63a96a6], .new-value[data-v-b63a96a6] {\n  padding: 4px 8px;\n  border-radius: 4px;\n}\n.old-value[data-v-b63a96a6] {\n  background: rgba(var(--color-error-rgb), 0.1);\n  color: var(--color-danger);\n  text-decoration: line-through;\n}\n.new-value[data-v-b63a96a6] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n  font-weight: 600;\n}\n.arrow[data-v-b63a96a6] {\n  color: var(--color-text-secondary);\n  font-weight: 600;\n}\n.no-commands[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.no-commands .empty-icon[data-v-b63a96a6] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n.no-commands .empty-text[data-v-b63a96a6] {\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  color: var(--color-text);\n  font-size: 1rem;\n}\n.no-commands .empty-hint[data-v-b63a96a6] {\n  font-size: 0.85rem;\n  opacity: 0.8;\n}\n\n/* 深色主题适配 */\n[data-theme="dark"] .command-log-modal[data-v-b63a96a6] {\n  background: #1e293b;\n  border-color: #475569;\n}\n[data-theme="dark"] .command-log-header[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #334155 0%, #1e293b 100%);\n  border-color: #475569;\n}\n[data-theme="dark"] .command-item[data-v-b63a96a6] {\n  background: #334155;\n  border-color: #475569;\n}\n[data-theme="dark"] .command-item[data-v-b63a96a6]:hover {\n  border-color: var(--color-primary);\n}\n[data-theme="dark"] .command-icon-wrapper[data-v-b63a96a6] {\n  background: rgba(var(--color-primary-rgb), 0.1);\n}\n[data-theme="dark"] .old-value[data-v-b63a96a6] {\n  background: rgba(var(--color-error-rgb), 0.2);\n}\n[data-theme="dark"] .new-value[data-v-b63a96a6] {\n  background: rgba(var(--color-success-rgb), 0.2);\n}\n.main-game-panel[data-v-b63a96a6] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n  font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n  box-sizing: border-box;\n}\n\n/* 短期记忆区域 */\n.memory-section[data-v-b63a96a6] {\n  padding: 12px 20px;\n  background: linear-gradient(135deg, #fefbff 0%, #f8fafc 100%);\n  border-bottom: 1px solid #e2e8f0;\n  position: relative;\n  z-index: 20;\n  flex-shrink: 0;\n}\n.memory-header[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  cursor: pointer;\n  padding: 4px 0;\n  transition: all 0.2s ease;\n}\n.memory-header[data-v-b63a96a6]:hover {\n  background: rgba(99, 102, 241, 0.05);\n  border-radius: 6px;\n  margin: -4px;\n  padding: 8px 4px;\n}\n.memory-title[data-v-b63a96a6] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #6366f1;\n}\n.memory-icon[data-v-b63a96a6] {\n  color: #94a3b8;\n  transition: transform 0.2s ease;\n}\n\n/* 下拉悬浮效果 */\n.memory-dropdown[data-v-b63a96a6] {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  background: var(--color-background);\n  border: 1px solid #e2e8f0;\n  border-top: none;\n  border-radius: 0 0 12px 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n  z-index: 19;\n  max-height: 300px;\n  overflow-y: auto;\n}\n.memory-content[data-v-b63a96a6] {\n  padding: 16px 20px;\n}\n.memory-item[data-v-b63a96a6] {\n  font-size: 0.85rem;\n  color: #374151;\n  margin-bottom: 12px;\n  padding: 12px 16px;\n  background: rgba(99, 102, 241, 0.05);\n  border-radius: 8px;\n  border-left: 3px solid #6366f1;\n  line-height: 1.5;\n}\n.memory-item[data-v-b63a96a6]:last-child {\n  margin-bottom: 0;\n}\n.no-memory[data-v-b63a96a6] {\n  font-size: 0.9rem;\n  color: #9ca3af;\n  font-style: italic;\n  text-align: center;\n  padding: 20px;\n}\n\n/* 下拉动画 */\n.memory-dropdown-enter-active[data-v-b63a96a6],\n.memory-dropdown-leave-active[data-v-b63a96a6] {\n  transition: all 0.3s ease;\n}\n.memory-dropdown-enter-from[data-v-b63a96a6] {\n  opacity: 0;\n  transform: translateY(-10px);\n}\n.memory-dropdown-leave-to[data-v-b63a96a6] {\n  opacity: 0;\n  transform: translateY(-10px);\n}\n\n/* 当前叙述显示区域 */\n.current-narrative[data-v-b63a96a6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-width: 0; /* 防止flex收缩问题 */\n  border-radius: 12px; /* 圆角 */\n  box-shadow: none !important; /* 移除阴影 */\n  background-color: var(--color-background) !important; /* 与padding区域相同背景色 */\n}\n.content-area[data-v-b63a96a6] {\n  background-color: var(--color-background) !important; /* 强制应用背景色 */\n  padding: 20px;\n  flex: 1;\n  overflow-y: auto;\n  scrollbar-width: thin;\n  /* 显示可见的滚动拇指，但轨道透明 */\n  scrollbar-color: rgba(148, 163, 184, 0.6) transparent;\n  box-sizing: border-box;\n  min-height: 200px;\n  display: flex; /* 让子元素可以撑满高度 */\n  box-shadow: none !important; /* 移除阴影 */\n}\n\n/* WebKit滚动条样式 */\n.content-area[data-v-b63a96a6]::-webkit-scrollbar {\n  width: 6px;\n  background: transparent;\n}\n.content-area[data-v-b63a96a6]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.content-area[data-v-b63a96a6]::-webkit-scrollbar-track-piece {\n  background: transparent;\n}\n.content-area[data-v-b63a96a6]::-webkit-scrollbar-thumb {\n  border-radius: 3px;\n  background-color: rgba(148, 163, 184, 0.6);\n}\n\n/* 悬停时略微增强可见度 */\n.content-area[data-v-b63a96a6]:hover::-webkit-scrollbar-thumb {\n  background-color: rgba(148, 163, 184, 0.8);\n}\n.content-area[data-v-b63a96a6]::-webkit-scrollbar-button {\n  display: none;\n}\n.content-area[data-v-b63a96a6]::-webkit-scrollbar-corner {\n  background: transparent;\n}\n\n\n/* AI处理时的显示样式 */\n.ai-processing-display[data-v-b63a96a6] {\n  width: 100%;\n  background: var(--color-surface); /* 确保AI处理区域使用主题表面颜色 */\n}\n\n/* 重置状态按钮 */\n.reset-state-btn[data-v-b63a96a6] {\n  padding: 6px;\n  font-size: 13px;\n  background: transparent;\n  color: var(--color-text-secondary);\n  border: 1px solid transparent;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: auto; /* 推到右侧 */\n}\n.reset-state-btn[data-v-b63a96a6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-danger);\n  border-color: var(--color-border-hover);\n  transform: translateY(-1px);\n}\n\n/* 流式内容显示 */\n.streaming-content[data-v-b63a96a6] {\n  width: 100%;\n}\n.streaming-meta[data-v-b63a96a6] {\n  justify-content: center !important; /* 强制居中，覆盖 narrative-meta 的 space-between */\n  position: relative; /* 添加相对定位，让时间和按钮可以绝对定位 */\n}\n.streaming-meta .narrative-time[data-v-b63a96a6] {\n  position: absolute;\n  left: 0;\n}\n.streaming-meta .reset-state-btn[data-v-b63a96a6] {\n  position: absolute;\n  right: 0;\n}\n.streaming-indicator[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.8rem;\n  color: var(--color-primary);\n  /* 现在这个会真正居中 */\n}\n.streaming-dot[data-v-b63a96a6] {\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  background: var(--color-primary);\n  animation: pulse-b63a96a6 1.2s ease-in-out infinite;\n}\n.streaming-text[data-v-b63a96a6] {\n  font-weight: 500;\n}\n\n/* 等待动画样式 */\n.waiting-animation[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 0; /* 增加一些垂直空间 */\n}\n.thinking-dots[data-v-b63a96a6] {\n  display: flex;\n  gap: 8px;\n}\n.thinking-dots .dot[data-v-b63a96a6] {\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: var(--color-primary);\n  animation: thinking-b63a96a6 1.4s ease-in-out infinite;\n}\n.thinking-dots .dot[data-v-b63a96a6]:nth-child(1) {\n  animation-delay: 0s;\n}\n.thinking-dots .dot[data-v-b63a96a6]:nth-child(2) {\n  animation-delay: 0.2s;\n}\n.thinking-dots .dot[data-v-b63a96a6]:nth-child(3) {\n  animation-delay: 0.4s;\n}\n@keyframes thinking-b63a96a6 {\n0%, 60%, 100% {\n    transform: scale(1);\n    opacity: 0.7;\n}\n30% {\n    transform: scale(1.3);\n    opacity: 1;\n}\n}\n\n/* .waiting-text is no longer used */\n@keyframes pulse-b63a96a6 {\n0% { box-shadow: 0 0 0 0 currentColor; opacity: 0.8;\n}\n70% { box-shadow: 0 0 0 6px transparent; opacity: 1;\n}\n100% { box-shadow: 0 0 0 0 transparent; opacity: 0.8;\n}\n}\n\n/* 输入框右侧的流式传输选项样式 - 删除旧样式 */\n\n/* 输入框容器样式 */\n.input-container[data-v-b63a96a6] {\n  flex: 1;\n  position: relative;\n  display: flex;\n  align-items: stretch; /* 让内部元素垂直拉伸 */\n  border: 1px solid #d1d5db;\n  border-radius: 8px;\n  background: var(--color-background);\n  transition: all 0.2s ease;\n  min-height: 32px; /* 减小最小高度以对应单行 */\n  max-width: 100%; /* 防止横向扩展 */\n  overflow: hidden; /* 确保内容不会溢出容器 */\n}\n.input-container[data-v-b63a96a6]:focus-within {\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n}\n.input-container[data-v-b63a96a6]:has(.game-input:disabled) {\n  background: #f9fafb;\n}\n\n/* 输入框内部的文本区域 */\n.input-container .game-input[data-v-b63a96a6] {\n  flex: 1;\n  border: none;\n  background: transparent;\n  padding: 8px 16px;\n  padding-right: 0; /* 右侧留给流式传输选项 */\n  outline: none;\n  box-shadow: none;\n  resize: none;\n  overflow-y: auto;\n  width: 100%; /* 确保宽度填满容器 */\n  min-height: 24px; /* 单行高度 */\n  max-height: 120px;\n  min-width: 0; /* 允许缩小 */\n  box-sizing: border-box;\n  word-wrap: break-word;\n  white-space: pre-wrap; /* 保持换行和空格 */\n  overflow-wrap: break-word;\n  /* 移除自动高度相关样式，用JS控制 */\n  height: auto;\n  line-height: 1.4;\n  /* 透明滚动条（Firefox） */\n  scrollbar-width: thin;\n  scrollbar-color: rgba(148, 163, 184, 0.6) transparent;\n}\n.input-container .game-input[data-v-b63a96a6]:focus {\n  border: none;\n  box-shadow: none;\n}\n\n/* 透明滚动条（WebKit） */\n.input-container .game-input[data-v-b63a96a6]::-webkit-scrollbar {\n  width: 6px;\n  background: transparent;\n}\n.input-container .game-input[data-v-b63a96a6]::-webkit-scrollbar-track,\n.input-container .game-input[data-v-b63a96a6]::-webkit-scrollbar-track-piece,\n.input-container .game-input[data-v-b63a96a6]::-webkit-scrollbar-corner {\n  background: transparent;\n}\n.input-container .game-input[data-v-b63a96a6]::-webkit-scrollbar-thumb {\n  border-radius: 3px;\n  background-color: rgba(148, 163, 184, 0.6);\n}\n.input-container .game-input[data-v-b63a96a6]:hover::-webkit-scrollbar-thumb {\n  background-color: rgba(148, 163, 184, 0.8);\n}\n\n/* 输入框内部的流式传输选项 */\n.stream-toggle-inside[data-v-b63a96a6] {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: 4px;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  white-space: nowrap;\n  padding: 4px 12px;\n  border-left: 1px solid #e5e7eb;\n  margin-left: 8px;\n  cursor: pointer;\n  user-select: none;\n  flex-shrink: 0;\n  align-self: stretch; /* 垂直拉伸以匹配容器高度 */\n  min-height: 32px; /* 减小最小高度以对应单行 */\n}\n.stream-toggle-inside[data-v-b63a96a6]:hover {\n  color: var(--color-text);\n}\n.stream-toggle-inside input[type="checkbox"][data-v-b63a96a6] {\n  width: 12px;\n  height: 12px;\n  cursor: pointer;\n}\n.stream-toggle-inside .label-text[data-v-b63a96a6] {\n  cursor: pointer;\n}\n\n/* 当前叙述显示区域 */\n/* .current-narrative 样式已合并到 line 1996 */\n.narrative-content[data-v-b63a96a6] {\n  line-height: 1.8;\n  color: var(--color-text);\n  font-size: 0.95rem;\n  background: var(--color-surface); /* 确保叙述内容区域背景一致 */\n}\n.narrative-meta[data-v-b63a96a6] {\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #f3f4f6;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.meta-buttons[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.header-action-btn.rollback-btn[data-v-b63a96a6] {\n  background: transparent;\n  border: 1px solid transparent;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 6px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n}\n.header-action-btn.rollback-btn[data-v-b63a96a6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-primary);\n}\n.narrative-time[data-v-b63a96a6] {\n  font-size: 0.8rem;\n  color: #6b7280;\n  font-weight: 500;\n}\n\n/* 变量更新按钮 */\n.variable-updates-toggle[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  background: linear-gradient(135deg, #3b82f6, #1d4ed8);\n  color: white;\n  border: none;\n  border-radius: 20px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n  position: relative;\n  overflow: hidden;\n}\n.variable-updates-toggle[data-v-b63a96a6]::before {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n  transition: left 0.5s ease;\n}\n.variable-updates-toggle[data-v-b63a96a6]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 16px rgba(59, 130, 246, 0.4);\n  background: linear-gradient(135deg, #2563eb, #1e40af);\n}\n.variable-updates-toggle[data-v-b63a96a6]:hover::before {\n  left: 100%;\n}\n.variable-updates-toggle.active[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #10b981, #059669);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n.variable-updates-toggle.disabled[data-v-b63a96a6] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: linear-gradient(135deg, #9ca3af, #6b7280);\n  box-shadow: 0 2px 8px rgba(156, 163, 175, 0.3);\n}\n.variable-updates-toggle.disabled[data-v-b63a96a6]:hover {\n  transform: none;\n  background: linear-gradient(135deg, #9ca3af, #6b7280);\n  box-shadow: 0 2px 8px rgba(156, 163, 175, 0.3);\n}\n.variable-updates-toggle.disabled[data-v-b63a96a6]::before {\n  display: none;\n}\n.update-count[data-v-b63a96a6] {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  font-size: 0.7rem;\n  font-weight: 700;\n  padding: 2px 6px;\n  border-radius: 10px;\n  min-width: 18px;\n  text-align: center;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n/* 悬浮面板覆盖层 */\n.variable-updates-overlay[data-v-b63a96a6] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n}\n\n/* 悬浮面板主体 */\n.variable-updates-modal[data-v-b63a96a6] {\n  background: var(--color-surface);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 500px;\n  max-height: 80vh;\n  overflow: hidden;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  border: 1px solid var(--color-border);\n  animation: modal-appear-b63a96a6 0.3s ease-out;\n}\n@keyframes modal-appear-b63a96a6 {\nfrom {\n    opacity: 0;\n    transform: scale(0.9) translateY(20px);\n}\nto {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n}\n}\n\n/* 悬浮面板动画 */\n.variable-updates-modal-enter-active[data-v-b63a96a6],\n.variable-updates-modal-leave-active[data-v-b63a96a6] {\n  transition: all 0.3s ease;\n}\n.variable-updates-modal-enter-from[data-v-b63a96a6] {\n  opacity: 0;\n  transform: scale(0.9) translateY(20px);\n}\n.variable-updates-modal-leave-to[data-v-b63a96a6] {\n  opacity: 0;\n  transform: scale(0.9) translateY(20px);\n}\n\n/* 悬浮面板头部 */\n.variable-updates-modal .updates-header[data-v-b63a96a6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  border-bottom: 1px solid var(--color-border);\n}\n.variable-updates-modal .updates-header h4[data-v-b63a96a6] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.close-updates-btn[data-v-b63a96a6] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 6px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-updates-btn[data-v-b63a96a6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  transform: rotate(90deg);\n}\n\n/* 悬浮面板内容 */\n.variable-updates-modal .updates-content[data-v-b63a96a6] {\n  padding: 16px;\n  overflow-y: auto;\n  max-height: 60vh;\n}\n\n/* 移除重复的样式，让内部FormattedText组件处理 */\n.empty-narrative[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: #9ca3af;\n  font-style: italic;\n  font-size: 0.9rem;\n}\n\n/* 动作队列显示区域 */\n.action-queue-display[data-v-b63a96a6] {\n  margin-bottom: 12px;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  padding: 12px;\n}\n.queue-header[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 8px;\n}\n.queue-title[data-v-b63a96a6] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #6366f1;\n}\n.clear-queue-btn[data-v-b63a96a6] {\n  background: transparent;\n  border: none;\n  color: #9ca3af;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n.clear-queue-btn[data-v-b63a96a6]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  color: #ef4444;\n}\n.queue-actions[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  max-height: 150px;\n  overflow-y: auto;\n}\n.queue-action-item[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(99, 102, 241, 0.05);\n  border: 1px solid rgba(99, 102, 241, 0.1);\n  border-radius: 6px;\n  font-size: 0.85rem;\n}\n.action-text[data-v-b63a96a6] {\n  flex: 1;\n  color: #374151;\n  line-height: 1.4;\n  margin-right: 8px;\n}\n.action-controls[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  flex-shrink: 0;\n}\n.undo-indicator[data-v-b63a96a6] {\n  font-size: 12px;\n  opacity: 0.7;\n  animation: rotate-b63a96a6 2s linear infinite;\n}\n@keyframes rotate-b63a96a6 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n.remove-action-btn[data-v-b63a96a6] {\n  background: transparent;\n  border: none;\n  color: #9ca3af;\n  cursor: pointer;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 16px;\n  line-height: 1;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n}\n.remove-action-btn[data-v-b63a96a6]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  color: #ef4444;\n}\n.input-section[data-v-b63a96a6] {\n  padding: 16px 20px 20px 20px; /* 进一步增加底部内边距 */\n  border-top: 1px solid #e2e8f0;\n  background: #f8fafc;\n  box-sizing: border-box;\n  flex-shrink: 0;\n}\n.input-wrapper[data-v-b63a96a6] {\n  display: flex;\n  gap: 12px;\n  align-items: stretch; /* 改为stretch让所有元素高度一致 */\n  width: 100%;\n  max-width: none;\n}\n.game-input[data-v-b63a96a6] {\n  /* 这些样式现在由 .input-container 处理 */\n  font-size: 0.9rem;\n  line-height: 1.4;\n  color: #374151;\n  resize: none;\n  /* 移除固定高度，改为自动调整 */\n  /* min-height: 44px; */\n  /* max-height: 120px; */\n  font-family: inherit;\n  /* 移除过渡效果，避免高度调整时的闪烁 */\n  /* transition: all 0.2s ease; */\n}\n\n/* 移除原来的 focus 样式，现在由容器处理 */\n/* .game-input:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n} */\n.game-input[data-v-b63a96a6]:disabled {\n  /* background: #f9fafb; */\n  color: #9ca3af;\n  cursor: not-allowed;\n}\n.game-input[data-v-b63a96a6]::placeholder {\n  color: #9ca3af;\n}\n.send-button[data-v-b63a96a6] {\n  padding: 12px 24px;\n  background: #3b82f6;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  font-family: inherit;\n  min-height: 32px; /* 减小最小高度以匹配输入框 */\n  align-self: stretch; /* 垂直拉伸以匹配容器高度 */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.send-button[data-v-b63a96a6]:hover:not(:disabled) {\n  background: #2563eb;\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n}\n.send-button[data-v-b63a96a6]:disabled {\n  background: #d1d5db;\n  color: #9ca3af;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n.animate-spin[data-v-b63a96a6] {\n  animation: spin-b63a96a6 1s linear infinite;\n}\n@keyframes spin-b63a96a6 {\nfrom {\n    transform: rotate(0deg);\n}\nto {\n    transform: rotate(360deg);\n}\n}\n\n/* 深色主题 */\n[data-theme="dark"] .main-game-panel[data-v-b63a96a6] {\n  background: var(--color-background);\n}\n\n/* 叙述内容深色主题 */\n[data-theme="dark"] .narrative-content[data-v-b63a96a6] {\n  background: #1e293b;\n  color: #e2e8f0;\n}\n[data-theme="dark"] .narrative-meta[data-v-b63a96a6] {\n  border-bottom-color: #374151;\n}\n[data-theme="dark"] .narrative-time[data-v-b63a96a6] {\n  color: #94a3b8;\n}\n\n/* 深色主题 - 变量更新按钮 */\n[data-theme="dark"] .variable-updates-toggle[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #3b82f6, #1e3a8a);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);\n}\n[data-theme="dark"] .variable-updates-toggle[data-v-b63a96a6]:hover {\n  background: linear-gradient(135deg, #2563eb, #1e40af);\n  box-shadow: 0 4px 16px rgba(59, 130, 246, 0.5);\n}\n[data-theme="dark"] .variable-updates-toggle.active[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #10b981, #065f46);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);\n}\n[data-theme="dark"] .variable-updates-toggle.active[data-v-b63a96a6]:hover {\n  background: linear-gradient(135deg, #059669, #047857);\n  box-shadow: 0 4px 16px rgba(16, 185, 129, 0.5);\n}\n[data-theme="dark"] .variable-updates-toggle.disabled[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #4b5563, #374151);\n  box-shadow: 0 2px 8px rgba(75, 85, 99, 0.4);\n}\n[data-theme="dark"] .variable-updates-toggle.disabled[data-v-b63a96a6]:hover {\n  background: linear-gradient(135deg, #4b5563, #374151);\n  box-shadow: 0 2px 8px rgba(75, 85, 99, 0.4);\n}\n[data-theme="dark"] .variable-updates-overlay[data-v-b63a96a6] {\n  background: rgba(0, 0, 0, 0.7);\n}\n[data-theme="dark"] .variable-updates-modal[data-v-b63a96a6] {\n  background: #1e293b;\n  border-color: #475569;\n}\n[data-theme="dark"] .variable-updates-modal .updates-header[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #334155 0%, #475569 100%);\n  border-color: #475569;\n}\n[data-theme="dark"] .variable-updates-modal .updates-header h4[data-v-b63a96a6] {\n  color: #e2e8f0;\n}\n[data-theme="dark"] .close-updates-btn[data-v-b63a96a6] {\n  color: #94a3b8;\n}\n[data-theme="dark"] .close-updates-btn[data-v-b63a96a6]:hover {\n  background: #475569;\n  color: #e2e8f0;\n}\n[data-theme="dark"] .empty-narrative[data-v-b63a96a6] {\n  color: #6b7280;\n}\n\n/* 确保深色主题下当前叙述区域背景一致 */\n[data-theme="dark"] .current-narrative[data-v-b63a96a6] {\n  background: #1e293b;\n}\n[data-theme="dark"] .ai-processing-display[data-v-b63a96a6] {\n  background: #1e293b !important;\n}\n[data-theme="dark"] .reset-state-btn[data-v-b63a96a6] {\n  background: rgba(var(--color-error-rgb), 0.2);\n  color: var(--color-danger);\n  border-color: rgba(var(--color-error-rgb), 0.3);\n}\n[data-theme="dark"] .reset-state-btn[data-v-b63a96a6]:hover {\n  background: rgba(var(--color-error-rgb), 0.3);\n  border-color: rgba(var(--color-error-rgb), 0.5);\n}\n[data-theme="dark"] .narrative-content[data-v-b63a96a6] {\n  background: #1e293b !important;\n}\n[data-theme="dark"] .input-section[data-v-b63a96a6] {\n  background: #334155;\n  border-top-color: #475569;\n}\n[data-theme="dark"] .game-input[data-v-b63a96a6] {\n  /* background: #1e293b; - 现在由容器处理 */\n  /* border-color: #475569; - 现在由容器处理 */\n  color: #e2e8f0;\n}\n\n/* 移除重复的深色主题 focus 样式 */\n/* [data-theme="dark"] .game-input:focus {\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);\n} */\n[data-theme="dark"] .game-input[data-v-b63a96a6]:disabled {\n  /* background: #0f172a; - 现在由容器处理 */\n  color: #64748b;\n}\n[data-theme="dark"] .game-input[data-v-b63a96a6]::placeholder {\n  color: #64748b;\n}\n[data-theme="dark"] .send-button[data-v-b63a96a6] {\n  background: #3b82f6;\n}\n[data-theme="dark"] .send-button[data-v-b63a96a6]:hover:not(:disabled) {\n  background: #2563eb;\n}\n[data-theme="dark"] .send-button[data-v-b63a96a6]:disabled {\n  background: #374151;\n  color: #64748b;\n}\n\n/* 短期记忆深色主题 */\n[data-theme="dark"] .memory-section[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);\n  border-color: #475569;\n}\n[data-theme="dark"] .memory-header[data-v-b63a96a6]:hover {\n  background: rgba(99, 102, 241, 0.1);\n}\n[data-theme="dark"] .memory-title[data-v-b63a96a6] {\n  color: #818cf8;\n}\n[data-theme="dark"] .memory-icon[data-v-b63a96a6] {\n  color: #64748b;\n}\n[data-theme="dark"] .memory-dropdown[data-v-b63a96a6] {\n  background: #1e293b;\n  border-color: #475569;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n}\n[data-theme="dark"] .memory-item[data-v-b63a96a6] {\n  background: rgba(129, 140, 248, 0.1);\n  border-left-color: #818cf8;\n  color: #e2e8f0;\n}\n\n/* 等待覆盖层深色主题 - 更新为AI处理显示样式 */\n[data-theme="dark"] .streaming-meta[data-v-b63a96a6] {\n  border-bottom-color: #374151;\n}\n[data-theme="dark"] .streaming-indicator[data-v-b63a96a6] {\n  color: #60a5fa;\n}\n[data-theme="dark"] .streaming-dot[data-v-b63a96a6] {\n  background: #60a5fa;\n}\n[data-theme="dark"] .thinking-dots .dot[data-v-b63a96a6] {\n  background: #60a5fa;\n}\n[data-theme="dark"] .waiting-text[data-v-b63a96a6] {\n  color: #94a3b8;\n}\n\n/* 输入框右侧流式传输选项深色主题 - 更新为内部样式 */\n[data-theme="dark"] .input-container[data-v-b63a96a6] {\n  background: #1e293b;\n  border-color: #475569;\n}\n[data-theme="dark"] .input-container[data-v-b63a96a6]:focus-within {\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);\n}\n[data-theme="dark"] .input-container[data-v-b63a96a6]:has(.game-input:disabled) {\n  background: #0f172a;\n}\n[data-theme="dark"] .stream-toggle-inside[data-v-b63a96a6] {\n  color: #94a3b8;\n  border-left-color: #475569;\n}\n[data-theme="dark"] .stream-toggle-inside[data-v-b63a96a6]:hover {\n  color: #e2e8f0;\n}\n\n/* 行动选择器按钮 */\n.action-selector-btn[data-v-b63a96a6] {\n  width: 44px;\n  min-height: 32px; /* 减小最小高度以匹配输入框 */\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: #6366f1;\n  align-self: stretch; /* 垂直拉伸以匹配容器高度 */\n  flex-shrink: 0;\n}\n.action-selector-btn[data-v-b63a96a6]:hover:not(:disabled) {\n  background: #f1f5f9;\n  border-color: #6366f1;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);\n}\n.action-selector-btn[data-v-b63a96a6]:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n}\n\n/* 行动选择弹窗 */\n.action-modal-overlay[data-v-b63a96a6],\n.action-config-overlay[data-v-b63a96a6] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.4);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(2px);\n}\n.action-modal[data-v-b63a96a6] {\n  background: var(--color-background);\n  border-radius: 12px;\n  max-width: 480px;\n  width: 90%;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n}\n.action-config-modal[data-v-b63a96a6] {\n  background: var(--color-background);\n  border-radius: 12px;\n  max-width: 400px;\n  width: 90%;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n}\n.modal-header[data-v-b63a96a6],\n.config-header[data-v-b63a96a6] {\n  padding: 16px 20px;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: var(--color-primary, #3b82f6);\n}\n.modal-header h3[data-v-b63a96a6],\n.config-header h3[data-v-b63a96a6] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: white;\n}\n.close-btn[data-v-b63a96a6] {\n  width: 28px;\n  height: 28px;\n  border: none;\n  background: var(--color-surface-light);\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  color: white;\n  transition: all 0.2s ease;\n}\n.close-btn[data-v-b63a96a6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.action-grid[data-v-b63a96a6] {\n  padding: 16px;\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 8px;\n}\n.quick-action-btn[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 6px;\n  padding: 12px 8px;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  background: var(--color-background);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.8rem;\n  min-height: 70px;\n}\n.quick-action-btn[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n  background: #f8fafc;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);\n}\n.quick-action-btn.cultivation[data-v-b63a96a6] {\n  border-color: rgba(34, 197, 94, 0.2);\n  background: rgba(34, 197, 94, 0.03);\n}\n.quick-action-btn.cultivation[data-v-b63a96a6]:hover {\n  border-color: #22c55e;\n  background: rgba(34, 197, 94, 0.08);\n}\n.quick-action-btn.exploration[data-v-b63a96a6] {\n  border-color: rgba(59, 130, 246, 0.2);\n  background: rgba(59, 130, 246, 0.03);\n}\n.quick-action-btn.exploration[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n  background: rgba(59, 130, 246, 0.08);\n}\n.quick-action-btn.social[data-v-b63a96a6] {\n  border-color: rgba(168, 85, 247, 0.2);\n  background: rgba(168, 85, 247, 0.03);\n}\n.quick-action-btn.social[data-v-b63a96a6]:hover {\n  border-color: #a855f7;\n  background: rgba(168, 85, 247, 0.08);\n}\n.quick-action-btn.other[data-v-b63a96a6] {\n  border-color: rgba(156, 163, 175, 0.2);\n  background: rgba(156, 163, 175, 0.03);\n}\n.quick-action-btn.other[data-v-b63a96a6]:hover {\n  border-color: #9ca3af;\n  background: rgba(156, 163, 175, 0.08);\n}\n.action-icon[data-v-b63a96a6] {\n  font-size: 1.2rem;\n  line-height: 1;\n}\n.action-text[data-v-b63a96a6] {\n  font-weight: 500;\n  color: #374151;\n  text-align: center;\n  line-height: 1.2;\n}\n\n/* 配置弹窗内容 */\n.config-content[data-v-b63a96a6] {\n  padding: 20px;\n}\n.action-description[data-v-b63a96a6] {\n  margin: 0 0 20px 0;\n  color: #6b7280;\n  line-height: 1.5;\n}\n.config-section[data-v-b63a96a6] {\n  margin-bottom: 20px;\n}\n.config-section[data-v-b63a96a6]:last-child {\n  margin-bottom: 0;\n}\n.config-label[data-v-b63a96a6] {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #374151;\n  font-size: 0.875rem;\n}\n.time-selector[data-v-b63a96a6] {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 12px;\n}\n.time-btn[data-v-b63a96a6] {\n  padding: 8px 16px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  background: var(--color-background);\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n}\n.time-btn[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n}\n.time-btn.active[data-v-b63a96a6] {\n  border-color: #3b82f6;\n  background: #3b82f6;\n  color: white;\n}\n.time-custom[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.875rem;\n}\n.time-input[data-v-b63a96a6] {\n  width: 80px;\n  padding: 6px 10px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  font-size: 0.875rem;\n}\n.action-options[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.option-item[data-v-b63a96a6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.option-item[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n  background: #f8fafc;\n}\n.option-item input[type="radio"][data-v-b63a96a6] {\n  margin: 0;\n}\n.config-actions[data-v-b63a96a6] {\n  padding: 20px;\n  border-top: 1px solid #e5e7eb;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n}\n.cancel-btn[data-v-b63a96a6],\n.confirm-btn[data-v-b63a96a6] {\n  padding: 8px 20px;\n  border-radius: 6px;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.cancel-btn[data-v-b63a96a6] {\n  border: 1px solid #d1d5db;\n  background: var(--color-background);\n  color: #6b7280;\n}\n.cancel-btn[data-v-b63a96a6]:hover {\n  background: #f9fafb;\n  border-color: #9ca3af;\n}\n.confirm-btn[data-v-b63a96a6] {\n  border: 1px solid #3b82f6;\n  background: #3b82f6;\n  color: white;\n}\n.confirm-btn[data-v-b63a96a6]:hover {\n  background: #2563eb;\n  border-color: #2563eb;\n}\n\n/* 深色主题适配 */\n[data-theme="dark"] .action-selector-btn[data-v-b63a96a6] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #d1d5db;\n}\n[data-theme="dark"] .action-selector-btn[data-v-b63a96a6]:hover:not(:disabled) {\n  background: #4b5563;\n  border-color: #6b7280;\n}\n[data-theme="dark"] .action-modal[data-v-b63a96a6],\n[data-theme="dark"] .action-config-modal[data-v-b63a96a6] {\n  background: #1f2937;\n}\n[data-theme="dark"] .modal-header[data-v-b63a96a6],\n[data-theme="dark"] .config-header[data-v-b63a96a6],\n[data-theme="dark"] .config-actions[data-v-b63a96a6] {\n  border-color: #374151;\n}\n[data-theme="dark"] .modal-header h3[data-v-b63a96a6],\n[data-theme="dark"] .config-header h3[data-v-b63a96a6],\n[data-theme="dark"] .category-title[data-v-b63a96a6],\n[data-theme="dark"] .config-label[data-v-b63a96a6],\n[data-theme="dark"] .action-name[data-v-b63a96a6] {\n  color: #f9fafb;\n}\n[data-theme="dark"] .close-btn[data-v-b63a96a6] {\n  background: #374151;\n  color: #d1d5db;\n}\n[data-theme="dark"] .close-btn[data-v-b63a96a6]:hover {\n  background: #4b5563;\n  color: #f9fafb;\n}\n[data-theme="dark"] .action-btn[data-v-b63a96a6] {\n  background: #374151;\n  border-color: #4b5563;\n}\n[data-theme="dark"] .action-btn[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n  background: #1f2937;\n}\n[data-theme="dark"] .time-btn[data-v-b63a96a6],\n[data-theme="dark"] .option-item[data-v-b63a96a6] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #d1d5db;\n}\n[data-theme="dark"] .time-input[data-v-b63a96a6] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #f9fafb;\n}\n[data-theme="dark"] .cancel-btn[data-v-b63a96a6] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #d1d5db;\n}\n[data-theme="dark"] .cancel-btn[data-v-b63a96a6]:hover {\n  background: #4b5563;\n}\n\n/* 深色主题动作队列样式 */\n[data-theme="dark"] .action-queue-display[data-v-b63a96a6] {\n  background: linear-gradient(135deg, #374151 0%, #1f2937 100%);\n  border-color: #4b5563;\n}\n[data-theme="dark"] .queue-title[data-v-b63a96a6] {\n  color: #818cf8;\n}\n[data-theme="dark"] .clear-queue-btn[data-v-b63a96a6] {\n  color: #9ca3af;\n}\n[data-theme="dark"] .clear-queue-btn[data-v-b63a96a6]:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #f87171;\n}\n[data-theme="dark"] .queue-action-item[data-v-b63a96a6] {\n  background: rgba(129, 140, 248, 0.1);\n  border-color: rgba(129, 140, 248, 0.2);\n}\n[data-theme="dark"] .action-text[data-v-b63a96a6] {\n  color: #e5e7eb;\n}\n[data-theme="dark"] .remove-action-btn[data-v-b63a96a6] {\n  color: #9ca3af;\n}\n[data-theme="dark"] .remove-action-btn[data-v-b63a96a6]:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #f87171;\n}\n[data-theme="dark"] .action-controls[data-v-b63a96a6] {\n  color: #d1d5db;\n}\n[data-theme="dark"] .undo-indicator[data-v-b63a96a6] {\n  filter: brightness(1.2);\n}\n\n/* 变更描述样式 */\n.change-description[data-v-b63a96a6] {\n  color: var(--color-text);\n  font-size: 0.8rem;\n  margin-bottom: 6px;\n  padding: 4px 8px;\n  background: var(--color-surface-light);\n  border-radius: 4px;\n  border-left: 2px solid var(--color-primary);\n  line-height: 1.3;\n  font-style: italic;\n}\n\n/* 深色主题下的变更描述 */\n[data-theme="dark"] .change-description[data-v-b63a96a6] {\n  background: #334155;\n  color: #e2e8f0;\n  border-left-color: #60a5fa;\n}\n\n/* 空状态样式 */\n.no-changes[data-v-b63a96a6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.no-changes .empty-icon[data-v-b63a96a6] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n  color: var(--color-text-secondary);\n}\n.no-changes .empty-text[data-v-b63a96a6] {\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.no-changes .empty-hint[data-v-b63a96a6] {\n  font-size: 0.8rem;\n  opacity: 0.8;\n  line-height: 1.4;\n}\n\n/* 图片预览容器样式 */\n.image-preview-container[data-v-b63a96a6] {\n  display: flex;\n  gap: 8px;\n  padding: 8px;\n  flex-wrap: wrap;\n  border-bottom: 1px solid #e5e7eb;\n  background: #f9fafb;\n}\n.image-preview-item[data-v-b63a96a6] {\n  position: relative;\n  width: 60px;\n  height: 60px;\n  border-radius: 6px;\n  overflow: hidden;\n  border: 2px solid #e5e7eb;\n  transition: all 0.2s ease;\n}\n.image-preview-item[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n  transform: scale(1.05);\n}\n.image-preview-item img[data-v-b63a96a6] {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.remove-image-btn[data-v-b63a96a6] {\n  position: absolute;\n  top: 2px;\n  right: 2px;\n  width: 20px;\n  height: 20px;\n  padding: 0;\n  background: rgba(239, 68, 68, 0.9);\n  border: none;\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transition: all 0.2s ease;\n}\n.image-preview-item:hover .remove-image-btn[data-v-b63a96a6] {\n  opacity: 1;\n}\n.remove-image-btn[data-v-b63a96a6]:hover {\n  background: rgba(220, 38, 38, 1);\n  transform: scale(1.1);\n}\n\n/* 图片上传按钮特殊样式 */\n.image-upload-btn svg[data-v-b63a96a6] {\n  color: #10b981;\n}\n.image-upload-btn:hover:not(:disabled) svg[data-v-b63a96a6] {\n  color: #059669;\n}\n\n/* 深色主题图片预览样式 */\n[data-theme="dark"] .image-preview-container[data-v-b63a96a6] {\n  background: #0f172a;\n  border-bottom-color: #475569;\n}\n[data-theme="dark"] .image-preview-item[data-v-b63a96a6] {\n  border-color: #475569;\n}\n[data-theme="dark"] .image-preview-item[data-v-b63a96a6]:hover {\n  border-color: #3b82f6;\n}\n\n/* 最新消息text样式 */\n.latest-message-text[data-v-b63a96a6] {\n  margin-top: 20px;\n  padding: 16px;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-left: 4px solid #818cf8;\n  border-radius: 8px;\n  font-size: 0.9rem;\n  color: #475569;\n  line-height: 1.7;\n}\n.latest-text-header[data-v-b63a96a6] {\n  font-weight: 600;\n  color: #6366f1;\n  margin-bottom: 8px;\n  font-size: 0.85rem;\n}\n[data-theme="dark"] .latest-message-text[data-v-b63a96a6] {\n  background: #334155;\n  border-color: #4b5563;\n  border-left-color: #818cf8;\n  color: #cbd5e1;\n}\n[data-theme="dark"] .latest-text-header[data-v-b63a96a6] {\n  color: #a5b4fc;\n}\n',""]);const i=l},1265:(e,n,t)=>{t.d(n,{EF:()=>o,Iz:()=>i,bk:()=>l,hp:()=>r,kp:()=>a});const a='\n========== 【最高优先级】数据同步铁律 ==========\n\n【核心原则】叙事文本(text)中的任何变化，都必须有对应的tavern_commands执行，违反此规则将导致数据不一致\n\n【必须同步的事件检查清单】\n- 修炼 → 推进时间 + 增加功法进度 + 消耗灵气 + 更新功法相关数据\n- 突破 → 更新境界(名称+阶段+进度+所需) + 增加寿命上限(用add) + 增加属性上限\n- 受伤 → 扣除气血(用add负数)\n- 获得物品 → set 背包.物品.{物品ID} (注意：修改具体物品，不是整个背包对象)\n- 消耗物品 → add 背包.物品.{物品ID}.数量 (负数) 或 delete 背包.物品.{物品ID}\n- NPC互动 → push记忆 + 调整好感度(add) + 更新当前状态 + 更新内心想法\n- 位置移动 → 同时更新描述 + longitude + latitude 三个字段\n\n【正确操作原则】\n[正确做法]\n- 修改具体字段路径，例如："背包.物品.sword_001.数量"\n- 使用 add/set 修改单个属性值\n- 数值增减用add，对象替换用set\n\n[错误做法 - 禁止]\n- 使用set替换整个对象（如整个"背包"、整个"装备栏"）\n- text中有剧情变化但commands为空数组\n- 只更新部分应该同步更新的字段\n\n【正确示例】\n- 获得1把剑 → {"action":"set","key":"背包.物品.sword_001","value":{完整物品对象}}\n- 消耗1颗丹药 → {"action":"add","key":"背包.物品.pill_001.数量","value":-1}\n- 增加好感度 → {"action":"add","key":"人物关系.张三.好感度","value":5}\n\n【错误示例 - 会导致数据丢失】\n- 错误：{"action":"set","key":"背包","value":{整个背包对象}}\n- 错误：{"action":"set","key":"装备栏","value":{整个装备栏对象}}\n',o='\n【境界阶段命名规则】\n[正确的阶段名称] 初期、中期、后期、圆满、极境\n[错误的阶段名称] 一层、二层、一重、第X层、第X阶段\n[特殊情况] 凡人境界无阶段，阶段字段为空字符串("")，炼气境及以上必须使用标准阶段名',r="\n【JSON格式严格要求】\n- 不得包含注释（不能使用 // 或 /* */ ）\n- 不得有尾随逗号（数组或对象最后一项后面不能有逗号）\n- 必须使用双引号，所有字段名必须加引号\n- 数字不能有前导0（例如：不能写 01，应该写 1）\n- 空值必须使用 null，不能使用 undefined\n- 布尔值必须小写：true / false（不能写 True / FALSE）",l='\n【六司系统规则】人物属性分为先天和后天两部分\n\n[先天六司] 天生属性，由出生时确定，终生不可改变\n- 包含：根骨、灵性、悟性、气运、魅力、心性\n- 数值范围：1-10\n- 【禁止操作】任何情况下都不得修改先天六司\n\n[后天六司] 可变属性，通过装备、大道感悟等获得\n- 包含：根骨、灵性、悟性、气运、魅力、心性\n- 来源：装备加成、大道感悟、特殊机缘\n- 【修改方式】使用add操作：{"action":"add","key":"角色基础信息.后天六司.根骨","value":1}\n\n[属性计算公式]\n最终属性值 = 先天六司 × 100% + 后天六司 × 20%',i='\n========== 【最高优先级】角色私密信息生成规则 ==========\n\n【强制执行条件】\n当 系统.nsfwMode === true 时，必须为符合性别过滤条件的所有NPC生成完整的私密信息对象\n\n【严格要求】\n不得以任何理由跳过、简化或省略私密信息的生成\n这是强制性要求，违反将导致生成失败\n\n【第一步：生成时机】\n- 创建NPC时：必须立即生成完整的私密信息对象，不得遗漏任何字段\n- 后续更新：可以更新动态字段（如性渴望程度、当前性状态等）\n\n【第二步：必填字段】私密信息对象必须包含以下14个字段，缺一不可\n\n[核心字段列表]\n1. 是否为处女: boolean（女性NPC必填）\n2. 是否为处男: boolean（男性NPC必填）\n3. 身体部位: Array（必须包含3-5个部位对象）\n   每个部位对象包含：部位名称、开发度(0-100)、敏感度(0-100)、特征描述、特殊印记\n4. 性格倾向: string（可选值："纯情" | "主动" | "被动" | "淫荡" | "M" | "S" | "双性"）\n5. 性取向: string（可选值："异性恋" | "同性恋" | "双性恋" | "泛性恋"）\n6. 性癖好: Array（0-3个元素）\n7. 性渴望程度: number（范围：0-100）\n8. 当前性状态: string（可选值："正常" | "微湿" | "兴奋" | "发情" | "高潮"等）\n9. 体液分泌状态: string（描述性文字）\n10. 性交总次数: number（非负整数）\n11. 性伴侣数量: number（非负整数）\n12. 性伴侣名单: Array<string>（禁止使用"保密"、"未知"等占位符）\n13. 最近一次性行为时间: string（时间格式或"从未"）\n14. 特殊体质: Array（0-N个元素）\n\n【第三步：逻辑约束】必须保持数据一致性\n- 所有数值字段范围：0-100\n- 逻辑一致性：是否为处女/处男=true → 性交总次数=0 且 性伴侣数量=0 且 性伴侣名单=[]\n- 数量匹配：性伴侣数量 必须等于 性伴侣名单.length\n\n【第四步：叙事整合】私密信息必须影响NPC行为\n- NPC的行为和对话必须与性格倾向、性渴望程度保持一致\n- 好感度低于60时，NPC会拒绝亲密行为\n- 违反人格底线的行为会导致好感度暴跌\n- 亲密行为的门槛：好感度≥60 或 性渴望≥70（纯情性格需要好感度≥80）\n\n【重要提醒】\n当nsfwMode=true时，创建任何NPC都必须包含完整的私密信息对象（14个必填字段）\n这是强制性要求，不可省略、简化或延后生成\n'},1325:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.mode-selection-container[data-v-6b737fda] {\n  width: 100%;\n  height: auto;\n  min-height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  box-sizing: border-box;\n  background: transparent;\n  overflow: hidden; /* 移除滚动 */\n}\n.selection-content[data-v-6b737fda] {\n  /* 添加透明磨砂效果 */\n  background: var(--color-surface-transparent);\n  backdrop-filter: blur(12px);\n  -webkit-backdrop-filter: blur(12px);\n  border-radius: 20px;\n  padding: 2rem;\n  border: 1px solid var(--color-border);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n  /* 调整到合适高度，确保内容完全可见 */\n  height: auto;\n  max-height: 90vh;\n  max-width: 1000px;\n  width: 90%;\n  overflow-y: auto;  /* 允许内部滚动 */\n  overflow-x: hidden;\n  /* 隐藏滚动条但保持滚动功能 */\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE and Edge */\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n/* 隐藏Webkit浏览器的滚动条 */\n.selection-content[data-v-6b737fda]::-webkit-scrollbar {\n  display: none;\n}\n.header-container[data-v-6b737fda] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  margin-bottom: 1.5rem; /* 减少底部间距 */\n}\n.title-version-row[data-v-6b737fda] {\n  position: relative;\n  display: flex;\n  justify-content: center; /* Center the title */\n  align-items: center;\n  width: 100%;\n  margin-bottom: 0.5rem; /* Space between title row and subtitle */\n}\n.version-tag[data-v-6b737fda] {\n  position: absolute;\n  right: 0;\n  top: 0; /* Align to the top of the container */\n  font-size: 0.8rem; /* Adjusted size */\n  font-family: 'Consolas', 'monospace';\n  color: var(--color-warning);\n  padding: 0.2rem 0.6rem;\n  background: rgba(var(--color-warning-rgb, 255, 193, 7), 0.1);\n  border: 1px solid rgba(var(--color-warning-rgb, 255, 193, 7), 0.4);\n  border-radius: 4px;\n  opacity: 0.85;\n  font-weight: bold;\n  backdrop-filter: blur(8px);\n  -webkit-backdrop-filter: blur(8px);\n}\n.main-title[data-v-6b737fda] {\n  font-family: var(--font-family-serif);\n  font-size: 3.5rem;\n  font-weight: 500;\n  letter-spacing: 0.5em;\n  color: var(--color-text);\n  text-shadow: 0 0 25px rgba(var(--color-primary-rgb), 0.5);\n  margin: 0;\n  text-align: center;\n  /* Add padding to compensate for letter-spacing and ensure true centering */\n  padding-left: 0.5em;\n}\n.sub-title[data-v-6b737fda] {\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n  letter-spacing: 0.1em;\n  opacity: 0.9;\n  margin: 0;\n}\n.gate-container[data-v-6b737fda] {\n  display: flex;\n  gap: 2rem;\n  width: 100%;\n  max-width: 900px;\n  justify-content: center;\n}\n.gate-card[data-v-6b737fda] {\n  flex: 1;\n  max-width: 300px;\n  padding: 1.5rem 1.5rem;\n  background: var(--color-surface-transparent);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  cursor: pointer;\n  text-align: center;\n  transition: all 0.4s ease;\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n}\n.gate-card[data-v-6b737fda]:hover {\n  transform: translateY(-10px);\n  border-color: var(--color-primary);\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2), 0 0 20px rgba(var(--color-primary-rgb), 0.3);\n  background: var(--color-surface);\n}\n.gate-card.disabled[data-v-6b737fda] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  pointer-events: none;\n}\n.gate-icon[data-v-6b737fda] {\n  display: flex;\n  justify-content: center;\n  color: var(--color-primary);\n  margin-bottom: 1.5rem;\n  transition: all 0.4s ease;\n}\n.gate-card:hover .gate-icon[data-v-6b737fda] {\n  transform: scale(1.1);\n  color: var(--color-accent);\n  filter: drop-shadow(0 0 10px rgba(var(--color-accent-rgb), 0.7));\n}\n.gate-title[data-v-6b737fda] {\n  font-family: var(--font-family-serif);\n  font-size: 1.6rem;\n  margin: 0 0 0.5rem 0;\n  color: var(--color-text);\n}\n.gate-description[data-v-6b737fda] {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 0.5rem;\n}\n.gate-detail[data-v-6b737fda] {\n  font-size: 0.85rem;\n  color: var(--color-text-muted);\n  line-height: 1.4;\n  opacity: 0.8;\n}\n.privacy-notice[data-v-6b737fda] {\n  margin-top: 1rem; /* 减少顶部间距 */\n  padding: 0.8rem; /* 减少内边距 */\n  background: rgba(var(--color-warning-rgb), 0.1);\n  border: 1px solid rgba(var(--color-warning-rgb), 0.3);\n  border-radius: 8px;\n  max-width: 600px;\n  text-align: center;\n}\n.privacy-notice p[data-v-6b737fda] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  margin: 0.5rem 0;\n  line-height: 1.5;\n}\n.privacy-notice strong[data-v-6b737fda] {\n  color: var(--color-warning);\n}\n.scroll-btn[data-v-6b737fda] {\n  margin-top: 1rem; /* 减少顶部间距 */\n  background: transparent;\n  border: 1px solid var(--color-border);\n  color: var(--color-text-secondary);\n  font-family: var(--font-family-serif);\n  font-size: 1rem;\n  letter-spacing: 0.3em;\n  padding: 0.6rem 2rem;\n  border-radius: 50px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  /* Prevent squishing and keep text on one line */\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  align-self: center;\n  white-space: nowrap;\n  flex: 0 0 auto;\n  max-width: 100%;\n}\n.scroll-btn[data-v-6b737fda]:hover {\n  background: var(--color-surface);\n  color: var(--color-text);\n  border-color: var(--color-primary);\n  box-shadow: 0 0 15px rgba(var(--color-primary-rgb), 0.3);\n}\n.footer-actions[data-v-6b737fda] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n  margin-top: 1rem; /* 减少顶部间距 */\n}\n@media (max-width: 640px) {\n.footer-actions[data-v-6b737fda] {\n    margin-top: 1.5rem;\n}\n.mode-selection-container[data-v-6b737fda] {\n    padding: 1rem;\n    height: auto;\n    min-height: 100%;\n    align-items: center; /* 居中显示 */\n    justify-content: center;\n}\n.selection-content[data-v-6b737fda] {\n    padding: 1.5rem;\n    height: auto;\n    max-height: 95vh;\n    overflow-y: auto; /* 移动端允许滚动 */\n    overflow-x: hidden;\n    /* 隐藏滚动条但保持滚动功能 */\n    scrollbar-width: none; /* Firefox */\n    -ms-overflow-style: none; /* IE and Edge */\n    gap: 1.5rem;\n}\n\n  /* 移动端也隐藏滚动条 */\n.selection-content[data-v-6b737fda]::-webkit-scrollbar {\n    display: none;\n}\n.main-title[data-v-6b737fda] {\n    font-size: 2.5rem;\n}\n.header-container[data-v-6b737fda] {\n    margin-bottom: 2rem;\n    flex-shrink: 0;\n}\n\n  /* 移动端版本号移到底部 */\n.title-version-row[data-v-6b737fda] {\n    flex-direction: column;\n    gap: 0.5rem;\n}\n.version-tag[data-v-6b737fda] {\n    position: static; /* 取消绝对定位 */\n    align-self: center; /* 居中显示 */\n    margin-top: 0.5rem;\n}\n.gate-container[data-v-6b737fda] {\n    flex-direction: column;\n    align-items: center;\n    gap: 1.5rem;\n    flex-shrink: 0;\n}\n.gate-card[data-v-6b737fda] {\n    width: 100%;\n    max-width: 350px;\n    padding: 2rem 1.5rem;\n}\n.gate-detail[data-v-6b737fda] {\n    font-size: 0.8rem;\n}\n.privacy-notice[data-v-6b737fda] {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    max-width: 100%;\n    flex-shrink: 0;\n}\n.privacy-notice p[data-v-6b737fda] {\n    font-size: 0.85rem;\n}\n.scroll-btn[data-v-6b737fda] {\n    margin-top: 1.5rem;\n    margin-bottom: 1rem;\n    flex-shrink: 0;\n    padding: 0.8rem 2rem;\n    font-size: 0.95rem;\n}\n}\n\n/* 超小屏幕优化（手机竖屏） */\n@media (max-width: 480px) {\n.mode-selection-container[data-v-6b737fda] {\n    padding: 0.5rem;\n}\n.selection-content[data-v-6b737fda] {\n    padding: 1rem;\n    border-radius: 15px;\n    gap: 1rem;\n}\n.main-title[data-v-6b737fda] {\n    font-size: 2rem;\n    letter-spacing: 0.3em;\n    padding-left: 0.3em;\n}\n.header-container[data-v-6b737fda] {\n    margin-bottom: 1.5rem;\n}\n.version-tag[data-v-6b737fda] {\n    font-size: 0.7rem;\n    padding: 0.15rem 0.5rem;\n}\n.gate-container[data-v-6b737fda] {\n    gap: 1rem;\n}\n.gate-card[data-v-6b737fda] {\n    padding: 1.5rem 1rem;\n}\n.gate-title[data-v-6b737fda] {\n    font-size: 1.4rem;\n}\n.privacy-notice[data-v-6b737fda] {\n    margin-top: 1rem;\n    padding: 0.8rem;\n}\n.scroll-btn[data-v-6b737fda] {\n    margin-top: 1rem;\n    margin-bottom: 0.5rem;\n    padding: 0.7rem 1.5rem;\n    font-size: 0.9rem;\n}\n}\n",""]);const i=l},1417:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.skills-content[data-v-075e9794] {\n  width: 100%;\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(280px, 420px);\n  gap: 0;\n  background: var(--color-background);\n  overflow: hidden;\n}\n\n/* 左侧：当前修炼+功法库 */\n.skills-main[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 24px;\n  gap: 24px;\n}\n.skills-and-library-grid[data-v-075e9794] {\n  display: grid;\n  grid-template-columns: minmax(0, 1fr) minmax(300px, 360px);\n  gap: 24px;\n  align-items: flex-start;\n}\n@media (max-width: 1200px) {\n.skills-and-library-grid[data-v-075e9794] {\n    grid-template-columns: 1fr;\n}\n}\n.skills-column[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n  min-width: 0;\n}\n.current-technique-section[data-v-075e9794],\n.technique-library-section[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n}\n\n/* 区块标题 */\n.section-header[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 16px;\n  padding-bottom: 12px;\n  border-bottom: 2px solid var(--color-border);\n}\n.header-icon[data-v-075e9794] {\n  font-size: 1.2rem;\n}\n.header-text[data-v-075e9794] {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.count-badge[data-v-075e9794] {\n  margin-left: auto;\n  padding: 2px 10px;\n  background: var(--color-primary);\n  color: white;\n  border-radius: 12px;\n  font-size: 0.85rem;\n  font-weight: 600;\n}\n\n/* 当前修炼槽位 */\n.current-technique-slot[data-v-075e9794] {\n  background: linear-gradient(135deg, var(--color-surface) 0%, var(--color-background) 100%);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 20px;\n  transition: all 0.3s ease;\n  min-height: 120px;\n  display: flex;\n  align-items: center;\n  position: relative;\n  overflow: hidden;\n}\n.current-technique-slot[data-v-075e9794]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 4px;\n  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n.current-technique-slot.has-technique[data-v-075e9794] {\n  cursor: pointer;\n  border-color: var(--color-success);\n  background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.05) 0%, var(--color-surface) 100%);\n}\n.current-technique-slot.has-technique[data-v-075e9794]::before {\n  opacity: 0.6;\n  background: linear-gradient(90deg, transparent, var(--color-success), transparent);\n}\n.current-technique-slot.has-technique[data-v-075e9794]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(var(--color-success-rgb), 0.3);\n}\n.current-technique-slot.has-technique[data-v-075e9794]:hover::before {\n  opacity: 1;\n  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);\n}\n.technique-content[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  width: 100%;\n}\n.technique-icon-wrapper[data-v-075e9794] {\n  width: 64px;\n  height: 64px;\n  border-radius: 12px;\n  border: 3px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-surface-light);\n  flex-shrink: 0;\n}\n.technique-icon-text[data-v-075e9794] {\n  font-size: 28px;\n  font-weight: bold;\n  color: var(--color-text);\n}\n.technique-info[data-v-075e9794] {\n  flex: 1;\n}\n.technique-name[data-v-075e9794] {\n  font-size: 1.2rem;\n  font-weight: 700;\n  margin-bottom: 4px;\n}\n.technique-quality[data-v-075e9794] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 8px;\n}\n.technique-progress[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.progress-bar-wrapper[data-v-075e9794] {\n  flex: 1;\n}\n.progress-text[data-v-075e9794] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 45px;\n  text-align: right;\n}\n\n/* 空槽位占位符 */\n.empty-slot-placeholder[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  width: 100%;\n  gap: 8px;\n  padding: 20px;\n}\n.empty-icon[data-v-075e9794] {\n  font-size: 3rem;\n  opacity: 0.5;\n}\n.empty-text[data-v-075e9794] {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.empty-hint[data-v-075e9794] {\n  font-size: 0.85rem;\n  color: var(--color-text-muted);\n}\n\n/* 已学技能区域 */\n.learned-skills-section[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n}\n.learned-skills-grid[data-v-075e9794] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 12px;\n  max-height: 300px;\n  overflow-y: auto;\n  padding-right: 8px;\n}\n.learned-skill-card[data-v-075e9794] {\n  background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.08) 0%, var(--color-surface) 100%);\n  border: 2px solid var(--color-success);\n  border-radius: 10px;\n  padding: 12px;\n  display: flex;\n  gap: 10px;\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n.learned-skill-card[data-v-075e9794]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 3px;\n  background: linear-gradient(90deg, transparent, var(--color-success), transparent);\n  opacity: 0.6;\n}\n.learned-skill-card[data-v-075e9794]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(var(--color-success-rgb), 0.25);\n}\n.skill-card-icon[data-v-075e9794] {\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: linear-gradient(135deg, var(--color-success), var(--color-info));\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 20px;\n  flex-shrink: 0;\n}\n.skill-card-body[data-v-075e9794] {\n  flex: 1;\n  min-width: 0;\n}\n.skill-card-name[data-v-075e9794] {\n  font-size: 0.95rem;\n  font-weight: 700;\n  color: var(--color-text);\n  margin-bottom: 4px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.skill-card-source[data-v-075e9794] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n}\n.skill-card-desc[data-v-075e9794] {\n  font-size: 0.7rem;\n  color: var(--color-text-muted);\n  line-height: 1.3;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  margin-bottom: 4px;\n}\n.skill-card-cost[data-v-075e9794] {\n  font-size: 0.7rem;\n  color: var(--color-info);\n  font-weight: 500;\n}\n\n/* 未掌握技能区域 */\n.unmastered-skills-section[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n}\n.unmastered-skills-grid[data-v-075e9794] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 12px;\n  max-height: 300px;\n  overflow-y: auto;\n  padding-right: 8px;\n}\n.unmastered-skill-card[data-v-075e9794] {\n  background: linear-gradient(135deg, rgba(var(--color-warning-rgb), 0.05) 0%, var(--color-surface) 100%);\n  border: 2px dashed var(--color-warning);\n  border-radius: 10px;\n  padding: 12px;\n  display: flex;\n  gap: 10px;\n  opacity: 0.8;\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n.unmastered-skill-card[data-v-075e9794]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 2px;\n  background: linear-gradient(90deg, transparent, var(--color-warning), transparent);\n  opacity: 0.5;\n}\n.unmastered-skill-card[data-v-075e9794]:hover {\n  opacity: 1;\n  border-color: var(--color-info);\n  border-style: solid;\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-warning-rgb), 0.2);\n}\n.unmastered-skill-card .skill-card-icon[data-v-075e9794] {\n  background: var(--color-surface-light);\n  color: var(--color-text-secondary);\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 20px;\n  flex-shrink: 0;\n}\n.unmastered-skill-card .skill-card-body[data-v-075e9794] {\n  flex: 1;\n  min-width: 0;\n}\n.unmastered-skill-card .skill-card-name[data-v-075e9794] {\n  font-size: 0.95rem;\n  font-weight: 700;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.unmastered-skill-card .skill-card-source[data-v-075e9794] {\n  font-size: 0.75rem;\n  color: var(--color-warning);\n  margin-bottom: 4px;\n  font-weight: 500;\n}\n.unmastered-skill-card .skill-card-progress[data-v-075e9794] {\n  margin: 6px 0;\n}\n.unmastered-skill-card .skill-progress-bar[data-v-075e9794] {\n  width: 100%;\n  height: 6px;\n  background: var(--color-surface-light);\n  border-radius: 3px;\n  overflow: hidden;\n  border: 1px solid var(--color-border);\n}\n.unmastered-skill-card .skill-progress-fill[data-v-075e9794] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-info), var(--color-primary));\n  transition: width 0.3s ease;\n  border-radius: 2px;\n}\n.unmastered-skill-card .skill-card-desc[data-v-075e9794] {\n  font-size: 0.7rem;\n  color: var(--color-text-muted);\n  line-height: 1.3;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n/* 功法库区域 */\n.technique-library-section[data-v-075e9794] {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.mobile-library-backdrop[data-v-075e9794] {\n  display: none;\n}\n.empty-library[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 20px;\n  text-align: center;\n  gap: 12px;\n}\n.empty-library .empty-icon[data-v-075e9794] {\n  font-size: 4rem;\n  opacity: 0.4;\n}\n.empty-library .empty-text[data-v-075e9794] {\n  font-size: 1.1rem;\n  color: var(--color-text-secondary);\n}\n.empty-library .empty-hint[data-v-075e9794] {\n  font-size: 0.9rem;\n  color: var(--color-text-muted);\n}\n\n/* 功法卡片网格 */\n.technique-grid[data-v-075e9794] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n  gap: 16px;\n  overflow-y: auto;\n  padding-right: 8px;\n}\n.mobile-library-close[data-v-075e9794],\n.mobile-library-toggle[data-v-075e9794] {\n  display: none;\n  border: none;\n  background: none;\n  font: inherit;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.mobile-library-close[data-v-075e9794] {\n  align-self: flex-end;\n  color: var(--color-text-secondary);\n  padding: 6px 12px;\n  border-radius: 999px;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n}\n.mobile-library-close[data-v-075e9794]:hover {\n  color: var(--color-text);\n  border-color: var(--color-text-secondary);\n}\n.mobile-library-toggle[data-v-075e9794] {\n  align-items: center;\n  gap: 8px;\n  border-radius: 999px;\n  padding: 12px 20px;\n  font-weight: 600;\n  background: var(--color-primary);\n  color: #ffffff;\n  box-shadow: 0 12px 20px rgba(var(--color-primary-rgb), 0.3);\n  position: fixed;\n  right: 24px;\n  bottom: 32px;\n  z-index: 1200;\n}\n.mobile-library-toggle .toggle-icon[data-v-075e9794] {\n  font-size: 1.2rem;\n}\n.mobile-library-toggle[data-v-075e9794]:disabled {\n  opacity: 0.7;\n  cursor: default;\n}\n.mobile-library-toggle[data-v-075e9794]:not(:disabled):hover {\n  transform: translateY(-2px);\n  box-shadow: 0 16px 24px rgba(var(--color-primary-rgb), 0.35);\n}\n.technique-card[data-v-075e9794] {\n  background: linear-gradient(135deg, var(--color-surface) 0%, var(--color-background) 100%);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  position: relative;\n  overflow: hidden;\n}\n.technique-card[data-v-075e9794]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 4px;\n  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n.technique-card[data-v-075e9794]:hover::before {\n  opacity: 1;\n}\n.technique-card[data-v-075e9794]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-4px);\n  box-shadow: 0 8px 20px rgba(var(--color-primary-rgb), 0.15);\n}\n.technique-card.selected[data-v-075e9794] {\n  border-color: var(--color-accent);\n  background: linear-gradient(135deg, var(--color-surface-hover) 0%, var(--color-surface) 100%);\n  box-shadow: 0 4px 16px rgba(var(--color-accent-rgb), 0.25);\n}\n.technique-card.selected[data-v-075e9794]::before {\n  opacity: 1;\n  background: linear-gradient(90deg, transparent, var(--color-accent), transparent);\n}\n.card-icon[data-v-075e9794] {\n  width: 56px;\n  height: 56px;\n  border-radius: 12px;\n  border: 3px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-surface-light);\n  flex-shrink: 0;\n  margin: 0 auto;\n  box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n}\n.icon-text[data-v-075e9794] {\n  font-size: 24px;\n  font-weight: bold;\n  color: var(--color-text);\n}\n.card-body[data-v-075e9794] {\n  flex: 1;\n  min-width: 0;\n  text-align: center;\n}\n.card-title[data-v-075e9794] {\n  font-size: 1.05rem;\n  font-weight: 700;\n  margin-bottom: 6px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.card-quality[data-v-075e9794] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 8px;\n  font-weight: 500;\n}\n.card-desc[data-v-075e9794] {\n  font-size: 0.75rem;\n  color: var(--color-text-muted);\n  line-height: 1.5;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-align: left;\n}\n\n\n\n/* 技能槽位 */\n.skill-slot[data-v-075e9794] {\n  background: var(--color-background);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 80px;\n  display: flex;\n  align-items: center;\n}\n.skill-slot[data-v-075e9794]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.2);\n}\n.skill-slot.has-skill[data-v-075e9794] {\n  border-color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.05);\n}\n\n/* 技能信息 */\n.skill-info[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n}\n.skill-icon[data-v-075e9794] {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  border: 2px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-surface);\n  flex-shrink: 0;\n  font-weight: bold;\n  color: var(--color-text);\n}\n.skill-type-text[data-v-075e9794] {\n  font-size: 18px;\n  font-weight: bold;\n}\n.skill-details[data-v-075e9794] {\n  flex: 1;\n  min-width: 0;\n}\n.skill-name[data-v-075e9794] {\n  font-weight: 600;\n  font-size: 1rem;\n  margin-bottom: 8px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n/* 进度条 */\n.skill-progress[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.progress-flex[data-v-075e9794] {\n  flex: 1;\n}\n.legacy-progress-bar[data-v-075e9794] {\n  flex: 1;\n  height: 8px; /* 增加高度 */\n  background: #e2e8f0; /* 更明显的背景色 */\n  border: 1px solid #cbd5e1; /* 添加边框 */\n  border-radius: 4px;\n  overflow: hidden;\n  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); /* 添加轻微阴影 */\n}\n.legacy-progress-fill[data-v-075e9794] {\n  height: 100%;\n  min-width: 1px; /* 确保最小可见宽度 */\n  background: linear-gradient(90deg, #22c55e, #3b82f6); /* 明确的颜色 */\n  border-radius: 3px;\n  transition: width 0.5s ease;\n}\n.progress-text[data-v-075e9794] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n  min-width: 35px;\n}\n\n/* 空槽位 */\n.empty-slot[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  color: var(--color-text-secondary);\n  width: 100%;\n  gap: 8px;\n}\n.empty-icon[data-v-075e9794] {\n  font-size: 2rem;\n  opacity: 0.5;\n  margin-bottom: 4px;\n}\n\n/* 详情侧边栏 */\n.skill-details-sidebar[data-v-075e9794] {\n  width: 380px; /* 增加宽度以容纳新设计 */\n  border-left: 1px solid var(--color-border);\n  background: var(--color-background); /* 改为背景色 */\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s ease;\n}\n.skill-details-sidebar.no-selection[data-v-075e9794] {\n  background: var(--color-surface);\n}\n.skill-details-content[data-v-075e9794] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 20px; /* 统一内边距 */\n  gap: 16px; /* 模块间距 */\n}\n\n/* 新增：顶部信息卡片 */\n.details-card[data-v-075e9794] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  position: relative;\n  overflow: hidden;\n}\n.card-bg-glow[data-v-075e9794] {\n  position: absolute;\n  top: -50%;\n  left: -50%;\n  width: 200%;\n  height: 200%;\n  background: radial-gradient(circle, rgba(var(--color-primary-rgb), 0.1) 0%, transparent 40%);\n  animation: rotate-glow-075e9794 10s linear infinite;\n  opacity: 0;\n  transition: opacity 0.5s ease;\n}\n.details-card:hover .card-bg-glow[data-v-075e9794] {\n  opacity: 1;\n}\n@keyframes rotate-glow-075e9794 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n.card-header[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 12px;\n}\n.details-icon-large[data-v-075e9794] {\n  width: 64px;\n  height: 64px;\n  border-radius: 10px;\n  border: 2px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-background);\n  flex-shrink: 0;\n  font-weight: bold;\n}\n.skill-type-text-large[data-v-075e9794] {\n  font-size: 24px;\n  font-weight: bold;\n}\n.details-title-area h3[data-v-075e9794] {\n  margin: 0;\n  font-size: 1.2rem; /* 增大字体 */\n  font-weight: 700; /* 加粗 */\n}\n.details-meta[data-v-075e9794] {\n  display: flex;\n  gap: 8px;\n  margin-top: 6px;\n}\n.meta-tag[data-v-075e9794] {\n  font-size: 0.75rem;\n  font-weight: 500;\n  padding: 3px 8px;\n  border-radius: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n}\n.meta-tag.quality-tag[data-v-075e9794] {\n  background: rgba(var(--quality-color-rgb), 0.1);\n  border-color: rgba(var(--quality-color-rgb), 0.3);\n  color: var(--quality-color);\n}\n.text-quality-神[data-v-075e9794] { --quality-color-rgb: 239, 68, 68; --quality-color: #ef4444;\n}\n.text-quality-仙[data-v-075e9794] { --quality-color-rgb: 245, 158, 11; --quality-color: #f59e0b;\n}\n.text-quality-天[data-v-075e9794] { --quality-color-rgb: 139, 92, 246; --quality-color: #8b5cf6;\n}\n.text-quality-地[data-v-075e9794] { --quality-color-rgb: 59, 130, 246; --quality-color: #3b82f6;\n}\n.text-quality-人[data-v-075e9794] { --quality-color-rgb: 16, 185, 129; --quality-color: #10b981;\n}\n.text-quality-凡[data-v-075e9794] { --quality-color-rgb: 107, 114, 128; --quality-color: #6b7280;\n}\n.details-description[data-v-075e9794] {\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n  font-size: 0.85rem;\n  margin: 0;\n}\n\n/* 新增：标签页系统 */\n.details-tabs[data-v-075e9794] {\n  display: flex;\n  background: var(--color-surface);\n  border-radius: 8px;\n  padding: 4px;\n  border: 1px solid var(--color-border);\n}\n.tab-btn[data-v-075e9794] {\n  flex: 1;\n  padding: 8px 12px;\n  border: none;\n  background: transparent;\n  border-radius: 6px;\n  cursor: pointer;\n  font-weight: 500;\n  color: var(--color-text-secondary);\n  transition: all 0.2s ease;\n}\n.tab-btn.active[data-v-075e9794] {\n  background: var(--color-primary);\n  color: white;\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.3);\n}\n.tab-btn[data-v-075e9794]:not(.active):hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.details-body[data-v-075e9794] {\n  flex: 1;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  overflow-y: auto;\n}\n.tab-content[data-v-075e9794] {\n  animation: fadeIn-075e9794 0.3s ease;\n}\n@keyframes fadeIn-075e9794 {\nfrom { opacity: 0; transform: translateY(10px);\n}\nto { opacity: 1; transform: translateY(0);\n}\n}\n.empty-tab[data-v-075e9794] {\n  text-align: center;\n  color: var(--color-text-secondary);\n  padding: 24px;\n  font-style: italic;\n}\n\n/* 修炼概览 */\n.overview-section h4[data-v-075e9794],\n.technique-level-section h4[data-v-075e9794],\n.cultivation-progress-section h4[data-v-075e9794],\n.skill-effects-section h4[data-v-075e9794],\n.technique-skills-section h4[data-v-075e9794],\n.unlocked-skills-section h4[data-v-075e9794],\n.cultivation-time-input h4[data-v-075e9794] {\n  margin: 0 0 12px 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n}\n.overview-grid[data-v-075e9794] {\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  gap: 12px 16px;\n  margin-bottom: 16px;\n}\n.overview-item[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.overview-item .label[data-v-075e9794] {\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n  min-width: 72px;\n}\n.overview-item .value[data-v-075e9794] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n.overview-item .with-bar[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.overview-item .with-bar .num[data-v-075e9794] {\n  min-width: 40px;\n  color: var(--color-success);\n  font-weight: 600;\n}\n\n/* 修炼进度部分 */\n.cultivation-progress-section[data-v-075e9794] {\n  margin-bottom: 20px;\n}\n.progress-container[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.progress-container .progress[data-v-075e9794] {\n  background: var(--color-background) !important;\n  border: 2px solid var(--color-primary) !important;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.2) !important;\n  min-width: 200px;\n}\n.legacy-progress-bar-large[data-v-075e9794] {\n  flex: 1;\n  height: 16px; /* 增加高度让大进度条更明显 */\n  background: #e2e8f0; /* 更明显的背景色 */\n  border: 1px solid #cbd5e1; /* 添加边框 */\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); /* 添加更明显的内阴影 */\n}\n.progress-percentage[data-v-075e9794] {\n  font-weight: 600;\n  color: var(--color-success);\n  min-width: 40px;\n}\n\n/* 功法效果部分 */\n.effect-text[data-v-075e9794] {\n  background: var(--color-background);\n  border-radius: 6px;\n  padding: 12px;\n  font-size: 0.9rem;\n  color: var(--color-text);\n  line-height: 1.4;\n  word-break: break-all;\n}\n\n/* 占位符 */\n.details-placeholder[data-v-075e9794] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: var(--color-text-secondary);\n  text-align: center;\n  padding: 40px 20px;\n}\n.placeholder-icon[data-v-075e9794] {\n  font-size: 3rem;\n  margin-bottom: 16px;\n  opacity: 0.5;\n}\n.placeholder-tip[data-v-075e9794] {\n  font-size: 0.8rem;\n  color: var(--color-text-muted);\n  margin-top: 8px;\n  opacity: 0.8;\n}\n.details-actions[data-v-075e9794] {\n  padding: 16px 20px;\n  border-top: 1px solid var(--color-border);\n  display: flex;\n  gap: 8px;\n}\n.action-btn[data-v-075e9794] {\n  flex: 1;\n  padding: 10px 16px;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n}\n.action-btn[data-v-075e9794]:hover {\n  transform: translateY(-1px);\n}\n\n/* 品级样式 */\n.grade-display[data-v-075e9794] {\n  font-size: 0.8rem;\n  font-weight: bold;\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid currentColor;\n  white-space: nowrap;\n}\n.grade-broken[data-v-075e9794] { background: #6b7280; color: white; border-color: #6b7280;\n}\n.grade-low[data-v-075e9794] { background: #10b981; color: white; border-color: #10b981;\n}\n.grade-mid[data-v-075e9794] { background: #3b82f6; color: white; border-color: #3b82f6;\n}\n.grade-high[data-v-075e9794] { background: #8b5cf6; color: white; border-color: #8b5cf6;\n}\n.grade-perfect[data-v-075e9794] { background: #f59e0b; color: white; border-color: #f59e0b;\n}\n.grade-unknown[data-v-075e9794] { background: #9ca3af; color: white; border-color: #9ca3af;\n}\n.cultivate-btn[data-v-075e9794] {\n  background: var(--color-info);\n  border-color: var(--color-info);\n  color: white;\n}\n.cultivate-btn[data-v-075e9794]:hover {\n  background: var(--color-info-hover);\n}\n.unequip-btn[data-v-075e9794] {\n  background: var(--color-warning);\n  border-color: var(--color-warning);\n  color: white;\n}\n.unequip-btn[data-v-075e9794]:hover {\n  background: var(--color-warning-hover);\n}\n\n/* 品质样式 */\n.border-quality-神[data-v-075e9794] { border-color: #ef4444 !important;\n}\n.border-quality-仙[data-v-075e9794] { border-color: #f59e0b !important;\n}\n.border-quality-天[data-v-075e9794] { border-color: #8b5cf6 !important;\n}\n.border-quality-地[data-v-075e9794] { border-color: #3b82f6 !important;\n}\n.border-quality-人[data-v-075e9794] { border-color: #10b981 !important;\n}\n.border-quality-凡[data-v-075e9794] { border-color: var(--color-border) !important;\n}\n.text-quality-神[data-v-075e9794] { color: #ef4444 !important;\n}\n.text-quality-仙[data-v-075e9794] { color: #f59e0b !important;\n}\n.text-quality-天[data-v-075e9794] { color: #8b5cf6 !important;\n}\n.text-quality-地[data-v-075e9794] { color: #3b82f6 !important;\n}\n.text-quality-人[data-v-075e9794] { color: #10b981 !important;\n}\n.text-quality-凡[data-v-075e9794] { color: var(--color-text) !important;\n}\n\n/* 功法等级显示 */\n.technique-level-section h4[data-v-075e9794] {\n  margin: 0 0 12px 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n}\n.quality-display[data-v-075e9794] {\n  font-weight: 600;\n  font-size: 1.1rem;\n  padding: 8px 12px;\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  text-align: center;\n  border: 2px solid transparent;\n}\n.quality-display.text-quality-神[data-v-075e9794] {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.3);\n}\n.quality-display.text-quality-仙[data-v-075e9794] {\n  background: rgba(245, 158, 11, 0.1);\n  border-color: rgba(245, 158, 11, 0.3);\n}\n.quality-display.text-quality-天[data-v-075e9794] {\n  background: rgba(139, 92, 246, 0.1);\n  border-color: rgba(139, 92, 246, 0.3);\n}\n.quality-display.text-quality-地[data-v-075e9794] {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: rgba(59, 130, 246, 0.3);\n}\n.quality-display.text-quality-人[data-v-075e9794] {\n  background: rgba(16, 185, 129, 0.1);\n  border-color: rgba(16, 185, 129, 0.3);\n}\n\n/* 熟练度信息 */\n.proficiency-info[data-v-075e9794] {\n  margin-top: 8px;\n  font-size: 0.8rem;\n  color: var(--color-info);\n  font-weight: 500;\n}\n\n/* 功法效果详情 */\n.effect-details[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.effect-item[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 0;\n}\n.effect-label[data-v-075e9794] {\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  min-width: 80px;\n}\n.effect-value[data-v-075e9794] {\n  color: var(--color-success);\n  font-weight: 500;\n}\n.special-abilities[data-v-075e9794] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n}\n.ability-tag[data-v-075e9794] {\n  background: var(--color-info);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.7rem;\n  font-weight: 500;\n}\n\n/* 功法技能列表 */\n.skills-list[data-v-075e9794] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.skill-item[data-v-075e9794] {\n  background: var(--color-background);\n  border-radius: 8px;\n  padding: 12px;\n  border: 1px solid var(--color-border);\n  transition: all 0.2s ease;\n}\n.skill-item[data-v-075e9794]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-1px);\n}\n.skill-header[data-v-075e9794] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 6px;\n}\n.skill-name[data-v-075e9794] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.skill-type[data-v-075e9794] {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 0.7rem;\n  font-weight: 500;\n}\n.type-攻击[data-v-075e9794] { background: #fee2e2; color: #dc2626;\n}\n.type-防御[data-v-075e9794] { background: #dbeafe; color: #2563eb;\n}\n.type-辅助[data-v-075e9794] { background: #ecfccb; color: #65a30d;\n}\n.type-移动[data-v-075e9794] { background: #fef3c7; color: #d97706;\n}\n.type-其他[data-v-075e9794] { background: #f3f4f6; color: #6b7280;\n}\n.skill-description[data-v-075e9794] {\n  font-size: 0.8rem;\n  color: var(--color-text);\n  line-height: 1.4;\n  margin-bottom: 6px;\n}\n.skill-unlock[data-v-075e9794] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 6px;\n}\n.skill-status[data-v-075e9794] {\n  font-size: 0.7rem;\n  font-weight: 600;\n  padding: 2px 6px;\n  border-radius: 4px;\n  display: inline-block;\n}\n.skill-status.unlocked[data-v-075e9794] {\n  background: #dcfce7;\n  color: #16a34a;\n}\n.skill-status.locked[data-v-075e9794] {\n  background: #fee2e2;\n  color: #dc2626;\n}\n\n/* 已解锁技能 */\n.unlocked-skills[data-v-075e9794] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n.unlocked-skill-tag[data-v-075e9794] {\n  background: var(--color-success);\n  color: white;\n  padding: 4px 10px;\n  border-radius: 16px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n\n/* 自定义修炼时间输入 */\n.time-input-group[data-v-075e9794] {\n  background: var(--color-surface);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid var(--color-border);\n}\n.input-row[data-v-075e9794] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 12px;\n}\n.input-row label[data-v-075e9794] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 30px;\n}\n.time-input[data-v-075e9794] {\n  width: 80px;\n  padding: 6px 10px;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  font-size: 0.9rem;\n  text-align: center;\n  background: var(--color-background);\n  color: var(--color-text);\n}\n.time-input[data-v-075e9794]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb), 0.2);\n}\n.time-total[data-v-075e9794] {\n  font-size: 0.9rem;\n  color: var(--color-accent);\n  font-weight: 600;\n  text-align: center;\n  padding: 8px;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n}\n\n/* 响应式设计 */\n@media (max-width: 1024px) {\n.skills-bottom[data-v-075e9794] {\n    grid-template-columns: 1fr;\n}\n.technique-library-section[data-v-075e9794] {\n    max-width: none;\n}\n}\n@media (max-width: 768px) {\n.skills-content[data-v-075e9794] {\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto;\n}\n.skills-main[data-v-075e9794] {\n    overflow-y: visible;\n    padding: 16px;\n}\n.skills-bottom[data-v-075e9794] {\n    gap: 16px;\n}\n.technique-library-section[data-v-075e9794] {\n    display: none;\n}\n.technique-library-section.is-mobile[data-v-075e9794] {\n    display: flex;\n    position: fixed;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    transform: translateY(calc(100% + 32px));\n    max-height: 80vh;\n    padding: 20px 20px 28px;\n    background: var(--color-background);\n    box-shadow: 0 -16px 32px rgba(0, 0, 0, 0.35);\n    border-top-left-radius: 16px;\n    border-top-right-radius: 16px;\n    z-index: 1500;\n    opacity: 0;\n    pointer-events: none;\n}\n.technique-library-section.is-mobile.is-open[data-v-075e9794] {\n    transform: translateY(0);\n    opacity: 1;\n    pointer-events: auto;\n}\n.technique-library-section.is-mobile .technique-grid[data-v-075e9794] {\n    max-height: calc(80vh - 140px);\n    overflow-y: auto;\n    padding-right: 4px;\n}\n.mobile-library-close[data-v-075e9794] {\n    display: inline-flex;\n}\n.mobile-library-toggle[data-v-075e9794] {\n    display: inline-flex;\n}\n.mobile-library-backdrop[data-v-075e9794] {\n    display: block;\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.45);\n    z-index: 1400;\n}\n.skill-details-sidebar[data-v-075e9794] {\n    position: static;\n    width: 100%;\n    max-height: none;\n    min-height: 400px;\n    border-left: none;\n    border-top: 2px solid var(--color-border);\n    overflow-y: visible;\n}\n.skill-details-sidebar.no-selection[data-v-075e9794] {\n    min-height: 200px;\n}\n}\n@media (max-width: 640px) {\n.skills-main[data-v-075e9794] {\n    padding: 12px;\n}\n.cultivation-section[data-v-075e9794] {\n    padding: 16px;\n}\n.skill-slot[data-v-075e9794] {\n    min-height: 60px;\n    padding: 12px;\n}\n.skill-icon[data-v-075e9794] {\n    width: 40px;\n    height: 40px;\n}\n.skill-type-text[data-v-075e9794] {\n    font-size: 16px;\n}\n.technique-grid[data-v-075e9794] {\n    grid-template-columns: 1fr;\n}\n.current-technique-section[data-v-075e9794],\n  .technique-library-section[data-v-075e9794] {\n    gap: 12px;\n}\n}\n@media (max-width: 480px) {\n.section-header h3[data-v-075e9794] {\n    font-size: 1.3rem;\n}\n.skill-slot-group[data-v-075e9794] {\n    padding: 16px;\n}\n.skill-info[data-v-075e9794] {\n    gap: 8px;\n}\n.details-header[data-v-075e9794] {\n    padding: 16px;\n    gap: 12px;\n}\n.details-icon-large[data-v-075e9794] {\n    width: 50px;\n    height: 50px;\n}\n.skill-type-text-large[data-v-075e9794] {\n    font-size: 20px;\n}\n}\n",""]);const i=l},1524:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n/* 顶栏动作统一处理，移除本地工具栏 */\n/* 容器约束防止溢出 */\n.memory-center-panel[data-v-722c190a] {\n  width: 100%;\n  max-width: 100%;\n  height: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n  container-type: inline-size;\n  margin: 0;\n  padding: 1rem;\n  display: flex;\n  flex-direction: column;\n}\n.filter-section[data-v-722c190a] {\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n.filter-tabs[data-v-722c190a] {\n  display: flex;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n  align-items: center;\n  margin: 0 0 1rem 0;\n  padding: 1rem;\n  background: rgba(var(--color-surface-rgb), 0.3);\n  border: 1px solid rgba(var(--color-border-rgb), 0.3);\n  border-radius: 12px;\n  backdrop-filter: blur(10px);\n}\n.filter-tabs .filter-tab[data-v-722c190a] {\n  flex: 0 0 auto;\n  margin: 0;\n}\n.filter-tabs .settings-toggle-btn[data-v-722c190a] {\n  margin-left: auto;\n}\n.filter-tab[data-v-722c190a] {\n  flex-shrink: 0;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 150px;\n  margin: 0;\n  padding: 0.75rem 1rem;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface);\n  color: var(--color-text-secondary);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  box-sizing: border-box;\n  font-size: 0.875rem;\n  font-weight: 500;\n  min-height: 40px;\n  position: relative;\n}\n.filter-tab[data-v-722c190a]:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.filter-tab.active[data-v-722c190a] {\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  border-color: var(--color-primary);\n  color: white;\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n.filter-tab .tab-icon[data-v-722c190a] {\n  font-size: 1.1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.filter-tab .tab-name[data-v-722c190a] {\n  font-weight: 500;\n  letter-spacing: 0.3px;\n}\n.filter-tab .tab-count[data-v-722c190a] {\n  background: rgba(255, 255, 255, 0.2);\n  color: var(--color-text);\n  padding: 0.2rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  min-width: 20px;\n  text-align: center;\n  line-height: 1;\n}\n.filter-tab.active .tab-count[data-v-722c190a] {\n  background: rgba(255, 255, 255, 0.25);\n  color: white;\n}\n.filter-section[data-v-722c190a] {\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.panel-content[data-v-722c190a] {\n  width: 100%;\n  max-width: 100%;\n  height: calc(100% - 80px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* 设置界面样式 */\n.settings-section[data-v-722c190a] {\n  margin: 0;\n  padding: 0;\n  background: rgba(var(--color-surface-rgb), 0.95);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  animation: fadeIn-722c190a 0.3s ease-in-out;\n  max-width: 100%;\n  width: 100%;\n  height: 100%;\n  max-height: calc(100% - 80px);\n  box-sizing: border-box;\n  overflow: hidden;\n  backdrop-filter: blur(10px);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n}\n.settings-header[data-v-722c190a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0;\n  padding: 1rem 1rem 0.5rem 1rem;\n  border-bottom: 1px solid var(--color-border);\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n  flex-shrink: 0;\n}\n.header-actions[data-v-722c190a] {\n  display: flex;\n  gap: 0.5rem;\n  align-items: center;\n}\n.test-btn[data-v-722c190a] {\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  border: none;\n  padding: 0.4rem 0.8rem;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.85rem;\n  font-weight: 500;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n.test-btn[data-v-722c190a]:hover {\n  background: linear-gradient(135deg, #059669, #047857);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n.settings-title[data-v-722c190a] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.settings-close-btn[data-v-722c190a] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  font-size: 1.2rem;\n  padding: 0.2rem;\n  border-radius: 4px;\n  transition: var(--transition-fast);\n  flex-shrink: 0;\n}\n.settings-close-btn[data-v-722c190a]:hover {\n  background: rgba(var(--color-danger-rgb), 0.1);\n  color: var(--color-danger);\n}\n.settings-content[data-v-722c190a] {\n  display: block;\n  max-width: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n  box-sizing: border-box;\n  flex: 1;\n  min-height: 0;\n  padding: 1rem;\n  scrollbar-width: thin;\n  scrollbar-color: var(--color-border) transparent;\n}\n.settings-content[data-v-722c190a]::-webkit-scrollbar {\n  width: 8px;\n}\n.settings-content[data-v-722c190a]::-webkit-scrollbar-track {\n  background: rgba(var(--color-border-rgb), 0.1);\n  border-radius: 4px;\n}\n.settings-content[data-v-722c190a]::-webkit-scrollbar-thumb {\n  background: var(--color-border);\n  border-radius: 4px;\n}\n.settings-content[data-v-722c190a]::-webkit-scrollbar-thumb:hover {\n  background: var(--color-border-hover);\n}\n.setting-item[data-v-722c190a] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  max-width: 100%;\n  overflow: visible;\n  box-sizing: border-box;\n  margin-bottom: 1.5rem;\n}\n.setting-label[data-v-722c190a] {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--color-text);\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  max-width: 100%;\n  overflow: hidden;\n  word-wrap: break-word;\n}\n.setting-input[data-v-722c190a] {\n  padding: 0.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  background: var(--color-surface);\n  color: var(--color-text);\n  font-size: 0.875rem;\n  width: 100px;\n  max-width: 120px;\n  transition: var(--transition-fast);\n  box-sizing: border-box;\n}\n.setting-input[data-v-722c190a]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb), 0.2);\n}\n.setting-textarea[data-v-722c190a] {\n  padding: 0.75rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface);\n  color: var(--color-text);\n  font-size: 0.875rem;\n  width: 100%;\n  max-width: 100%;\n  transition: var(--transition-fast);\n  box-sizing: border-box;\n  resize: vertical;\n  min-height: 100px;\n  font-family: monospace;\n  line-height: 1.4;\n}\n.setting-textarea[data-v-722c190a]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 2px rgba(var(--color-primary-rgb), 0.2);\n}\n.setting-textarea[data-v-722c190a]::placeholder {\n  color: var(--color-text-secondary);\n  opacity: 0.7;\n}\n.setting-checkbox[data-v-722c190a] {\n  margin-right: 0.5rem;\n  accent-color: var(--color-primary);\n  flex-shrink: 0;\n}\n.setting-hint[data-v-722c190a] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  opacity: 0.8;\n  max-width: 100%;\n  overflow: hidden;\n  word-wrap: break-word;\n}\n.settings-actions[data-v-722c190a] {\n  display: flex;\n  gap: 0.75rem;\n  margin-top: 2rem;\n  flex-wrap: wrap;\n  max-width: 100%;\n  overflow: visible;\n  box-sizing: border-box;\n}\n\n/* 手动总结区域 */\n.manual-summary-section[data-v-722c190a] {\n  margin-top: 1.5rem;\n  padding: 1rem;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n.summary-info[data-v-722c190a] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  margin-bottom: 0.75rem;\n}\n.info-text[data-v-722c190a] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.info-hint[data-v-722c190a] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n\n/* 通用操作按钮基样式，确保有清晰边框 */\n.action-btn[data-v-722c190a] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: var(--transition-fast);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  box-sizing: border-box;\n  background: var(--color-surface);\n  color: var(--color-text);\n}\n@keyframes fadeIn-722c190a {\nfrom {\n    opacity: 0;\n    transform: translateY(-10px);\n}\nto {\n    opacity: 1;\n    transform: translateY(0);\n}\n}\n.action-btn.success[data-v-722c190a] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  border: 1px solid rgba(var(--color-success-rgb), 0.3);\n  color: var(--color-success);\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: var(--transition-fast);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  box-sizing: border-box;\n}\n.action-btn.success[data-v-722c190a]:hover {\n  background: rgba(var(--color-success-rgb), 0.2);\n  border-color: var(--color-success);\n}\n\n/* 信息按钮，用于“重置默认”等操作 */\n.action-btn.info[data-v-722c190a] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  border: 1px solid rgba(var(--color-info-rgb), 0.3);\n  color: var(--color-info);\n}\n.action-btn.info[data-v-722c190a]:hover {\n  background: rgba(var(--color-info-rgb), 0.2);\n  border-color: var(--color-info);\n}\n.settings-toggle-btn[data-v-722c190a] {\n  background: rgba(var(--color-surface-rgb), 0.8);\n  border: 1px solid var(--color-border);\n  padding: 0.6rem;\n  border-radius: 8px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  width: 40px;\n  height: 40px;\n  box-sizing: border-box;\n  backdrop-filter: blur(10px);\n}\n.settings-toggle-btn[data-v-722c190a]:hover,\n.settings-toggle-btn.active[data-v-722c190a] {\n  background: rgba(var(--color-primary-rgb), 0.15);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.2);\n}\n\n/* 记忆卡片特定样式 */\n.memory-list[data-v-722c190a] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n.memory-card[data-v-722c190a] {\n  padding: 1rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  transition: var(--transition-fast);\n  cursor: pointer;\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n  word-wrap: break-word;\n  word-break: break-word;\n}\n.memory-card[data-v-722c190a]:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.1);\n}\n.memory-header[data-v-722c190a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n}\n.memory-actions[data-v-722c190a] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.delete-memory-btn[data-v-722c190a] {\n  background: transparent;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  padding: 0.25rem 0.5rem;\n  cursor: pointer;\n  font-size: 0.9rem;\n  transition: all 0.2s ease;\n  opacity: 0.6;\n}\n.delete-memory-btn[data-v-722c190a]:hover {\n  opacity: 1;\n  background: rgba(220, 38, 38, 0.1);\n  border-color: #dc2626;\n  transform: scale(1.1);\n}\n.memory-type-badge[data-v-722c190a] {\n  padding: 0.25rem 0.5rem;\n  border-radius: 1rem;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text-secondary);\n}\n.badge-short[data-v-722c190a] {\n  border-color: rgba(var(--color-warning-rgb), 0.3);\n  background: rgba(var(--color-warning-rgb), 0.1);\n  color: var(--color-warning);\n}\n.badge-medium[data-v-722c190a] {\n  border-color: rgba(var(--color-success-rgb), 0.3);\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n}\n.badge-long[data-v-722c190a] {\n  border-color: rgba(var(--color-info-rgb), 0.3);\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n}\n.memory-time[data-v-722c190a] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n.memory-content[data-v-722c190a] {\n  font-size: 0.875rem;\n  color: var(--color-text);\n  line-height: 1.5;\n  margin-bottom: 0.5rem;\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  word-wrap: break-word;\n  word-break: break-word;\n}\n.memory-title[data-v-722c190a] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  margin-bottom: 0.75rem;\n  text-align: center;\n  padding: 0.5rem;\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-accent-rgb), 0.05));\n  border-radius: 6px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n}\n.memory-section[data-v-722c190a] {\n  display: flex;\n  align-items: center;\n  margin: 0.75rem 0 0.5rem 0;\n  padding: 0.5rem 0;\n  border-bottom: 1px solid rgba(var(--color-border-rgb), 0.3);\n}\n.memory-icon[data-v-722c190a] {\n  font-size: 1.2rem;\n  margin-right: 0.5rem;\n}\n.memory-section-title[data-v-722c190a] {\n  font-weight: 600;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.memory-item[data-v-722c190a] {\n  margin: 0.3rem 0;\n  padding-left: 1rem;\n  color: var(--color-text);\n  line-height: 1.4;\n  position: relative;\n  width: 100%;\n  max-width: 100%;\n  overflow: hidden;\n  word-wrap: break-word;\n  word-break: break-word;\n}\n.memory-item[data-v-722c190a]::before {\n  content: '';\n  position: absolute;\n  left: 0.25rem;\n  top: 0.6rem;\n  width: 3px;\n  height: 3px;\n  background: var(--color-accent);\n  border-radius: 50%;\n}\n.memory-importance[data-v-722c190a] {\n  font-size: 0.75rem;\n  color: var(--color-accent);\n  font-weight: 500;\n  padding: 0.25rem 0.5rem;\n  background: rgba(var(--color-accent-rgb), 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(var(--color-accent-rgb), 0.3);\n  display: inline-block;\n}\n.empty-hint[data-v-722c190a] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  opacity: 0.7;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.memory-center-panel[data-v-722c190a] {\n    gap: 0.75rem;\n    width: 100%;\n    max-width: 100%;\n    overflow: hidden;\n}\n.header-actions .btn-text[data-v-722c190a] {\n    display: none;\n}\n.filter-tabs[data-v-722c190a] {\n    gap: 0.3rem;\n}\n.filter-tab[data-v-722c190a] {\n    max-width: 120px;\n    font-size: 0.8rem;\n}\n.memory-status[data-v-722c190a] {\n    gap: 0.5rem;\n    padding: 0.6rem;\n    flex-direction: column;\n}\n.status-item[data-v-722c190a] {\n    min-width: 80px;\n    flex: 1 1 100px;\n    width: 100%;\n    max-width: 100%;\n}\n.status-text[data-v-722c190a] {\n    font-size: 0.7rem;\n    min-width: 2.5rem;\n}\n.memory-card[data-v-722c190a] {\n    padding: 0.8rem;\n}\n.memory-content[data-v-722c190a] {\n    font-size: 0.8rem;\n}\n.memory-header[data-v-722c190a] {\n    flex-direction: column;\n    gap: 0.5rem;\n    align-items: flex-start;\n}\n.memory-type-badge[data-v-722c190a] {\n    align-self: flex-start;\n}\n.memory-time[data-v-722c190a] {\n    align-self: flex-end;\n    font-size: 0.7rem;\n}\n}\n@media (max-width: 480px) {\n.memory-center-panel[data-v-722c190a] {\n    gap: 0.5rem;\n}\n.filter-tabs[data-v-722c190a] {\n    gap: 0.2rem;\n}\n.filter-tab[data-v-722c190a] {\n    max-width: 100px;\n    font-size: 0.75rem;\n    padding: 0.4rem 0.6rem;\n}\n.memory-status[data-v-722c190a] {\n    padding: 0.5rem;\n}\n.status-item[data-v-722c190a] {\n    gap: 0.3rem;\n}\n.status-label[data-v-722c190a] {\n    font-size: 0.7rem;\n    min-width: 1.5rem;\n}\n.status-bar[data-v-722c190a] {\n    height: 4px;\n}\n.status-text[data-v-722c190a] {\n    font-size: 0.65rem;\n    min-width: 2rem;\n}\n.memory-card[data-v-722c190a] {\n    padding: 0.6rem;\n}\n.memory-content[data-v-722c190a] {\n    font-size: 0.75rem;\n}\n.memory-section-title[data-v-722c190a] {\n    font-size: 0.8rem;\n}\n.memory-item[data-v-722c190a] {\n    font-size: 0.75rem;\n    padding-left: 0.8rem;\n}\n}\n",""]);const i=l},1530:e=>{e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%2712%27 viewBox=%270 0 12 12%27%3E%3Cpath fill=%27%23e5e7eb%27 d=%27M6 9L1 4h10z%27/%3E%3C/svg%3E"},1591:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.game-view[data-v-61af6578] {\n  width: 100%;\n  height: 100%;\n  background: var(--color-background);\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  font-size: 14px;\n  display: grid;\n  grid-template-rows: auto 1fr;\n  overflow: hidden;\n}\n.game-content[data-v-61af6578] {\n  flex: 1;\n  display: flex;\n  align-items: stretch;\n  gap: 0;\n  padding: 0;\n  position: relative;\n  min-height: 0;\n  background: var(--color-background);\n}\n.left-sidebar[data-v-61af6578] {\n  width: 240px;\n  background: var(--color-surface);\n  transition: all 0.3s ease;\n  z-index: 10;\n  display: flex;\n  flex-direction: column;\n  border-right: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.left-sidebar.collapsed[data-v-61af6578] {\n  width: 0;\n  overflow: hidden;\n}\n.right-panel-area[data-v-61af6578] {\n  width: 280px;\n  background: var(--color-surface);\n  transition: all 0.3s ease;\n  border-left: 1px solid var(--color-border);\n  flex-shrink: 0;\n  display: flex;\n  flex-direction: column;\n}\n.right-panel-area.collapsed[data-v-61af6578] {\n  width: 0;\n  overflow: hidden;\n}\n.sidebar-wrapper[data-v-61af6578] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.main-content[data-v-61af6578] {\n  flex: 1;\n  background: var(--color-background);\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  position: relative;\n}\n\n/* 收缩按钮样式 */\n.collapse-btn[data-v-61af6578] {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  width: 24px;\n  height: 48px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 20;\n  color: var(--color-text-secondary);\n}\n.collapse-btn[data-v-61af6578]:hover {\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n/* 左侧收缩按钮 */\n.collapse-btn.left[data-v-61af6578] {\n  left: 240px;\n  border-radius: 0 8px 8px 0;\n  transition: left 0.3s ease, background 0.2s ease;\n}\n\n/* 左侧栏收缩时，按钮移动到最左侧 */\n.left-sidebar.collapsed ~ .collapse-btn.left[data-v-61af6578] {\n  left: 0;\n}\n\n/* 右侧收缩按钮 */\n.collapse-btn.right[data-v-61af6578] {\n  right: 280px;\n  border-radius: 8px 0 0 8px;\n  transition: right 0.3s ease, background 0.2s ease;\n}\n\n/* 右侧栏收缩时，按钮移动到最右侧 */\n.right-panel-area.collapsed ~ .collapse-btn.right[data-v-61af6578],\n.collapse-btn.right.collapsed[data-v-61af6578] {\n  right: 0;\n}\n\n/* 面板覆盖模式样式 - 只隐藏右侧栏，保留左侧栏 */\n.game-content.panel-mode .right-panel-area[data-v-61af6578] {\n  display: none;\n}\n.panel-overlay[data-v-61af6578] {\n  width: 100%;\n  height: 100%;\n  background: var(--color-background);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.panel-header[data-v-61af6578] { position: relative; display: flex; align-items: center; gap: 8px; padding: 6px 12px; min-height: 30px; height: auto; background: transparent; border-bottom: none; flex-shrink: 0;\n}\n.panel-header[data-v-61af6578]::after { content: ''; position: absolute; left: 8px; right: 8px; bottom: 0; height: 1px; background: linear-gradient(90deg, transparent, rgba(var(--color-primary-rgb,46,92,184), .35), transparent);\n}\n.panel-header.compact[data-v-61af6578]::after {\n  content: '';\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 2px;\n  background: linear-gradient(90deg, transparent, var(--color-primary), transparent);\n  opacity: 0.25;\n}\n.panel-title-icon[data-v-61af6578] { color: var(--color-primary); flex-shrink: 0;\n}\n.panel-title-compact[data-v-61af6578] { display: flex; align-items: center; gap: 8px; min-width: 0; flex: 1; justify-content: center;\n}\n.panel-title-compact .title-text[data-v-61af6578] { font-size: 0.92rem; font-weight: 600; color: var(--color-text); letter-spacing: 0.2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\n}\n.back-btn[data-v-61af6578] { background: transparent; border: none; padding: 2px 6px; border-radius: 4px; color: var(--color-text-secondary); cursor: pointer; transition: all 0.2s ease; display: inline-flex; align-items: center;\n}\n.back-btn[data-v-61af6578]:hover { background: var(--color-surface-hover); color: var(--color-text);\n}\n.panel-actions[data-v-61af6578] { margin-left: auto; display: flex; align-items: center; gap: 4px;\n}\n.action-btn-compact[data-v-61af6578] { background: transparent; border: none; width: 26px; height: 26px; border-radius: 4px; color: var(--color-text-secondary); display: inline-flex; align-items: center; justify-content: center; cursor: pointer; transition: var(--transition-fast);\n}\n.action-btn-compact[data-v-61af6578]:hover { background: var(--color-surface-hover); color: var(--color-text);\n}\n.panel-content[data-v-61af6578] {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.panel-header.compact[data-v-61af6578] { padding: 6px 10px; position: sticky; top: 0; z-index: 2; background: var(--color-background);\n}\n.panel-content.compact[data-v-61af6578] { padding: 6px 10px 10px 10px;\n}\n\n/* 数据加载提示样式 */\n.data-loading[data-v-61af6578] {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, var(--color-background) 0%, var(--color-surface) 100%);\n  position: relative;\n  overflow: hidden;\n}\n.data-loading[data-v-61af6578]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: radial-gradient(circle at 50% 50%, rgba(var(--color-primary-rgb, 46, 92, 184), 0.05) 0%, transparent 70%);\n  animation: pulse-61af6578 3s ease-in-out infinite;\n}\n.loading-content[data-v-61af6578] {\n  text-align: center;\n  padding: 60px 40px;\n  max-width: 500px;\n  position: relative;\n  z-index: 1;\n}\n.loading-spinner-wrapper[data-v-61af6578] {\n  position: relative;\n  width: 80px;\n  height: 80px;\n  margin: 0 auto 32px;\n}\n.loading-spinner[data-v-61af6578] {\n  width: 80px;\n  height: 80px;\n  border: 3px solid transparent;\n  border-top: 3px solid var(--color-primary);\n  border-right: 3px solid var(--color-primary);\n  border-radius: 50%;\n  animation: spin-61af6578 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;\n  position: relative;\n}\n.spinner-glow[data-v-61af6578] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  background: radial-gradient(circle, rgba(var(--color-primary-rgb, 46, 92, 184), 0.3) 0%, transparent 70%);\n  animation: glow-61af6578 2s ease-in-out infinite;\n}\n@keyframes spin-61af6578 {\n0% { transform: rotate(0deg);\n}\n100% { transform: rotate(360deg);\n}\n}\n@keyframes glow-61af6578 {\n0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(0.9);\n}\n50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1);\n}\n}\n@keyframes pulse-61af6578 {\n0%, 100% { opacity: 0.5;\n}\n50% { opacity: 1;\n}\n}\n.loading-title[data-v-61af6578] {\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin: 0 0 12px 0;\n  letter-spacing: 2px;\n  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent) 100%);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n.loading-message[data-v-61af6578] {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  margin: 0 0 32px 0;\n  font-weight: 500;\n}\n.loading-steps[data-v-61af6578] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin-bottom: 32px;\n  text-align: left;\n}\n.loading-step[data-v-61af6578] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 10px 16px;\n  background: var(--color-surface);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n  transition: all 0.3s ease;\n}\n.loading-step.active[data-v-61af6578] {\n  background: rgba(var(--color-primary-rgb, 46, 92, 184), 0.1);\n  border-color: var(--color-primary);\n}\n.step-icon[data-v-61af6578] {\n  font-size: 1.2rem;\n  font-weight: bold;\n  color: var(--color-success);\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n}\n.loading-step.active .step-icon[data-v-61af6578] {\n  color: var(--color-primary);\n  animation: bounce-61af6578 1s ease-in-out infinite;\n}\n@keyframes bounce-61af6578 {\n0%, 100% { transform: translateY(0);\n}\n50% { transform: translateY(-4px);\n}\n}\n.step-text[data-v-61af6578] {\n  font-size: 0.95rem;\n  color: var(--color-text);\n  font-weight: 500;\n}\n.loading-hint[data-v-61af6578] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  margin: 0;\n  padding: 12px 20px;\n  background: var(--color-surface);\n  border-radius: 8px;\n  border-left: 3px solid var(--color-primary);\n}\n\n/* 移动端适配 */\n@media (max-width: 768px) {\n.game-view[data-v-61af6578] {\n    font-size: 13px;\n}\n\n  /* 移动端侧边栏浮动显示，不占用主内容空间 */\n.left-sidebar[data-v-61af6578] {\n    position: fixed;\n    top: 0; /* 从顶部开始 */\n    left: 0;\n    bottom: 0;\n    height: 100%;\n    width: 280px;\n    z-index: 1000;\n    transform: translateX(-100%);\n    transition: transform 0.3s ease;\n    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);\n    overflow: hidden;\n    background: var(--color-surface); /* 和右侧栏一样的背景色 */\n}\n.left-sidebar[data-v-61af6578]:not(.collapsed) {\n    transform: translateX(0);\n}\n.left-sidebar .sidebar-wrapper[data-v-61af6578] {\n    overflow-y: auto;\n    overflow-x: hidden;\n    height: 100%;\n    -webkit-overflow-scrolling: touch;\n    box-sizing: border-box;\n}\n.right-panel-area[data-v-61af6578] {\n    position: fixed;\n    top: 0; /* 从顶部开始 */\n    right: 0;\n    bottom: 0;\n    height: 100%;\n    width: 260px;\n    z-index: 1000;\n    transform: translateX(100%);\n    transition: transform 0.3s ease;\n    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.15);\n    overflow: hidden;\n    background: var(--color-surface); /* 和左侧栏一样的背景色 */\n}\n.right-panel-area[data-v-61af6578]:not(.collapsed) {\n    transform: translateX(0);\n}\n.right-panel-area .sidebar-wrapper[data-v-61af6578] {\n    overflow-y: auto;\n    overflow-x: hidden;\n    height: 100%;\n    -webkit-overflow-scrolling: touch;\n    box-sizing: border-box;\n}\n\n  /* 移动端背景遮罩层 - 改为在侧边栏后面，但不影响侧边栏本身 */\n.left-sidebar[data-v-61af6578]:not(.collapsed)::before,\n  .right-panel-area[data-v-61af6578]:not(.collapsed)::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.5);\n    z-index: -1; /* 在侧边栏后面 */\n    pointer-events: none; /* 不阻止点击事件 */\n}\n\n  /* 左侧遮罩只在侧边栏右侧显示 */\n.left-sidebar[data-v-61af6578]:not(.collapsed)::before {\n    left: 280px; /* 从侧边栏右边缘开始 */\n}\n\n  /* 右侧遮罩只在侧边栏左侧显示 */\n.right-panel-area[data-v-61af6578]:not(.collapsed)::before {\n    right: 260px; /* 从侧边栏左边缘开始 */\n}\n\n  /* 移动端收缩按钮样式 - 参考电脑版样式 */\n.collapse-btn[data-v-61af6578] {\n    position: fixed;\n    z-index: 1001;\n    width: 20px;\n    height: 44px;\n    background: var(--color-surface);\n    border: 1px solid var(--color-border);\n    color: var(--color-text-secondary);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    touch-action: manipulation;\n    top: 50%;\n    transform: translateY(-50%);\n    transition: all 0.3s ease;\n}\n.collapse-btn svg[data-v-61af6578] {\n    width: 14px;\n    height: 14px;\n}\n.collapse-btn[data-v-61af6578]:active {\n    background: var(--color-surface-light);\n    color: var(--color-text);\n}\n\n  /* 左侧按钮：默认在左边缘，跟随侧边栏一起移动 */\n.collapse-btn.left[data-v-61af6578] {\n    left: 0;\n    border-radius: 0 8px 8px 0;\n    border-left: none;\n    transform: translateX(0) translateY(-50%);\n    transition: transform 0.3s ease, background 0.2s ease;\n}\n\n  /* 左侧栏展开时，按钮跟随移动 280px */\n.left-sidebar:not(.collapsed) ~ .collapse-btn.left[data-v-61af6578] {\n    transform: translateX(280px) translateY(-50%);\n}\n\n  /* 右侧按钮：默认在右边缘，跟随侧边栏一起移动 */\n.collapse-btn.right[data-v-61af6578] {\n    right: 0;\n    border-radius: 8px 0 0 8px;\n    border-right: none;\n    transform: translateX(0) translateY(-50%);\n    transition: transform 0.3s ease, background 0.2s ease;\n}\n\n  /* 右侧栏展开时（按钮没有 collapsed 类），按钮跟随移动 -260px */\n.collapse-btn.right[data-v-61af6578]:not(.collapsed) {\n    transform: translateX(-260px) translateY(-50%);\n}\n\n  /* 主内容区域占满屏幕 */\n.main-content[data-v-61af6578] {\n    width: 100%;\n    margin: 0;\n    padding: 0;\n    overflow-x: hidden;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n}\n.game-content[data-v-61af6578] {\n    gap: 0;\n    /* 确保内容区域留出TopBar空间 */\n    margin-top: 0;\n}\n\n  /* 移动端面板全屏优化 */\n.panel-overlay[data-v-61af6578] {\n    position: fixed;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 999;\n    overflow: hidden;\n}\n\n  /* 面板头部移动端优化 */\n.panel-header[data-v-61af6578] {\n    padding: 4px 8px;\n    min-height: 36px;\n    flex-wrap: nowrap;\n}\n.panel-header.compact[data-v-61af6578] {\n    padding: 4px 8px;\n}\n.panel-title-compact .title-text[data-v-61af6578] {\n    font-size: 0.85rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n  /* 面板内容移动端优化 - 确保文本区域能够收缩 */\n.panel-content[data-v-61af6578] {\n    padding: 8px;\n    overflow-y: auto;\n    overflow-x: hidden;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n}\n.panel-content.compact[data-v-61af6578] {\n    padding: 6px 8px 8px 8px;\n}\n\n  /* 确保面板内所有文本元素自动换行 */\n.panel-content[data-v-61af6578] *,\n  .panel-overlay[data-v-61af6578] * {\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    max-width: 100%;\n}\n\n  /* 数据加载提示移动端优化 */\n.data-loading[data-v-61af6578] {\n    padding: 8px;\n}\n.loading-content[data-v-61af6578] {\n    padding: 40px 20px;\n    max-width: 100%;\n}\n.loading-title[data-v-61af6578] {\n    font-size: 1.2rem;\n    white-space: normal;\n    word-wrap: break-word;\n}\n.loading-message[data-v-61af6578] {\n    font-size: 0.9rem;\n    white-space: normal;\n    word-wrap: break-word;\n}\n.loading-steps[data-v-61af6578] {\n    gap: 8px;\n}\n.loading-step[data-v-61af6578] {\n    padding: 8px 12px;\n}\n.step-text[data-v-61af6578] {\n    font-size: 0.85rem;\n    white-space: normal;\n    word-wrap: break-word;\n}\n.loading-hint[data-v-61af6578] {\n    font-size: 0.8rem;\n    white-space: normal;\n    word-wrap: break-word;\n}\n}\n\n/* 超小屏幕适配 */\n@media (max-width: 480px) {\n.game-view[data-v-61af6578] {\n    font-size: 12px;\n}\n.left-sidebar[data-v-61af6578] {\n    width: 240px;\n}\n\n  /* 左侧栏展开时，按钮跟随移动 240px（匹配侧边栏宽度） */\n.left-sidebar:not(.collapsed) ~ .collapse-btn.left[data-v-61af6578] {\n    transform: translateX(240px) translateY(-50%);\n}\n.right-panel-area[data-v-61af6578] {\n    width: 220px;\n}\n\n  /* 右侧栏展开时，按钮跟随移动 -220px（匹配侧边栏宽度） */\n.collapse-btn.right[data-v-61af6578]:not(.collapsed) {\n    transform: translateX(-220px) translateY(-50%);\n}\n\n  /* 小屏幕上面板全屏显示 */\n.panel-overlay[data-v-61af6578] {\n    position: fixed;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 999;\n}\n.panel-header[data-v-61af6578] {\n    padding: 3px 6px;\n    min-height: 32px;\n}\n.panel-title-compact .title-text[data-v-61af6578] {\n    font-size: 0.8rem;\n}\n.panel-content[data-v-61af6578] {\n    padding: 6px;\n    font-size: 0.9em;\n}\n.loading-title[data-v-61af6578] {\n    font-size: 1rem;\n}\n.loading-message[data-v-61af6578] {\n    font-size: 0.85rem;\n}\n.step-text[data-v-61af6578] {\n    font-size: 0.8rem;\n}\n.loading-hint[data-v-61af6578] {\n    font-size: 0.75rem;\n}\n}\n",""]);const i=l},1601:e=>{e.exports=function(e){return e[1]}},1606:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"/* 统一的游戏面板主题样式 */\n\n/* === 面板基础容器 === */\n.game-panel {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: var(--color-background);\n  overflow: hidden;\n  gap: 0.75rem;\n  position: relative;\n  font-family: var(--font-family-sans-serif);\n}\n\n/* === 面板头部 === */\n.panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  flex-shrink: 0;\n  backdrop-filter: blur(10px);\n  margin: 0.5rem;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.header-icon {\n  font-size: 1.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 2.5rem;\n  height: 2.5rem;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border-radius: 50%;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n}\n\n.header-info {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.panel-title {\n  margin: 0;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: var(--color-text);\n  /* 防止标题在紧凑布局中撑破布局 */\n  min-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.panel-subtitle {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n\n.header-actions {\n  display: flex;\n  gap: 0.5rem;\n  /* 允许按钮自动换行，避免溢出 */\n  flex-wrap: wrap;\n  justify-content: flex-end;\n  max-width: 100%;\n}\n\n/* === 动作按钮 === */\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  padding: 0.5rem 0.75rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface);\n  color: var(--color-text);\n  font-size: 0.875rem;\n  /* 行为：默认不换行，但容器可多行显示 */\n  white-space: nowrap;\n  cursor: pointer;\n  transition: var(--transition-fast);\n  /* 允许在需要时收缩，避免容器被撑破 */\n  flex: 0 1 auto;\n  max-width: 100%;\n}\n\n.action-btn:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 4px rgba(var(--color-primary-rgb), 0.1);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n\n.action-btn.primary {\n  background: var(--color-primary);\n  color: var(--color-background);\n  border-color: var(--color-primary);\n}\n\n.action-btn.primary:hover {\n  background: var(--color-primary-hover);\n  border-color: var(--color-primary-hover);\n}\n\n.action-btn.secondary {\n  background: var(--color-accent);\n  color: var(--color-background);\n  border-color: var(--color-accent);\n}\n\n.action-btn.secondary:hover {\n  background: var(--color-accent-hover);\n  border-color: var(--color-accent-hover);\n}\n\n.action-btn.danger {\n  border-color: var(--color-error);\n  color: var(--color-error);\n}\n\n.action-btn.danger:hover {\n  background: rgba(var(--color-error-rgb), 0.05);\n  border-color: var(--color-danger);\n  color: var(--color-danger);\n}\n\n.btn-icon {\n  flex-shrink: 0;\n}\n\n.btn-text {\n  font-weight: 500;\n}\n\n/* === 内容区域 === */\n.panel-content {\n  flex: 1;\n  overflow-y: auto;\n  margin: 0 0.5rem 0.5rem 0.5rem;\n  scrollbar-width: thin;\n  scrollbar-color: var(--scrollbar-thumb) transparent;\n}\n\n.panel-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.panel-content::-webkit-scrollbar-track {\n  background: rgba(var(--color-border-rgb), 0.1);\n  border-radius: 3px;\n}\n\n.panel-content::-webkit-scrollbar-thumb {\n  background: var(--scrollbar-thumb);\n  border-radius: 3px;\n  opacity: 0.6;\n}\n\n.panel-content::-webkit-scrollbar-thumb:hover {\n  opacity: 0.8;\n}\n\n/* === 筛选标签 === */\n.filter-section {\n  padding: 0.5rem 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  flex-shrink: 0;\n  margin: 0 0.5rem;\n}\n\n.filter-tabs {\n  display: flex;\n  gap: 0.5rem;\n  overflow-x: auto;\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n}\n\n.filter-tabs::-webkit-scrollbar {\n  display: none;\n}\n\n.filter-tab {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  padding: 0.5rem 0.75rem;\n  border: 1px solid var(--color-border);\n  border-radius: 1.5rem;\n  background: var(--color-surface);\n  color: var(--color-text-secondary);\n  font-size: 0.875rem;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: var(--transition-fast);\n  flex-shrink: 0;\n}\n\n.filter-tab:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n}\n\n.filter-tab.active {\n  background: var(--color-primary);\n  color: var(--color-background);\n  border-color: var(--color-primary);\n}\n\n.tab-icon {\n  font-size: 1rem;\n}\n\n.tab-name {\n  font-weight: 500;\n}\n\n.tab-count {\n  font-size: 0.75rem;\n  background: rgba(255, 255, 255, 0.2);\n  padding: 0.125rem 0.375rem;\n  border-radius: 0.75rem;\n  font-weight: 600;\n}\n\n.filter-tab.active .tab-count {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n/* === 网格布局 === */\n.items-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n  gap: 0.75rem;\n  padding: 0.5rem;\n}\n\n.currency-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n  gap: 0.75rem;\n}\n\n/* === 卡片样式 === */\n.item-card, .currency-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: var(--transition-fast);\n  position: relative;\n}\n\n.item-card:hover, .currency-item:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.1);\n}\n\n/* === 状态指示 === */\n.loading-state, .empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n\n.loading-spinner, .empty-icon {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n}\n\n.loading-text, .empty-text {\n  font-size: 1rem;\n  margin: 0;\n}\n\n/* === 详情区域 === */\n.detail-section {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-top: 1rem;\n}\n\n.detail-header {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--color-border);\n}\n\n.detail-title {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin: 0;\n}\n\n.detail-content {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.info-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 0.5rem;\n}\n\n.info-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem;\n  background: var(--color-surface-light);\n  border-radius: 4px;\n  font-size: 0.875rem;\n}\n\n.info-label {\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n\n.info-value {\n  color: var(--color-text);\n  font-weight: 600;\n}\n\n/* === 列表样式 === */\n.list-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.list-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  cursor: pointer;\n  transition: var(--transition-fast);\n}\n\n.list-item:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-border-hover);\n  transform: translateX(2px);\n}\n\n.list-item-content {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  flex: 1;\n}\n\n.list-item-title {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n\n.list-item-subtitle {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n\n/* === 进度条 === */\n.progress-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.progress-bar {\n  height: 6px;\n  background: rgba(var(--color-border-rgb), 0.3);\n  border-radius: 3px;\n  overflow: hidden;\n}\n\n.progress-fill {\n  height: 100%;\n  background: var(--color-primary);\n  border-radius: 3px;\n  transition: width 0.3s ease;\n}\n\n.progress-text {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n\n/* === 分割线 === */\n.section-divider {\n  height: 1px;\n  background: var(--color-border);\n  margin: 1rem 0;\n}\n\n/* === 响应式适配 === */\n@media (max-width: 640px) {\n  .game-panel {\n    gap: 0.5rem;\n  }\n  \n  .panel-header {\n    padding: 0.5rem 0.75rem;\n    margin: 0.25rem;\n    /* 小屏时头部内容纵向排列，避免左右挤压 */\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem 0.5rem;\n  }\n\n  .filter-section {\n    padding: 0.5rem;\n    margin: 0 0.25rem;\n  }\n\n  .panel-content {\n    margin: 0 0.25rem 0.25rem 0.25rem;\n  }\n\n  .header-left {\n    min-width: 0;\n    flex: 1 1 auto;\n  }\n  \n  .header-actions .btn-text {\n    display: none;\n  }\n\n  .header-actions {\n    /* 头部操作按钮独占一行并可换行 */\n    width: 100%;\n    justify-content: flex-start;\n    gap: 0.375rem;\n  }\n\n  .action-btn {\n    /* 移动端更紧凑的按钮尺寸 */\n    padding: 0.4rem 0.6rem;\n    font-size: 0.8125rem;\n  }\n  \n  .items-grid {\n    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\n    gap: 0.5rem;\n  }\n  \n  .info-grid {\n    grid-template-columns: 1fr;\n  }\n\n  /* 详情区域按钮在窄屏堆叠，避免溢出 */\n  .details-actions {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n  }\n\n  .details-actions .action-btn,\n  .details-actions .dialog-btn,\n  .details-actions .operation-btn,\n  .details-actions .card-btn {\n    flex: 1 1 100%;\n    max-width: 100%;\n  }\n}\n\n/* === 特殊状态样式 === */\n.success-indicator {\n  color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.1);\n  border-color: rgba(var(--color-success-rgb), 0.3);\n}\n\n.warning-indicator {\n  color: var(--color-warning);\n  background: rgba(var(--color-warning-rgb), 0.1);\n  border-color: rgba(var(--color-warning-rgb), 0.3);\n}\n\n.error-indicator {\n  color: var(--color-error);\n  background: rgba(var(--color-error-rgb), 0.1);\n  border-color: rgba(var(--color-error-rgb), 0.3);\n}\n\n.info-indicator {\n  color: var(--color-info);\n  background: rgba(var(--color-info-rgb), 0.1);\n  border-color: rgba(var(--color-info-rgb), 0.3);\n}\n\n/* === 动画效果 === */\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.fade-in-up {\n  animation: fadeInUp 0.3s ease-out;\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n.pulse {\n  animation: pulse 2s infinite;\n}\n",""]);const i=l},1667:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.left-sidebar[data-v-722579ba] {\n  width: 100%;\n  height: 100%;\n  padding: 16px;\n  box-sizing: border-box;\n  font-family: var(--font-family-sans-serif);\n  display: flex;\n  flex-direction: column;\n  background: var(--color-surface);\n}\n.sidebar-header[data-v-722579ba] {\n  margin-bottom: 16px;\n  padding-bottom: 12px;\n  border-bottom: 1px solid var(--color-border);\n}\n.sidebar-title[data-v-722579ba] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n.title-icon[data-v-722579ba] {\n  color: var(--color-primary);\n}\n.sidebar-content[data-v-722579ba] {\n  flex: 1;\n  overflow-y: auto;\n  scrollbar-width: thin;\n  scrollbar-color: rgba(0, 0, 0, 0.2) transparent;\n  padding-right: 4px;\n}\n.sidebar-content[data-v-722579ba]::-webkit-scrollbar {\n  width: 4px;\n}\n.sidebar-content[data-v-722579ba]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.sidebar-content[data-v-722579ba]::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 2px;\n}\n[data-theme=\"dark\"] .sidebar-content[data-v-722579ba]::-webkit-scrollbar-thumb {\n  background: var(--scrollbar-thumb-color);\n}\n\n/* 功能分区样式 */\n.function-section[data-v-722579ba] {\n  margin-bottom: 24px;\n}\n.section-title[data-v-722579ba] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  margin-bottom: 12px;\n  padding: 0 4px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.function-group[data-v-722579ba] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.system-section[data-v-722579ba] {\n  border-top: 1px solid var(--color-border);\n  padding-top: 16px;\n}\n.divider[data-v-722579ba] {\n  height: 1px;\n  background: var(--color-border);\n  margin: 16px 0;\n}\n\n/* 增强的按钮样式 */\n.function-btn[data-v-722579ba] {\n  display: flex;\n  align-items: center;\n  padding: 12px 16px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  font-family: inherit;\n  text-align: left;\n  width: 100%;\n  position: relative;\n  overflow: hidden;\n}\n.function-btn[data-v-722579ba]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, var(--color-surface-light), transparent);\n  transition: left 0.5s ease;\n}\n.function-btn[data-v-722579ba]:hover::before {\n  left: 100%;\n}\n.function-btn[data-v-722579ba]:hover {\n  background: var(--color-surface-light);\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 20px rgba(var(--color-primary-rgb), 0.15);\n}\n.function-btn[data-v-722579ba]:active {\n  transform: translateY(-1px) scale(0.98);\n  transition: all 0.1s ease;\n}\n\n/* 按钮图标区域 */\n.btn-icon[data-v-722579ba] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  background: var(--color-background);\n  margin-right: 12px;\n  transition: all 0.3s ease;\n  flex-shrink: 0;\n}\n\n/* 按钮内容区域 */\n.btn-content[data-v-722579ba] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n}\n.btn-text[data-v-722579ba] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n  line-height: 1.2;\n}\n.btn-desc[data-v-722579ba] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  line-height: 1.1;\n}\n\n/* 按钮箭头 */\n.btn-arrow[data-v-722579ba] {\n  color: var(--color-text-muted);\n  transition: all 0.3s ease;\n  margin-left: 8px;\n}\n.function-btn:hover .btn-arrow[data-v-722579ba] {\n  color: var(--color-primary);\n  transform: translateX(2px);\n}\n\n/* 无箭头按钮的右边距补偿 */\n.function-btn.no-arrow .btn-content[data-v-722579ba] {\n  margin-right: 22px; /* 14px (箭头宽度) + 8px (margin-left) */\n}\n\n/* 分类颜色主题 */\n.function-btn.primary .btn-icon[data-v-722579ba] {\n  background: rgba(59, 130, 246, 0.1);\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n.function-btn.primary:hover .btn-icon[data-v-722579ba] {\n  background: rgba(59, 130, 246, 0.15);\n  border-color: rgba(59, 130, 246, 0.3);\n}\n.function-btn.secondary .btn-icon[data-v-722579ba] {\n  background: rgba(16, 185, 129, 0.1);\n  border: 1px solid rgba(16, 185, 129, 0.2);\n}\n.function-btn.secondary:hover .btn-icon[data-v-722579ba] {\n  background: rgba(16, 185, 129, 0.15);\n  border-color: rgba(16, 185, 129, 0.3);\n}\n.function-btn.accent .btn-icon[data-v-722579ba] {\n  background: rgba(139, 92, 246, 0.1);\n  border: 1px solid rgba(139, 92, 246, 0.2);\n}\n.function-btn.accent:hover .btn-icon[data-v-722579ba] {\n  background: rgba(139, 92, 246, 0.15);\n  border-color: rgba(139, 92, 246, 0.3);\n}\n.function-btn.system .btn-icon[data-v-722579ba] {\n  background: rgba(107, 114, 128, 0.1);\n  border: 1px solid rgba(107, 114, 128, 0.2);\n}\n.function-btn.system:hover .btn-icon[data-v-722579ba] {\n  background: rgba(107, 114, 128, 0.15);\n  border-color: rgba(107, 114, 128, 0.3);\n}\n\n/* 禁用状态样式 */\n.function-btn[data-v-722579ba]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: var(--color-surface-light);\n}\n.function-btn[data-v-722579ba]:disabled:hover {\n  background: var(--color-surface-light);\n  transform: none;\n  box-shadow: none;\n  border-color: var(--color-border);\n}\n.function-btn:disabled .btn-icon[data-v-722579ba] {\n  background: var(--color-background);\n  border-color: var(--color-border);\n}\n.function-btn:disabled .btn-arrow[data-v-722579ba] {\n  opacity: 0.3;\n  transform: none;\n}\n.function-btn.disabled[data-v-722579ba] {\n  position: relative;\n  opacity: 0.6;\n}\n.disabled-text[data-v-722579ba] {\n  font-style: italic;\n  opacity: 0.7;\n}\n\n/* 退出按钮特殊样式 */\n.exit-btn[data-v-722579ba] {\n  border-color: var(--color-error);\n  background: rgba(239, 68, 68, 0.05);\n}\n.exit-btn[data-v-722579ba]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: var(--color-error);\n  box-shadow: 0 4px 20px rgba(239, 68, 68, 0.15);\n}\n.exit-btn .btn-text[data-v-722579ba] {\n  color: var(--color-error);\n}\n.exit-btn .btn-desc[data-v-722579ba] {\n  color: rgba(239, 68, 68, 0.7);\n}\n.exit-btn .btn-icon[data-v-722579ba] {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.2);\n}\n.exit-btn:hover .btn-icon[data-v-722579ba] {\n  background: rgba(239, 68, 68, 0.15);\n  border-color: rgba(239, 68, 68, 0.3);\n}\n\n/* 深色主题无需额外适配：已统一使用主题变量 */\n\n/* 响应式适配 */\n@media (max-width: 768px) {\n.left-sidebar[data-v-722579ba] {\n    padding: 12px;\n}\n.function-btn[data-v-722579ba] {\n    padding: 10px 14px;\n}\n.btn-icon[data-v-722579ba] {\n    width: 32px;\n    height: 32px;\n}\n.btn-text[data-v-722579ba] {\n    font-size: 0.85rem;\n}\n.btn-desc[data-v-722579ba] {\n    font-size: 0.7rem;\n}\n}\n",""]);const i=l},1774:(e,n,t)=>{t.d(n,{Ey:()=>x,nY:()=>$});var a=t(4061),o=!1;function r(e,n,t){return Array.isArray(e)?(e.length=Math.max(e.length,n),e.splice(n,1,t),t):(e[n]=t,t)}let l;const i=e=>l=e,c=Symbol();function s(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var d;!function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"}(d||(d={}));const m="undefined"!=typeof window,p=(()=>"object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:"object"==typeof globalThis?globalThis:{HTMLElement:null})();function v(e,n,t){const a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){h(a.response,n,t)},a.onerror=function(){console.error("could not download file")},a.send()}function u(e){const n=new XMLHttpRequest;n.open("HEAD",e,!1);try{n.send()}catch(e){}return n.status>=200&&n.status<=299}function g(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){const t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}const f="object"==typeof navigator?navigator:{userAgent:""},b=(()=>/Macintosh/.test(f.userAgent)&&/AppleWebKit/.test(f.userAgent)&&!/Safari/.test(f.userAgent))(),h=m?"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype&&!b?function(e,n="download",t){const a=document.createElement("a");a.download=n,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?u(a.href)?v(e,n,t):(a.target="_blank",g(a)):g(a)):(a.href=URL.createObjectURL(e),setTimeout(function(){URL.revokeObjectURL(a.href)},4e4),setTimeout(function(){g(a)},0))}:"msSaveOrOpenBlob"in f?function(e,n="download",t){if("string"==typeof e)if(u(e))v(e,n,t);else{const n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){g(n)})}else navigator.msSaveOrOpenBlob(function(e,{autoBom:n=!1}={}){return n&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,t),n)}:function(e,n,t,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return v(e,n,t);const o="application/octet-stream"===e.type,r=/constructor/i.test(String(p.HTMLElement))||"safari"in p,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&r||b)&&"undefined"!=typeof FileReader){const n=new FileReader;n.onloadend=function(){let e=n.result;if("string"!=typeof e)throw a=null,new Error("Wrong reader.result type");e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location.assign(e),a=null},n.readAsDataURL(e)}else{const n=URL.createObjectURL(e);a?a.location.assign(n):location.href=n,a=null,setTimeout(function(){URL.revokeObjectURL(n)},4e4)}}:()=>{},{assign:y}=Object;function x(){const e=(0,a.effectScope)(!0),n=e.run(()=>(0,a.ref)({}));let t=[],r=[];const l=(0,a.markRaw)({install(e){i(l),o||(l._a=e,e.provide(c,l),e.config.globalProperties.$pinia=l,r.forEach(e=>t.push(e)),r=[])},use(e){return this._a||o?t.push(e):r.push(e),this},_p:t,_a:null,_e:e,_s:new Map,state:n});return l}const k=()=>{};function w(e,n,t,o=k){e.push(n);const r=()=>{const t=e.indexOf(n);t>-1&&(e.splice(t,1),o())};return!t&&(0,a.getCurrentScope)()&&(0,a.onScopeDispose)(r),r}function N(e,...n){e.slice().forEach(e=>{e(...n)})}const E=e=>e(),V=Symbol(),C=Symbol();function z(e,n){e instanceof Map&&n instanceof Map?n.forEach((n,t)=>e.set(t,n)):e instanceof Set&&n instanceof Set&&n.forEach(e.add,e);for(const t in n){if(!n.hasOwnProperty(t))continue;const o=n[t],r=e[t];s(r)&&s(o)&&e.hasOwnProperty(t)&&!(0,a.isRef)(o)&&!(0,a.isReactive)(o)?e[t]=z(r,o):e[t]=o}return e}const S=Symbol();function B(e){return!s(e)||!e.hasOwnProperty(S)}const{assign:D}=Object;function A(e){return!(!(0,a.isRef)(e)||!e.effect)}function _(e,n,t={},l,c,s){let m;const p=D({actions:{}},t),v={deep:!0};let u,g,f,b=[],h=[];const y=l.state.value[e];let x;function S(n){let t;u=g=!1,"function"==typeof n?(n(l.state.value[e]),t={type:d.patchFunction,storeId:e,events:f}):(z(l.state.value[e],n),t={type:d.patchObject,payload:n,storeId:e,events:f});const o=x=Symbol();(0,a.nextTick)().then(()=>{x===o&&(u=!0)}),g=!0,N(b,t,l.state.value[e])}s||y||(o?r(l.state.value,e,{}):l.state.value[e]={}),(0,a.ref)({});const _=s?function(){const{state:e}=t,n=e?e():{};this.$patch(e=>{D(e,n)})}:k,$=(n,t="")=>{if(V in n)return n[C]=t,n;const a=function(){i(l);const t=Array.from(arguments),o=[],r=[];let c;N(h,{args:t,name:a[C],store:T,after:function(e){o.push(e)},onError:function(e){r.push(e)}});try{c=n.apply(this&&this.$id===e?this:T,t)}catch(e){throw N(r,e),e}return c instanceof Promise?c.then(e=>(N(o,e),e)).catch(e=>(N(r,e),Promise.reject(e))):(N(o,c),c)};return a[V]=!0,a[C]=t,a},I={_p:l,$id:e,$onAction:w.bind(null,h),$patch:S,$reset:_,$subscribe(n,t={}){const o=w(b,n,t.detached,()=>r()),r=m.run(()=>(0,a.watch)(()=>l.state.value[e],a=>{("sync"===t.flush?g:u)&&n({storeId:e,type:d.direct,events:f},a)},D({},v,t)));return o},$dispose:function(){m.stop(),b=[],h=[],l._s.delete(e)}};o&&(I._r=!1);const T=(0,a.reactive)(I);l._s.set(e,T);const j=(l._a&&l._a.runWithContext||E)(()=>l._e.run(()=>(m=(0,a.effectScope)()).run(()=>n({action:$}))));for(const n in j){const t=j[n];if((0,a.isRef)(t)&&!A(t)||(0,a.isReactive)(t))s||(y&&B(t)&&((0,a.isRef)(t)?t.value=y[n]:z(t,y[n])),o?r(l.state.value[e],n,t):l.state.value[e][n]=t);else if("function"==typeof t){const e=$(t,n);o?r(j,n,e):j[n]=e,p.actions[n]=t}}return o?Object.keys(j).forEach(e=>{r(T,e,j[e])}):(D(T,j),D((0,a.toRaw)(T),j)),Object.defineProperty(T,"$state",{get:()=>l.state.value[e],set:e=>{S(n=>{D(n,e)})}}),o&&(T._r=!0),l._p.forEach(e=>{D(T,m.run(()=>e({store:T,app:l._a,pinia:l,options:p})))}),y&&s&&t.hydrate&&t.hydrate(T.$state,y),u=!0,g=!0,T}function $(e,n,t){let s,d;const m="function"==typeof n;function p(e,t){const p=(0,a.hasInjectionContext)();return(e=e||(p?(0,a.inject)(c,null):null))&&i(e),(e=l)._s.has(s)||(m?_(s,n,d,e):function(e,n,t){const{state:l,actions:c,getters:s}=n,d=t.state.value[e];let m;m=_(e,function(){d||(o?r(t.state.value,e,l?l():{}):t.state.value[e]=l?l():{});const n=(0,a.toRefs)(t.state.value[e]);return D(n,c,Object.keys(s||{}).reduce((n,r)=>(n[r]=(0,a.markRaw)((0,a.computed)(()=>{i(t);const n=t._s.get(e);if(!o||n._r)return s[r].call(n,n)})),n),{}))},n,t,0,!0)}(s,d,e)),e._s.get(s)}return"string"==typeof e?(s=e,d=m?t:n):(d=e,s=e.id),p.$id=s,p}},1783:(e,n,t)=>{t.d(n,{A:()=>a});const a=(0,t(9596).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},1932:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.character-details-wrapper[data-v-5ffd8816] {\n  width: 100%;\n  height: 100%;\n  background: var(--color-background);\n  overflow-y: auto;\n}\n\n/* 加载和错误状�?*/\n.loading-container[data-v-5ffd8816], .error-container[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--color-text-secondary);\n}\n.loading-spinner[data-v-5ffd8816] {\n  width: 40px;\n  height: 40px;\n  border: 3px solid var(--color-border);\n  border-top: 3px solid var(--color-primary);\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 16px;\n}\n.error-icon[data-v-5ffd8816] {\n  margin-bottom: 16px;\n  color: var(--color-danger);\n}\n.retry-btn[data-v-5ffd8816] {\n  margin-top: 16px;\n  padding: 8px 16px;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n}\n\n/* 角色头部信息简化版 */\n.character-header[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 24px;\n  padding: 24px;\n  background: var(--color-surface);\n  border-bottom: 1px solid var(--color-border);\n  border-radius: 12px 12px 0 0;\n}\n\n/* 新版头部布局 */\n.header-modern[data-v-5ffd8816] {\n  flex-direction: column;\n  gap: 16px;\n}\n.header-main[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  gap: 16px;\n}\n.header-left[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  min-width: 0;\n  flex: 1;\n}\n.header-stats[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12px;\n  width: 100%;\n  padding-top: 12px;\n  border-top: 1px solid var(--color-border);\n}\n.stat-item[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 12px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n}\n.stat-label[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.stat-value[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.stat-value.gender.gender-男[data-v-5ffd8816] {\n  color: #3b82f6;\n}\n.stat-value.gender.gender-女[data-v-5ffd8816] {\n  color: #ec4899;\n}\n.stat-value.spirit-root[data-v-5ffd8816] {\n  color: var(--color-primary);\n}\n.stat-value.reputation[data-v-5ffd8816] {\n  color: var(--color-warning);\n}\n.avatar-circle[data-v-5ffd8816] {\n  width: 56px;\n  height: 56px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, var(--color-primary), var(--color-info));\n  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(var(--color-primary-rgb), 0.3);\n  flex-shrink: 0;\n}\n.avatar-initial[data-v-5ffd8816] {\n  color: #fff;\n  font-size: 1.25rem;\n  font-weight: 800;\n  letter-spacing: 1px;\n}\n.title-area[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  min-width: 0;\n}\n.meta-chips[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.meta-chip[data-v-5ffd8816] {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 10px;\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 999px;\n  white-space: nowrap;\n}\n.realm-chip[data-v-5ffd8816] {\n  color: var(--color-primary);\n  background: rgba(var(--color-primary-rgb), 0.06);\n  border-color: rgba(var(--color-primary-rgb), 0.35);\n}\n.age-chip[data-v-5ffd8816] {\n  color: var(--color-info);\n  background: rgba(var(--color-info-rgb), 0.06);\n  border-color: rgba(var(--color-info-rgb), 0.35);\n}\n.location-chip[data-v-5ffd8816] {\n  color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.06);\n  border-color: rgba(var(--color-success-rgb), 0.35);\n}\n.header-right[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.reputation-badge[data-v-5ffd8816] {\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 10px;\n  background: rgba(var(--color-warning-rgb), 0.12);\n  border: 1px solid rgba(var(--color-warning-rgb), 0.35);\n  border-radius: 10px;\n}\n.rep-label[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n}\n.rep-value[data-v-5ffd8816] {\n  font-weight: 700;\n  color: var(--color-warning);\n}\n.cultivation-compact[data-v-5ffd8816] {\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n}\n.cultivation-compact.mortal[data-v-5ffd8816] {\n  padding: 4px 8px;\n  background: rgba(var(--color-text-tertiary-rgb), 0.08);\n  border: 1px dashed rgba(var(--color-text-tertiary-rgb), 0.25);\n  border-radius: 8px;\n}\n.compact-bar[data-v-5ffd8816] {\n  width: 120px;\n  height: 6px;\n  background: rgba(var(--color-border-rgb), 0.5);\n  border-radius: 3px;\n  overflow: hidden;\n  position: relative;\n}\n.compact-progress[data-v-5ffd8816] {\n  height: 100%;\n  background: linear-gradient(90deg,\n    var(--color-info) 0%,\n    var(--color-success) 80%,\n    var(--color-warning) 100%\n  );\n  width: 0%;\n  transition: width 0.3s ease;\n  border-radius: 3px;\n}\n.compact-label[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 28px;\n}\n.compact-text[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  font-weight: 500;\n  color: var(--color-text);\n  font-variant-numeric: tabular-nums;\n  min-width: 45px;\n  text-align: right;\n}\n.character-gender[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-width: 80px;\n}\n.gender-symbol[data-v-5ffd8816] {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 2rem;\n  font-weight: bold;\n  color: white;\n  margin-bottom: 8px;\n  transition: all 0.3s ease;\n  background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n.gender-女 .gender-symbol[data-v-5ffd8816] {\n  background: linear-gradient(135deg, var(--color-accent), var(--color-accent-hover));\n  box-shadow: 0 4px 12px rgba(var(--color-accent-rgb), 0.3);\n}\n.gender-男 .gender-symbol[data-v-5ffd8816] {\n  background: linear-gradient(135deg, var(--color-info), var(--color-info-hover));\n  box-shadow: 0 4px 12px rgba(var(--color-info-rgb), 0.3);\n}\n.gender-text[data-v-5ffd8816] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n.character-info[data-v-5ffd8816] {\n  flex: 1;\n}\n.character-name[data-v-5ffd8816] {\n  margin: 0 0 16px 0;\n  font-size: 2rem;\n  font-weight: 700;\n  color: var(--color-text);\n}\n.character-details[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 12px;\n}\n.detail-item[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.label[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.value[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.realm[data-v-5ffd8816] {\n  color: var(--color-warning);\n  font-weight: 700;\n}\n.gender-value[data-v-5ffd8816] {\n  padding: 4px 12px;\n  border-radius: 16px;\n  font-weight: 600;\n  font-size: 0.9rem;\n}\n.gender-value.gender-女[data-v-5ffd8816] {\n  background: rgba(var(--color-accent-rgb), 0.1);\n  color: var(--color-accent);\n  border: 1px solid rgba(var(--color-accent-rgb), 0.3);\n}\n.gender-value.gender-男[data-v-5ffd8816] {\n  background: transparent;\n  color: var(--color-text);\n  border: none;\n}\n.character-stats[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  min-width: 120px;\n}\n.stat-item[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  gap: 8px;\n}\n.stat-label[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.stat-value[data-v-5ffd8816] {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--color-primary);\n}\n.stat-display[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 4px;\n}\n.stat-value.reputation[data-v-5ffd8816] {\n  color: var(--color-warning);\n  text-shadow: 0 1px 2px rgba(245, 158, 11, 0.3);\n}\n.stat-display.cultivation[data-v-5ffd8816] {\n  width: 100%;\n  min-width: 100px;\n}\n\n/* 凡人修炼状态样�?*/\n.stat-display.mortal-state[data-v-5ffd8816] {\n  padding: 8px 16px;\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-radius: 6px;\n  border: 1px dashed rgba(var(--color-primary-rgb), 0.3);\n}\n.mortal-hint[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-tertiary);\n  font-weight: 400;\n  opacity: 0.9;\n}\n.cultivation-bar[data-v-5ffd8816] {\n  width: 100%;\n  height: 8px;\n  background: var(--color-border);\n  border-radius: 4px;\n  overflow: hidden;\n  margin-bottom: 4px;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n.cultivation-progress[data-v-5ffd8816] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-info), var(--color-success));\n  border-radius: 4px;\n  transition: width 0.5s ease;\n  box-shadow: 0 1px 2px rgba(59, 130, 246, 0.3);\n}\n.cultivation-text[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-info);\n  white-space: nowrap;\n}\n\n/* 内容网格 - 改为更灵活的响应式布局 */\n.content-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 16px;\n  padding: 16px;\n  max-width: 100%;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n\n/* 信息区块优化 */\n.info-section[data-v-5ffd8816] {\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 16px;\n  box-shadow: none;\n  transition: border-color 0.2s ease, background-color 0.2s ease;\n  position: relative;\n  overflow: hidden;\n  box-sizing: border-box;\n  min-width: 0;\n}\n.info-section[data-v-5ffd8816]:hover {\n  transform: none;\n  box-shadow: none;\n  border-color: var(--color-border-hover);\n}\n.section-title[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: 0 0 20px 0;\n  font-size: 1.2rem;\n  font-weight: 700;\n  color: var(--color-text);\n  padding-bottom: 12px;\n  border-bottom: 2px solid rgba(var(--color-border-rgb), 0.3);\n  position: relative;\n}\n.section-title[data-v-5ffd8816]::after {\n  content: '';\n  position: absolute;\n  bottom: -2px;\n  left: 0;\n  width: 40px;\n  height: 2px;\n  background: var(--color-primary);\n  border-radius: 1px;\n}\n.title-icon[data-v-5ffd8816] {\n  color: var(--color-primary);\n  flex-shrink: 0;\n  padding: 8px;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border-radius: 8px;\n}\n\n/* 生命状�?*/\n.vitals-grid[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.vital-item[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.vital-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: var(--color-text);\n}\n.vital-bar[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.bar-container[data-v-5ffd8816] {\n  flex: 1;\n  height: 12px;\n  background: var(--color-border);\n  border-radius: 6px;\n  overflow: hidden;\n}\n.bar-fill[data-v-5ffd8816] {\n  height: 100%;\n  transition: width 0.3s ease;\n}\n.bar-danger[data-v-5ffd8816] { background: linear-gradient(90deg, var(--color-danger), var(--color-danger-hover));\n}\n.bar-info[data-v-5ffd8816] { background: linear-gradient(90deg, var(--color-info), var(--color-info-hover));\n}\n.bar-accent[data-v-5ffd8816] { background: linear-gradient(90deg, var(--color-warning), var(--color-warning-hover));\n}\n\n/* 生命状态颜�?红蓝金三�?*/\n.bar-red[data-v-5ffd8816] { background: linear-gradient(90deg, var(--vital-health), var(--vital-health));\n}\n.bar-blue[data-v-5ffd8816] { background: linear-gradient(90deg, var(--vital-lingqi), var(--vital-lingqi));\n}\n.bar-gold[data-v-5ffd8816] { background: linear-gradient(90deg, var(--vital-spirit), var(--vital-spirit));\n}\n.vital-text[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 60px;\n}\n\n/* 天赋与灵�?*/\n.talent-grid[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.talent-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n}\n.talent-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  margin-right: 1rem;\n}\n.talent-value[data-v-5ffd8816] {\n  font-weight: 600;\n}\n.tier[data-v-5ffd8816], .spirit-root[data-v-5ffd8816] {\n  padding: 4px 12px;\n  border-radius: 16px;\n  font-size: 0.85rem;\n}\n.tier[data-v-5ffd8816] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n}\n.spirit-root[data-v-5ffd8816] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n}\n.talent-tags[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 12px;\n}\n.talent-tag[data-v-5ffd8816] {\n  padding: 4px 10px;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  color: var(--color-primary);\n  border-radius: 12px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n\n/* 状态效�?*/\n.effects-list[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.effect-item[data-v-5ffd8816] {\n  padding: 12px;\n  border-radius: 8px;\n  border-left: 4px solid;\n}\n.effect-buff[data-v-5ffd8816] {\n  border-color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.1);\n}\n.effect-debuff[data-v-5ffd8816] {\n  border-color: var(--color-danger);\n  background: rgba(var(--color-danger-rgb), 0.1);\n}\n.effect-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 4px;\n}\n.effect-name[data-v-5ffd8816] {\n  font-weight: 600;\n}\n.effect-remove-btn[data-v-5ffd8816] {\n  padding: 4px;\n  background: transparent;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n}\n.effect-remove-btn[data-v-5ffd8816]:hover {\n  background: var(--color-danger);\n  border-color: var(--color-danger);\n  color: white;\n}\n.effect-duration[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n}\n.effect-description[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text);\n  line-height: 1.4;\n  margin-bottom: 8px;\n}\n.effect-time-info[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  margin-top: 8px;\n  padding-top: 8px;\n  border-top: 1px solid var(--color-border);\n}\n.body-parts-list[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.body-part-item[data-v-5ffd8816] {\n  padding: 12px;\n  background: var(--color-surface);\n  border-radius: 8px;\n  border-left: 4px solid var(--color-info);\n}\n.part-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.part-name[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.part-level[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  font-weight: 600;\n  padding: 2px 8px;\n  border-radius: 10px;\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n}\n.part-description[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  line-height: 1.5;\n}\n.effect-created[data-v-5ffd8816],\n.effect-remaining[data-v-5ffd8816] {\n  opacity: 0.8;\n}\n\n/* 六司属�?*/\n.basic-info-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 12px;\n}\n.basic-info-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  background: var(--color-surface-light);\n  border-radius: 6px;\n  min-height: 36px;\n}\n.basic-info-item .info-label[data-v-5ffd8816] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.basic-info-item .info-value[data-v-5ffd8816] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.basic-info-item .info-value.gender.gender-男[data-v-5ffd8816] {\n  color: #3b82f6;\n}\n.basic-info-item .info-value.gender.gender-女[data-v-5ffd8816] {\n  color: #ec4899;\n}\n.basic-info-item .info-value.origin[data-v-5ffd8816] {\n  color: var(--color-accent);\n}\n.basic-info-item .info-value.world[data-v-5ffd8816] {\n  color: var(--color-primary);\n}\n.basic-info-item .info-value.race[data-v-5ffd8816] {\n  color: var(--color-info);\n}\n.attributes-display[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n.attribute-group-title[data-v-5ffd8816] {\n  margin: 0 0 12px 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  white-space: nowrap;\n}\n.attributes-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n  gap: 12px;\n}\n.attributes-grid.compact[data-v-5ffd8816] {\n  grid-template-columns: repeat(3, minmax(80px, 1fr));\n  gap: 8px;\n}\n.attribute-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 12px;\n  border-radius: 8px;\n  background: var(--color-surface-light);\n  min-height: 44px;\n  min-width: 80px; /* 确保有足够空间显示完整属性名 */\n  width: 100%;\n  box-sizing: border-box;\n}\n.attribute-item.final[data-v-5ffd8816] {\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n  font-weight: 600;\n}\n.attribute-item.innate[data-v-5ffd8816] {\n  background: var(--color-surface-hover);\n}\n.attribute-item.acquired[data-v-5ffd8816] {\n  background: rgba(var(--color-border-rgb), 0.1);\n}\n.attribute-item.acquired.has-bonus[data-v-5ffd8816] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  border: 1px solid rgba(var(--color-success-rgb), 0.2);\n}\n.attr-name[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  white-space: nowrap;\n  flex: 1 1 auto;\n  min-width: 0;\n  overflow: visible;\n  text-overflow: initial;\n  padding-right: 8px;\n}\n.attr-value[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n  white-space: nowrap;\n  overflow: visible;\n  text-overflow: initial;\n  flex-shrink: 0;\n  min-width: auto;\n}\n.attribute-item.acquired.has-bonus .attr-value[data-v-5ffd8816] {\n  color: var(--color-success);\n}\n.attribute-breakdown[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: 1fr;\n  gap: 20px;\n}\n\n/* 功法系统交互样式 */\n.technique-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: background-color 0.2s ease;\n}\n.technique-header[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n}\n.technique-main[data-v-5ffd8816] {\n  flex: 1;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.technique-toggle[data-v-5ffd8816] {\n  margin-left: 12px;\n}\n.toggle-icon[data-v-5ffd8816] {\n  transition: transform 0.3s ease;\n  color: var(--color-text-secondary);\n}\n.toggle-icon.rotated[data-v-5ffd8816] {\n  transform: rotate(180deg);\n}\n.technique-details[data-v-5ffd8816] {\n  margin-top: 12px;\n  padding: 16px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n}\n.technique-description[data-v-5ffd8816] {\n  margin-bottom: 16px;\n}\n.technique-description p[data-v-5ffd8816] {\n  margin: 0;\n  color: var(--color-text);\n  line-height: 1.6;\n  font-style: italic;\n}\n.technique-effects[data-v-5ffd8816] {\n  border-top: 1px solid var(--color-border);\n  padding-top: 12px;\n}\n.effects-title[data-v-5ffd8816] {\n  margin: 0 0 8px 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.effects-list[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.effect-item[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.85rem;\n}\n.effect-label[data-v-5ffd8816] {\n  color: var(--color-text-secondary);\n  min-width: 80px;\n}\n.effect-value[data-v-5ffd8816] {\n  color: var(--color-success);\n  font-weight: 600;\n}\n.attribute-bonuses[data-v-5ffd8816] {\n  display: flex;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n.bonus-tag[data-v-5ffd8816] {\n  padding: 2px 6px;\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n  border-radius: 4px;\n  font-size: 0.75rem;\n  border: 1px solid rgba(var(--color-success-rgb), 0.3);\n}\n.no-effects-text[data-v-5ffd8816] {\n  color: var(--color-text-secondary);\n  font-style: italic;\n  font-size: 0.85rem;\n  padding-top: 8px;\n}\n\n/* 技能系统样�?*/\n.skills-header[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: background-color 0.2s ease;\n}\n.skills-header[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n}\n.skills-count[data-v-5ffd8816] {\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n  margin-left: auto;\n}\n.skills-preview[data-v-5ffd8816] {\n  margin-top: 12px;\n}\n.skills-list-compact[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n.skill-tag.compact[data-v-5ffd8816] {\n  padding: 4px 8px;\n  font-size: 0.8rem;\n}\n.more-skills[data-v-5ffd8816] {\n  color: var(--color-text-secondary);\n  font-style: italic;\n  font-size: 0.8rem;\n  padding: 4px 8px;\n}\n.skills-details[data-v-5ffd8816] {\n  margin-top: 16px;\n  padding: 16px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n}\n.skill-category[data-v-5ffd8816] {\n  margin-bottom: 20px;\n}\n.skill-category[data-v-5ffd8816]:last-child {\n  margin-bottom: 0;\n}\n.category-title[data-v-5ffd8816] {\n  margin: 0 0 12px 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  padding-bottom: 6px;\n  border-bottom: 1px solid rgba(var(--color-primary-rgb), 0.2);\n}\n.skills-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\n  gap: 10px;\n}\n.skill-card[data-v-5ffd8816] {\n  padding: 12px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  position: relative;\n}\n.skill-card[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.1);\n}\n.skill-card.skill-locked[data-v-5ffd8816] {\n  opacity: 0.6;\n  border-color: var(--color-border);\n  border-style: dashed;\n}\n.skill-card.skill-locked[data-v-5ffd8816]:hover {\n  border-color: var(--color-warning);\n}\n.skill-name[data-v-5ffd8816] {\n  font-weight: 600;\n  font-size: 0.9rem;\n  color: var(--color-text);\n  margin-bottom: 4px;\n}\n.skill-type[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n}\n.skill-source[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  color: var(--color-accent);\n  font-style: italic;\n}\n.skill-proficiency-mini[data-v-5ffd8816] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  padding: 2px 4px;\n  background: rgba(var(--color-info-rgb), 0.1);\n  border-radius: 4px;\n  width: fit-content;\n}\n.skill-unlock[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  color: var(--color-warning);\n  font-style: italic;\n}\n.skill-status[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n.unlock-icon[data-v-5ffd8816] {\n  color: var(--color-success);\n}\n\n/* 修炼功法 */\n.cultivation-display[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n.technique-info[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.technique-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.technique-name[data-v-5ffd8816] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  cursor: pointer;\n}\n.technique-quality[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  padding: 4px 8px;\n  background: var(--color-surface-hover);\n  border-radius: 12px;\n}\n.technique-progress[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.progress-item[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.progress-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  min-width: 80px;\n}\n.progress-bar[data-v-5ffd8816] {\n  flex: 1;\n  height: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  overflow: hidden;\n  box-shadow: inset 0 1px 3px rgba(var(--color-border-rgb), 0.15);\n}\n.progress-fill[data-v-5ffd8816] {\n  height: 100%;\n  min-width: 2px; /* 确保即使0%时也有最小宽度显�?*/\n  background: linear-gradient(90deg, var(--color-primary), var(--color-primary-hover));\n  transition: width 0.3s ease;\n  border-radius: 4px; /* 稍微圆润的角 */\n}\n.progress-text[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 40px;\n}\n.learned-skills[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.skills-title[data-v-5ffd8816] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.skills-list[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.skill-tag[data-v-5ffd8816] {\n  padding: 6px 12px;\n  background: var(--color-info);\n  color: white;\n  border-radius: 16px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n\n/* 三千大道 */\n.dao-list[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.dao-header-section[data-v-5ffd8816] {\n  margin-bottom: 12px;\n}\n.dao-summary[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 0;\n}\n.dao-count[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n.dao-expand-btn[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  background: none;\n  border: 1px solid var(--color-border);\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.dao-expand-btn[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.dao-preview[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.dao-details[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.dao-item[data-v-5ffd8816] {\n  padding: 12px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.dao-item[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.1);\n}\n.dao-item.compact[data-v-5ffd8816] {\n  padding: 8px 10px;\n}\n.dao-item.detailed[data-v-5ffd8816] {\n  padding: 16px;\n}\n.more-dao[data-v-5ffd8816] {\n  padding: 8px 12px;\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 0.8rem;\n  font-style: italic;\n  border: 1px dashed var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n}\n.dao-stats[data-v-5ffd8816] {\n  margin-top: 12px;\n  padding-top: 12px;\n  border-top: 1px solid rgba(var(--color-border-rgb), 0.5);\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 8px;\n}\n.dao-stats .stat-item[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n.dao-stats .stat-label[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 2px;\n}\n.dao-stats .stat-value[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.dao-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.dao-name[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.dao-stage[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  background: var(--color-info);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 10px;\n}\n.dao-progress[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.progress-bar.small[data-v-5ffd8816] {\n  height: 6px;\n}\n.progress-text.small[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  min-width: 35px;\n}\n\n/* 人际关系 */\n.relationships-summary[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.relationship-stats[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n  gap: 12px;\n}\n.relationship-categories[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.category-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  background: var(--color-surface-light);\n  border-radius: 6px;\n}\n.category-name[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text);\n}\n.category-count[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-primary);\n}\n\n/* 背包概览 */\n.inventory-summary[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n.inventory-stats .stat-group[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.spirit-stones[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.stones-title[data-v-5ffd8816] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.stones-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n}\n.stone-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  border-radius: 6px;\n  font-size: 0.85rem;\n}\n.grade-common[data-v-5ffd8816] { background: rgba(128, 128, 128, 0.1);\n}\n.grade-rare[data-v-5ffd8816] { background: rgba(59, 130, 246, 0.1);\n}\n.grade-epic[data-v-5ffd8816] { background: rgba(147, 51, 234, 0.1);\n}\n.grade-legend[data-v-5ffd8816] { background: rgba(245, 158, 11, 0.1);\n}\n.stone-name[data-v-5ffd8816] {\n  color: var(--color-text);\n}\n.stone-count[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n\n/* 宗门信息 */\n.sect-info[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.sect-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.sect-name[data-v-5ffd8816] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.sect-type[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  padding: 4px 8px;\n  background: var(--color-primary);\n  color: white;\n  border-radius: 12px;\n}\n.sect-details[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.detail-row[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.detail-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n}\n.detail-value[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n\n/* 空状�?*/\n.empty-state[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-icon[data-v-5ffd8816] {\n  margin-bottom: 8px;\n  opacity: 0.6;\n  color: var(--color-text-muted);\n}\n\n/* 品质颜色 */\n.border-quality-神品[data-v-5ffd8816], .text-quality-神品[data-v-5ffd8816] { color: #ef4444 !important;\n}\n.border-quality-极品[data-v-5ffd8816], .text-quality-极品[data-v-5ffd8816] { color: #f59e0b !important;\n}\n.border-quality-上品[data-v-5ffd8816], .text-quality-上品[data-v-5ffd8816] { color: #8b5cf6 !important;\n}\n.border-quality-中品[data-v-5ffd8816], .text-quality-中品[data-v-5ffd8816] { color: #3b82f6 !important;\n}\n.border-quality-下品[data-v-5ffd8816], .text-quality-下品[data-v-5ffd8816] { color: #10b981 !important;\n}\n.border-quality-凡品[data-v-5ffd8816], .text-quality-凡品[data-v-5ffd8816] { color: #84cc16 !important;\n}\n.border-quality-未知[data-v-5ffd8816], .text-quality-未知[data-v-5ffd8816] { color: var(--color-text) !important;\n}\n\n/* 宗门关系颜色 */\n.relationship-恶劣[data-v-5ffd8816] { color: var(--color-danger) !important;\n}\n.relationship-一般[data-v-5ffd8816] { color: var(--color-text-secondary) !important;\n}\n.relationship-良好[data-v-5ffd8816] { color: var(--color-success) !important;\n}\n.relationship-亲密[data-v-5ffd8816] { color: var(--color-info) !important;\n}\n\n/* 响应式设�?*/\n@media (max-width: 1400px) {\n.content-grid[data-v-5ffd8816] {\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: 12px;\n    padding: 12px;\n}\n}\n@media (max-width: 1200px) {\n.content-grid[data-v-5ffd8816] {\n    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));\n    gap: 12px;\n}\n.right-column[data-v-5ffd8816] {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n    gap: 12px;\n}\n.right-column .info-section[data-v-5ffd8816] {\n    margin-bottom: 0;\n}\n}\n@media (max-width: 900px) {\n.content-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    gap: 12px;\n    padding: 8px;\n}\n.right-column[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    gap: 12px;\n}\n}\n@media (max-width: 640px) {\n.character-header[data-v-5ffd8816] {\n    flex-direction: column;\n    text-align: center;\n    gap: 12px;\n    padding: 16px;\n}\n.header-left[data-v-5ffd8816] { justify-content: center;\n}\n.header-right[data-v-5ffd8816] { width: 100%; justify-content: center; flex-wrap: wrap;\n}\n.compact-bar[data-v-5ffd8816] { width: 60%;\n}\n.character-details[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    text-align: center;\n    gap: 8px;\n}\n.content-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    padding: 8px;\n    gap: 12px;\n}\n.right-column[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n.info-section[data-v-5ffd8816] {\n    padding: 12px;\n    margin-bottom: 12px;\n    border-radius: 8px;\n}\n.attributes-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    gap: 8px;\n}\n.attributes-grid.compact[data-v-5ffd8816] {\n    grid-template-columns: repeat(2, minmax(70px, 1fr));\n    gap: 8px;\n}\n.attribute-breakdown[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    gap: 12px;\n}\n.stones-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n\n\n  /* 确保文字显示完整 */\n.attr-name[data-v-5ffd8816], .attr-value[data-v-5ffd8816] {\n    white-space: nowrap;\n    overflow: visible;\n    text-overflow: initial;\n}\n.attribute-item[data-v-5ffd8816] {\n    min-height: 36px;\n    padding: 8px;\n    min-width: 70px; /* 确保移动端也有足够空�?*/\n    width: 100%;\n}\n.character-name[data-v-5ffd8816] {\n    font-size: 1.6rem;\n}\n.section-title[data-v-5ffd8816] {\n    font-size: 1rem;\n}\n}\n@media (max-width: 480px) {\n.character-details-wrapper[data-v-5ffd8816] {\n    font-size: 14px;\n}\n.character-header[data-v-5ffd8816] {\n    padding: 12px;\n    gap: 8px;\n}\n.header-main[data-v-5ffd8816] {\n    flex-direction: column;\n    align-items: flex-start;\n}\n.header-right[data-v-5ffd8816] {\n    width: 100%;\n}\n.header-stats[data-v-5ffd8816] {\n    padding-top: 8px;\n    gap: 8px;\n}\n.stat-item[data-v-5ffd8816] {\n    flex: 1 1 calc(50% - 4px);\n    min-width: 120px;\n}\n.gender-symbol[data-v-5ffd8816] {\n    width: 40px;\n    height: 40px;\n    font-size: 1.3rem;\n}\n.character-name[data-v-5ffd8816] {\n    font-size: 1.4rem;\n}\n.content-grid[data-v-5ffd8816] {\n    padding: 6px;\n    gap: 8px;\n}\n.info-section[data-v-5ffd8816] {\n    padding: 10px;\n    margin-bottom: 8px;\n    border-radius: 6px;\n}\n.section-title[data-v-5ffd8816] {\n    font-size: 0.9rem;\n    margin-bottom: 12px;\n}\n.attributes-grid.compact[data-v-5ffd8816] {\n    grid-template-columns: repeat(2, minmax(60px, 1fr));\n    gap: 6px;\n}\n.attribute-item[data-v-5ffd8816] {\n    padding: 6px;\n    min-height: 32px;\n    min-width: 60px; /* 确保超小屏幕也有足够空间 */\n}\n.attr-name[data-v-5ffd8816] {\n    font-size: 0.8rem;\n}\n.attr-value[data-v-5ffd8816] {\n    font-size: 0.85rem;\n}\n.skill-card[data-v-5ffd8816] {\n    padding: 8px;\n}\n.dao-item[data-v-5ffd8816] {\n    padding: 8px;\n}\n.technique-progress[data-v-5ffd8816] {\n    gap: 8px;\n}\n.progress-item[data-v-5ffd8816] {\n    gap: 8px;\n}\n.progress-label[data-v-5ffd8816] {\n    min-width: 60px;\n    font-size: 0.8rem;\n}\n}\n\n/* 自定义弹窗样�?*/\n.modal-overlay[data-v-5ffd8816] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  z-index: 3000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(8px);\n  animation: overlay-fade-in-5ffd8816 0.3s ease-out;\n}\n@keyframes overlay-fade-in-5ffd8816 {\nfrom { opacity: 0;\n}\nto { opacity: 1;\n}\n}\n.skill-modal[data-v-5ffd8816], .dao-modal[data-v-5ffd8816] {\n  background: var(--color-surface);\n  border-radius: 20px;\n  width: 100%;\n  max-width: 500px;\n  max-height: 80vh;\n  overflow: hidden;\n  box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);\n  animation: modal-slide-up-5ffd8816 0.4s cubic-bezier(0.16, 1, 0.3, 1);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n@keyframes modal-slide-up-5ffd8816 {\nfrom {\n    opacity: 0;\n    transform: translateY(40px) scale(0.95);\n}\nto {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n}\n.modal-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 24px 28px 20px 28px;\n  border-bottom: 1px solid var(--color-border);\n  background: linear-gradient(135deg, var(--color-surface-light), rgba(var(--color-primary-rgb), 0.05));\n  position: relative;\n}\n.modal-header[data-v-5ffd8816]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 3px;\n  background: linear-gradient(90deg, var(--color-primary), var(--color-accent), var(--color-success));\n}\n.modal-header h3[data-v-5ffd8816] {\n  margin: 0;\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: var(--color-text);\n  background: linear-gradient(135deg, var(--color-text), var(--color-primary));\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n.modal-close-btn[data-v-5ffd8816] {\n  background: var(--color-surface-hover);\n  border: 1px solid var(--color-border);\n  padding: 8px;\n  border-radius: 10px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  transition: all 0.3s ease;\n}\n.modal-close-btn[data-v-5ffd8816]:hover {\n  background: var(--color-danger);\n  border-color: var(--color-danger);\n  color: white;\n  transform: scale(1.1);\n}\n.modal-content[data-v-5ffd8816] {\n  padding: 24px 28px 28px 28px;\n  overflow-y: auto;\n  max-height: calc(80vh - 80px);\n}\n\n/* 技能详情样�?*/\n.skill-detail-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 16px;\n  margin-bottom: 24px;\n}\n.skill-detail-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  background: var(--color-surface-light);\n  border-radius: 12px;\n  border: 1px solid var(--color-border);\n  transition: all 0.2s ease;\n}\n.skill-detail-item[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: rgba(var(--color-primary-rgb), 0.3);\n}\n.detail-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.detail-value[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.status-unlocked[data-v-5ffd8816] {\n  color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.1);\n  padding: 4px 8px;\n  border-radius: 6px;\n  font-size: 0.85rem;\n}\n.status-locked[data-v-5ffd8816] {\n  color: var(--color-warning);\n  background: rgba(var(--color-warning-rgb), 0.1);\n  padding: 4px 8px;\n  border-radius: 6px;\n  font-size: 0.85rem;\n}\n.skill-description[data-v-5ffd8816] {\n  background: linear-gradient(135deg, var(--color-surface-light), rgba(var(--color-info-rgb), 0.05));\n  border-radius: 12px;\n  padding: 20px;\n  border-left: 4px solid var(--color-info);\n}\n.skill-description h4[data-v-5ffd8816] {\n  margin: 0 0 12px 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-info);\n}\n.skill-description p[data-v-5ffd8816] {\n  margin: 0;\n  color: var(--color-text);\n  line-height: 1.6;\n  font-style: italic;\n}\n\n/* 大道详情样式 */\n.dao-progress-section[data-v-5ffd8816] {\n  margin-bottom: 20px;\n  padding: 20px;\n  background: linear-gradient(135deg, var(--color-surface-light), rgba(var(--color-success-rgb), 0.05));\n  border-radius: 12px;\n  border: 1px solid rgba(var(--color-success-rgb), 0.2);\n}\n.dao-stage-info[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.stage-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.stage-value[data-v-5ffd8816] {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.1);\n  padding: 4px 12px;\n  border-radius: 16px;\n}\n.dao-progress-bar[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.progress-bar-bg[data-v-5ffd8816] {\n  flex: 1;\n  height: 12px;\n  background: var(--color-border);\n  border-radius: 6px;\n  overflow: hidden;\n  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n.progress-bar-fill[data-v-5ffd8816] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-success), var(--color-info));\n  border-radius: 6px;\n  transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 2px 8px rgba(var(--color-success-rgb), 0.4);\n}\n.progress-text[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-success);\n  min-width: 45px;\n  text-align: right;\n}\n.dao-stats-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 16px;\n  margin-bottom: 20px;\n}\n.dao-stat-item[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 16px;\n  background: var(--color-surface-light);\n  border-radius: 12px;\n  border: 1px solid var(--color-border);\n  text-align: center;\n  transition: all 0.2s ease;\n}\n.dao-stat-item[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: rgba(var(--color-primary-rgb), 0.3);\n  transform: translateY(-2px);\n}\n.stat-label[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 8px;\n  font-weight: 500;\n}\n.stat-value[data-v-5ffd8816] {\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: var(--color-primary);\n}\n.dao-description[data-v-5ffd8816] {\n  background: linear-gradient(135deg, var(--color-surface-light), rgba(var(--color-warning-rgb), 0.05));\n  border-radius: 12px;\n  padding: 20px;\n  border-left: 4px solid var(--color-warning);\n}\n.dao-description h4[data-v-5ffd8816] {\n  margin: 0 0 12px 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-warning);\n}\n.dao-description p[data-v-5ffd8816] {\n  margin: 0;\n  color: var(--color-text);\n  line-height: 1.6;\n  font-style: italic;\n}\n\n/* 响应式优�?*/\n@media (max-width: 640px) {\n.skill-detail-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n.dao-stats-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n.modal-content[data-v-5ffd8816] {\n    padding: 20px 24px 24px 24px;\n}\n.modal-header[data-v-5ffd8816] {\n    padding: 20px 24px 16px 24px;\n}\n.modal-header h3[data-v-5ffd8816] {\n    font-size: 1.2rem;\n}\n}\n\n/* 新的结构化数据样�?*/\n.spirit-root-display[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n.spirit-root-main[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n.spirit-root-name-section[data-v-5ffd8816] {\n  display: flex;\n  justify-content: flex-start;\n}\n.spirit-root-badges[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  align-items: flex-end;\n}\n.badge-row[data-v-5ffd8816] {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.spirit-root-grade[data-v-5ffd8816] {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  text-align: center;\n  min-width: 32px;\n}\n.spirit-root-grade.grade-下品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #8B5CF6, #A78BFA);\n  color: white;\n}\n.spirit-root-grade.grade-中品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #3B82F6, #60A5FA);\n  color: white;\n}\n.spirit-root-grade.grade-上品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #10B981, #34D399);\n  color: white;\n}\n.spirit-root-grade.grade-极品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #F59E0B, #FBBF24);\n  color: white;\n}\n.spirit-root-grade.grade-神品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #DC2626, #F87171);\n  color: white;\n}\n.spirit-root-grade.grade-仙品[data-v-5ffd8816] { background: linear-gradient(135deg, #EF4444, #F87171); color: white;\n}\n.spirit-root-grade.grade-天品[data-v-5ffd8816] { background: linear-gradient(135deg, #EF4444, #F87171); color: white;\n}\n.spirit-root-grade.grade-圣品[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #EC4899, #F472B6);\n  color: white;\n}\n.spirit-root-quality[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-weight: 600;\n  text-align: center;\n  border: 1px solid;\n}\n.spirit-root-quality.quality-变异[data-v-5ffd8816] {\n  background: rgba(139, 69, 19, 0.1);\n  color: #8B4513;\n  border-color: #8B4513;\n}\n.spirit-root-quality.quality-复合[data-v-5ffd8816] {\n  background: rgba(75, 85, 99, 0.1);\n  color: #4B5563;\n  border-color: #4B5563;\n}\n.spirit-root-quality.quality-传说[data-v-5ffd8816] {\n  background: linear-gradient(135deg, #7C3AED, #A78BFA);\n  color: white;\n  border: none;\n}\n.spirit-root-desc[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  max-width: 200px;\n  text-align: right;\n  line-height: 1.4;\n  margin-top: 0.25rem;\n}\n.quality-仙品[data-v-5ffd8816] { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white;\n}\n.quality-天品[data-v-5ffd8816] { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white;\n}\n.quality-地品[data-v-5ffd8816] { background: linear-gradient(135deg, #a78bfa, #8b5cf6); color: white;\n}\n.quality-玄品[data-v-5ffd8816] { background: linear-gradient(135deg, #60a5fa, #3b82f6); color: white;\n}\n.quality-黄品[data-v-5ffd8816] { background: linear-gradient(135deg, #34d399, #10b981); color: white;\n}\n.quality-凡品[data-v-5ffd8816] { background: linear-gradient(135deg, #9ca3af, #6b7280); color: white;\n}\n\n/* 修炼速度样式 */\n.spirit-root-speed[data-v-5ffd8816] {\n  padding: 2px 8px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  border-radius: 12px;\n  background: linear-gradient(135deg, #10b981, #34d399);\n  color: white;\n  border: none;\n  margin-left: 4px;\n}\n\n/* 灵根特殊效果样式 */\n.spirit-root-effects[data-v-5ffd8816] {\n  margin-top: 8px;\n}\n.effects-title[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n}\n.effects-list[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n}\n.effect-tag[data-v-5ffd8816] {\n  padding: 2px 6px;\n  font-size: 0.7rem;\n  background: rgba(59, 130, 246, 0.1);\n  color: var(--color-primary);\n  border-radius: 8px;\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n.talent-tags[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  align-items: flex-end;\n  flex-direction: column;\n}\n.talent-tag[data-v-5ffd8816] {\n  position: relative;\n  background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(147, 51, 234, 0.1));\n  color: #9333ea;\n  padding: 4px 12px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n  border: 1px solid rgba(147, 51, 234, 0.2);\n  cursor: help;\n}\n.talent-description-display[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  padding-left: 8px;\n  border-left: 2px solid var(--color-border);\n}\n\n/* 新的天赋与灵根卡片样式 */\n.talent-content[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n/* 天赋容器样式 */\n.talents-container[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.talents-container.no-talents[data-v-5ffd8816] {\n  opacity: 0.7;\n}\n.talent-item.no-talent[data-v-5ffd8816] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  border: 1px dashed var(--color-border);\n}\n.talent-item.no-talent .talent-name[data-v-5ffd8816] {\n  color: var(--color-text-secondary);\n  font-style: italic;\n  font-size: 0.9rem;\n}\n.talent-tier-card[data-v-5ffd8816],\n.spirit-root-card[data-v-5ffd8816],\n.talents-card[data-v-5ffd8816] {\n  padding: 16px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  transition: all 0.2s ease;\n}\n.spirit-root-card[data-v-5ffd8816] {\n  cursor: pointer;\n}\n.spirit-root-card[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 16px rgba(var(--color-primary-rgb), 0.15);\n}\n.talent-tier-card[data-v-5ffd8816]:hover,\n.talents-card[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.1);\n}\n\n/* 天资等级描述样式 */\n.tier-description[data-v-5ffd8816] {\n  margin-top: 12px;\n  padding: 10px;\n  background: var(--color-background);\n  border-radius: 8px;\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n  border-left: 3px solid var(--color-primary);\n}\n\n/* 卡片头部样式 */\n.tier-header[data-v-5ffd8816],\n.root-header[data-v-5ffd8816],\n.talents-header[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(var(--color-border-rgb), 0.3);\n}\n.tier-icon[data-v-5ffd8816],\n.root-icon[data-v-5ffd8816],\n.talents-icon[data-v-5ffd8816] {\n  font-size: 1.2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.tier-label[data-v-5ffd8816],\n.root-label[data-v-5ffd8816],\n.talents-label[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.click-hint[data-v-5ffd8816] {\n  margin-left: auto;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  opacity: 0.7;\n  transition: opacity 0.2s ease;\n}\n.spirit-root-card:hover .click-hint[data-v-5ffd8816] {\n  opacity: 1;\n}\n\n/* 灵根卡片新样式 */\n.root-main-info[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  align-items: flex-start;\n}\n.root-name[data-v-5ffd8816] {\n  font-size: 1.1rem;\n  font-weight: 700;\n}\n.property-badges[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.prop-badge[data-v-5ffd8816] {\n  padding: 4px 12px;\n  font-size: 0.75rem;\n  font-weight: 600;\n  border-radius: 999px;\n  border: 1px solid transparent;\n}\n.grade-badge[data-v-5ffd8816] {\n  color: white;\n  border: none;\n}\n.grade-凡品[data-v-5ffd8816] { background: #9ca3af;\n}\n.grade-下品[data-v-5ffd8816] { background: #10b981;\n}\n.grade-中品[data-v-5ffd8816] { background: #3b82f6;\n}\n.grade-上品[data-v-5ffd8816] { background: #8b5cf6;\n}\n.grade-极品[data-v-5ffd8816] { background: #f59e0b;\n}\n.grade-神品[data-v-5ffd8816] { background: #ef4444;\n}\n.grade-特殊[data-v-5ffd8816] { background: linear-gradient(45deg, #f59e0b, #ef4444);\n}\n.speed-badge[data-v-5ffd8816] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n  border-color: rgba(var(--color-info-rgb), 0.3);\n}\n.quality-badge[data-v-5ffd8816] {\n  background: rgba(var(--color-accent-rgb), 0.1);\n  color: var(--color-accent);\n  border-color: rgba(var(--color-accent-rgb), 0.3);\n}\n.root-description[data-v-5ffd8816] {\n  margin-top: 12px;\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  line-height: 1.5;\n}\n.root-effects[data-v-5ffd8816] {\n  margin-top: 12px;\n  padding-top: 12px;\n  border-top: 1px solid rgba(var(--color-border-rgb), 0.3);\n}\n.effects-tags[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n.root-effects .effect-tag[data-v-5ffd8816] {\n  padding: 4px 10px;\n  font-size: 0.8rem;\n  background: rgba(var(--color-primary-rgb), 0.1);\n  color: var(--color-primary);\n  border-radius: 999px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n}\n\n/* 灵根弹窗新样式 */\n.detail-value.type-value[data-v-5ffd8816],\n.detail-value.grade-value[data-v-5ffd8816],\n.detail-value.speed-value[data-v-5ffd8816] {\n  padding: 6px 16px;\n  border-radius: 999px;\n  font-size: 1rem;\n  display: inline-block;\n  margin-top: 4px;\n}\n.detail-value.grade-value[data-v-5ffd8816] {\n  color: white;\n}\n.detail-value.speed-value[data-v-5ffd8816] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n  border: 1px solid rgba(var(--color-info-rgb), 0.3);\n}\n.talents-count[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-left: auto;\n}\n\n/* 声望显示样式 */\n.reputation-item .vital-label[data-v-5ffd8816] {\n  color: var(--color-warning);\n}\n.reputation-display[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n}\n.reputation-value[data-v-5ffd8816] {\n  padding: 4px 12px;\n  background: linear-gradient(135deg, rgba(var(--color-warning-rgb), 0.1), rgba(var(--color-warning-rgb), 0.05));\n  border: 1px solid rgba(var(--color-warning-rgb), 0.3);\n  border-radius: 16px;\n  font-weight: 600;\n  color: var(--color-warning);\n  font-size: 0.85rem;\n}\n.reputation-number[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  opacity: 0.8;\n  margin-left: 4px;\n}\n\n/* 灵根详情弹窗样式 */\n.spirit-root-modal[data-v-5ffd8816] {\n  background: var(--color-surface);\n  border-radius: 20px;\n  width: 100%;\n  max-width: 600px;\n  max-height: 80vh;\n  overflow: hidden;\n  box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);\n  animation: modal-slide-up-5ffd8816 0.4s cubic-bezier(0.16, 1, 0.3, 1);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n.spirit-root-detail-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 16px;\n  margin-bottom: 24px;\n}\n.detail-card[data-v-5ffd8816] {\n  padding: 16px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  text-align: center;\n  transition: all 0.2s ease;\n}\n.detail-card[data-v-5ffd8816]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.1);\n}\n.detail-header[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(var(--color-border-rgb), 0.3);\n}\n.detail-icon[data-v-5ffd8816] {\n  font-size: 1.2rem;\n}\n.detail-title[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.detail-value[data-v-5ffd8816] {\n  font-weight: 700;\n  color: var(--color-primary);\n  font-size: 1.1rem;\n}\n.spirit-root-description[data-v-5ffd8816],\n.spirit-root-effects-section[data-v-5ffd8816],\n.advanced-details[data-v-5ffd8816] {\n  margin-bottom: 20px;\n}\n.spirit-root-description h4[data-v-5ffd8816],\n.spirit-root-effects-section h4[data-v-5ffd8816],\n.advanced-details h4[data-v-5ffd8816] {\n  margin: 0 0 12px 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.spirit-root-description p[data-v-5ffd8816] {\n  margin: 0;\n  color: var(--color-text);\n  line-height: 1.6;\n  font-style: italic;\n}\n.effects-grid[data-v-5ffd8816] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n.effects-grid .effect-tag-modal[data-v-5ffd8816] {\n  padding: 6px 14px;\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n  border-radius: 999px;\n  font-size: 0.85rem;\n  font-weight: 500;\n  border: 1px solid rgba(var(--color-success-rgb), 0.3);\n  transition: all 0.2s ease;\n}\n.effects-grid .effect-tag-modal[data-v-5ffd8816]:hover {\n  background: rgba(var(--color-success-rgb), 0.2);\n  transform: translateY(-1px);\n}\n.advanced-grid[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.advanced-item[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  background: var(--color-surface-light);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.advanced-label[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n}\n.advanced-value[data-v-5ffd8816] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n\n/* 响应式优化 */\n@media (max-width: 640px) {\n.spirit-root-detail-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n.talent-content[data-v-5ffd8816] {\n    gap: 12px;\n}\n.talent-tier-card[data-v-5ffd8816],\n  .spirit-root-card[data-v-5ffd8816],\n  .talents-card[data-v-5ffd8816] {\n    padding: 12px;\n}\n.tier-value[data-v-5ffd8816] {\n    font-size: 1rem;\n    padding: 4px 12px;\n}\n.property-badges[data-v-5ffd8816] {\n    justify-content: center;\n    gap: 4px;\n}\n}\n.info-value.clickable[data-v-5ffd8816] {\n    cursor: pointer;\n    text-decoration: underline;\n    text-decoration-style: dashed;\n    text-underline-offset: 3px;\n    transition: color 0.2s, text-decoration-color 0.2s;\n}\n.info-value.clickable[data-v-5ffd8816]:hover {\n    text-decoration-style: solid;\n    color: var(--color-primary-hover);\n}\n.info-value.origin.clickable[data-v-5ffd8816] {\n    color: var(--color-accent);\n}\n.info-value.origin.clickable[data-v-5ffd8816]:hover {\n    color: var(--color-accent-hover);\n}\n\n/* ==================== 全新顶部卡片设计 ==================== */\n.character-header-card[data-v-5ffd8816] {\n  position: relative;\n  background: linear-gradient(135deg, #1a1f35 0%, #0f1419 100%);\n  border-radius: 16px;\n  overflow: hidden;\n  margin-bottom: 24px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n}\n.header-bg-decoration[data-v-5ffd8816] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background:\n    radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),\n    radial-gradient(circle at 80% 50%, rgba(168, 85, 247, 0.15) 0%, transparent 50%);\n  pointer-events: none;\n}\n.header-content[data-v-5ffd8816] {\n  position: relative;\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  gap: 24px;\n  padding: 28px;\n  align-items: center;\n}\n.profile-section[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 20px;\n}\n.avatar-wrapper[data-v-5ffd8816] {\n  position: relative;\n}\n.avatar-circle[data-v-5ffd8816] {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);\n  box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4);\n  position: relative;\n  z-index: 2;\n}\n.avatar-text[data-v-5ffd8816] {\n  color: #fff;\n  font-size: 2rem;\n  font-weight: 800;\n  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n.avatar-glow[data-v-5ffd8816] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 100px;\n  height: 100px;\n  background: radial-gradient(circle, rgba(59, 130, 246, 0.4) 0%, transparent 70%);\n  border-radius: 50%;\n  animation: pulse-glow-5ffd8816 2s ease-in-out infinite;\n}\n@keyframes pulse-glow-5ffd8816 {\n0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1);\n}\n50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1);\n}\n}\n.identity-info[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.character-title[data-v-5ffd8816] {\n  font-size: 1.75rem;\n  font-weight: 700;\n  color: #fff;\n  margin: 0;\n  text-shadow: 0 2px 12px rgba(0, 0, 0, 0.5);\n  letter-spacing: 0.5px;\n}\n.character-subtitle[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n.subtitle-item[data-v-5ffd8816] {\n  font-size: 0.95rem;\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 500;\n}\n.gender-badge[data-v-5ffd8816] {\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-weight: 600;\n}\n.gender-badge.gender-男[data-v-5ffd8816] {\n  background: rgba(59, 130, 246, 0.2);\n  color: #60a5fa;\n  border: 1px solid rgba(59, 130, 246, 0.3);\n}\n.gender-badge.gender-女[data-v-5ffd8816] {\n  background: rgba(236, 72, 153, 0.2);\n  color: #f472b6;\n  border: 1px solid rgba(236, 72, 153, 0.3);\n}\n.subtitle-divider[data-v-5ffd8816] {\n  color: rgba(255, 255, 255, 0.3);\n}\n.age-text[data-v-5ffd8816], .origin-text[data-v-5ffd8816], .race-text[data-v-5ffd8816] {\n  color: rgba(255, 255, 255, 0.7);\n}\n.core-stats-grid[data-v-5ffd8816] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\n  gap: 12px;\n  flex: 1;\n}\n.stat-card[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  transition: all 0.3s ease;\n}\n.stat-card[data-v-5ffd8816]:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n  transform: translateY(-2px);\n}\n.card-icon[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  border-radius: 8px;\n  flex-shrink: 0;\n}\n.realm-card .card-icon[data-v-5ffd8816] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.2));\n  color: #60a5fa;\n}\n.spirit-card .card-icon[data-v-5ffd8816] {\n  background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(147, 51, 234, 0.2));\n  color: #c084fc;\n}\n.location-card .card-icon[data-v-5ffd8816] {\n  background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));\n  color: #34d399;\n}\n.reputation-card .card-icon[data-v-5ffd8816] {\n  background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));\n  color: #fbbf24;\n}\n.card-content[data-v-5ffd8816] {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  min-width: 0;\n}\n.card-label[data-v-5ffd8816] {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.card-value[data-v-5ffd8816] {\n  font-size: 1rem;\n  font-weight: 700;\n  color: #fff;\n  line-height: 1.4;\n  word-break: break-all;\n}\n.location-value[data-v-5ffd8816] {\n  font-size: 0.9rem;\n  line-height: 1.3;\n}\n.cultivation-section[data-v-5ffd8816] {\n  min-width: 200px;\n}\n.cultivation-progress-card[data-v-5ffd8816] {\n  background: rgba(255, 255, 255, 0.05);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n.progress-header[data-v-5ffd8816] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.progress-label[data-v-5ffd8816] {\n  font-size: 0.85rem;\n  color: rgba(255, 255, 255, 0.7);\n  font-weight: 600;\n}\n.progress-percentage[data-v-5ffd8816] {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: #60a5fa;\n}\n.progress-bar-container[data-v-5ffd8816] {\n  position: relative;\n}\n.progress-bar-bg[data-v-5ffd8816] {\n  height: 10px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 999px;\n  overflow: hidden;\n  position: relative;\n}\n.progress-bar-fill[data-v-5ffd8816] {\n  height: 100%;\n  background: linear-gradient(90deg, #3b82f6, #8b5cf6);\n  border-radius: 999px;\n  position: relative;\n  transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.progress-bar-shine[data-v-5ffd8816] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n  /* 移除动画效果 */\n}\n.progress-text[data-v-5ffd8816] {\n  font-size: 0.8rem;\n  color: rgba(255, 255, 255, 0.6);\n  text-align: center;\n}\n.cultivation-status[data-v-5ffd8816] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n}\n.status-icon[data-v-5ffd8816] {\n  font-size: 1.5rem;\n}\n.status-text[data-v-5ffd8816] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n/* 响应式设计 */\n@media (max-width: 1200px) {\n.header-content[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n    gap: 20px;\n}\n.core-stats-grid[data-v-5ffd8816] {\n    grid-template-columns: repeat(2, 1fr);\n}\n.cultivation-section[data-v-5ffd8816] {\n    min-width: auto;\n}\n}\n@media (max-width: 768px) {\n.header-content[data-v-5ffd8816] {\n    padding: 20px;\n}\n.profile-section[data-v-5ffd8816] {\n    flex-direction: column;\n    text-align: center;\n    gap: 12px;\n}\n.character-subtitle[data-v-5ffd8816] {\n    justify-content: center;\n}\n.core-stats-grid[data-v-5ffd8816] {\n    grid-template-columns: 1fr;\n}\n.avatar-circle[data-v-5ffd8816] {\n    width: 64px;\n    height: 64px;\n}\n.avatar-text[data-v-5ffd8816] {\n    font-size: 1.5rem;\n}\n.character-title[data-v-5ffd8816] {\n    font-size: 1.5rem;\n}\n}\n  ",""]);const i=l},2067:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n/* 顶部功能按钮 */\n.top-actions-container[data-v-d9928082] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.1);\n  justify-content: flex-end;\n}\n.top-actions-container .action-item[data-v-d9928082] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  white-space: nowrap;\n}\n.top-actions-container .action-item[data-v-d9928082]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.talent-tier-selection[data-v-d9928082] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.loading-state[data-v-d9928082],\n.error-state[data-v-d9928082],\n.placeholder[data-v-d9928082] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.tier-layout[data-v-d9928082] {\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  gap: 2rem;\n  height: 100%;\n  overflow: hidden;\n}\n.tier-left-panel[data-v-d9928082] {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--color-surface);\n}\n.tiers-list-container[data-v-d9928082] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.tiers-list-container[data-v-d9928082]::-webkit-scrollbar { width: 8px;\n}\n.tiers-list-container[data-v-d9928082]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.tiers-list-container[data-v-d9928082]::-webkit-scrollbar-thumb { background: rgba(var(--color-primary-rgb), 0.3); border-radius: 4px;\n}\n.tiers-list-container[data-v-d9928082]::-webkit-scrollbar-thumb:hover { background: rgba(var(--color-primary-rgb), 0.5);\n}\n.tier-item[data-v-d9928082] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  margin-bottom: 0.5rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-left: 3px solid transparent;\n}\n.item-content[data-v-d9928082] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-grow: 1;\n}\n\n/* 按钮组容器 */\n.action-buttons[data-v-d9928082] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n  margin-left: 0.5rem;\n}\n.tier-item:hover .action-buttons[data-v-d9928082] {\n  opacity: 1;\n}\n\n/* 编辑按钮 */\n.edit-btn[data-v-d9928082] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.edit-btn[data-v-d9928082]:hover {\n  color: var(--color-primary);\n  background-color: rgba(59, 130, 246, 0.1);\n}\n.delete-btn[data-v-d9928082] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.delete-btn[data-v-d9928082]:hover {\n  color: var(--color-danger);\n  background-color: rgba(255, 0, 0, 0.1);\n}\n.tier-item[data-v-d9928082]:hover {\n  background: rgba(var(--tier-glow-color-rgb, 229, 192, 123), 0.1);\n}\n.tier-item.selected[data-v-d9928082] {\n  background: rgba(var(--tier-glow-color-rgb, 229, 192, 123), 0.2);\n  color: var(--tier-glow-color, #e5c07b);\n  border-left: 3px solid var(--tier-glow-color, #e5c07b);\n  box-shadow: 0 0 15px rgba(var(--tier-glow-color-rgb, 229, 192, 123), 0.3);\n}\n.tier-name[data-v-d9928082] {\n  font-weight: 600;\n  color: var(--tier-glow-color, inherit);\n}\n.tier-points[data-v-d9928082] {\n  color: var(--color-accent);\n  font-weight: 500;\n}\n.single-actions-container[data-v-d9928082] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  gap: 0.5rem;\n}\n.action-item[data-v-d9928082] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 1rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n.action-item[data-v-d9928082]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.action-name[data-v-d9928082] {\n  font-weight: 500;\n}\n.tier-details-container[data-v-d9928082] {\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  padding: 1.5rem;\n  background: var(--color-surface);\n}\n.tier-details[data-v-d9928082] {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n}\n.tier-details h2[data-v-d9928082] {\n  margin-top: 0;\n  margin-bottom: 1rem;\n  font-size: 2rem;\n  text-align: center;\n  flex-shrink: 0;\n  text-shadow: 0 0 20px currentColor;\n}\n.description-scroll[data-v-d9928082] {\n  flex: 1;\n  overflow-y: auto;\n  line-height: 1.6;\n  padding-right: 0.5rem;\n  min-height: 0;\n}\n.description-scroll p[data-v-d9928082] {\n  margin: 0;\n  white-space: pre-wrap;\n  color: var(--color-text-secondary);\n}\n.description-scroll[data-v-d9928082]::-webkit-scrollbar { width: 8px;\n}\n.description-scroll[data-v-d9928082]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.description-scroll[data-v-d9928082]::-webkit-scrollbar-thumb { background: rgba(var(--color-primary-rgb), 0.3); border-radius: 4px;\n}\n.description-scroll[data-v-d9928082]::-webkit-scrollbar-thumb:hover { background: rgba(var(--color-primary-rgb), 0.5);\n}\n.points-display[data-v-d9928082] {\n  text-align: center;\n  font-weight: bold;\n  color: var(--color-accent);\n  font-size: 1.2rem;\n  padding-top: 1rem;\n  margin-top: 1rem;\n  border-top: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n\n/* 响应式适配 - 手机端优化 */\n@media (max-width: 1200px) {\n.tier-layout[data-v-d9928082] {\n    grid-template-columns: 1fr 1.8fr;\n    gap: 1.5rem;\n}\n}\n@media (max-width: 1024px) {\n.tier-layout[data-v-d9928082] {\n    grid-template-columns: 1fr 1.5fr;\n    gap: 1.2rem;\n}\n.tier-details h2[data-v-d9928082] {\n    font-size: 1.8rem;\n}\n}\n@media (max-width: 640px) {\n.top-actions-container[data-v-d9928082] {\n    flex-wrap: wrap;\n    justify-content: stretch;\n}\n.top-actions-container .action-item[data-v-d9928082] {\n    flex-grow: 1;\n    text-align: center;\n}\n.tier-layout[data-v-d9928082] {\n    /* 改为垂直堆叠布局 */\n    grid-template-columns: 1fr;\n    grid-template-rows: auto 1fr;\n    gap: 1rem;\n    height: auto;\n    overflow: visible;\n    padding: 0.8rem;\n}\n.tier-left-panel[data-v-d9928082] {\n    order: 1;\n    max-height: 40vh;\n}\n.tier-details-container[data-v-d9928082] {\n    order: 2;\n    min-height: 300px;\n}\n.tiers-list-container[data-v-d9928082] {\n    max-height: 35vh;\n    /* 添加触摸滚动优化 */\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n}\n  \n  /* 优化触摸体验 */\n.tier-item[data-v-d9928082],\n  .action-item[data-v-d9928082] {\n    -webkit-tap-highlight-color: transparent;\n    touch-action: manipulation;\n}\n}\n@media (max-width: 640px) {\n.tier-layout[data-v-d9928082] {\n    gap: 0.8rem;\n    padding: 0.6rem;\n}\n.tier-left-panel[data-v-d9928082] {\n    max-height: 35vh;\n}\n.tiers-list-container[data-v-d9928082] {\n    max-height: 30vh;\n    padding: 0.5rem;\n}\n.tier-item[data-v-d9928082] {\n    padding: 0.7rem;\n    font-size: 0.95rem;\n    margin-bottom: 0.4rem;\n}\n.single-actions-container[data-v-d9928082] {\n    padding: 0.5rem;\n    gap: 0.4rem;\n}\n.action-item[data-v-d9928082] {\n    padding: 0.7rem 1rem;\n    font-size: 0.9rem;\n}\n.tier-details-container[data-v-d9928082] {\n    padding: 1.2rem;\n    min-height: 250px;\n}\n.tier-details h2[data-v-d9928082] {\n    font-size: 1.6rem;\n    margin-bottom: 0.8rem;\n}\n.points-display[data-v-d9928082] {\n    font-size: 1.1rem;\n}\n}\n@media (max-width: 480px) {\n.top-actions-container[data-v-d9928082] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.talent-tier-selection[data-v-d9928082] {\n    padding: 0.4rem;\n    height: auto;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.tier-layout[data-v-d9928082] {\n    gap: 0.6rem;\n    padding: 0;\n    height: auto;\n    min-height: 0;\n}\n.tier-left-panel[data-v-d9928082] {\n    max-height: none;\n    border-radius: 6px;\n}\n.tiers-list-container[data-v-d9928082] {\n    max-height: 26vh;\n    padding: 0.4rem;\n}\n.tier-item[data-v-d9928082] {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.9rem;\n    margin-bottom: 0.3rem;\n    border-radius: 4px;\n}\n.tier-name[data-v-d9928082] {\n    font-size: 0.9rem;\n}\n.tier-points[data-v-d9928082] {\n    font-size: 0.8rem;\n}\n.single-actions-container[data-v-d9928082] {\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.4rem;\n}\n.action-item[data-v-d9928082] {\n    padding: 0.6rem;\n    font-size: 0.85rem;\n    border-radius: 4px;\n}\n.tier-details-container[data-v-d9928082] {\n    padding: 1rem;\n    min-height: 200px;\n    border-radius: 6px;\n}\n.tier-details h2[data-v-d9928082] {\n    font-size: 1.4rem;\n    margin-bottom: 0.6rem;\n    text-align: center;\n}\n.description-scroll[data-v-d9928082] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    padding-right: 0.3rem;\n}\n.points-display[data-v-d9928082] {\n    font-size: 1rem;\n    text-align: center;\n    padding-top: 0.8rem;\n    margin-top: 0.8rem;\n}\n.placeholder[data-v-d9928082] {\n    font-size: 1rem;\n    padding: 1rem;\n    text-align: center;\n    min-height: 150px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.top-actions-container[data-v-d9928082] {\n    flex-direction: column;\n    align-items: stretch;\n    padding: 0.5rem;\n}\n.top-actions-container .action-item[data-v-d9928082] {\n    text-align: center;\n}\n}\n@media (max-width: 360px) {\n.talent-tier-selection[data-v-d9928082] {\n    padding: 0.3rem;\n}\n.tier-layout[data-v-d9928082] {\n    gap: 0.4rem;\n}\n.tier-left-panel[data-v-d9928082] {\n    max-height: 28vh;\n}\n.tiers-list-container[data-v-d9928082] {\n    max-height: 24vh;\n    padding: 0.3rem;\n}\n.tier-item[data-v-d9928082] {\n    padding: 0.5rem 0.6rem;\n    font-size: 0.85rem;\n    margin-bottom: 0.2rem;\n}\n.tier-name[data-v-d9928082] {\n    font-size: 0.8rem;\n}\n.tier-points[data-v-d9928082] {\n    font-size: 0.75rem;\n}\n.tier-details-container[data-v-d9928082] {\n    padding: 0.8rem;\n    min-height: 180px;\n}\n.tier-details h2[data-v-d9928082] {\n    font-size: 1.2rem;\n    margin-bottom: 0.5rem;\n}\n.description-scroll[data-v-d9928082] {\n    font-size: 0.85rem;\n    line-height: 1.4;\n}\n.points-display[data-v-d9928082] {\n    font-size: 0.9rem;\n    padding-top: 0.6rem;\n    margin-top: 0.6rem;\n}\n.action-item[data-v-d9928082] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.placeholder[data-v-d9928082] {\n    font-size: 0.9rem;\n    padding: 0.8rem;\n    min-height: 120px;\n}\n}\n",""]);const i=l},2224:e=>{e.exports=_},2231:(e,n,t)=>{t.r(n),t.d(n,{default:()=>C});var a=t(4061),o=t(1783);const r={class:"tree-node"},l={key:0,class:"arrow"},i={key:1,class:"arrow"},c={class:"key"},s={key:2,class:"value"},d={key:0,class:"node-children"},m=(0,a.defineComponent)({__name:"TreeNode",props:{nodeKey:{},value:{},path:{}},emits:["delete-item"],setup(e,{emit:n}){const m=(0,a.defineAsyncComponent)(()=>Promise.resolve().then(t.bind(t,2231))),p=e,v=n,u=(0,a.ref)(!1),g=(0,a.computed)(()=>"object"==typeof p.value&&null!==p.value),f=(0,a.computed)(()=>null===p.value?"null":"string"==typeof p.value&&p.value.length>100?`"${p.value.substring(0,100)}..."`:JSON.stringify(p.value)),b=(0,a.computed)(()=>{const e=p.path,n=e.startsWith("背包_物品.")&&2===e.split(".").length,t=e.startsWith("人物关系.")&&2===e.split(".").length;return n||t}),h=()=>{g.value&&(u.value=!u.value)},y=()=>{v("delete-item",p.path)};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",r,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["node-line",{"is-object":g.value}]),onClick:h},[g.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",l,(0,a.toDisplayString)(u.value?"▼":"▶"),1)):((0,a.openBlock)(),(0,a.createElementBlock)("span",i)),(0,a.createElementVNode)("span",c,(0,a.toDisplayString)(e.nodeKey)+":",1),g.value?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("span",s,(0,a.toDisplayString)(f.value),1)),b.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:3,onClick:(0,a.withModifiers)(y,["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(o.A),{size:14})])):(0,a.createCommentVNode)("v-if",!0)],2),g.value&&u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",d,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.value,(t,o)=>((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(m),{key:o,"node-key":o,value:t,path:`${e.path}.${o}`,onDeleteItem:n[0]||(n[0]=e=>v("delete-item",e))},null,8,["node-key","value","path"]))),128))])):(0,a.createCommentVNode)("v-if",!0)]))}});var p=t(5072),v=t.n(p),u=t(7825),g=t.n(u),f=t(7659),b=t.n(f),h=t(5056),y=t.n(h),x=t(540),k=t.n(x),w=t(1113),N=t.n(w),E=t(9904),V={};V.styleTagTransform=N(),V.setAttributes=y(),V.insert=b().bind(null,"head"),V.domAPI=g(),V.insertStyleElement=k(),v()(E.A,V),E.A&&E.A.locals&&E.A.locals;const C=(0,t(6262).A)(m,[["__scopeId","data-v-70308211"]])},2589:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.top-bar[data-v-18a40716] {\n  width: 100%;\n  height: 56px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 16px;\n  box-sizing: border-box;\n  background: var(--color-surface, #f8f9fa);\n  border-bottom: 1px solid var(--color-border, #e2e8f0);\n  font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n  flex-shrink: 0;\n  min-height: 56px;\n}\n.left-section[data-v-18a40716] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  flex: 1;\n}\n.game-title[data-v-18a40716] { font-size: 1.1rem; font-weight: 700; color: var(--color-text); margin: 0; letter-spacing: 0.2px; white-space: nowrap;\n}\n.character-quick-info[data-v-18a40716] { display: flex; align-items: center; gap: 8px; padding: 4px 10px; background: var(--color-surface-light); border-radius: 14px; border: 1px solid var(--color-border);\n}\n.character-name[data-v-18a40716] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.character-realm[data-v-18a40716] {\n  font-size: 0.75rem;\n  color: var(--color-accent);\n  font-weight: 500;\n  padding: 2px 6px;\n  background: var(--color-accent-light);\n  border-radius: 10px;\n}\n.center-section[data-v-18a40716] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n}\n.location-time-info[data-v-18a40716] { display: flex; align-items: center; gap: 8px; padding: 4px 12px; background: var(--color-surface-light); border: 1px solid var(--color-border); border-radius: 10px; white-space: nowrap;\n}\n.location-text[data-v-18a40716] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-success);\n}\n.separator[data-v-18a40716] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.time-value[data-v-18a40716] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  font-family: \'Courier New\', monospace;\n}\n.right-section[data-v-18a40716] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex: 1;\n  justify-content: flex-end;\n}\n.fullscreen-btn[data-v-18a40716] { width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; background: var(--color-surface-light); border: 1px solid var(--color-border); border-radius: 8px; cursor: pointer; font-size: 16px; color: var(--color-text-secondary); transition: all 0.2s ease;\n}\n.fullscreen-btn[data-v-18a40716]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n  color: var(--color-text);\n}\n\n/* 手机端适配 */\n@media (max-width: 767px) {\n.top-bar[data-v-18a40716] {\n    padding: 0 8px;\n    height: 50px;\n    min-height: 50px;\n    flex-wrap: nowrap;\n}\n.game-title[data-v-18a40716] {\n    font-size: 0.9rem;\n    white-space: nowrap;\n    writing-mode: horizontal-tb;\n}\n.character-quick-info[data-v-18a40716] {\n    gap: 4px;\n    padding: 2px 6px;\n    flex-shrink: 1;\n    min-width: 0;\n}\n.character-name[data-v-18a40716] {\n    font-size: 0.7rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 60px;\n}\n.character-realm[data-v-18a40716] {\n    font-size: 0.6rem;\n    padding: 1px 3px;\n    white-space: nowrap;\n}\n.center-section[data-v-18a40716] {\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n}\n.location-time-info[data-v-18a40716] {\n    padding: 3px 6px;\n    gap: 4px;\n    flex-wrap: wrap;\n    justify-content: center;\n    max-width: 100%;\n}\n.location-text[data-v-18a40716] {\n    font-size: 0.7rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 80px;\n}\n.separator[data-v-18a40716] {\n    font-size: 0.65rem;\n}\n.time-value[data-v-18a40716] {\n    font-size: 0.65rem;\n    white-space: nowrap;\n}\n.fullscreen-btn[data-v-18a40716] {\n    width: 26px;\n    height: 26px;\n    font-size: 14px;\n    flex-shrink: 0;\n}\n.left-section[data-v-18a40716] {\n    gap: 6px;\n    flex: 0 1 auto;\n    min-width: 0;\n}\n.right-section[data-v-18a40716] {\n    gap: 6px;\n    flex: 0 0 auto;\n}\n}\n\n/* 超小屏幕适配 */\n@media (max-width: 375px) {\n.top-bar[data-v-18a40716] {\n    padding: 0 4px;\n}\n.game-title[data-v-18a40716] {\n    font-size: 0.8rem;\n}\n.character-quick-info[data-v-18a40716] {\n    gap: 3px;\n    padding: 2px 4px;\n}\n.character-name[data-v-18a40716] {\n    font-size: 0.65rem;\n    max-width: 50px;\n}\n.location-text[data-v-18a40716] {\n    font-size: 0.65rem;\n    max-width: 60px;\n}\n.time-value[data-v-18a40716] {\n    font-size: 0.6rem;\n}\n}\n\n/* 平板适配 */\n@media (min-width: 641px) and (max-width: 1024px) {\n.top-bar[data-v-18a40716] {\n    padding: 0 16px;\n}\n.game-title[data-v-18a40716] {\n    font-size: 1.1rem;\n}\n.left-section[data-v-18a40716] {\n    gap: 12px;\n}\n.right-section[data-v-18a40716] {\n    gap: 10px;\n}\n}\n\n/* 深色主题 */\n[data-theme="dark"] .top-bar[data-v-18a40716] {\n  background: #1e293b;\n  border-bottom-color: #334155;\n}\n[data-theme="dark"] .game-title[data-v-18a40716] {\n  color: #f1f5f9;\n}\n[data-theme="dark"] .character-quick-info[data-v-18a40716] {\n  background: #334155;\n  border-color: #475569;\n}\n[data-theme="dark"] .character-name[data-v-18a40716] {\n  color: #e2e8f0;\n}\n[data-theme="dark"] .character-realm[data-v-18a40716] {\n  background: rgba(167, 139, 250, 0.2);\n  color: #a78bfa;\n}\n[data-theme="dark"] .location-time-info[data-v-18a40716] {\n  background: #334155;\n  border-color: #475569;\n}\n[data-theme="dark"] .location-text[data-v-18a40716] {\n  color: #34d399;\n}\n[data-theme="dark"] .separator[data-v-18a40716] {\n  color: #64748b;\n}\n[data-theme="dark"] .time-value[data-v-18a40716] {\n  color: #cbd5e1;\n}\n[data-theme="dark"] .fullscreen-btn[data-v-18a40716] {\n  background: transparent;\n  border-color: #475569;\n  color: #94a3b8;\n}\n[data-theme="dark"] .fullscreen-btn[data-v-18a40716]:hover {\n  background: #334155;\n  border-color: #64748b;\n  color: #e2e8f0;\n}\n',""]);const i=l},2614:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n/* Unified style tokens for Character Management */\n.character-management-panel[data-v-fd2fc302] {\n  --cm-radius-sm: 6px;\n  --cm-radius-md: 8px;\n  --cm-radius-lg: 12px;\n  --cm-gap-xs: 0.25rem;\n  --cm-gap-sm: 0.5rem;\n  --cm-gap-md: 0.8rem;\n  --cm-gap-lg: 1rem;\n  --cm-border-width: 1px;\n  --cm-border-strong: 2px;\n  --cm-divider-width: 2px;\n  /* Card sizing tokens */\n  --cm-card-min-h: 92px;\n  --cm-card-padding: 0.9rem;\n  --cm-avatar-size: 36px;\n  --cm-header-gap: 0.75rem;\n  --cm-name-font: 1rem;\n  --cm-meta-font: 0.8rem;\n  --cm-save-count-minw: 36px;\n  --cm-save-count-count-font: 1.05rem;\n  --cm-save-count-label-font: 0.7rem;\n}\n/* 基础样式重置 */\n[data-v-fd2fc302] {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* 自定义对话框样式 */\n.dialog-overlay[data-v-fd2fc302] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(10, 20, 30, 0.6);\n  backdrop-filter: blur(8px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  transition: opacity 0.3s ease;\n}\n.dialog-box[data-v-fd2fc302] {\n  background: var(--color-surface-transparent);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  padding: 2rem;\n  width: 90%;\n  max-width: 450px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n  color: var(--color-text);\n  transform: scale(0.95);\n  opacity: 0;\n  animation: dialog-fade-in-fd2fc302 0.3s forwards;\n}\n@keyframes dialog-fade-in-fd2fc302 {\nto {\n    transform: scale(1);\n    opacity: 1;\n}\n}\n.dialog-title[data-v-fd2fc302] {\n  font-size: 1.5rem;\n  color: var(--color-accent);\n  margin: 0 0 1rem 0;\n  font-weight: 600;\n}\n.dialog-message[data-v-fd2fc302] {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  margin: 0 0 1.5rem 0;\n  line-height: 1.6;\n}\n.dialog-input[data-v-fd2fc302] {\n  width: 100%;\n  padding: 0.8rem 1rem;\n  background: var(--color-background-transparent);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  color: var(--color-text);\n  font-size: 1rem;\n  margin-bottom: 1.5rem;\n  transition: border-color 0.3s, box-shadow 0.3s;\n}\n.dialog-input[data-v-fd2fc302]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.2);\n}\n.dialog-actions[data-v-fd2fc302] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n}\n.btn-dialog-confirm[data-v-fd2fc302],\n.btn-dialog-cancel[data-v-fd2fc302] {\n  padding: 0.6rem 1.5rem;\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n  cursor: pointer;\n  font-weight: 600;\n  transition: all 0.3s;\n}\n.btn-dialog-confirm[data-v-fd2fc302] {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.btn-dialog-confirm[data-v-fd2fc302]:hover {\n  background: var(--color-primary-dark);\n  transform: translateY(-2px);\n}\n.btn-dialog-cancel[data-v-fd2fc302] {\n  background: var(--color-surface);\n  color: var(--color-text);\n  border: 1px solid var(--color-border);\n}\n.btn-dialog-cancel[data-v-fd2fc302]:hover {\n  background: var(--color-background);\n}\n\n/* 主容器样式 */\n.character-management-panel[data-v-fd2fc302] {\n  width: 100%;\n  height: 100%;\n  background: var(--color-background);\n  color: var(--color-text);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  position: relative;\n}\n.character-management-panel.fullscreen[data-v-fd2fc302] {\n  background: var(--color-background);\n}\n\n/* 全屏模式头部 */\n.fullscreen-header[data-v-fd2fc302] {\n  position: relative;\n  z-index: 10;\n  padding: 2rem;\n  background: var(--color-surface-transparent);\n  backdrop-filter: blur(12px);\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.fullscreen-back-btn[data-v-fd2fc302] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: transparent;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n}\n.fullscreen-back-btn[data-v-fd2fc302]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  border-color: var(--color-primary);\n}\n.fullscreen-title[data-v-fd2fc302] {\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n  text-align: center;\n}\n.fullscreen-title h1[data-v-fd2fc302] {\n  font-family: var(--font-family-serif);\n  font-size: 2.5rem;\n  font-weight: 500;\n  letter-spacing: 0.3em;\n  color: var(--color-text);\n  text-shadow: 0 0 20px rgba(var(--color-primary-rgb), 0.4);\n  margin: 0 0 0.5rem 0;\n  padding-left: 0.3em;\n}\n.fullscreen-title p[data-v-fd2fc302] {\n  font-size: 1rem;\n  color: var(--color-text-secondary);\n  letter-spacing: 0.1em;\n  opacity: 0.8;\n  margin: 0;\n}\n\n/* 主体内容 */\n.main-content[data-v-fd2fc302] {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.main-content.fullscreen-content[data-v-fd2fc302] {\n  position: relative;\n  flex: 1;\n  overflow: hidden;\n}\n\n/* 移动端头部导航 */\n.mobile-header[data-v-fd2fc302] {\n  display: none;\n  background: var(--color-surface-transparent);\n  backdrop-filter: blur(12px);\n  border-bottom: 1px solid var(--color-border);\n  padding: 1rem;\n  align-items: center;\n  gap: 1rem;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n}\n.mobile-menu-btn[data-v-fd2fc302] {\n  display: flex;\n  align-items: center;\n  gap: 0.6rem;\n  padding: 0.8rem 1rem;\n  background: linear-gradient(135deg, \n    rgba(var(--color-surface-rgb), 0.8), \n    rgba(var(--color-background-rgb), 0.6)\n  );\n  backdrop-filter: blur(10px);\n  border: 2px solid rgba(var(--color-border-rgb), 0.3);\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n  font-weight: 600;\n  position: relative;\n  overflow: hidden;\n}\n.mobile-menu-btn[data-v-fd2fc302]:hover {\n  background: linear-gradient(135deg, \n    rgba(var(--color-surface-rgb), 0.9), \n    rgba(var(--color-background-rgb), 0.7)\n  );\n  color: var(--color-primary);\n  border-color: var(--color-primary);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.2);\n}\n.mobile-menu-btn.active[data-v-fd2fc302] {\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  color: white;\n  border-color: var(--color-primary);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.4);\n}\n.hamburger[data-v-fd2fc302] {\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  width: 16px;\n  height: 12px;\n}\n.hamburger span[data-v-fd2fc302] {\n  display: block;\n  height: 2px;\n  width: 100%;\n  background: currentColor;\n  border-radius: 1px;\n  transition: transform 0.2s ease;\n}\n.mobile-menu-btn.active .hamburger span[data-v-fd2fc302]:nth-child(1) {\n  transform: rotate(45deg) translate(3px, 3px);\n}\n.mobile-menu-btn.active .hamburger span[data-v-fd2fc302]:nth-child(2) {\n  opacity: 0;\n}\n.mobile-menu-btn.active .hamburger span[data-v-fd2fc302]:nth-child(3) {\n  transform: rotate(-45deg) translate(3px, -3px);\n}\n.mobile-title[data-v-fd2fc302] {\n  flex: 1;\n  min-width: 0; /* Allow shrinking and text-overflow to work */\n}\n.mobile-title h2[data-v-fd2fc302] {\n  margin: 0;\n  font-size: 1.2rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.mobile-title .selected-info[data-v-fd2fc302] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-top: 0.2rem;\n  /* Fix for vertical text issue on small screens */\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.panel-overlay[data-v-fd2fc302] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1100;\n}\n\n/* 空状态 */\n.empty-state[data-v-fd2fc302] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: 2rem;\n}\n.empty-icon[data-v-fd2fc302] {\n  font-size: 4rem;\n  margin-bottom: 1rem;\n}\n.empty-state h2[data-v-fd2fc302] {\n  color: var(--color-accent);\n  margin-bottom: 0.5rem;\n}\n.empty-actions[data-v-fd2fc302] {\n  display: flex;\n  gap: 1rem;\n  margin-top: 1rem;\n}\n.btn-create[data-v-fd2fc302], .btn-import[data-v-fd2fc302] {\n  padding: 1rem 2rem;\n  color: white;\n  border-radius: 12px;\n  font-size: 1.1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n.btn-create[data-v-fd2fc302] {\n  background: linear-gradient(135deg, var(--color-success), var(--color-info));\n  border: 1px solid var(--color-success);\n}\n.btn-create[data-v-fd2fc302]:hover {\n  transform: scale(1.05);\n}\n.btn-import[data-v-fd2fc302] {\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  border: 1px solid var(--color-primary);\n}\n.btn-import[data-v-fd2fc302]:hover {\n  transform: scale(1.05);\n}\n\n/* 管理布局 - 3行2列网格 */\n.management-layout[data-v-fd2fc302] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  height: 100%;\n}\n\n/* 3行2列网格布局 - 简洁版本 */\n.grid-container[data-v-fd2fc302] {\n  display: grid;\n  grid-template-columns: 320px 1fr;\n  grid-template-rows: auto 1fr auto;\n  grid-template-areas:\n    \"header-left header-right\"\n    \"content-left content-right\"\n    \"footer-left footer-right\";\n  height: 100%;\n  overflow: hidden;\n  /* 使用单一垂直分割线 */\n  position: relative;\n}\n\n/* 统一的垂直分割线 */\n.grid-container[data-v-fd2fc302]::before {\n  content: '';\n  position: absolute;\n  left: 320px;\n  top: 0;\n  bottom: 0;\n  width: 2px;\n  background: var(--color-primary);\n  z-index: 10;\n}\n\n/* 标题栏 - 简化样式 */\n.grid-header-left[data-v-fd2fc302], .grid-header-right[data-v-fd2fc302] {\n  padding: 0.8rem 1rem;\n  background: var(--color-surface);\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n}\n.grid-header-left h2[data-v-fd2fc302], .grid-header-right h2[data-v-fd2fc302] {\n  margin: 0;\n  font-size: 1rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.character-count[data-v-fd2fc302] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: var(--color-background);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  border: 1px solid var(--color-border);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 100%;\n}\n\n/* 右侧标题栏布局 */\n.header-left-content[data-v-fd2fc302] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n  flex: 1;\n  min-width: 0;\n}\n.selected-char-info[data-v-fd2fc302] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  background: linear-gradient(135deg,\n    rgba(var(--color-primary-rgb), 0.1),\n    rgba(var(--color-accent-rgb), 0.05)\n  );\n  padding: 0.3rem 0.6rem;\n  border-radius: 6px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.3);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: fit-content;\n}\n\n/* 存档操作按钮组 */\n.save-actions-buttons[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.6rem;\n  flex-shrink: 0;\n}\n.btn-save-action[data-v-fd2fc302] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.6rem 1rem;\n  border: 2px solid;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 0.85rem;\n  font-weight: 600;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  background: linear-gradient(135deg,\n    rgba(var(--color-surface-rgb), 0.8),\n    rgba(var(--color-background-rgb), 0.6)\n  );\n  backdrop-filter: blur(10px);\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n}\n.btn-save-action.export[data-v-fd2fc302] {\n  color: var(--color-success);\n  border-color: rgba(var(--color-success-rgb), 0.4);\n}\n.btn-save-action.export[data-v-fd2fc302]:hover:not(:disabled) {\n  background: linear-gradient(135deg, var(--color-success), rgba(var(--color-success-rgb), 0.8));\n  color: white;\n  border-color: var(--color-success);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-success-rgb), 0.3);\n}\n.btn-save-action.import[data-v-fd2fc302] {\n  color: var(--color-info);\n  border-color: rgba(var(--color-info-rgb), 0.4);\n}\n.btn-save-action.import[data-v-fd2fc302]:hover:not(:disabled) {\n  background: linear-gradient(135deg, var(--color-info), rgba(var(--color-info-rgb), 0.8));\n  color: white;\n  border-color: var(--color-info);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-info-rgb), 0.3);\n}\n.btn-save-action[data-v-fd2fc302]:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n  filter: grayscale(0.5);\n}\n.btn-save-action[data-v-fd2fc302]:disabled:hover {\n  transform: none;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n}\n\n/* 内容区域 - 简化样式 */\n.grid-content-left[data-v-fd2fc302], .grid-content-right[data-v-fd2fc302] {\n  background: var(--color-background);\n}\n\n/* 底部区域 */\n.grid-footer-left[data-v-fd2fc302], .grid-footer-right[data-v-fd2fc302] {\n  min-height: 0;\n}\n\n/* 角色面板 - 简化 */\n.characters-panel[data-v-fd2fc302] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n.characters-grid[data-v-fd2fc302] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n/* 角色卡片 - 简化紧凑设计 */\n.character-card[data-v-fd2fc302] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 0.6rem;\n  margin-bottom: 0.4rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.character-card[data-v-fd2fc302]:hover {\n  border-color: var(--color-primary);\n  box-shadow: 0 1px 4px rgba(var(--color-primary-rgb), 0.2);\n}\n.character-card.active[data-v-fd2fc302] {\n  border-color: var(--color-success);\n  background: rgba(var(--color-success-rgb), 0.05);\n}\n.character-card.single-mode[data-v-fd2fc302] {\n  border-left: 3px solid var(--color-success);\n}\n.character-card.online-mode[data-v-fd2fc302] {\n  border-left: 3px solid var(--color-primary);\n}\n\n/* 卡片头部 - 简化 */\n.card-header[data-v-fd2fc302] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n.char-avatar[data-v-fd2fc302] {\n  position: relative;\n  width: 28px;\n  height: 28px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  color: white;\n  font-size: 0.8rem;\n  flex-shrink: 0;\n  background: linear-gradient(135deg, var(--color-success), var(--color-info));\n}\n.char-avatar.联机[data-v-fd2fc302] {\n  background: linear-gradient(135deg, var(--color-primary), var(--color-info));\n}\n.mode-indicator[data-v-fd2fc302] {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 10px;\n  height: 10px;\n  background: rgba(0, 0, 0, 0.7);\n  color: var(--color-warning);\n  border-radius: 50%;\n  font-size: 0.45rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  border: 1px solid var(--color-background);\n}\n.char-info[data-v-fd2fc302] {\n  flex: 1;\n  min-width: 0;\n}\n.char-name[data-v-fd2fc302] {\n  margin: 0 0 0.1rem 0;\n  font-size: 0.85rem;\n  color: var(--color-text);\n  font-weight: 600;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.char-meta[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.3rem;\n  font-size: 0.65rem;\n  color: var(--color-text-secondary);\n}\n.save-count[data-v-fd2fc302] {\n  text-align: center;\n  flex-shrink: 0;\n  min-width: 28px;\n}\n.save-count .count[data-v-fd2fc302] {\n  display: block;\n  font-size: 0.9rem;\n  font-weight: bold;\n  color: var(--color-accent);\n  line-height: 1;\n}\n.save-count .label[data-v-fd2fc302] {\n  font-size: 0.6rem;\n  color: var(--color-text-secondary);\n  line-height: 1;\n}\n\n/* 卡片操作 - 简化按钮 */\n.card-actions[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.3rem;\n  margin-top: 0.5rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid var(--color-border);\n}\n.btn-details[data-v-fd2fc302], .btn-export[data-v-fd2fc302], .btn-delete[data-v-fd2fc302] {\n  flex: 1;\n  padding: 0.3rem 0.5rem;\n  border-radius: 4px;\n  border: 1px solid var(--color-border);\n  cursor: pointer;\n  font-size: 0.7rem;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  background: var(--color-background);\n}\n.btn-details[data-v-fd2fc302] {\n  color: var(--color-info);\n  border-color: var(--color-info);\n}\n.btn-details[data-v-fd2fc302]:hover {\n  background: var(--color-info);\n  color: white;\n}\n.btn-export[data-v-fd2fc302] {\n  color: var(--color-success);\n  border-color: var(--color-success);\n}\n.btn-export[data-v-fd2fc302]:hover {\n  background: var(--color-success);\n  color: white;\n}\n.btn-delete[data-v-fd2fc302] {\n  color: var(--color-error);\n  border-color: var(--color-error);\n}\n.btn-delete[data-v-fd2fc302]:hover {\n  background: var(--color-error);\n  color: white;\n}\n\n/* 右侧存档面板 - 简化 */\n.saves-panel[data-v-fd2fc302] {\n  background: var(--color-background);\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n/* 无选择状态 */\n.no-selection[data-v-fd2fc302] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: var(--color-text-secondary);\n}\n.no-selection-icon[data-v-fd2fc302] {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n}\n\n/* 存档容器 */\n.saves-container[data-v-fd2fc302], .online-saves-container[data-v-fd2fc302] {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 1rem;\n  height: 0;\n  -webkit-overflow-scrolling: touch;\n  scrollbar-width: thin;\n  scrollbar-color: rgba(var(--color-primary-rgb), 0.3) transparent;\n}\n.saves-container[data-v-fd2fc302]::-webkit-scrollbar,\n.online-saves-container[data-v-fd2fc302]::-webkit-scrollbar {\n  width: 6px;\n}\n.saves-container[data-v-fd2fc302]::-webkit-scrollbar-track,\n.online-saves-container[data-v-fd2fc302]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.saves-container[data-v-fd2fc302]::-webkit-scrollbar-thumb,\n.online-saves-container[data-v-fd2fc302]::-webkit-scrollbar-thumb {\n  background: rgba(var(--color-primary-rgb), 0.3);\n  border-radius: 3px;\n}\n.saves-container[data-v-fd2fc302]::-webkit-scrollbar-thumb:hover,\n.online-saves-container[data-v-fd2fc302]::-webkit-scrollbar-thumb:hover {\n  background: rgba(var(--color-primary-rgb), 0.5);\n}\n.saves-section[data-v-fd2fc302] {\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n}\n\n/* 上次对话存档区域 */\n.auto-saves-section[data-v-fd2fc302] {\n  margin-bottom: 1.5rem;\n}\n.auto-saves-section h3[data-v-fd2fc302] {\n  margin: 0 0 0.8rem 0;\n  color: var(--color-warning);\n  font-size: 1rem;\n  font-weight: 600;\n}\n.auto-saves-grid[data-v-fd2fc302] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n}\n\n/* 手动存档区域 */\n.manual-saves-section[data-v-fd2fc302] {\n  margin-bottom: 1rem;\n}\n.manual-saves-header[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.8rem;\n}\n.manual-saves-header h3[data-v-fd2fc302] {\n  margin: 0;\n  color: var(--color-warning);\n  font-size: 1rem;\n  font-weight: 600;\n}\n.save-info-text[data-v-fd2fc302] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n.manual-saves-grid[data-v-fd2fc302] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n  gap: 1rem;\n  max-height: 400px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0;\n  -webkit-overflow-scrolling: touch;\n  scroll-behavior: smooth;\n  scrollbar-width: thin;\n  scrollbar-color: rgba(var(--color-primary-rgb), 0.3) transparent;\n}\n.manual-saves-grid[data-v-fd2fc302]::-webkit-scrollbar {\n  width: 6px;\n}\n.manual-saves-grid[data-v-fd2fc302]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.manual-saves-grid[data-v-fd2fc302]::-webkit-scrollbar-thumb {\n  background: rgba(var(--color-primary-rgb), 0.3);\n  border-radius: 3px;\n}\n.manual-saves-grid[data-v-fd2fc302]::-webkit-scrollbar-thumb:hover {\n  background: rgba(var(--color-primary-rgb), 0.5);\n}\n\n/* 存档卡片 */\n.save-card[data-v-fd2fc302], .online-save-card[data-v-fd2fc302] {\n  background: linear-gradient(135deg, \n    rgba(var(--color-surface-rgb), 0.9), \n    rgba(var(--color-background-rgb), 0.7)\n  );\n  backdrop-filter: blur(15px);\n  border: 2px solid rgba(var(--color-border-rgb), 0.6);\n  border-radius: 8px;\n  padding: 0.9rem;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  color: var(--color-text);\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  -webkit-tap-highlight-color: transparent;\n  touch-action: manipulation;\n}\n.save-card[data-v-fd2fc302]::before, .online-save-card[data-v-fd2fc302]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: linear-gradient(135deg, \n    rgba(var(--color-primary-rgb), 0.06), \n    rgba(var(--color-accent-rgb), 0.03)\n  );\n  opacity: 0;\n  transition: opacity 0.3s ease;\n  border-radius: 8px;\n}\n.save-card[data-v-fd2fc302]:hover::before, .online-save-card[data-v-fd2fc302]:hover::before {\n  opacity: 1;\n}\n.save-card[data-v-fd2fc302]:hover, .online-save-card[data-v-fd2fc302]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: \n    0 4px 15px rgba(var(--color-primary-rgb), 0.15),\n    0 2px 8px rgba(0, 0, 0, 0.08);\n}\n.save-card.has-data[data-v-fd2fc302] {\n  border-left: 4px solid var(--color-success);\n  border-color: rgba(var(--color-success-rgb), 0.8);\n  position: relative;\n}\n.save-card.has-data[data-v-fd2fc302]::after {\n  content: '';\n  position: absolute;\n  top: 0.7rem;\n  right: 0.7rem;\n  width: 6px;\n  height: 6px;\n  background: var(--color-success);\n  border-radius: 50%;\n  box-shadow: 0 0 8px rgba(var(--color-success-rgb), 0.6);\n}\n\n/* 存档数据 */\n.save-header[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.8rem;\n}\n.save-name[data-v-fd2fc302] {\n  margin: 0;\n  font-size: 1rem;\n  color: var(--color-warning);\n  font-weight: 600;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 140px;\n}\n.save-badges[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.4rem;\n  flex-shrink: 0;\n}\n.realm-badge[data-v-fd2fc302], .age-badge[data-v-fd2fc302] {\n  padding: 2px 6px;\n  border-radius: 8px;\n  font-size: 0.7rem;\n  font-weight: 600;\n  white-space: nowrap;\n}\n.realm-badge[data-v-fd2fc302] {\n  background: rgba(var(--color-success-rgb), 0.15);\n  color: var(--color-success);\n}\n.age-badge[data-v-fd2fc302] {\n  background: rgba(var(--color-accent-rgb), 0.15);\n  color: var(--color-accent);\n}\n\n/* 存档统计 */\n.save-stats[data-v-fd2fc302] {\n  margin-bottom: 0.8rem;\n}\n.stat-grid[data-v-fd2fc302] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 0.6rem;\n}\n.stat[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.8rem;\n  align-items: center;\n}\n.stat .label[data-v-fd2fc302] {\n  color: var(--color-text-secondary);\n  font-size: 0.75rem;\n}\n.stat .value[data-v-fd2fc302] {\n  color: var(--color-text);\n  font-weight: 600;\n  font-size: 0.8rem;\n}\n\n/* 存档底部 */\n.save-footer[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  padding-top: 0.6rem;\n  border-top: 1px solid rgba(var(--color-border-rgb), 0.2);\n}\n.save-footer .location[data-v-fd2fc302] {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 120px;\n}\n.sync-status[data-v-fd2fc302] {\n  padding: 1px 4px;\n  border-radius: 3px;\n  font-weight: 600;\n  font-size: 0.7rem;\n}\n.sync-status.synced[data-v-fd2fc302] {\n  background: rgba(var(--color-success-rgb), 0.15);\n  color: var(--color-success);\n}\n\n/* 空存档 */\n.save-empty[data-v-fd2fc302] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  color: var(--color-text-secondary);\n  min-height: 100px;\n}\n.empty-slot-icon[data-v-fd2fc302] {\n  font-size: 2rem;\n  margin-bottom: 0.4rem;\n  opacity: 0.6;\n}\n.empty-text[data-v-fd2fc302] {\n  margin-bottom: 0.6rem;\n  font-size: 0.9rem;\n}\n.empty-desc[data-v-fd2fc302] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  opacity: 0.8;\n}\n.auto-save-desc[data-v-fd2fc302] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  display: block;\n  margin-top: 0.3rem;\n}\n\n/* 存档操作按钮 */\n.save-actions[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.5rem;\n}\n.btn-edit-save[data-v-fd2fc302],\n.btn-delete-save[data-v-fd2fc302] {\n  cursor: pointer;\n  padding: 0.3rem 0.5rem;\n  border-radius: 4px;\n  transition: all 0.2s;\n  font-size: 0.7rem;\n  font-weight: 600;\n  border: 1px solid;\n  backdrop-filter: blur(5px);\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  min-width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.btn-edit-save[data-v-fd2fc302] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  border-color: rgba(var(--color-info-rgb), 0.3);\n  color: var(--color-info);\n}\n.btn-edit-save[data-v-fd2fc302]:hover {\n  background: rgba(var(--color-info-rgb), 0.2);\n  border-color: rgba(var(--color-info-rgb), 0.5);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(var(--color-info-rgb), 0.2);\n}\n.btn-delete-save[data-v-fd2fc302] {\n  background: rgba(var(--color-error-rgb), 0.1);\n  border-color: rgba(var(--color-error-rgb), 0.3);\n  color: var(--color-error);\n}\n.btn-delete-save[data-v-fd2fc302]:hover:not(.disabled):not(:disabled) {\n  background: rgba(var(--color-error-rgb), 0.2);\n  border-color: rgba(var(--color-error-rgb), 0.5);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(var(--color-error-rgb), 0.2);\n}\n.btn-delete-save.disabled[data-v-fd2fc302],\n.btn-delete-save[data-v-fd2fc302]:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n  background: rgba(128, 128, 128, 0.1) !important;\n  border-color: rgba(128, 128, 128, 0.2) !important;\n  color: #888 !important;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n/* 按钮样式 */\n.btn-start[data-v-fd2fc302], .btn-play[data-v-fd2fc302], .btn-sync[data-v-fd2fc302] {\n  padding: 0.6rem 1rem;\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  color: white;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.5);\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 0.8rem;\n  font-weight: 600;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.25);\n  position: relative;\n  overflow: hidden;\n}\n.btn-start[data-v-fd2fc302]:hover, .btn-play[data-v-fd2fc302]:hover, .btn-sync[data-v-fd2fc302]:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.35);\n}\n.btn-start[data-v-fd2fc302]::before, .btn-play[data-v-fd2fc302]::before, .btn-sync[data-v-fd2fc302]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);\n  transition: left 0.4s;\n}\n.btn-start[data-v-fd2fc302]:hover::before, .btn-play[data-v-fd2fc302]:hover::before, .btn-sync[data-v-fd2fc302]:hover::before {\n  left: 100%;\n}\n\n/* 联机模式样式 */\n.online-saves-container[data-v-fd2fc302] {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 1rem;\n  height: 0;\n}\n.login-prompt[data-v-fd2fc302] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: 2rem;\n}\n.login-icon[data-v-fd2fc302] {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n}\n.btn-login[data-v-fd2fc302] {\n  padding: 0.8rem 1.5rem;\n  background: var(--color-primary);\n  color: white;\n  border: 1px solid var(--color-primary-active);\n  border-radius: 8px;\n  cursor: pointer;\n  margin-top: 1rem;\n}\n.online-save-card[data-v-fd2fc302] {\n  background: linear-gradient(135deg, \n    rgba(var(--color-surface-rgb), 0.9), \n    rgba(var(--color-background-rgb), 0.7)\n  );\n  backdrop-filter: blur(15px);\n  border: 2px solid rgba(var(--color-border-rgb), 0.6);\n  border-radius: 8px;\n  padding: 0.9rem;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  color: var(--color-text);\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.online-actions[data-v-fd2fc302] {\n  display: flex;\n  gap: 0.5rem;\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid var(--color-border);\n}\n\n/* 详情弹窗 */\n.modal-overlay[data-v-fd2fc302] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n  backdrop-filter: blur(4px);\n}\n.details-modal[data-v-fd2fc302] {\n  background: var(--color-surface-transparent);\n  backdrop-filter: blur(20px);\n  border-radius: 15px;\n  width: 90%;\n  max-width: 800px;\n  max-height: 90vh;\n  overflow-y: auto;\n  border: 1px solid var(--color-border);\n}\n.modal-header[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem 2rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.modal-header h3[data-v-fd2fc302] {\n  margin: 0;\n  color: var(--color-accent);\n}\n.btn-close[data-v-fd2fc302] {\n  background: none;\n  border: 1px solid var(--color-border);\n  font-size: 1.5rem;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.1rem;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 6px;\n}\n.modal-content[data-v-fd2fc302] {\n  padding: 2rem;\n}\n.details-grid[data-v-fd2fc302] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 2rem;\n}\n.detail-section[data-v-fd2fc302] {\n  background: linear-gradient(135deg,\n    rgba(var(--color-primary-rgb), 0.08),\n    rgba(var(--color-accent-rgb), 0.06)\n  );\n  border: 1px solid rgba(var(--color-primary-rgb), 0.15);\n  border-radius: 10px;\n  padding: 1.5rem;\n  backdrop-filter: blur(8px);\n}\n.detail-section h4[data-v-fd2fc302] {\n  margin: 0 0 1rem 0;\n  color: var(--color-warning);\n}\n.detail-items[data-v-fd2fc302] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.8rem;\n}\n.detail-item[data-v-fd2fc302] {\n  display: flex;\n  justify-content: space-between;\n  padding: 0.5rem 0;\n  border-bottom: 1px solid rgba(var(--color-border-rgb), 0.3);\n}\n.detail-item .label[data-v-fd2fc302] {\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.detail-item .value[data-v-fd2fc302] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n.attributes-display[data-v-fd2fc302] {\n  display: flex;\n  justify-content: center;\n}\n.talents-list[data-v-fd2fc302] {\n  min-height: 100px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.talent-items[data-v-fd2fc302] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.talent-tag[data-v-fd2fc302] {\n  background: rgba(var(--color-accent-rgb), 0.15);\n  color: var(--color-accent);\n  padding: 4px 8px;\n  border-radius: 6px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n.no-talents[data-v-fd2fc302] {\n  color: var(--color-text-secondary);\n  font-style: italic;\n  text-align: center;\n}\n\n/* 响应式适配 */\n@media (max-width: 1200px) {\n.grid-container[data-v-fd2fc302] {\n    grid-template-columns: 300px 1fr;\n}\n  \n  /* 调整分割线位置 */\n.grid-container[data-v-fd2fc302]::before {\n    left: 300px;\n}\n.manual-saves-grid[data-v-fd2fc302] {\n    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n}\n}\n@media (max-width: 1024px) {\n.grid-container[data-v-fd2fc302] {\n    grid-template-columns: 280px 1fr;\n}\n  \n  /* 调整分割线位置 */\n.grid-container[data-v-fd2fc302]::before {\n    left: 280px;\n}\n.characters-panel[data-v-fd2fc302] {\n    max-width: 260px;\n}\n.save-card[data-v-fd2fc302], .online-save-card[data-v-fd2fc302] {\n    padding: 0.8rem;\n}\n.details-grid[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    gap: 1.5rem;\n}\n}\n@media (max-width: 640px) {\n.mobile-header[data-v-fd2fc302] {\n    display: flex;\n}\n.character-management-panel[data-v-fd2fc302] {\n    height: 100%;\n    overflow: hidden;\n}\n.main-content[data-v-fd2fc302] {\n    flex: 1;\n    overflow: hidden;\n    min-height: 0;\n}\n.management-layout[data-v-fd2fc302] {\n    flex-direction: column;\n    height: 100%;\n}\n.grid-container[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    grid-template-rows: auto 1fr auto;\n    grid-template-areas:\n      \"header-right\"\n      \"content-main\"\n      \"footer-main\";\n    order: 1;\n}\n\n  /* 移动端隐藏垂直分割线 */\n.grid-container[data-v-fd2fc302]::before {\n    display: none;\n}\n.grid-header-left[data-v-fd2fc302] {\n    border-right: none;\n    border-bottom: 1px solid var(--color-border);\n    /* 手机端隐藏左侧标题栏 */\n    display: none;\n}\n.grid-header-right[data-v-fd2fc302] {\n    padding: 0.8rem;\n    flex-direction: column;\n    align-items: stretch;\n    gap: 0.8rem;\n}\n.header-left-content[data-v-fd2fc302] {\n    gap: 0.3rem;\n}\n.save-actions-buttons[data-v-fd2fc302] {\n    width: 100%;\n    gap: 0.5rem;\n}\n.btn-save-action[data-v-fd2fc302] {\n    flex: 1;\n    padding: 0.7rem 0.8rem;\n    font-size: 0.8rem;\n    justify-content: center;\n}\n.btn-save-action span[data-v-fd2fc302] {\n    display: inline;\n}\n.grid-content-left[data-v-fd2fc302],\n  .grid-content-right[data-v-fd2fc302] {\n    grid-area: content-main;\n    position: relative;\n    overflow: hidden;\n    height: 100%;\n}\n.grid-footer-left[data-v-fd2fc302],\n  .grid-footer-right[data-v-fd2fc302] {\n    grid-area: footer-main;\n    border-right: none;\n}\n.characters-panel[data-v-fd2fc302] {\n    position: fixed;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 85%;\n    max-width: 280px;\n    z-index: 1200;\n    transform: translateX(-100%);\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);\n    border: none;\n    background: var(--color-surface);\n    backdrop-filter: blur(20px);\n    margin: 0;\n    padding: 0;\n    border-right: none;\n}\n.characters-panel.is-open[data-v-fd2fc302] {\n    transform: translateX(0);\n}\n.saves-panel[data-v-fd2fc302] {\n    width: 100%;\n    border-left: none;\n}\n.saves-container[data-v-fd2fc302], .online-saves-container[data-v-fd2fc302] {\n    padding: 1rem 1.2rem;\n    flex: 1;\n    min-height: 0;\n    max-height: none;\n}\n.auto-saves-grid[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    gap: 0.8rem;\n}\n.manual-saves-grid[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    gap: 0.8rem;\n    max-height: 300px;\n}\n.modal-content[data-v-fd2fc302] {\n    padding: 1rem;\n}\n.details-modal[data-v-fd2fc302] {\n    width: 95%;\n    max-height: 85vh;\n}\n.dialog-box[data-v-fd2fc302] {\n    width: 95%;\n    max-width: 400px;\n    padding: 1.5rem;\n}\n.characters-grid[data-v-fd2fc302] {\n    padding: 1rem;\n}\n.character-card[data-v-fd2fc302] {\n    padding: 1rem;\n    margin-bottom: 0.8rem;\n    transition: all 0.2s ease;\n}\n.character-card[data-v-fd2fc302]:active {\n    transform: scale(0.98);\n    background: linear-gradient(135deg, \n      rgba(var(--color-primary-rgb), 0.05), \n      rgba(var(--color-accent-rgb), 0.03)\n    );\n}\n.card-header[data-v-fd2fc302] {\n    flex-wrap: wrap;\n    gap: 0.8rem;\n}\n.char-info[data-v-fd2fc302] {\n    min-width: 120px;\n}\n.char-meta[data-v-fd2fc302] {\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n}\n@media (max-width: 640px) {\n.mobile-header[data-v-fd2fc302] {\n    padding: 0.8rem 1rem;\n}\n.mobile-menu-btn[data-v-fd2fc302] {\n    padding: 0.4rem 0.6rem;\n    font-size: 0.8rem;\n    min-height: 44px;\n    min-width: 44px;\n}\n.mobile-title h2[data-v-fd2fc302] {\n    font-size: 1.1rem;\n}\n.mobile-title .selected-info[data-v-fd2fc302] {\n    font-size: 0.75rem;\n}\n.characters-panel[data-v-fd2fc302] {\n    width: 90%;\n    max-width: 300px;\n}\n.character-card[data-v-fd2fc302] {\n    padding: 0.9rem;\n    position: relative;\n    overflow: hidden;\n}\n.character-card[data-v-fd2fc302]::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    background: rgba(var(--color-primary-rgb), 0.1);\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    transition: width 0.3s ease, height 0.3s ease;\n    pointer-events: none;\n}\n.character-card[data-v-fd2fc302]:active::after {\n    width: 200px;\n    height: 200px;\n}\n.save-card[data-v-fd2fc302], .online-save-card[data-v-fd2fc302] {\n    padding: 1rem;\n    position: relative;\n    overflow: hidden;\n}\n.save-card[data-v-fd2fc302]::after, .online-save-card[data-v-fd2fc302]::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    background: rgba(var(--color-success-rgb), 0.1);\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    transition: width 0.3s ease, height 0.3s ease;\n    pointer-events: none;\n}\n.save-card[data-v-fd2fc302]:active::after, .online-save-card[data-v-fd2fc302]:active::after {\n    width: 150px;\n    height: 150px;\n}\n.auto-saves-grid[data-v-fd2fc302] {\n    gap: 0.6rem;\n}\n.manual-saves-grid[data-v-fd2fc302] {\n    gap: 0.6rem;\n}\n}\n@media (max-width: 480px) {\n.empty-actions[data-v-fd2fc302] {\n    flex-direction: column;\n}\n.btn-create[data-v-fd2fc302], .btn-import[data-v-fd2fc302] {\n    width: 100%;\n}\n.mobile-header[data-v-fd2fc302] {\n    padding: 0.6rem 0.8rem;\n}\n.mobile-menu-btn[data-v-fd2fc302] {\n    padding: 0.4rem 0.5rem;\n    min-height: 44px;\n    min-width: 44px;\n}\n.mobile-title h2[data-v-fd2fc302] {\n    font-size: 1rem;\n}\n.hamburger[data-v-fd2fc302] {\n    width: 14px;\n    height: 10px;\n}\n.characters-panel[data-v-fd2fc302] {\n    width: 95%;\n    max-width: 280px;\n}\n.characters-grid[data-v-fd2fc302] {\n    padding: 0.8rem;\n}\n.character-card[data-v-fd2fc302] {\n    padding: 0.8rem;\n    margin-bottom: 0.8rem;\n    min-height: 80px;\n}\n.btn-save-action span[data-v-fd2fc302] {\n    font-size: 0.75rem;\n}\n.card-header[data-v-fd2fc302] {\n    margin-bottom: 0.8rem;\n    gap: 0.6rem;\n}\n.char-avatar[data-v-fd2fc302] {\n    width: 40px;\n    height: 40px;\n    font-size: 1.1rem;\n}\n.mode-indicator[data-v-fd2fc302] {\n    width: 16px;\n    height: 16px;\n    font-size: 0.6rem;\n}\n.char-name[data-v-fd2fc302] {\n    font-size: 1rem;\n}\n.char-meta[data-v-fd2fc302] {\n    font-size: 0.8rem;\n}\n.saves-container[data-v-fd2fc302], .online-saves-container[data-v-fd2fc302] {\n    padding: 0.8rem;\n    flex: 1;\n    min-height: 0;\n    max-height: none;\n}\n.save-card[data-v-fd2fc302], .online-save-card[data-v-fd2fc302] {\n    padding: 0.9rem;\n    min-height: 120px;\n}\n.stat-grid[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    gap: 0.5rem;\n}\n.save-footer[data-v-fd2fc302] {\n    flex-direction: column;\n    gap: 0.3rem;\n    align-items: flex-start;\n}\n.dialog-box[data-v-fd2fc302] {\n    width: 95%;\n    padding: 1.2rem;\n    max-height: 90vh;\n    overflow-y: auto;\n}\n.dialog-title[data-v-fd2fc302] {\n    font-size: 1.3rem;\n}\n.dialog-actions[data-v-fd2fc302] {\n    flex-direction: column-reverse;\n    gap: 0.8rem;\n}\n.btn-dialog-confirm[data-v-fd2fc302],\n  .btn-dialog-cancel[data-v-fd2fc302] {\n    width: 100%;\n    padding: 0.8rem;\n    min-height: 44px;\n    font-size: 1rem;\n}\n.details-grid[data-v-fd2fc302] {\n    grid-template-columns: 1fr;\n    gap: 1rem;\n}\n.detail-section[data-v-fd2fc302] {\n    padding: 1rem;\n}\n.btn-details[data-v-fd2fc302], .btn-export[data-v-fd2fc302], .btn-delete[data-v-fd2fc302] {\n    min-height: 36px;\n    font-size: 0.85rem;\n    padding: 0.6rem 0.8rem;\n}\n.btn-start[data-v-fd2fc302], .btn-play[data-v-fd2fc302], .btn-sync[data-v-fd2fc302] {\n    min-height: 40px;\n    padding: 0.7rem 1rem;\n    font-size: 0.85rem;\n}\n}\n@media (max-width: 360px) {\n.mobile-header[data-v-fd2fc302] {\n    padding: 0.5rem;\n}\n.mobile-menu-btn[data-v-fd2fc302] {\n    padding: 0.3rem 0.4rem;\n    gap: 0.3rem;\n    min-height: 40px;\n    min-width: 40px;\n}\n.mobile-title h2[data-v-fd2fc302] {\n    font-size: 0.95rem;\n}\n.mobile-title .selected-info[data-v-fd2fc302] {\n    font-size: 0.7rem;\n}\n.characters-panel[data-v-fd2fc302] {\n    width: 100%;\n    max-width: 260px;\n    min-width: 240px;\n}\n.character-card[data-v-fd2fc302] {\n    padding: 0.6rem;\n    min-height: 70px;\n}\n.save-card[data-v-fd2fc302], .online-save-card[data-v-fd2fc302] {\n    padding: 0.8rem;\n    min-height: 100px;\n}\n.save-header[data-v-fd2fc302] {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.5rem;\n}\n.save-badges[data-v-fd2fc302] {\n    align-self: stretch;\n    justify-content: flex-start;\n}\n.dialog-box[data-v-fd2fc302] {\n    width: 98%;\n    padding: 1rem;\n    margin: 0.5rem;\n    max-height: 95vh;\n}\n.dialog-title[data-v-fd2fc302] {\n    font-size: 1.1rem;\n}\n.dialog-message[data-v-fd2fc302] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n}\n.dialog-input[data-v-fd2fc302] {\n    padding: 0.7rem;\n    font-size: 0.9rem;\n}\n.btn-dialog-confirm[data-v-fd2fc302],\n  .btn-dialog-cancel[data-v-fd2fc302] {\n    padding: 0.7rem;\n    font-size: 0.9rem;\n    min-height: 40px;\n}\n.character-management-panel[data-v-fd2fc302] {\n    height: 100%;\n    overflow: hidden;\n}\n.main-content[data-v-fd2fc302] {\n    flex: 1;\n    overflow: hidden;\n    min-height: 0;\n}\n.saves-container[data-v-fd2fc302], .online-saves-container[data-v-fd2fc302] {\n    flex: 1;\n    min-height: 0;\n    padding: 0.6rem;\n    max-height: none;\n}\n.char-name[data-v-fd2fc302] {\n    font-size: 0.9rem;\n}\n.char-meta[data-v-fd2fc302] {\n    font-size: 0.75rem;\n}\n.save-count .count[data-v-fd2fc302] {\n    font-size: 1rem;\n}\n.save-count .label[data-v-fd2fc302] {\n    font-size: 0.65rem;\n}\n}\n\n/* Style unification overrides */\n/* Replace absolute divider with contextual borders */\n.grid-container[data-v-fd2fc302]::before { content: none;\n}\n.grid-header-left[data-v-fd2fc302],\n.grid-content-left[data-v-fd2fc302],\n.grid-footer-left[data-v-fd2fc302] {\n  border-right: var(--cm-divider-width) solid var(--color-primary);\n  box-sizing: border-box;\n}\n\n/* Ensure left column fills its grid cell at <=1024px (fix misaligned divider) */\n@media (max-width: 1024px) {\n.grid-content-left.characters-panel[data-v-fd2fc302] {\n    max-width: none;\n    width: 100%;\n}\n}\n\n/* Consistent radii across controls */\n.dialog-box[data-v-fd2fc302] { border-radius: var(--cm-radius-lg);\n}\n.dialog-input[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.btn-dialog-confirm[data-v-fd2fc302],\n.btn-dialog-cancel[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.fullscreen-back-btn[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.character-card[data-v-fd2fc302] { border-radius: var(--cm-radius-sm);\n}\n.save-card[data-v-fd2fc302],\n.online-save-card[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.btn-details[data-v-fd2fc302],\n.btn-delete[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.btn-start[data-v-fd2fc302],\n.btn-play[data-v-fd2fc302],\n.btn-sync[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n.btn-login[data-v-fd2fc302],\n.btn-close[data-v-fd2fc302] { border-radius: var(--cm-radius-md);\n}\n\n/* Desktop card density adjustments: make character list less flat */\n@media (min-width: 769px) {\n.characters-grid[data-v-fd2fc302] { padding: 0.8rem;\n}\n.character-card[data-v-fd2fc302] {\n    min-height: var(--cm-card-min-h);\n    padding: var(--cm-card-padding);\n}\n.card-header[data-v-fd2fc302] {\n    gap: var(--cm-header-gap);\n    margin-bottom: 0.6rem;\n}\n.char-avatar[data-v-fd2fc302] {\n    width: var(--cm-avatar-size);\n    height: var(--cm-avatar-size);\n    font-size: 0.95rem;\n}\n.char-name[data-v-fd2fc302] { font-size: var(--cm-name-font);\n}\n.char-meta[data-v-fd2fc302] { font-size: var(--cm-meta-font);\n}\n.save-count[data-v-fd2fc302] { min-width: var(--cm-save-count-minw);\n}\n.save-count .count[data-v-fd2fc302] { font-size: var(--cm-save-count-count-font);\n}\n.save-count .label[data-v-fd2fc302] { font-size: var(--cm-save-count-label-font);\n}\n}\n",""]);const i=l},2753:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.talent-selection-container[data-v-5a49dc56] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.loading-state[data-v-5a49dc56],\n.error-state[data-v-5a49dc56],\n.placeholder[data-v-5a49dc56] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.talent-layout[data-v-5a49dc56] {\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  gap: 2rem;\n  height: 100%;\n  overflow: hidden;\n}\n.talent-left-panel[data-v-5a49dc56] {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--color-surface);\n}\n\n/* 顶部功能按钮 */\n.top-actions-container[data-v-5a49dc56] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.1);\n  justify-content: flex-end;\n}\n.top-actions-container .action-item[data-v-5a49dc56] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  white-space: nowrap;\n}\n.top-actions-container .action-item[data-v-5a49dc56]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.talent-list-container[data-v-5a49dc56] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.talent-list-container[data-v-5a49dc56]::-webkit-scrollbar { width: 8px;\n}\n.talent-list-container[data-v-5a49dc56]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.talent-list-container[data-v-5a49dc56]::-webkit-scrollbar-thumb { background: rgba(180, 142, 173, 0.3); border-radius: 4px;\n}\n.talent-list-container[data-v-5a49dc56]::-webkit-scrollbar-thumb:hover { background: rgba(180, 142, 173, 0.5);\n}\n.talent-item[data-v-5a49dc56] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  margin-bottom: 0.5rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-left: 3px solid transparent;\n}\n.item-content[data-v-5a49dc56] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-grow: 1;\n  gap: 0.5rem;\n}\n.talent-cost[data-v-5a49dc56] {\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n  white-space: nowrap;\n  flex-shrink: 0;\n}\n\n/* 按钮组容器 */\n.action-buttons[data-v-5a49dc56] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n  margin-left: 0.5rem;\n}\n.talent-item:hover .action-buttons[data-v-5a49dc56] {\n  opacity: 1;\n}\n\n/* 编辑按钮 */\n.edit-btn[data-v-5a49dc56] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.edit-btn[data-v-5a49dc56]:hover {\n  color: var(--color-primary);\n  background-color: rgba(59, 130, 246, 0.1);\n}\n.delete-btn[data-v-5a49dc56] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.delete-btn[data-v-5a49dc56]:hover {\n  color: var(--color-danger);\n  background-color: rgba(255, 0, 0, 0.1);\n}\n.talent-item[data-v-5a49dc56]:hover {\n  background: rgba(180, 142, 173, 0.1);\n}\n.talent-item.selected[data-v-5a49dc56] {\n  background: rgba(180, 142, 173, 0.2);\n  color: #b48ead;\n  border-left: 3px solid #b48ead;\n  font-weight: 600;\n}\n.talent-name[data-v-5a49dc56] {\n  font-weight: 500;\n}\n.single-actions-container[data-v-5a49dc56] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  gap: 0.5rem;\n}\n.action-item[data-v-5a49dc56] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 1rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n.action-item[data-v-5a49dc56]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.action-name[data-v-5a49dc56] {\n  font-weight: 500;\n}\n.talent-details-container[data-v-5a49dc56] {\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  padding: 1.5rem;\n  background: var(--color-surface);\n}\n.talent-details[data-v-5a49dc56] {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n}\n.talent-details h2[data-v-5a49dc56] {\n  margin-top: 0;\n  margin-bottom: 1rem;\n  color: #b48ead;\n  flex-shrink: 0;\n}\n.description-scroll[data-v-5a49dc56] {\n  flex: 1;\n  overflow-y: auto;\n  line-height: 1.6;\n  margin-bottom: 1rem;\n  padding-right: 0.5rem;\n}\n.description-scroll p[data-v-5a49dc56] {\n  margin: 0;\n  white-space: pre-wrap;\n  color: var(--color-text-secondary);\n}\n.description-scroll[data-v-5a49dc56]::-webkit-scrollbar { width: 8px;\n}\n.description-scroll[data-v-5a49dc56]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.description-scroll[data-v-5a49dc56]::-webkit-scrollbar-thumb { background: rgba(180, 142, 173, 0.3); border-radius: 4px;\n}\n.description-scroll[data-v-5a49dc56]::-webkit-scrollbar-thumb:hover { background: rgba(180, 142, 173, 0.5);\n}\n\n/* 响应式适配 - 手机端优化 */\n@media (max-width: 1200px) {\n.talent-layout[data-v-5a49dc56] {\n    grid-template-columns: 1fr 1.8fr;\n    gap: 1.5rem;\n}\n}\n@media (max-width: 1024px) {\n.talent-layout[data-v-5a49dc56] {\n    grid-template-columns: 1fr 1.5fr;\n    gap: 1.2rem;\n}\n.talent-details h2[data-v-5a49dc56] {\n    font-size: 1.6rem;\n}\n}\n@media (max-width: 640px) {\n.top-actions-container[data-v-5a49dc56] {\n    flex-wrap: wrap;\n    justify-content: stretch;\n}\n.top-actions-container .action-item[data-v-5a49dc56] {\n    flex-grow: 1;\n    text-align: center;\n}\n.talent-layout[data-v-5a49dc56] {\n    /* 改为垂直堆叠布局 */\n    grid-template-columns: 1fr;\n    grid-template-rows: auto 1fr;\n    gap: 1rem;\n    height: auto;\n    overflow: visible;\n    padding: 0.8rem;\n}\n.talent-left-panel[data-v-5a49dc56] {\n    order: 1;\n    max-height: 40vh;\n}\n.talent-details-container[data-v-5a49dc56] {\n    order: 2;\n    min-height: 300px;\n}\n.talent-list-container[data-v-5a49dc56] {\n    max-height: 35vh;\n    /* 添加触摸滚动优化 */\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n}\n  \n  /* 优化触摸体验 */\n.talent-item[data-v-5a49dc56],\n  .action-item[data-v-5a49dc56] {\n    -webkit-tap-highlight-color: transparent;\n    touch-action: manipulation;\n}\n}\n@media (max-width: 640px) {\n.talent-layout[data-v-5a49dc56] {\n    gap: 0.8rem;\n    padding: 0.6rem;\n}\n.talent-left-panel[data-v-5a49dc56] {\n    max-height: 35vh;\n}\n.talent-list-container[data-v-5a49dc56] {\n    max-height: 30vh;\n    padding: 0.5rem;\n}\n.talent-item[data-v-5a49dc56] {\n    padding: 0.7rem;\n    font-size: 0.95rem;\n    margin-bottom: 0.4rem;\n}\n.single-actions-container[data-v-5a49dc56] {\n    padding: 0.5rem;\n    gap: 0.4rem;\n}\n.action-item[data-v-5a49dc56] {\n    padding: 0.7rem 1rem;\n    font-size: 0.9rem;\n}\n.talent-details-container[data-v-5a49dc56] {\n    padding: 1.2rem;\n    min-height: 250px;\n}\n.talent-details h2[data-v-5a49dc56] {\n    font-size: 1.4rem;\n    margin-bottom: 0.8rem;\n}\n}\n@media (max-width: 480px) {\n.top-actions-container[data-v-5a49dc56] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.talent-selection-container[data-v-5a49dc56] {\n    padding: 0.4rem;\n    height: auto;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.talent-layout[data-v-5a49dc56] {\n    gap: 0.6rem;\n    padding: 0;\n    height: auto;\n    min-height: 0;\n}\n.talent-left-panel[data-v-5a49dc56] {\n    max-height: none;\n    border-radius: 6px;\n}\n.talent-list-container[data-v-5a49dc56] {\n    max-height: 26vh;\n    padding: 0.4rem;\n}\n.talent-item[data-v-5a49dc56] {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.9rem;\n    margin-bottom: 0.3rem;\n    border-radius: 4px;\n}\n.talent-name[data-v-5a49dc56] {\n    font-size: 0.9rem;\n}\n.single-actions-container[data-v-5a49dc56] {\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.4rem;\n}\n.action-item[data-v-5a49dc56] {\n    padding: 0.6rem;\n    font-size: 0.85rem;\n    border-radius: 4px;\n}\n.talent-details-container[data-v-5a49dc56] {\n    padding: 1rem;\n    min-height: 200px;\n    border-radius: 6px;\n}\n.talent-details h2[data-v-5a49dc56] {\n    font-size: 1.3rem;\n    margin-bottom: 0.6rem;\n}\n.description-scroll[data-v-5a49dc56] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    padding-right: 0.3rem;\n}\n.placeholder[data-v-5a49dc56] {\n    font-size: 1rem;\n    padding: 1rem;\n    text-align: center;\n    min-height: 150px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.top-actions-container[data-v-5a49dc56] {\n    flex-direction: column;\n    align-items: stretch;\n    padding: 0.5rem;\n}\n.top-actions-container .action-item[data-v-5a49dc56] {\n    text-align: center;\n}\n}\n@media (max-width: 360px) {\n.talent-selection-container[data-v-5a49dc56] {\n    padding: 0.3rem;\n}\n.talent-layout[data-v-5a49dc56] {\n    gap: 0.4rem;\n}\n.talent-left-panel[data-v-5a49dc56] {\n    max-height: 28vh;\n}\n.talent-list-container[data-v-5a49dc56] {\n    max-height: 24vh;\n    padding: 0.3rem;\n}\n.talent-item[data-v-5a49dc56] {\n    padding: 0.5rem 0.6rem;\n    font-size: 0.85rem;\n    margin-bottom: 0.2rem;\n}\n.talent-name[data-v-5a49dc56] {\n    font-size: 0.8rem;\n}\n.talent-details-container[data-v-5a49dc56] {\n    padding: 0.8rem;\n    min-height: 180px;\n}\n.talent-details h2[data-v-5a49dc56] {\n    font-size: 1.1rem;\n    margin-bottom: 0.5rem;\n}\n.description-scroll[data-v-5a49dc56] {\n    font-size: 0.85rem;\n    line-height: 1.4;\n}\n.action-item[data-v-5a49dc56] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.placeholder[data-v-5a49dc56] {\n    font-size: 0.9rem;\n    padding: 0.8rem;\n    min-height: 120px;\n}\n}\n",""]);const i=l},2881:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.attribute-allocation-container[data-v-0d0d1bb1] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  color: var(--color-text);\n}\n.header[data-v-0d0d1bb1] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.points-display .negative[data-v-0d0d1bb1] {\n  color: var(--color-error) !important;\n}\nh2[data-v-0d0d1bb1] {\n  margin: 0;\n  color: var(--color-accent);\n}\n.points-display[data-v-0d0d1bb1] {\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.points-display span[data-v-0d0d1bb1] {\n  font-weight: bold;\n  color: var(--color-primary);\n  font-size: 1.5rem;\n}\n.attributes-list[data-v-0d0d1bb1] {\n  overflow-y: auto;\n  flex-grow: 1;\n}\n.attribute-item[data-v-0d0d1bb1] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 0;\n  border-bottom: 1px solid var(--color-border);\n}\n.attribute-item[data-v-0d0d1bb1]:last-child {\n  border-bottom: none;\n}\n.attribute-info[data-v-0d0d1bb1] {\n  flex-basis: 70%;\n}\n.attribute-name[data-v-0d0d1bb1] {\n  font-size: 1.1rem;\n  font-weight: 500;\n  color: var(--color-accent);\n}\n.attribute-desc[data-v-0d0d1bb1] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  margin: 0.3rem 0 0 0;\n  line-height: 1.4;\n}\n.attribute-controls[data-v-0d0d1bb1] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n.attribute-controls button[data-v-0d0d1bb1] {\n  width: 35px;\n  height: 35px;\n  border-radius: 50%;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  color: var(--color-accent);\n  font-size: 1.5rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.attribute-controls button[data-v-0d0d1bb1]:hover:not(:disabled) {\n  background: var(--color-accent);\n  color: var(--color-surface);\n  border-color: var(--color-accent);\n}\n.attribute-controls button[data-v-0d0d1bb1]:disabled,\n.attribute-controls button.disabled[data-v-0d0d1bb1] {\n  opacity: 0.4;\n  cursor: not-allowed;\n  background: var(--color-surface-light);\n  border-color: var(--color-border);\n  color: var(--color-text-muted);\n}\n.attribute-value[data-v-0d0d1bb1] {\n  font-size: 1.4rem;\n  font-weight: bold;\n  min-width: 30px;\n  text-align: center;\n  color: var(--color-text);\n}\n.actions[data-v-0d0d1bb1] {\n  padding-top: 1rem;\n  display: flex;\n  justify-content: center;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n.actions button[data-v-0d0d1bb1] {\n  padding: 0.5rem 1.5rem;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface);\n  color: var(--color-text);\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.actions button[data-v-0d0d1bb1]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n}\n.actions .btn-secondary[data-v-0d0d1bb1] {\n  border-color: var(--color-text-secondary);\n  color: var(--color-text-secondary);\n}\n.actions .btn-secondary[data-v-0d0d1bb1]:hover {\n  background: var(--color-text-secondary);\n  color: var(--color-surface);\n}\n.actions .btn-warning[data-v-0d0d1bb1] {\n  border-color: var(--color-warning);\n  color: var(--color-warning);\n}\n.actions .btn-warning[data-v-0d0d1bb1]:hover {\n  background: var(--color-warning);\n  color: var(--color-surface);\n}\n.actions .btn-success[data-v-0d0d1bb1] {\n  border-color: var(--color-success);\n  color: var(--color-success);\n}\n.actions .btn-success[data-v-0d0d1bb1]:hover {\n  background: var(--color-success);\n  color: var(--color-surface);\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n.header[data-v-0d0d1bb1] {\n    flex-direction: column;\n    gap: 0.75rem;\n    text-align: center;\n    padding-bottom: 0.75rem;\n}\n.header h2[data-v-0d0d1bb1] {\n    font-size: 1.4rem;\n}\n.points-display[data-v-0d0d1bb1] {\n    font-size: 1.1rem;\n}\n.points-display span[data-v-0d0d1bb1] {\n    font-size: 1.3rem;\n}\n.attribute-item[data-v-0d0d1bb1] {\n    flex-direction: row;\n    gap: 0.75rem;\n    padding: 0.75rem 0;\n}\n.attribute-info[data-v-0d0d1bb1] {\n    flex-basis: 60%;\n}\n.attribute-name[data-v-0d0d1bb1] {\n    font-size: 1rem;\n}\n.attribute-desc[data-v-0d0d1bb1] {\n    font-size: 0.8rem;\n}\n.attribute-controls[data-v-0d0d1bb1] {\n    justify-content: flex-end;\n    gap: 0.75rem;\n}\n.attribute-controls button[data-v-0d0d1bb1] {\n    width: 36px;\n    height: 36px;\n    font-size: 1.6rem;\n}\n.attribute-value[data-v-0d0d1bb1] {\n    font-size: 1.4rem;\n    min-width: 35px;\n}\n.actions[data-v-0d0d1bb1] {\n    gap: 0.75rem;\n    padding-top: 0.75rem;\n}\n.actions button[data-v-0d0d1bb1] {\n    padding: 0.6rem 1.5rem;\n    font-size: 0.95rem;\n}\n}\n@media (max-width: 640px) {\n.header[data-v-0d0d1bb1] {\n    gap: 1rem;\n}\n.attribute-item[data-v-0d0d1bb1] {\n    flex-direction: column;\n    gap: 1rem;\n    padding: 1.5rem 0;\n}\n.attribute-info[data-v-0d0d1bb1] {\n    flex-basis: auto;\n    text-align: center;\n}\n.attribute-controls[data-v-0d0d1bb1] {\n    justify-content: center;\n    gap: 1.5rem;\n}\n.attribute-controls button[data-v-0d0d1bb1] {\n    width: 40px;\n    height: 40px;\n    font-size: 1.8rem;\n}\n.attribute-value[data-v-0d0d1bb1] {\n    font-size: 1.6rem;\n    min-width: 40px;\n}\n.actions[data-v-0d0d1bb1] {\n    gap: 1rem;\n}\n.actions button[data-v-0d0d1bb1] {\n    padding: 0.75rem 2rem;\n    font-size: 1rem;\n}\n}\n@media (max-width: 480px) {\n.header h2[data-v-0d0d1bb1] {\n    font-size: 1.5rem;\n}\n.points-display[data-v-0d0d1bb1] {\n    font-size: 1rem;\n}\n.points-display span[data-v-0d0d1bb1] {\n    font-size: 1.3rem;\n}\n.attribute-name[data-v-0d0d1bb1] {\n    font-size: 1rem;\n}\n.attribute-desc[data-v-0d0d1bb1] {\n    font-size: 0.8rem;\n}\n.attribute-controls button[data-v-0d0d1bb1] {\n    width: 36px;\n    height: 36px;\n    font-size: 1.6rem;\n}\n.attribute-value[data-v-0d0d1bb1] {\n    font-size: 1.4rem;\n}\n.actions[data-v-0d0d1bb1] {\n    flex-direction: column;\n    align-items: center;\n}\n.actions button[data-v-0d0d1bb1] {\n    width: 100%;\n    max-width: 200px;\n}\n}\n",""]);const i=l},3019:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.hexagon-chart-container[data-v-256c0aae] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n/* 浅色主题 - 金辉仙光 */\n.grid-line[data-v-256c0aae] {\n  fill: none;\n  stroke: var(--color-primary);\n  stroke-width: 1;\n  opacity: 0.2;\n}\n.data-polygon[data-v-256c0aae] {\n  fill: url(#goldGradient);\n  stroke: var(--color-primary);\n  stroke-width: 2.5;\n  filter: drop-shadow(0 0 8px rgba(218, 165, 32, 0.3));\n  transition: all 0.3s ease;\n}\n.data-polygon[data-v-256c0aae]:hover {\n  filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.5));\n}\n.data-point[data-v-256c0aae] {\n  fill: var(--color-accent);\n  stroke: rgba(255, 255, 255, 0.9);\n  stroke-width: 2;\n  filter: drop-shadow(0 0 4px rgba(255, 140, 0, 0.4));\n}\n.data-value-text[data-v-256c0aae] {\n  fill: var(--color-text);\n  font-size: 12px;\n  font-weight: bold;\n  font-family: var(--font-family-serif);\n  text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);\n}\n.label-text[data-v-256c0aae] {\n  fill: var(--color-primary);\n  font-size: 13px;\n  font-weight: 600;\n  font-family: var(--font-family-serif);\n  text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.9);\n}\n\n/* 深色主题 - 夜空星辰 */\n[data-theme="dark"] .grid-line[data-v-256c0aae] {\n  stroke: #64b5f6;\n  opacity: 0.4;\n}\n[data-theme="dark"] .data-polygon[data-v-256c0aae] {\n  fill: url(#darkGradient);\n  stroke: #64b5f6;\n}\n[data-theme="dark"] .data-point[data-v-256c0aae] {\n  fill: #ba68c8;\n  stroke: rgba(30, 30, 60, 0.8);\n}\n[data-theme="dark"] .data-value-text[data-v-256c0aae] {\n  fill: #e1e4e8;\n}\n[data-theme="dark"] .label-text[data-v-256c0aae] {\n  fill: #64b5f6;\n}\n',""]);const i=l},3098:(e,n,t)=>{function a(e){return JSON.parse(JSON.stringify(e))}function o(e){if(!e)return console.warn("[数据验证] 存档数据为空"),e;if(e.背包||(e.背包={灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}}),e.背包.物品||(e.背包.物品={}),e.背包.灵石||(e.背包.灵石={下品:0,中品:0,上品:0,极品:0}),e.背包?.物品){const n=e.背包.物品;Object.keys(n).forEach(e=>{const t=n[e];t&&"object"==typeof t&&t.名称||(delete n[e],console.warn(`[数据验证] 移除无效物品: ${e}`))})}return e}async function r(e){try{console.log("[数据验证] 酒馆重复变量清理（新系统中已优化）")}catch(e){console.warn("[数据验证] 清理酒馆重复变量失败:",e)}}function l(e){if(!e||"object"!=typeof e)return console.error("[NPC校验] 提供的输入不是一个有效的对象:",e),[!1,null];const n={...e};if("string"!=typeof n.名字||0===n.名字.trim().length)return console.error("[NPC校验] 核心字段`名字`缺失或无效:",n),[!1,null];const t={...n};return"string"!=typeof t.性别&&(t.性别="其他"),"number"!=typeof t.年龄&&(t.年龄=void 0),"string"!=typeof t.与玩家关系&&(t.与玩家关系="相识"),"number"!=typeof t.好感度&&(t.好感度=0),Array.isArray(t.记忆)||(t.记忆=[]),Array.isArray(t.人格底线)||(t.人格底线=[]),Array.isArray(t.天赋)||(t.天赋=[]),Array.isArray(t.性格特征)||(t.性格特征=[]),"object"!=typeof t.境界||null===t.境界?t.境界={名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"}:("string"!=typeof t.境界.名称&&(t.境界.名称="凡人"),"string"!=typeof t.境界.阶段&&(t.境界.阶段=""),"number"!=typeof t.境界.当前进度&&(t.境界.当前进度=0),"number"!=typeof t.境界.下一级所需&&(t.境界.下一级所需=100),"string"!=typeof t.境界.突破描述&&(t.境界.突破描述="引气入体，感悟天地灵气，踏上修仙第一步")),"object"!=typeof t.背包||null===t.背包?t.背包={灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}}:("object"==typeof t.背包.灵石&&null!==t.背包.灵石||(t.背包.灵石={下品:0,中品:0,上品:0,极品:0}),"object"==typeof t.背包.物品&&null!==t.背包.物品||(t.背包.物品={})),"boolean"!=typeof t.实时关注&&(t.实时关注=!1),[!0,t]}function i(e,n,t){const a=[];if(!e)return a.push("存档数据为空"),{isValid:!1,errors:a};if(e.背包?(e.背包.灵石||a.push("灵石数据缺失"),e.背包.物品||a.push("物品数据缺失")):a.push("背包数据缺失"),n?.角色基础信息){const e=n.角色基础信息;e.名字&&"string"==typeof e.名字||a.push("角色姓名无效"),e.性别||a.push("角色性别缺失")}return"creation"===t&&(e.玩家角色状态?.位置||a.push("当前位置信息缺失"),e.玩家角色状态?.境界||a.push("境界信息缺失")),{isValid:0===a.length,errors:a}}t.d(n,{aD:()=>r,deepCleanForClone:()=>a,jx:()=>l,qj:()=>o,zB:()=>i})},3302:(e,n,t)=>{t.d(n,{Yz:()=>r,w9:()=>o});class a{static instance;debugMode=!1;consoleDebug=!1;performanceMonitor=!1;constructor(){this.loadDebugSettings()}static getInstance(){return a.instance||(a.instance=new a),a.instance}loadDebugSettings(){try{const e=localStorage.getItem("dad_game_settings");if(e){const n=JSON.parse(e);this.debugMode=n.debugMode||!1,this.consoleDebug=n.consoleDebug||!1,this.performanceMonitor=n.performanceMonitor||!1}}catch(e){console.error("加载调试设置失败:",e),this.debugMode=!1,this.consoleDebug=!1,this.performanceMonitor=!1}}reloadSettings(){this.loadDebugSettings()}setDebugMode(e){this.debugMode=e,this.reloadSettings(),this.consoleDebug&&console.log("[调试] 调试模式"+(e?"已启用":"已禁用"))}isDebugMode(){return this.debugMode}isConsoleDebugEnabled(){return this.debugMode&&this.consoleDebug}isPerformanceMonitorEnabled(){return this.debugMode&&this.performanceMonitor}log(e,n,t){this.isConsoleDebugEnabled()&&(void 0!==t?console.log(`[${e}] ${n}`,t):console.log(`[${e}] ${n}`))}warn(e,n,t){this.isConsoleDebugEnabled()&&(void 0!==t?console.warn(`[${e}] ${n}`,t):console.warn(`[${e}] ${n}`))}error(e,n,t){void 0!==t?console.error(`[${e}] ${n}`,t):console.error(`[${e}] ${n}`)}timeStart(e){this.isPerformanceMonitorEnabled()&&console.time(`[性能] ${e}`)}timeEnd(e){this.isPerformanceMonitorEnabled()&&console.timeEnd(`[性能] ${e}`)}group(e){this.isConsoleDebugEnabled()&&console.group(`[调试] ${e}`)}groupEnd(){this.isConsoleDebugEnabled()&&console.groupEnd()}info(e,n,t){this.debugMode&&(void 0!==t?console.info(`[${e}] ${n}`,t):console.info(`[${e}] ${n}`))}table(e,n,t){this.isConsoleDebugEnabled()&&(console.log(`[${e}] ${n}:`),console.table(t))}count(e){this.isPerformanceMonitorEnabled()&&console.count(`[统计] ${e}`)}countReset(e){this.isPerformanceMonitorEnabled()&&console.countReset(`[统计] ${e}`)}}const o=a.getInstance(),r={log:(e,n,t)=>o.log(e,n,t),warn:(e,n,t)=>o.warn(e,n,t),error:(e,n,t)=>o.error(e,n,t),info:(e,n,t)=>o.info(e,n,t),timeStart:e=>o.timeStart(e),timeEnd:e=>o.timeEnd(e),group:e=>o.group(e),groupEnd:()=>o.groupEnd(),table:(e,n,t)=>o.table(e,n,t),count:e=>o.count(e),countReset:e=>o.countReset(e),setMode:e=>o.setDebugMode(e),isEnabled:()=>o.isDebugMode(),reload:()=>o.reloadSettings()}},3310:(e,n,t)=>{t.d(n,{useActionQueueStore:()=>r});var a=t(1774),o=t(4061);const r=(0,a.nY)("actionQueue",()=>{const e=(0,o.ref)([]),n=()=>{console.log("[操作队列] 清空操作队列，共",e.value.length,"个操作"),e.value=[],a()},t=()=>0===e.value.length?"":`\n\n【玩家最近操作】\n在本轮对话前，玩家进行了以下操作：\n${e.value.map(e=>{switch(e.type){case"cultivate":return"大道"===e.itemType?`感悟了《${e.itemName}》大道`:`修炼了《${e.itemName}》功法`;case"equip":return`装备了《${e.itemName}》${e.itemType||"法宝"}`;case"use":return e.description||`使用了《${e.itemName}》`;case"unequip":return`卸下了《${e.itemName}》装备`;case"discard":return`丢弃了《${e.itemName}》`;case"npc_trade":return`尝试与 ${e.npcName} 交易 ${e.itemName}`;case"npc_request":return`向 ${e.npcName} 索要 ${e.itemName}`;case"npc_steal":return`尝试从 ${e.npcName} 身上偷取 ${e.itemName}`;default:return e.description}}).map(e=>`• ${e}`).join("\n")}\n\n⚠️ **重要提醒**：请优先基于这些玩家操作来生成回应！先处理和反映这些具体动作的结果，然后再回应用户输入的文本内容。这些操作具有更高的优先级，应该在叙事中得到明确体现。`,a=()=>{try{localStorage.setItem("dao_action_queue",JSON.stringify(e.value))}catch(e){console.warn("[操作队列] 保存到localStorage失败:",e)}};return(()=>{try{const n=localStorage.getItem("dao_action_queue");if(n){const t=JSON.parse(n),a=Date.now()-36e5;e.value=t.filter(e=>e.timestamp>a),console.log("[操作队列] 从存储加载",e.value.length,"个操作")}}catch(e){console.warn("[操作队列] 从localStorage加载失败:",e)}})(),{pendingActions:e,addAction:n=>{const t={...n,id:`action_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};"equip"===t.type?e.value=e.value.filter(e=>!("unequip"===e.type&&e.itemName===t.itemName)):"unequip"===t.type&&(e.value=e.value.filter(e=>!("equip"===e.type&&e.itemName===t.itemName))),"cultivate"===t.type&&(e.value=e.value.filter(e=>"cultivate"!==e.type));const o=e.value.findIndex(e=>e.type===n.type&&e.itemName===n.itemName);-1!==o?e.value[o]=t:e.value.push(t),console.log("[操作队列] 添加操作:",t),a()},removeAction:n=>{const t=e.value.findIndex(e=>e.id===n);if(-1!==t){const n=e.value.splice(t,1)[0];return console.log("[操作队列] 移除操作:",n),a(),n}return null},clearActions:n,getActionPrompt:t,consumeActions:()=>{const e=t();return e&&n(),e}}})},3329:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.save-panel[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n  overflow: hidden;\n  padding: 1rem;\n  gap: 1rem;\n  position: relative;\n}\n\n/* 工具栏移除：统一到顶栏动作 */\n\n/* 头部 */\n.panel-header[data-v-60408b0c] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  background: white;\n  border-radius: 0.75rem;\n  border: 1px solid #bae6fd;\n  flex-shrink: 0;\n}\n.header-left[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.header-icon[data-v-60408b0c] {\n  font-size: 1.5rem;\n}\n.header-info[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.panel-title[data-v-60408b0c] {\n  margin: 0;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #0369a1;\n}\n.save-subtitle[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #0284c7;\n}\n.header-actions[data-v-60408b0c] {\n  display: flex;\n  gap: 0.5rem;\n}\n.action-btn[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  border: 1px solid #bae6fd;\n  border-radius: 0.5rem;\n  background: white;\n  color: #0369a1;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.875rem;\n}\n.action-btn[data-v-60408b0c]:hover {\n  background: #f0f9ff;\n  border-color: #0284c7;\n}\n.action-btn.primary[data-v-60408b0c] {\n  background: #0284c7;\n  border-color: #0284c7;\n  color: white;\n}\n.action-btn.primary[data-v-60408b0c]:hover {\n  background: #0369a1;\n}\n.action-btn[data-v-60408b0c]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.animate-spin[data-v-60408b0c] {\n  animation: spin-60408b0c 1s linear infinite;\n}\n@keyframes spin-60408b0c {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n\n/* 存档容器 */\n.saves-container[data-v-60408b0c] {\n  flex: 1;\n  overflow-y: auto;\n  min-height: 0;\n  padding: 0 0.5rem 3rem 0.5rem;\n  \n  /* 滚动条样式 */\n  scrollbar-width: thin;\n  scrollbar-color: rgba(2, 132, 199, 0.3) rgba(243, 244, 246, 0.5);\n}\n.saves-container[data-v-60408b0c]::-webkit-scrollbar {\n  width: 8px;\n}\n.saves-container[data-v-60408b0c]::-webkit-scrollbar-track {\n  background: rgba(243, 244, 246, 0.5);\n  border-radius: 4px;\n}\n.saves-container[data-v-60408b0c]::-webkit-scrollbar-thumb {\n  background: rgba(2, 132, 199, 0.3);\n  border-radius: 4px;\n  transition: background 0.2s ease;\n}\n.saves-container[data-v-60408b0c]::-webkit-scrollbar-thumb:hover {\n  background: rgba(2, 132, 199, 0.5);\n}\n\n/* 区块样式 */\n.current-save-section[data-v-60408b0c],\n.saves-section[data-v-60408b0c],\n.operations-section[data-v-60408b0c] {\n  margin-bottom: 1.5rem;\n  background: white;\n  border-radius: 0.75rem;\n  border: 1px solid #bae6fd;\n  overflow: hidden;\n}\n.section-header[data-v-60408b0c] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.25rem;\n  background: #f0f9ff;\n  border-bottom: 1px solid #bae6fd;\n}\n.header-actions[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.section-title[data-v-60408b0c] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: #0369a1;\n}\n.saves-count[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #0c4a6e;\n  background: white;\n  padding: 0.25rem 0.75rem;\n  border-radius: 0.5rem;\n  font-weight: 600;\n  border: 1px solid #bae6fd;\n}\n\n/* 当前存档卡片 */\n.current-save-card[data-v-60408b0c] {\n  padding: 1.25rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.save-preview[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n.save-preview.small[data-v-60408b0c] {\n  gap: 0.75rem;\n}\n.preview-avatar[data-v-60408b0c] {\n  width: 3rem;\n  height: 3rem;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #0284c7, #0369a1);\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  font-size: 1.25rem;\n}\n.preview-avatar.small[data-v-60408b0c] {\n  width: 2.5rem;\n  height: 2.5rem;\n  font-size: 1rem;\n}\n.preview-info[data-v-60408b0c] {\n  flex: 1;\n}\n.character-name[data-v-60408b0c] {\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #0369a1;\n  margin-bottom: 0.25rem;\n}\n.save-name[data-v-60408b0c] {\n  font-size: 1rem;\n  font-weight: 700;\n  color: #1e40af;\n  margin-bottom: 0.15rem;\n}\n.character-name-small[data-v-60408b0c] {\n  font-size: 0.8rem;\n  font-weight: 500;\n  color: #64748b;\n  margin-bottom: 0.15rem;\n}\n.character-details[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.875rem;\n  color: #64748b;\n}\n.detail-separator[data-v-60408b0c] {\n  color: #cbd5e1;\n}\n.save-time[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n\n/* 特殊存档说明提示 */\n.save-hint[data-v-60408b0c] {\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  margin-top: 0.25rem;\n  display: inline-block;\n  font-weight: 500;\n}\n.save-hint.auto[data-v-60408b0c] {\n  background: rgba(16, 185, 129, 0.1);\n  color: #059669;\n  border: 1px solid rgba(16, 185, 129, 0.2);\n}\n.save-hint.last[data-v-60408b0c] {\n  background: rgba(59, 130, 246, 0.1);\n  color: #2563eb;\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n\n/* 当前进度的特殊存档说明 */\n.current-save-hint[data-v-60408b0c] {\n  font-size: 0.875rem;\n  padding: 0.5rem 0.75rem;\n  border-radius: 6px;\n  margin-top: 0.75rem;\n  display: block;\n  font-weight: 500;\n  line-height: 1.5;\n}\n.current-save-hint.auto[data-v-60408b0c] {\n  background: rgba(16, 185, 129, 0.1);\n  color: #059669;\n  border-left: 3px solid #10b981;\n}\n.current-save-hint.last[data-v-60408b0c] {\n  background: rgba(59, 130, 246, 0.1);\n  color: #2563eb;\n  border-left: 3px solid #3b82f6;\n}\n.save-stats[data-v-60408b0c] {\n  display: flex;\n  gap: 2rem;\n}\n.stat-item[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.stat-label[data-v-60408b0c] {\n  font-size: 0.75rem;\n  color: #64748b;\n  font-weight: 500;\n}\n.stat-value[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #0369a1;\n  font-weight: 600;\n}\n\n/* 存档列表 */\n.loading-state[data-v-60408b0c],\n.empty-state[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  text-align: center;\n}\n.loading-spinner[data-v-60408b0c],\n.empty-icon[data-v-60408b0c] {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n}\n.loading-text[data-v-60408b0c],\n.empty-text[data-v-60408b0c] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: #0369a1;\n  margin-bottom: 0.5rem;\n}\n.empty-hint[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n.saves-list[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  padding: 1rem;\n}\n.save-card[data-v-60408b0c] {\n  border: 1px solid #e0f2fe;\n  border-radius: 0.5rem;\n  background: #f8fafc;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.save-card[data-v-60408b0c]:hover {\n  background: #f0f9ff;\n  border-color: #bae6fd;\n  transform: translateY(-1px);\n}\n.save-card.active[data-v-60408b0c] {\n  background: #e0f2fe;\n  border-color: #0284c7;\n}\n.card-header[data-v-60408b0c] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  border-bottom: 1px solid #e0f2fe;\n}\n.card-actions[data-v-60408b0c] {\n  display: flex;\n  gap: 0.5rem;\n}\n.card-btn[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 2rem;\n  height: 2rem;\n  border: 1px solid #bae6fd;\n  border-radius: 0.375rem;\n  background: white;\n  color: #0284c7;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.card-btn[data-v-60408b0c]:hover {\n  background: #f0f9ff;\n  border-color: #0284c7;\n}\n.card-btn[data-v-60408b0c]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.card-btn.primary[data-v-60408b0c] {\n  color: #10b981;\n  border-color: #d1fae5;\n}\n.card-btn.primary[data-v-60408b0c]:hover {\n  background: #f0fdf4;\n  border-color: #10b981;\n}\n.card-btn.danger[data-v-60408b0c] {\n  color: #ef4444;\n  border-color: #fecaca;\n}\n.card-btn.danger[data-v-60408b0c]:hover {\n  background: #fef2f2;\n  border-color: #ef4444;\n}\n.card-btn.warning[data-v-60408b0c] {\n  color: #f59e0b;\n  border-color: #fef3c7;\n}\n.card-btn.warning[data-v-60408b0c]:hover {\n  background: #fffbeb;\n  border-color: #f59e0b;\n}\n\n/* 新建存档按钮 */\n.new-save-btn[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 2rem;\n  height: 2rem;\n  border: 1px solid #10b981;\n  border-radius: 0.375rem;\n  background: white;\n  color: #10b981;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.new-save-btn[data-v-60408b0c]:hover {\n  background: #f0fdf4;\n  border-color: #059669;\n  color: #059669;\n}\n.new-save-btn[data-v-60408b0c]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.card-content[data-v-60408b0c] {\n  padding: 1rem;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.save-details[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.detail-row[data-v-60408b0c] {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.875rem;\n}\n.detail-label[data-v-60408b0c] {\n  color: #64748b;\n}\n.detail-value[data-v-60408b0c] {\n  color: #0369a1;\n  font-weight: 500;\n}\n\n/* 操作列表 */\n.operations-list[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.operation-btn[data-v-60408b0c] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 0.5rem;\n}\n.operation-btn[data-v-60408b0c]:hover {\n  background: #f0f9ff;\n}\n.operation-btn.primary[data-v-60408b0c] {\n  background: linear-gradient(135deg, #0369a1 0%, #0284c7 100%);\n  color: white;\n}\n.operation-btn.primary[data-v-60408b0c]:hover {\n  background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(3, 105, 161, 0.3);\n}\n.operation-btn.primary .btn-title[data-v-60408b0c],\n.operation-btn.primary .btn-desc[data-v-60408b0c] {\n  color: white;\n}\n.operation-btn.danger[data-v-60408b0c]:hover {\n  background: #fef2f2;\n  color: #ef4444;\n}\n.operation-btn[data-v-60408b0c]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.btn-content[data-v-60408b0c] {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  gap: 0.25rem;\n}\n.btn-title[data-v-60408b0c] {\n  font-weight: 500;\n  color: #0369a1;\n}\n.btn-desc[data-v-60408b0c] {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n.operation-btn.danger .btn-title[data-v-60408b0c] {\n  color: #ef4444;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.save-stats[data-v-60408b0c] {\n    gap: 1rem;\n}\n.card-header[data-v-60408b0c] {\n    flex-direction: column;\n    gap: 1rem;\n    align-items: stretch;\n}\n.save-preview[data-v-60408b0c] {\n    justify-content: center;\n}\n.card-actions[data-v-60408b0c] {\n    justify-content: center;\n}\n.header-actions .btn-text[data-v-60408b0c] {\n    display: none;\n}\n}\n\n/* 深色主题 */\n[data-theme="dark"] .save-panel[data-v-60408b0c] {\n  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);\n}\n[data-theme="dark"] .panel-header[data-v-60408b0c],\n[data-theme="dark"] .current-save-section[data-v-60408b0c],\n[data-theme="dark"] .saves-section[data-v-60408b0c],\n[data-theme="dark"] .operations-section[data-v-60408b0c] {\n  background: #1e293b;\n  border-color: #475569;\n}\n\n/* 存档名图标样式 */\n.auto-save-icon[data-v-60408b0c],\n.last-save-icon[data-v-60408b0c] {\n  display: inline-block;\n  margin-right: 0.25rem;\n  vertical-align: middle;\n}\n.auto-save-icon[data-v-60408b0c] {\n  color: #10b981;\n}\n.last-save-icon[data-v-60408b0c] {\n  color: #3b82f6;\n}\n[data-theme="dark"] .section-header[data-v-60408b0c] {\n  background: #334155;\n  border-bottom-color: #475569;\n}\n[data-theme="dark"] .panel-title[data-v-60408b0c],\n[data-theme="dark"] .section-title[data-v-60408b0c],\n[data-theme="dark"] .character-name[data-v-60408b0c],\n[data-theme="dark"] .save-name[data-v-60408b0c] {\n  color: #0ea5e9;\n}\n[data-theme="dark"] .character-name-small[data-v-60408b0c] {\n  color: #94a3b8;\n}\n[data-theme="dark"] .save-subtitle[data-v-60408b0c],\n[data-theme="dark"] .saves-count[data-v-60408b0c] {\n  color: #38bdf8;\n}\n[data-theme="dark"] .action-btn[data-v-60408b0c],\n[data-theme="dark"] .card-btn[data-v-60408b0c] {\n  background: #374151;\n  border-color: #475569;\n  color: #0ea5e9;\n}\n[data-theme="dark"] .action-btn[data-v-60408b0c]:hover,\n[data-theme="dark"] .card-btn[data-v-60408b0c]:hover {\n  background: #4b5563;\n}\n[data-theme="dark"] .card-btn.primary[data-v-60408b0c] {\n  color: #10b981;\n  border-color: #065f46;\n}\n[data-theme="dark"] .card-btn.primary[data-v-60408b0c]:hover {\n  background: #065f46;\n}\n[data-theme="dark"] .card-btn.warning[data-v-60408b0c] {\n  color: #f59e0b;\n  border-color: #78350f;\n}\n[data-theme="dark"] .card-btn.warning[data-v-60408b0c]:hover {\n  background: #78350f;\n}\n[data-theme="dark"] .new-save-btn[data-v-60408b0c] {\n  background: #374151;\n  border-color: #10b981;\n  color: #10b981;\n}\n[data-theme="dark"] .new-save-btn[data-v-60408b0c]:hover {\n  background: #065f46;\n  border-color: #059669;\n}\n[data-theme="dark"] .save-card[data-v-60408b0c] {\n  background: #374151;\n  border-color: #4b5563;\n}\n[data-theme="dark"] .save-card[data-v-60408b0c]:hover {\n  background: #4b5563;\n}\n[data-theme="dark"] .save-card.active[data-v-60408b0c] {\n  background: #1e40af;\n  border-color: #0ea5e9;\n}\n[data-theme="dark"] .operation-btn[data-v-60408b0c]:hover {\n  background: #374151;\n}\n[data-theme="dark"] .btn-title[data-v-60408b0c] {\n  color: #e5e7eb;\n}\n',""]);const i=l},3332:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.modal-overlay[data-v-3b19ffcd] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.6);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n.modal-container[data-v-3b19ffcd] {\n  background: var(--color-surface);\n  border-radius: 8px;\n  box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n  width: 90%;\n  max-width: 500px;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n.modal-header[data-v-3b19ffcd] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.modal-title[data-v-3b19ffcd] {\n  margin: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.modal-close-button[data-v-3b19ffcd] {\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n}\n.modal-content[data-v-3b19ffcd] {\n  padding: 1.5rem;\n  overflow-y: auto;\n  line-height: 1.6;\n  color: var(--color-text);\n  white-space: pre-wrap; /* Allows line breaks in the content */\n}\n.modal-fade-enter-active[data-v-3b19ffcd],\n.modal-fade-leave-active[data-v-3b19ffcd] {\n  transition: opacity 0.3s ease;\n}\n.modal-fade-enter-from[data-v-3b19ffcd],\n.modal-fade-leave-to[data-v-3b19ffcd] {\n  opacity: 0;\n}\n",""]);const i=l},3613:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.tavern-data-panel[data-v-525aaac2] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n  overflow: hidden;\n}\n",""]);const i=l},3811:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.quest-panel[data-v-7e802482] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  overflow-y: auto;\n}\n\n/* 头部 */\n.quest-header[data-v-7e802482] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1rem;\n  background: var(--color-background-soft);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n}\n.header-title[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 1.125rem;\n  font-weight: 600;\n}\n.header-icon[data-v-7e802482] {\n  font-size: 1.25rem;\n}\n.count-badge[data-v-7e802482] {\n  background: var(--color-primary);\n  color: white;\n  padding: 0.125rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 600;\n}\n.header-actions[data-v-7e802482] {\n  display: flex;\n  gap: 0.5rem;\n}\n.toggle-btn[data-v-7e802482],\n.config-btn[data-v-7e802482] {\n  padding: 0.375rem 0.75rem;\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n  background: var(--color-background);\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s;\n  font-size: 0.875rem;\n}\n.toggle-btn.active[data-v-7e802482] {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.toggle-btn[data-v-7e802482]:hover,\n.config-btn[data-v-7e802482]:hover {\n  background: var(--color-background-mute);\n}\n\n/* 配置面板 */\n.config-panel[data-v-7e802482] {\n  background: var(--color-background-soft);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.config-row[data-v-7e802482] {\n  display: flex;\n  align-items: flex-start;\n  gap: 1rem;\n}\n.custom-prompt-row[data-v-7e802482] {\n  flex-direction: column;\n  align-items: stretch;\n}\n.config-label[data-v-7e802482] {\n  min-width: 80px;\n  font-weight: 500;\n  color: var(--color-text);\n  line-height: 2;\n}\n.config-select[data-v-7e802482],\n.config-input[data-v-7e802482],\n.config-textarea[data-v-7e802482] {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  background: var(--color-background);\n  color: var(--color-text);\n  font-size: 0.875rem;\n}\n.config-textarea[data-v-7e802482] {\n  resize: vertical;\n  font-family: inherit;\n}\n\n/* 禁用提示 */\n.disabled-notice[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 1rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.notice-icon[data-v-7e802482] {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n  opacity: 0.6;\n}\n.notice-text[data-v-7e802482] {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.notice-hint[data-v-7e802482] {\n  font-size: 0.875rem;\n  opacity: 0.8;\n}\n\n/* 任务卡片 */\n.tasks-container[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.task-card[data-v-7e802482] {\n  background: var(--color-background-soft);\n  border: 2px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  transition: all 0.2s;\n}\n.task-card[data-v-7e802482]:hover {\n  border-color: var(--color-primary);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n/* 任务类型样式 */\n.task-type-relationship[data-v-7e802482] { border-left: 4px solid #3b82f6;\n}\n.task-type-companion[data-v-7e802482] { border-left: 4px solid #ec4899;\n}\n.task-type-cultivation[data-v-7e802482] { border-left: 4px solid #8b5cf6;\n}\n.task-type-exploration[data-v-7e802482] { border-left: 4px solid #10b981;\n}\n.task-type-combat[data-v-7e802482] { border-left: 4px solid #ef4444;\n}\n.task-type-custom[data-v-7e802482] { border-left: 4px solid #f59e0b;\n}\n.task-header[data-v-7e802482] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.875rem 1rem;\n  background: var(--color-background-mute);\n  cursor: pointer;\n}\n.task-title-area[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.625rem;\n  flex: 1;\n}\n.task-icon[data-v-7e802482] {\n  font-size: 1.25rem;\n}\n.task-title[data-v-7e802482] {\n  font-size: 1rem;\n  font-weight: 600;\n  margin: 0;\n}\n.task-type-badge[data-v-7e802482] {\n  background: var(--color-primary);\n  color: white;\n  padding: 0.125rem 0.5rem;\n  border-radius: 10px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.expand-btn[data-v-7e802482] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.25rem 0.5rem;\n  font-size: 0.875rem;\n}\n.task-body[data-v-7e802482] {\n  padding: 1rem;\n  border-top: 1px solid var(--color-border);\n}\n.task-description[data-v-7e802482] {\n  margin: 0 0 1rem 0;\n  line-height: 1.6;\n  color: var(--color-text);\n}\n.subsection-title[data-v-7e802482] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  margin: 0 0 0.5rem 0;\n  color: var(--color-text-secondary);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n/* 任务条件 */\n.task-conditions[data-v-7e802482] {\n  margin-bottom: 1rem;\n}\n.condition-item[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem;\n  margin-bottom: 0.375rem;\n  background: var(--color-background);\n  border-radius: 4px;\n  border: 1px solid var(--color-border);\n}\n.condition-item.completed[data-v-7e802482] {\n  background: rgba(16, 185, 129, 0.1);\n  border-color: rgb(16, 185, 129);\n}\n.condition-icon[data-v-7e802482] {\n  font-size: 1rem;\n  flex-shrink: 0;\n}\n.condition-text[data-v-7e802482] {\n  flex: 1;\n  font-size: 0.875rem;\n}\n.condition-progress[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex-shrink: 0;\n}\n.progress-bar-mini[data-v-7e802482] {\n  width: 60px;\n  height: 6px;\n  background: var(--color-background-mute);\n  border-radius: 3px;\n  overflow: hidden;\n}\n.progress-fill[data-v-7e802482] {\n  height: 100%;\n  background: var(--color-primary);\n  transition: width 0.3s;\n}\n.progress-text-mini[data-v-7e802482] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  min-width: 40px;\n}\n\n/* 任务奖励 */\n.task-rewards[data-v-7e802482] {\n  margin-bottom: 1rem;\n}\n.rewards-list[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.375rem;\n}\n.reward-item[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem;\n  background: rgba(59, 130, 246, 0.1);\n  border-radius: 4px;\n  font-size: 0.875rem;\n}\n.reward-icon[data-v-7e802482] {\n  font-size: 1rem;\n}\n\n/* 任务底部信息 */\n.task-footer[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.375rem;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border-radius: 4px;\n  margin-bottom: 0.75rem;\n}\n.time-limit[data-v-7e802482],\n.failure-penalty[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.875rem;\n}\n.footer-label[data-v-7e802482] {\n  font-weight: 500;\n  color: var(--color-text-secondary);\n}\n.footer-value[data-v-7e802482] {\n  color: var(--color-text);\n}\n.penalty-text[data-v-7e802482] {\n  color: #ef4444;\n}\n.task-meta[data-v-7e802482] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  padding-top: 0.5rem;\n  border-top: 1px solid var(--color-border);\n}\n.meta-label[data-v-7e802482] {\n  font-weight: 500;\n}\n\n/* 空状态 */\n.empty-tasks[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 1rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-icon[data-v-7e802482] {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n  opacity: 0.6;\n}\n.empty-text[data-v-7e802482] {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.empty-hint[data-v-7e802482] {\n  font-size: 0.875rem;\n  opacity: 0.8;\n}\n\n/* 已完成任务 */\n.completed-section[data-v-7e802482] {\n  margin-top: auto;\n  border-top: 1px solid var(--color-border);\n  padding-top: 1rem;\n}\n.completed-header[data-v-7e802482] {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1rem;\n  background: var(--color-background-soft);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s;\n  font-size: 1rem;\n  font-weight: 600;\n}\n.completed-header[data-v-7e802482]:hover {\n  background: var(--color-background-mute);\n}\n.expand-icon[data-v-7e802482] {\n  margin-left: auto;\n  font-size: 0.75rem;\n}\n.completed-list[data-v-7e802482] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.375rem;\n  padding: 0.75rem;\n  max-height: 300px;\n  overflow-y: auto;\n}\n.completed-item[data-v-7e802482] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem;\n  background: var(--color-background-soft);\n  border-radius: 4px;\n  font-size: 0.875rem;\n}\n.completed-icon[data-v-7e802482] {\n  font-size: 1rem;\n  flex-shrink: 0;\n}\n.completed-name[data-v-7e802482] {\n  flex: 1;\n  color: var(--color-text-secondary);\n}\n.more-hint[data-v-7e802482] {\n  text-align: center;\n  padding: 0.5rem;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n",""]);const i=l},3943:(e,n,t)=>{t.d(n,{E0:()=>c,QS:()=>r,UZ:()=>d,wG:()=>m});var a=t(2224);function o(e){const n=e.分钟??0;return 365*e.年*24*60+30*e.月*24*60+24*e.日*60+60*e.小时+n}function r(e){if(e<=0)return"已过期";const n=Math.floor(e/525600),t=Math.floor(e%525600/43200),a=Math.floor(e%43200/1440),o=Math.floor(e%1440/60),r=e%60,l=[];return n>0&&l.push(`${n}年`),t>0&&l.push(`${t}月`),a>0&&l.push(`${a}天`),o>0&&l.push(`${o}小时`),r>0&&l.push(`${r}分钟`),l.length>0?l.join(""):"不足1分钟"}function l(e){if(!e||"string"!=typeof e)return 0;let n=0;const t=e.match(/(\d+)年/);t&&(n+=365*parseInt(t[1])*24*60);const a=e.match(/(\d+)月/);a&&(n+=30*parseInt(a[1])*24*60);const o=e.match(/(\d+)天/);o&&(n+=24*parseInt(o[1])*60);const r=e.match(/(\d+)小时/);r&&(n+=60*parseInt(r[1]));const l=e.match(/(\d+)分钟/);return l&&(n+=parseInt(l[1])),n}function i(e,n){if(e.生成时间&&"number"==typeof e.持续时间分钟){const t=o(e.生成时间);return o(n)-t>=e.持续时间分钟}return!(!e.时间||!e.剩余时间)&&l(e.剩余时间)<=0}function c(e,n){if(e.生成时间&&"number"==typeof e.持续时间分钟){const t=o(e.生成时间),a=o(n)-t,r=e.持续时间分钟-a;return Math.max(0,r)}return e.剩余时间?Math.max(0,l(e.剩余时间)):60}function s(e,n){try{if(!e||"object"!=typeof e)return console.warn("[状态效果] 无效的状态效果数据:",e),null;if(e.生成时间&&"number"==typeof e.持续时间分钟)return e;const t={状态名称:e.状态名称||e.name||"未知状态",类型:e.类型||e.type||"buff",生成时间:{年:n.年,月:n.月,日:n.日,小时:n.小时||0,分钟:n.分钟??0},持续时间分钟:0,状态描述:e.状态描述||e.description||"无描述",强度:e.强度||e.intensity,来源:e.来源||e.source};return e.剩余时间?t.持续时间分钟=l(e.剩余时间):e.duration?t.持续时间分钟=l(e.duration):t.持续时间分钟=60,console.log(`[状态效果] 已规范化状态效果: ${t.状态名称}, 持续时间: ${t.持续时间分钟}分钟`),t}catch(e){return console.error("[状态效果] 规范化状态效果失败:",e),null}}function d(e){try{const n=(0,a.get)(e,"玩家角色状态.状态效果",[]);if(!Array.isArray(n)||0===n.length)return!1;const t=e.游戏时间;if(!t)return console.warn("[状态效果] 游戏时间不存在，无法更新状态效果"),!1;let o=!1;const r=[];for(const e of n){const n=s(e,t);n?i(n,t)?(console.log(`[状态效果] 状态效果"${n.状态名称}"已过期，将被移除`),o=!0):r.push(n):console.warn("[状态效果] 跳过无效的状态效果:",e)}return(0,a.set)(e,"玩家角色状态.状态效果",r),o&&console.log(`[状态效果] 已移除 ${n.length-r.length} 个过期状态效果`),o}catch(e){return console.error("[状态效果] 更新状态效果失败:",e),!1}}function m(e,n){try{const t=(0,a.get)(e,"玩家角色状态.状态效果",[]),o=t.length,r=t.filter(e=>e.状态名称!==n);(0,a.set)(e,"玩家角色状态.状态效果",r);const l=o>r.length;return l&&console.log(`[状态效果] 已移除状态效果: ${n}`),l}catch(e){return console.error("[状态效果] 移除状态效果失败:",e),!1}}},4042:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n/* 主容器 */\n.preview-container[data-v-bcd8af9a] {\n  height: 100%;\n  padding: 2rem;\n  box-sizing: border-box;\n  overflow-y: auto;\n}\n\n/* 标题 */\n.title[data-v-bcd8af9a] {\n  text-align: center;\n  color: var(--color-accent);\n  margin: 0 0 0.5rem 0;\n  font-family: var(--font-family-serif);\n  font-size: 2rem;\n  font-weight: 600;\n}\n.subtitle[data-v-bcd8af9a] {\n  text-align: center;\n  color: var(--color-text-secondary);\n  margin: 0 0 2rem 0;\n  font-size: 1rem;\n  opacity: 0.8;\n}\n\n/* 网格布局 */\n.preview-grid[data-v-bcd8af9a] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 1.5rem;\n}\n\n/* 基础卡片样式 */\n.preview-item[data-v-bcd8af9a] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1.5rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.preview-item h3[data-v-bcd8af9a] {\n  margin: 0;\n  color: var(--color-primary);\n  border-bottom: 1px solid var(--color-border);\n  padding-bottom: 0.5rem;\n  font-size: 1.1rem;\n  font-weight: 600;\n}\n.preview-item p[data-v-bcd8af9a] {\n  margin: 0;\n  font-size: 1rem;\n  color: var(--color-text);\n  line-height: 1.5;\n}\n.preview-item h4[data-v-bcd8af9a] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.item-description[data-v-bcd8af9a] {\n  font-size: 0.9rem !important;\n  color: var(--color-text-secondary) !important;\n  margin-top: 0.5rem !important;\n  opacity: 0.9;\n}\n.talents-item li .item-description[data-v-bcd8af9a] {\n  margin-top: 0.25rem !important;\n  padding-left: 0.5rem;\n  border-left: 2px solid var(--color-border);\n}\n\n/* 名字输入 */\n.name-item[data-v-bcd8af9a], .race-item[data-v-bcd8af9a] {\n  grid-column: span 2;\n}\n@media (min-width: 769px) {\n.name-item[data-v-bcd8af9a], .race-item[data-v-bcd8af9a] {\n    grid-column: 1 / -1;\n}\n}\n.name-item label[data-v-bcd8af9a] {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  margin-bottom: 0.5rem;\n  display: block;\n}\n.name-item input[data-v-bcd8af9a], .input-field input[data-v-bcd8af9a] {\n  width: 100%;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  color: var(--color-text);\n  padding: 0.75rem;\n  border-radius: 4px;\n  font-size: 1rem;\n  box-sizing: border-box;\n}\n.input-field input[data-v-bcd8af9a] {\n    background: var(--color-surface);\n}\n.name-item input[data-v-bcd8af9a]:focus, .input-field input[data-v-bcd8af9a]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n}\n\n/* 性别选择 */\n.gender-control[data-v-bcd8af9a] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.gender-label[data-v-bcd8af9a] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n  font-size: 1rem;\n  padding: 0.5rem;\n  border-radius: 4px;\n  color: var(--color-text);\n}\n.gender-label[data-v-bcd8af9a]:hover {\n  background: var(--color-surface-light);\n}\n.gender-label input[type="radio"][data-v-bcd8af9a] {\n  width: 16px;\n  height: 16px;\n  margin: 0;\n}\n\n/* 年龄控制 */\n.age-control[data-v-bcd8af9a] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n}\n.age-btn[data-v-bcd8af9a] {\n  width: 32px;\n  height: 32px;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface);\n  color: var(--color-text);\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.age-btn[data-v-bcd8af9a]:hover:not(:disabled) {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.age-btn[data-v-bcd8af9a]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.age-display[data-v-bcd8af9a] {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 60px;\n  text-align: center;\n}\n\n/* 列表样式 */\n.preview-item ul[data-v-bcd8af9a] {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n.preview-item li[data-v-bcd8af9a] {\n  margin-bottom: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface-light);\n  border-radius: 4px;\n  color: var(--color-text);\n  line-height: 1.4;\n}\n.preview-item li strong[data-v-bcd8af9a] {\n  display: block;\n  margin-bottom: 0.25rem;\n  color: var(--color-primary);\n}\n\n/* 云端信息 */\n.cloud-info-item[data-v-bcd8af9a] {\n  text-align: center;\n  background: var(--color-surface-light);\n  border: 1px dashed var(--color-border);\n}\n.cloud-info-text[data-v-bcd8af9a] {\n  font-size: 0.95rem;\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n  font-style: italic;\n}\n\n/* 响应式 */\n@media (max-width: 768px) {\n.preview-container[data-v-bcd8af9a] {\n    padding: 1rem;\n}\n.preview-grid[data-v-bcd8af9a] {\n    grid-template-columns: 1fr;\n    gap: 1rem;\n}\n.gender-control[data-v-bcd8af9a] {\n    flex-direction: row;\n    flex-wrap: wrap;\n    justify-content: space-around;\n}\n.gender-label[data-v-bcd8af9a] {\n    flex: 1;\n    min-width: 80px;\n    justify-content: center;\n}\n}\n@media (min-width: 769px) and (max-width: 1024px) {\n.preview-grid[data-v-bcd8af9a] {\n    grid-template-columns: repeat(2, 1fr);\n}\n}\n\n/* 暗色主题 */\n[data-theme="dark"] .preview-item[data-v-bcd8af9a] {\n  background: #1f2937;\n  border-color: #374151;\n}\n[data-theme="dark"] .name-item input[data-v-bcd8af9a] {\n  background: #111827;\n  border-color: #374151;\n  color: #f9fafb;\n}\n[data-theme="dark"] .gender-label[data-v-bcd8af9a]:hover {\n  background: #374151;\n}\n[data-theme="dark"] .age-btn[data-v-bcd8af9a] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #f9fafb;\n}\n[data-theme="dark"] .preview-item li[data-v-bcd8af9a] {\n  background: #374151;\n  color: #e5e7eb;\n}\n[data-theme="dark"] .cloud-info-item[data-v-bcd8af9a] {\n  background: #374151;\n}\n@media (max-width: 480px) {\n.preview-container[data-v-bcd8af9a] {\n    padding: 1rem;\n}\n.title[data-v-bcd8af9a] {\n    font-size: 1.6rem;\n}\n.subtitle[data-v-bcd8af9a] {\n    font-size: 0.9rem;\n    margin-bottom: 1.5rem;\n}\n.preview-item[data-v-bcd8af9a] {\n    padding: 1rem;\n    gap: 0.8rem;\n}\n.preview-item h3[data-v-bcd8af9a] {\n    font-size: 1rem;\n}\n.preview-item h4[data-v-bcd8af9a] {\n    font-size: 1rem;\n}\n.item-description[data-v-bcd8af9a] {\n    font-size: 0.85rem !important;\n}\n.name-item label[data-v-bcd8af9a] {\n    font-size: 1rem;\n}\n.name-item input[data-v-bcd8af9a] {\n    padding: 0.6rem;\n    font-size: 0.9rem;\n}\n.gender-label[data-v-bcd8af9a] {\n    font-size: 0.9rem;\n    padding: 0.4rem;\n}\n.age-control[data-v-bcd8af9a] {\n    gap: 0.8rem;\n}\n.age-btn[data-v-bcd8af9a] {\n    width: 28px;\n    height: 28px;\n    font-size: 0.9rem;\n}\n.age-display[data-v-bcd8af9a] {\n    font-size: 1rem;\n}\n.preview-item li[data-v-bcd8af9a] {\n    padding: 0.6rem;\n}\n}\n',""]);const i=l},4061:e=>{e.exports=Vue},4081:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.video-background-container[data-v-faad78a8] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: -10;\n  pointer-events: none;\n  background-color: #1a1b26; /* 简单的暗色背景作为备用 */\n}\n.video-background[data-v-faad78a8] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transform: translate(-50%, -50%);\n  z-index: -2;\n}\n.video-overlay[data-v-faad78a8] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(10, 15, 24, 0);\n  z-index: -1;\n}\n",""]);const i=l},4096:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n\n.ol-overviewmap .ol-viewport:hover {\n  cursor: pointer;\n}\n',""]);const i=l},4244:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.thousand-dao-content[data-v-3c90b3e6] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n  overflow: hidden;\n}\n\n/* 顶栏动作统一处理 */\n\n/* 头部样式 */\n.dao-header[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  background: var(--color-surface);\n  border-bottom: 1px solid var(--color-border);\n}\n.header-left[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.header-icon[data-v-3c90b3e6] {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  background: var(--color-primary);\n  border-radius: 10px;\n  color: white;\n}\n.panel-title[data-v-3c90b3e6] {\n  margin: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.panel-subtitle[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n.refresh-btn[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 16px;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-background);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n}\n.refresh-btn[data-v-3c90b3e6]:hover:not(:disabled) {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n}\n.refresh-btn[data-v-3c90b3e6]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* 主要内容 */\n.dao-main[data-v-3c90b3e6] {\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n}\n.dao-overview[data-v-3c90b3e6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n/* 大道统计 */\n.dao-stats[data-v-3c90b3e6] {\n  display: flex;\n  gap: 1rem;\n  padding: 1rem;\n  background: var(--color-surface-light);\n}\n.stat-card[data-v-3c90b3e6] {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 16px;\n  background: var(--color-surface);\n  border-radius: 12px;\n  border: 1px solid var(--color-border);\n}\n.stat-icon[data-v-3c90b3e6] {\n  font-size: 1.5rem;\n  opacity: 0.8;\n}\n.stat-value[data-v-3c90b3e6] {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--color-text);\n}\n.stat-label[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n\n/* 大道章节 */\n.dao-sections[data-v-3c90b3e6] {\n  flex: 1;\n  padding: 1rem;\n  overflow-y: auto;\n}\n.cultivating-section[data-v-3c90b3e6] {\n  padding: 1rem;\n  padding-bottom: 0;\n}\n.cultivating-card[data-v-3c90b3e6] {\n  background: var(--color-surface);\n  border: 2px solid var(--color-primary);\n  border-radius: 12px;\n  padding: 16px;\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.1);\n}\n.cultivating-info[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.cultivating-name[data-v-3c90b3e6] {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.cultivating-level[data-v-3c90b3e6] {\n  background: var(--color-primary);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.cultivating-progress[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.dao-section[data-v-3c90b3e6] {\n  margin-bottom: 2rem;\n}\n.section-title[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin: 0 0 16px 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.title-icon[data-v-3c90b3e6] {\n  font-size: 1rem;\n}\n\n/* 空状态 */\n.empty-state[data-v-3c90b3e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 40px;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-icon[data-v-3c90b3e6] {\n  font-size: 3rem;\n  margin-bottom: 16px;\n  opacity: 0.5;\n}\n.empty-tip[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  margin-top: 8px;\n  opacity: 0.8;\n}\n\n/* 大道网格 */\n.dao-grid[data-v-3c90b3e6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 16px;\n}\n.dao-card[data-v-3c90b3e6] {\n  background: var(--color-surface);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n.dao-card[data-v-3c90b3e6]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.15);\n}\n.dao-card.selected[data-v-3c90b3e6] {\n  border-color: var(--color-primary);\n  background: rgba(var(--color-primary-rgb), 0.05);\n}\n.dao-card-header[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.dao-name[data-v-3c90b3e6] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.dao-stage[data-v-3c90b3e6] {\n  background: var(--color-info);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n\n/* 进度条 */\n.dao-progress[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n}\n.progress-bar[data-v-3c90b3e6] {\n  flex: 1;\n  height: 6px;\n  background: var(--color-border);\n  border-radius: 3px;\n  overflow: hidden;\n}\n.progress-fill[data-v-3c90b3e6] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-success), var(--color-info));\n  border-radius: 3px;\n  transition: width 0.5s ease;\n}\n.progress-text[data-v-3c90b3e6] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n  min-width: 35px;\n}\n.dao-experience[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n\n/* 发现提示 */\n.dao-discover-hint[data-v-3c90b3e6] {\n  padding: 0;\n}\n.discover-card[data-v-3c90b3e6] {\n  display: flex;\n  gap: 20px;\n  padding: 24px;\n  background: linear-gradient(135deg, var(--color-surface) 0%, rgba(var(--color-primary-rgb), 0.05) 100%);\n  border: 1px solid var(--color-border);\n  border-radius: 16px;\n  align-items: flex-start;\n}\n.discover-icon[data-v-3c90b3e6] {\n  font-size: 3rem;\n  opacity: 0.8;\n  flex-shrink: 0;\n}\n.discover-content h5[data-v-3c90b3e6] {\n  margin: 0 0 12px 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.discover-content p[data-v-3c90b3e6] {\n  margin: 0 0 16px 0;\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n}\n.discover-methods[data-v-3c90b3e6] {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 8px;\n}\n.discover-methods li[data-v-3c90b3e6] {\n  padding: 8px 12px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  font-size: 0.9rem;\n  color: var(--color-text);\n  transition: all 0.2s ease;\n}\n.discover-methods li[data-v-3c90b3e6]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n}\n\n/* 阶段显示增强 */\n.stage-display[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.stage-name[data-v-3c90b3e6] {\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.stage-number[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 2px 8px;\n  border-radius: 12px;\n}\n.progress-detail[data-v-3c90b3e6] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n}\n\n/* 统计高亮 */\n.stat-highlight[data-v-3c90b3e6] {\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.next-stage[data-v-3c90b3e6] {\n  font-weight: 500;\n  color: var(--color-info);\n}\n\n/* 阶段列表 */\n.stages-list[data-v-3c90b3e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  max-height: 300px;\n  overflow-y: auto;\n  padding-right: 4px;\n}\n.stage-item[data-v-3c90b3e6] {\n  display: flex;\n  gap: 12px;\n  padding: 12px;\n  border-radius: 8px;\n  transition: all 0.2s ease;\n}\n.stage-item.completed[data-v-3c90b3e6] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  border: 1px solid rgba(var(--color-success-rgb), 0.3);\n}\n.stage-item.current[data-v-3c90b3e6] {\n  background: rgba(var(--color-primary-rgb), 0.1);\n  border: 1px solid rgba(var(--color-primary-rgb), 0.3);\n  box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.15);\n}\n.stage-item.locked[data-v-3c90b3e6] {\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  opacity: 0.7;\n}\n.stage-marker[data-v-3c90b3e6] {\n  flex-shrink: 0;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 0.9rem;\n}\n.stage-details[data-v-3c90b3e6] {\n  flex: 1;\n}\n.stage-details .stage-name[data-v-3c90b3e6] {\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 4px;\n}\n.stage-desc[data-v-3c90b3e6] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  line-height: 1.4;\n  margin-bottom: 4px;\n}\n.stage-req[data-v-3c90b3e6] {\n  font-size: 0.8rem;\n  color: var(--color-info);\n  font-weight: 500;\n}\n\n/* 增强按钮样式 */\n.cultivate-dao[data-v-3c90b3e6] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  width: 100%;\n  padding: 12px 16px;\n  background: linear-gradient(135deg, var(--color-primary), var(--color-info));\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n.cultivate-dao[data-v-3c90b3e6]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);\n  transition: left 0.5s ease;\n}\n.cultivate-dao[data-v-3c90b3e6]:hover::before {\n  left: 100%;\n}\n.cultivate-dao[data-v-3c90b3e6]:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n\n/* 大道详情侧边栏 */\n.dao-details-sidebar[data-v-3c90b3e6] {\n  width: 320px;\n  background: var(--color-surface);\n  border-left: 1px solid var(--color-border);\n  display: flex;\n  flex-direction: column;\n}\n.details-header[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px;\n  border-bottom: 1px solid var(--color-border);\n}\n.details-header h3[data-v-3c90b3e6] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.close-details[data-v-3c90b3e6] {\n  background: none;\n  border: none;\n  padding: 4px;\n  border-radius: 4px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  transition: all 0.2s ease;\n}\n.close-details[data-v-3c90b3e6]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.details-content[data-v-3c90b3e6] {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n}\n.detail-section[data-v-3c90b3e6] {\n  margin-bottom: 24px;\n}\n.detail-section h4[data-v-3c90b3e6] {\n  margin: 0 0 12px 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  text-transform: uppercase;\n  font-weight: 600;\n}\n.stage-info[data-v-3c90b3e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.current-stage[data-v-3c90b3e6] {\n  font-weight: 500;\n  color: var(--color-text);\n}\n.dao-description[data-v-3c90b3e6] {\n  color: var(--color-text);\n  line-height: 1.6;\n  margin: 0;\n}\n.dao-stats-detail[data-v-3c90b3e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.stat-row[data-v-3c90b3e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.status-badge[data-v-3c90b3e6] {\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.status-badge.unlocked[data-v-3c90b3e6] {\n  background: var(--color-success);\n  color: white;\n}\n\n/* 详情操作 */\n.details-actions[data-v-3c90b3e6] {\n  padding: 16px 20px;\n  border-top: 1px solid var(--color-border);\n}\n.cultivate-dao[data-v-3c90b3e6] {\n  width: 100%;\n  padding: 10px 16px;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.cultivate-dao[data-v-3c90b3e6]:hover {\n  background: var(--color-primary-hover);\n}\n\n/* 加载状态 */\n.loading-placeholder[data-v-3c90b3e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: var(--color-text-secondary);\n}\n.loading-spinner[data-v-3c90b3e6] {\n  width: 32px;\n  height: 32px;\n  border: 3px solid var(--color-border);\n  border-top: 3px solid var(--color-primary);\n  border-radius: 50%;\n  margin-bottom: 16px;\n  opacity: 0.8;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.thousand-dao-content[data-v-3c90b3e6] {\n    padding: 0;\n}\n.dao-header[data-v-3c90b3e6] {\n    padding: 1rem;\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: var(--color-surface);\n}\n.header-left[data-v-3c90b3e6] {\n    gap: 0.5rem;\n}\n.panel-title[data-v-3c90b3e6] {\n    font-size: 1.1rem;\n}\n.panel-subtitle[data-v-3c90b3e6] {\n    display: none;\n}\n.refresh-btn[data-v-3c90b3e6] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.dao-main[data-v-3c90b3e6] {\n    flex-direction: column;\n    padding: 0;\n}\n.dao-stats[data-v-3c90b3e6] {\n    padding: 1rem;\n    gap: 0.75rem;\n}\n.stat-card[data-v-3c90b3e6] {\n    padding: 1rem;\n    min-height: 80px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n}\n.stat-icon[data-v-3c90b3e6] {\n    font-size: 1.25rem;\n    margin-bottom: 0.5rem;\n}\n.stat-value[data-v-3c90b3e6] {\n    font-size: 1.25rem;\n    margin-bottom: 0.25rem;\n}\n.stat-label[data-v-3c90b3e6] {\n    font-size: 0.8rem;\n}\n.dao-sections[data-v-3c90b3e6] {\n    padding: 1rem;\n}\n.dao-grid[data-v-3c90b3e6] {\n    grid-template-columns: 1fr;\n    gap: 0.75rem;\n}\n.dao-card[data-v-3c90b3e6] {\n    padding: 1rem;\n}\n.dao-card-header[data-v-3c90b3e6] {\n    margin-bottom: 0.75rem;\n}\n.dao-name[data-v-3c90b3e6] {\n    font-size: 0.95rem;\n}\n.dao-stage[data-v-3c90b3e6] {\n    font-size: 0.7rem;\n}\n.dao-details-sidebar[data-v-3c90b3e6] {\n    width: 100%;\n    max-height: 60vh;\n    border-left: none;\n    border-top: 1px solid var(--color-border);\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 200;\n    border-radius: 1rem 1rem 0 0;\n    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);\n}\n.details-header[data-v-3c90b3e6] {\n    padding: 1rem;\n    border-bottom: 1px solid var(--color-border);\n    background: var(--color-surface);\n    border-radius: 1rem 1rem 0 0;\n}\n.details-header h3[data-v-3c90b3e6] {\n    font-size: 1.1rem;\n}\n.details-content[data-v-3c90b3e6] {\n    padding: 1rem;\n    max-height: calc(60vh - 120px);\n    overflow-y: auto;\n}\n.detail-section[data-v-3c90b3e6] {\n    margin-bottom: 1.5rem;\n}\n.detail-section h4[data-v-3c90b3e6] {\n    font-size: 0.85rem;\n    margin-bottom: 0.75rem;\n}\n.details-actions[data-v-3c90b3e6] {\n    padding: 1rem;\n    background: var(--color-surface);\n    border-top: 1px solid var(--color-border);\n}\n.cultivate-dao[data-v-3c90b3e6] {\n    padding: 0.75rem;\n    font-size: 0.9rem;\n}\n}\n",""]);const i=l},4270:(e,n,t)=>{t.d(n,{b:()=>a,o:()=>i});const a=(0,t(4061).ref)([]),o=new Map;let r=0;const l=e=>{a.value=a.value.filter(n=>n.id!==e)},i=new class{show(e,n,t={}){const{duration:i=2500,id:c}=t;if(!c&&((e,n)=>{const t=((e,n)=>`${e}::${n}`)(e,n),a=Date.now();if(a-(o.get(t)||0)<1500)return!0;o.set(t,a);for(const[e,n]of o)a-n>6e3&&o.delete(e);return!1})(e,n))return;if(c){const t=a.value.find(e=>e.id===c);if(t)return t.message=n,t.type=e,void("loading"!==e&&setTimeout(()=>l(c),i))}const s={id:c||`toast-${Date.now()}-${r++}`,type:e,message:n,duration:i};a.value.push(s),"loading"!==e&&setTimeout(()=>l(s.id),i)}success(e,n={}){this.show("success",e,n)}error(e,n={}){this.show("error",e,n)}warning(e,n={}){this.show("warning",e,n)}info(e,n={}){this.show("info",e,n)}loading(e,n){this.show("loading",e,{...n,duration:999999})}hide(e){l(e)}}},4381:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.data-status[data-v-45214445] {\n  padding: 1rem;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  gap: 2rem;\n}\n.status-item[data-v-45214445] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.status-label[data-v-45214445] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.status-value[data-v-45214445] {\n  font-size: 0.875rem;\n  font-weight: 500;\n}\n.status-value.connected[data-v-45214445] {\n  color: var(--color-success);\n}\n.status-value.disconnected[data-v-45214445] {\n  color: var(--color-danger);\n}\n",""]);const i=l},4388:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n/* 作者信息模态框样式 */\n.author-modal-overlay[data-v-6ff8c096] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  padding: 1rem;\n}\n.author-modal[data-v-6ff8c096] {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 16px;\n  max-width: 600px;\n  width: 100%;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n  animation: modalSlideIn-6ff8c096 0.3s ease-out;\n}\n@keyframes modalSlideIn-6ff8c096 {\nfrom {\n    opacity: 0;\n    transform: translateY(-20px) scale(0.95);\n}\nto {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n}\n.author-modal-header[data-v-6ff8c096] {\n  padding: 1.5rem 2rem;\n  border-bottom: 2px solid #e2e8f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border-radius: 16px 16px 0 0;\n}\n.author-modal-header h3[data-v-6ff8c096] {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 700;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.close-btn[data-v-6ff8c096] {\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  font-size: 1.5rem;\n  width: 32px;\n  height: 32px;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn[data-v-6ff8c096]:hover {\n  background: rgba(255, 255, 255, 0.3);\n  transform: rotate(90deg);\n}\n.author-modal-body[data-v-6ff8c096] {\n  padding: 2rem;\n}\n.version-badge[data-v-6ff8c096] {\n  display: inline-block;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  padding: 0.5rem 1.25rem;\n  border-radius: 20px;\n  font-size: 0.9rem;\n  font-weight: 700;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 6px -1px rgba(102, 126, 234, 0.3);\n}\n.info-section[data-v-6ff8c096] {\n  margin-bottom: 2rem;\n}\n.info-section[data-v-6ff8c096]:last-child {\n  margin-bottom: 0;\n}\n.info-section h4[data-v-6ff8c096] {\n  color: #1e293b;\n  font-size: 1.1rem;\n  font-weight: 700;\n  margin-bottom: 1rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.info-section p[data-v-6ff8c096] {\n  color: #475569;\n  line-height: 1.7;\n  margin: 0.5rem 0;\n}\n.info-section a[data-v-6ff8c096] {\n  color: #667eea;\n  text-decoration: none;\n  font-weight: 600;\n  transition: color 0.2s;\n}\n.info-section a[data-v-6ff8c096]:hover {\n  color: #764ba2;\n  text-decoration: underline;\n}\n.feature-list[data-v-6ff8c096] {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n.feature-list li[data-v-6ff8c096] {\n  padding: 0.75rem 0;\n  color: #475569;\n  line-height: 1.6;\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n  border-bottom: 1px solid #e2e8f0;\n}\n.feature-list li[data-v-6ff8c096]:last-child {\n  border-bottom: none;\n}\n.feature-list strong[data-v-6ff8c096] {\n  color: #1e293b;\n  font-weight: 600;\n}\n.tech-stack[data-v-6ff8c096] {\n  color: #64748b;\n  font-size: 0.95rem;\n  padding: 1rem;\n  background: #f1f5f9;\n  border-radius: 8px;\n  border-left: 4px solid #667eea;\n}\n.version-note[data-v-6ff8c096] {\n  color: #475569;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  padding: 1rem;\n  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\n  border-radius: 8px;\n  border-left: 4px solid #f59e0b;\n}\n.version-note strong[data-v-6ff8c096] {\n  color: #92400e;\n}\n.copyright-notice[data-v-6ff8c096] {\n  padding: 1.25rem;\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n  border-radius: 8px;\n  border: 2px solid #dc2626;\n}\n.copyright-notice p[data-v-6ff8c096] {\n  margin: 0.5rem 0;\n  color: #1e293b;\n}\n.copyright-notice p[data-v-6ff8c096]:first-child {\n  font-weight: 700;\n  font-size: 1.05rem;\n  color: #dc2626;\n  margin-bottom: 0.75rem;\n}\n.copyright-notice strong[data-v-6ff8c096] {\n  color: #dc2626;\n  font-weight: 700;\n}\n.copyright-list[data-v-6ff8c096] {\n  list-style: none;\n  padding: 0;\n  margin: 1rem 0;\n}\n.copyright-list li[data-v-6ff8c096] {\n  padding: 0.5rem 0;\n  color: #475569;\n  line-height: 1.5;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  border-bottom: 1px solid #fee2e2;\n}\n.copyright-list li[data-v-6ff8c096]:last-child {\n  border-bottom: none;\n}\n.copyright-list strong[data-v-6ff8c096] {\n  color: #1e293b;\n  font-weight: 600;\n}\n.copyright-warning[data-v-6ff8c096] {\n  margin-top: 1rem;\n  padding: 0.75rem;\n  background: #dc2626;\n  color: white;\n  border-radius: 6px;\n  font-weight: 600;\n  text-align: center;\n}\n\n/* 深色主题 */\n[data-theme="dark"] .author-modal[data-v-6ff8c096] {\n  background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);\n}\n[data-theme="dark"] .author-modal-header[data-v-6ff8c096] {\n  border-bottom-color: #334155;\n}\n[data-theme="dark"] .info-section h4[data-v-6ff8c096] {\n  color: #f1f5f9;\n}\n[data-theme="dark"] .info-section p[data-v-6ff8c096] {\n  color: #cbd5e1;\n}\n[data-theme="dark"] .feature-list li[data-v-6ff8c096] {\n  color: #cbd5e1;\n  border-bottom-color: #334155;\n}\n[data-theme="dark"] .feature-list strong[data-v-6ff8c096] {\n  color: #f1f5f9;\n}\n[data-theme="dark"] .tech-stack[data-v-6ff8c096] {\n  background: #0f172a;\n  color: #94a3b8;\n  border-left-color: #667eea;\n}\n[data-theme="dark"] .version-note[data-v-6ff8c096] {\n  background: linear-gradient(135deg, #422006 0%, #713f12 100%);\n  color: #fde68a;\n  border-left-color: #f59e0b;\n}\n[data-theme="dark"] .version-note strong[data-v-6ff8c096] {\n  color: #fbbf24;\n}\n[data-theme="dark"] .copyright-notice[data-v-6ff8c096] {\n  background: linear-gradient(135deg, #450a0a 0%, #7f1d1d 100%);\n  border-color: #dc2626;\n}\n[data-theme="dark"] .copyright-notice p[data-v-6ff8c096] {\n  color: #fecaca;\n}\n[data-theme="dark"] .copyright-notice p[data-v-6ff8c096]:first-child {\n  color: #fca5a5;\n}\n[data-theme="dark"] .copyright-notice strong[data-v-6ff8c096] {\n  color: #fca5a5;\n}\n[data-theme="dark"] .copyright-list li[data-v-6ff8c096] {\n  color: #fecaca;\n  border-bottom-color: #7f1d1d;\n}\n[data-theme="dark"] .copyright-list strong[data-v-6ff8c096] {\n  color: #fef2f2;\n}\n[data-theme="dark"] .copyright-warning[data-v-6ff8c096] {\n  background: #dc2626;\n  color: white;\n}\n\n/* 滚动条美化 */\n.author-modal[data-v-6ff8c096]::-webkit-scrollbar {\n  width: 8px;\n}\n.author-modal[data-v-6ff8c096]::-webkit-scrollbar-track {\n  background: #f1f5f9;\n  border-radius: 4px;\n}\n.author-modal[data-v-6ff8c096]::-webkit-scrollbar-thumb {\n  background: #cbd5e1;\n  border-radius: 4px;\n}\n.author-modal[data-v-6ff8c096]::-webkit-scrollbar-thumb:hover {\n  background: #94a3b8;\n}\n[data-theme="dark"] .author-modal[data-v-6ff8c096]::-webkit-scrollbar-track {\n  background: #0f172a;\n}\n[data-theme="dark"] .author-modal[data-v-6ff8c096]::-webkit-scrollbar-thumb {\n  background: #475569;\n}\n[data-theme="dark"] .author-modal[data-v-6ff8c096]::-webkit-scrollbar-thumb:hover {\n  background: #64748b;\n}\n',""]);const i=l},4417:e=>{e.exports=function(e,n){return n||(n={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),n.hash&&(e+=n.hash),/["'() \t\n]|(%20)/.test(e)||n.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4440:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n\n/* 头部 */\n.panel-header[data-v-13a846e5] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  background: var(--color-surface);\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n  flex-shrink: 0;\n  margin: 1rem 1rem 0 1rem;\n}\n.header-left[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.header-icon[data-v-13a846e5] {\n  font-size: 1.5rem;\n}\n.header-info[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.panel-title[data-v-13a846e5] {\n  margin: 0;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.panel-subtitle[data-v-13a846e5] {\n  font-size: 0.875rem;\n  color: var(--color-accent);\n}\n.header-actions[data-v-13a846e5] {\n  display: flex;\n  gap: 0.5rem;\n}\n\n/* 修炼容器 */\n.panel-content[data-v-13a846e5] {\n  flex: 1;\n  margin: 0 1rem 1rem 1rem;\n  min-height: 0;\n}\n.cultivation-sections[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.loading-state[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  text-align: center;\n}\n.loading-spinner[data-v-13a846e5] {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n}\n.loading-text[data-v-13a846e5] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.empty-state[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  padding: 1.5rem;\n}\n.empty-icon[data-v-13a846e5] {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n}\n.empty-text[data-v-13a846e5] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 0.25rem;\n}\n.empty-hint[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n\n/* 修炼功法卡片 */\n.cultivation-status[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n}\n.cultivation-info[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.technique-item[data-v-13a846e5] {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n  padding: 1rem;\n  background: var(--color-surface-light);\n  border: 2px solid var(--color-border);\n  border-radius: 0.75rem;\n  transition: var(--transition-fast);\n}\n.technique-item[data-v-13a846e5]:hover {\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-color: var(--color-primary);\n}\n.technique-icon[data-v-13a846e5] {\n  font-size: 1.5rem;\n  flex-shrink: 0;\n  padding: 0.5rem;\n  border-radius: 0.5rem;\n  border: 2px solid;\n  background: var(--color-surface);\n}\n.technique-info[data-v-13a846e5] {\n  flex: 1;\n  min-width: 0;\n}\n.technique-details[data-v-13a846e5] {\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid var(--color-border);\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.detail-block-title[data-v-13a846e5] {\n  font-size: 0.8rem;\n  font-weight: 600;\n  color: var(--color-accent);\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n.description-text[data-v-13a846e5] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n  margin: 0;\n}\n.effects-list[data-v-13a846e5] {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  font-size: 0.85rem;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.effects-list li[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.effect-icon[data-v-13a846e5] {\n  font-size: 1rem;\n}\n.attribute-bonus[data-v-13a846e5] {\n  background: rgba(var(--color-primary-rgb), 0.1);\n  color: var(--color-primary);\n  padding: 0.125rem 0.375rem;\n  border-radius: 0.25rem;\n  font-size: 0.75rem;\n  margin-left: 0.25rem;\n}\n.technique-name[data-v-13a846e5] {\n  font-size: 1rem;\n  font-weight: 700;\n  margin-bottom: 0.25rem;\n}\n.technique-quality[data-v-13a846e5] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 0.5rem;\n}\n.technique-progress[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n/* 技能部分 */\n.skills-section[data-v-13a846e5] {\n  border-top: 1px solid var(--color-border);\n  padding-top: 1rem;\n}\n.skills-header[data-v-13a846e5] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n}\n.skills-title[data-v-13a846e5] {\n  margin: 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.skills-title[data-v-13a846e5]::before {\n  content: '⚡';\n  font-size: 1rem;\n}\n.skills-count[data-v-13a846e5] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n}\n.skills-list[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.skill-item[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 0.5rem;\n  cursor: pointer;\n  transition: var(--transition-fast);\n}\n.skill-item[data-v-13a846e5]:hover {\n  background: rgba(var(--color-info-rgb), 0.05);\n  border-color: var(--color-info);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n}\n.skill-icon[data-v-13a846e5] {\n  font-size: 1rem;\n  flex-shrink: 0;\n  color: var(--color-warning);\n}\n.skill-info[data-v-13a846e5] {\n  flex: 1;\n  min-width: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.skill-header-info[data-v-13a846e5] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.25rem;\n}\n.skill-name[data-v-13a846e5] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.skill-type[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n.skill-source-tag[data-v-13a846e5] {\n  font-size: 0.7rem;\n  padding: 0.125rem 0.375rem;\n  border-radius: 0.5rem;\n  font-weight: 500;\n  width: fit-content;\n  margin-bottom: 0.125rem;\n}\n.skill-unlock-requirement[data-v-13a846e5] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  margin-bottom: 0.25rem;\n  padding: 0.125rem 0.375rem;\n  background: rgba(var(--color-info-rgb), 0.1);\n  border-left: 2px solid var(--color-info);\n  border-radius: 0.25rem;\n}\n.source-direct[data-v-13a846e5] {\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n  border: 1px solid rgba(var(--color-success-rgb), 0.2);\n}\n.source-technique[data-v-13a846e5] {\n  background: rgba(var(--color-info-rgb), 0.1);\n  color: var(--color-info);\n  border: 1px solid rgba(var(--color-info-rgb), 0.2);\n}\n.source-default[data-v-13a846e5] {\n  background: rgba(var(--color-border-rgb), 0.1);\n  color: var(--color-text-secondary);\n  border: 1px solid var(--color-border);\n}\n.skill-proficiency[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.75rem;\n}\n.proficiency-label[data-v-13a846e5] {\n  color: var(--color-text-secondary);\n  min-width: 3.5rem;\n}\n.proficiency-bar[data-v-13a846e5] {\n  flex: 1;\n  height: 3px;\n  background: rgba(var(--color-border-rgb), 0.3);\n  border-radius: 1.5px;\n  overflow: hidden;\n}\n.proficiency-fill[data-v-13a846e5] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-warning), var(--color-success));\n  transition: width 0.3s ease;\n}\n.proficiency-text[data-v-13a846e5] {\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 2.5rem;\n  text-align: right;\n}\n.skill-level[data-v-13a846e5] {\n  font-size: 0.75rem;\n  font-weight: 600;\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid;\n  text-align: center;\n  min-width: 3rem;\n}\n.level-master[data-v-13a846e5] {\n  background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));\n  border-color: #ef4444;\n  color: #dc2626;\n}\n.level-expert[data-v-13a846e5] {\n  background: linear-gradient(135deg, rgba(147, 51, 234, 0.2), rgba(147, 51, 234, 0.1));\n  border-color: #9333ea;\n  color: #7c3aed;\n}\n.level-proficient[data-v-13a846e5] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(59, 130, 246, 0.1));\n  border-color: #3b82f6;\n  color: #2563eb;\n}\n.level-beginner[data-v-13a846e5] {\n  background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));\n  border-color: #22c55e;\n  color: #16a34a;\n}\n.level-novice[data-v-13a846e5] {\n  background: linear-gradient(135deg, rgba(156, 163, 175, 0.2), rgba(156, 163, 175, 0.1));\n  border-color: #9ca3af;\n  color: #6b7280;\n}\n\n/* 品质颜色 */\n.border-quality-神[data-v-13a846e5], .text-quality-神[data-v-13a846e5] { border-color: #ef4444; color: #ef4444;\n}\n.border-quality-仙[data-v-13a846e5], .text-quality-仙[data-v-13a846e5] { border-color: #f59e0b; color: #f59e0b;\n}\n.border-quality-天[data-v-13a846e5], .text-quality-天[data-v-13a846e5] { border-color: #8b5cf6; color: #8b5cf6;\n}\n.border-quality-地[data-v-13a846e5], .text-quality-地[data-v-13a846e5] { border-color: #3b82f6; color: #3b82f6;\n}\n.border-quality-玄[data-v-13a846e5], .text-quality-玄[data-v-13a846e5] { border-color: #10b981; color: #10b981;\n}\n.border-quality-黄[data-v-13a846e5], .text-quality-黄[data-v-13a846e5] { border-color: #84cc16; color: #84cc16;\n}\n.border-quality-凡[data-v-13a846e5], .text-quality-凡[data-v-13a846e5] { border-color: var(--color-border); color: var(--color-text);\n}\n\n/* 大道列表 */\n.dao-count[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n}\n.dao-list[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.dao-item[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 0.5rem;\n  transition: var(--transition-fast);\n}\n.dao-item[data-v-13a846e5]:hover {\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-color: var(--color-primary);\n}\n.dao-icon[data-v-13a846e5] {\n  font-size: 1.25rem;\n  flex-shrink: 0;\n}\n.dao-info[data-v-13a846e5] {\n  flex: 1;\n  min-width: 0;\n}\n.dao-name[data-v-13a846e5] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 0.25rem;\n}\n.dao-stage[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-accent);\n  margin-bottom: 0.25rem;\n}\n.dao-progress[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.progress-bar[data-v-13a846e5] {\n  flex: 1;\n  height: 8px; /* 增加高度 */\n  background: #e2e8f0; /* 更明显的背景色 */\n  border: 1px solid #cbd5e1; /* 添加边框 */\n  border-radius: 4px;\n  overflow: hidden;\n  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); /* 添加轻微阴影 */\n}\n.progress-fill[data-v-13a846e5] {\n  height: 100%;\n  min-width: 1px; /* 确保最小可见宽度 */\n  background: linear-gradient(90deg, #22c55e, #3b82f6); /* 明确的颜色 */\n  transition: width 0.3s ease;\n}\n.progress-text[data-v-13a846e5] {\n  font-size: 0.625rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 2rem;\n  text-align: right;\n}\n.more-dao[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  text-align: center;\n  padding: 0.5rem;\n  font-style: italic;\n}\n\n/* 装备系统 */\n.equipment-count[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n}\n.equipment-slots[data-v-13a846e5] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 0.75rem;\n}\n.equipment-slot[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 0.5rem;\n  transition: var(--transition-fast);\n}\n.equipment-slot.equipped[data-v-13a846e5] {\n  background: rgba(var(--color-success-rgb), 0.05);\n  border-color: var(--color-success);\n}\n.slot-icon[data-v-13a846e5] {\n  font-size: 1.25rem;\n  flex-shrink: 0;\n}\n.slot-info[data-v-13a846e5] {\n  flex: 1;\n  min-width: 0;\n}\n.slot-name[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 0.125rem;\n}\n.slot-equipment[data-v-13a846e5] {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--color-text);\n}\n.equipment-slot:not(.equipped) .slot-equipment[data-v-13a846e5] {\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n\n/* 天赋列表 */\n.talent-count[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: var(--color-surface-light);\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n}\n.talents-list[data-v-13a846e5] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.talent-item[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 0.5rem;\n}\n.talent-icon[data-v-13a846e5] {\n  font-size: 1.25rem;\n  flex-shrink: 0;\n  color: var(--color-warning);\n}\n.talent-info[data-v-13a846e5] {\n  flex: 1;\n  min-width: 0;\n}\n.talent-name[data-v-13a846e5] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 0.25rem;\n}\n.talent-description[data-v-13a846e5] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n.technique-actions[data-v-13a846e5] {\n  display: flex;\n  gap: 0.5rem;\n  margin-top: 0.75rem;\n}\n\n/* 按钮样式 */\n.action-btn[data-v-13a846e5] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1rem;\n  border: none;\n  border-radius: 0.5rem;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex: 1;\n}\n.cultivate-btn[data-v-13a846e5] {\n  background: #dbeafe;\n  color: #1e40af;\n  border: 1px solid #93c5fd;\n}\n.cultivate-btn[data-v-13a846e5]:hover {\n  background: #93c5fd;\n  transform: translateY(-1px);\n}\n.stop-cultivation-btn[data-v-13a846e5] {\n  background: #fef3e2;\n  color: #c2410c;\n  border: 1px solid #fed7aa;\n}\n.stop-cultivation-btn[data-v-13a846e5]:hover {\n  background: #fed7aa;\n  transform: translateY(-1px);\n}\n.action-btn[data-v-13a846e5]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* 动画 */\n.animate-spin[data-v-13a846e5] {\n  animation: spin-13a846e5 1s linear infinite;\n}\n@keyframes spin-13a846e5 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.header-actions .btn-text[data-v-13a846e5] {\n    display: none;\n}\n.equipment-slots[data-v-13a846e5] {\n    grid-template-columns: 1fr;\n}\n}\n",""]);const i=l},4670:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.data-display[data-v-62ba194a] {\n  flex: 1;\n  overflow: auto;\n  padding: 1rem;\n}\n.loading-state[data-v-62ba194a],\n.no-connection[data-v-62ba194a],\n.error-state[data-v-62ba194a] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 1rem;\n  padding: 3rem;\n  color: var(--color-text-secondary);\n}\n.retry-btn[data-v-62ba194a] {\n  padding: 0.5rem 1rem;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s;\n}\n.retry-btn[data-v-62ba194a]:hover {\n  background: var(--color-primary-hover);\n}\n.hint[data-v-62ba194a] {\n  font-size: 0.875rem;\n  opacity: 0.7;\n}\n.animate-spin[data-v-62ba194a] {\n  animation: spin-62ba194a 1s linear infinite;\n}\n@keyframes spin-62ba194a {\nfrom {\n    transform: rotate(0deg);\n}\nto {\n    transform: rotate(360deg);\n}\n}\n",""]);const i=l},4775:(e,n,t)=>{t.d(n,{IJ:()=>l});var a=t(6912),o=t(1265);const r=`\n# 任务：角色初始化\n\n生成修仙开局故事并初始化世界状态。\n\n**输出格式**:\n\`\`\`json\n{\n  "text": "1200-2500字开局故事",\n  "mid_term_memory": "可选：50-100字核心事件总结",\n  "tavern_commands": [{"action": "set", "key": "位置.描述", "value": "大陆·地点"}, ...]\n}\n\`\`\`\n\n**要求**: JSON中禁止使用注释、尾随逗号和单引号。'text'字段长度必须大于等于1200字。'tavern_commands'为必需字段。\n\n---\n\n# 1. 开局故事 (text)\n\n生成1200-2500字的沉浸式开场，体现角色的出身、天赋和所处环境。\n\n**叙事**: 通过行为和感受来展现角色特质，禁止直接提及"根骨"、"灵根"等术语。例如，高根骨体现为体魄强健，高悟性体现为领悟力超群，神品灵根则可能伴随天地异象。\n\n**一致性**: 故事内容必须与玩家的选择完全匹配，并积极体现其优势。\n\n**年龄**: 从玩家选择的开局年龄开始，禁止修改寿命，禁止时间跳跃。\n\n**格式**: 纯叙事，不包含时间标记。\n\n---\n\n# 2. 初始世界状态 (tavern_commands)\n\n根据开局故事，通过commands添加初始实体。\n\n**物品与灵石**: 初始2-5件物品，灵石数量根据出身背景决定 (凡人0-10, 小康10-50, 宗门弟子50-200)，物品品质需与出身匹配。\n\n**NPC**: 初始0-3个与故事相关的NPC，使用简化格式。\n\n**大道**: 如果天赋与某个大道对应，则解锁该大道。\n\n---\n\n# 角色初始化规则\n\n${["# 任务：生成开局故事并初始化世界","","## 1. 随机选项处理",'检测到"随机灵根"或"随机出身"时必须替换为具体内容。灵根根据天资等级选择品级，出身根据世界背景选择。text和commands中禁止出现"随机"字样。',"","## 2. 玩家选择不可更改","玩家已选的具体灵根或出身，严禁使用commands进行修改。","","## 3. 位置设置",'位置格式必须为 "大陆名·地点名" 或 "大陆名·区域·地点名"。地点必须从可用的`availableContinents`和`availableLocations`中选择，禁止编造。',"","## 4. 物品创建流程","先创建物品到背包，然后装备栏引用该物品ID，最后标记物品为已装备状态。","","## 5. 开局年龄","严格按照玩家选择的年龄开始游戏。禁止修改寿命，禁止时间跳跃。","","## 6. 初始资源范围","灵石: 凡人(0-10), 小康(10-50), 宗门弟子(50-200)。","物品: 2-5件。","NPC: 0-3个。","功法: 0-2部。","","## 7. 叙事要求","生成1200-2500字的沉浸式开场故事。通过行为暗示角色特质，禁止直接提及游戏术语。纯叙事，不加时间标记。","",o.EF,"",o.Iz].join("\n")}\n\n---\n\n# 数据结构\n\n${a.uH}\n\n---\n\n# 参考数据\n\n以下是当前状态和参考信息:\n\n提醒：位置必须从'availableContinents'和'availableLocations'中选择，禁止编造。\n\n\`\`\`json\nINPUT_PLACEHOLDER\n\`\`\`\n`.trim();function l(e){const n=e=>{if(!e)return"无";if("string"==typeof e)return e.includes("随机灵根")?`${e}\n    *   AI必须处理: 这是一个随机选项，必须在生成故事前将其替换为具体的灵根。`:e.includes("随机出生")?`${e}\n    *   AI必须处理: 这是一个随机选项，必须在生成故事前将其替换为具体的出身。`:String(e);if("object"!=typeof e)return String(e);if(e.名称&&e.品级){const n=e.描述||"";return`${e.名称}(${e.品级})${n?`\n    *   描述: ${n}`:""}`}if(e.name&&e.tier&&void 0!==e.description)return`${e.name}(${e.tier})\n    *   描述: ${e.description}`;if(e.name&&e.description&&"number"==typeof e.total_points)return`${e.name}\n    *   详细描述: ${e.description}\n    *   天赋点数: ${e.total_points}`;if(e.name&&e.description&&"number"==typeof e.talent_cost&&e.attribute_modifiers){const n=Object.entries(e.attribute_modifiers).map(([e,n])=>`${e}${Number(n)>0?"+":""}${n}`).join(", ");return`${e.name}\n    *   详细描述: ${e.description}${n?`\n    *   属性影响: ${n}`:""}`}if(e.name&&e.description&&"number"==typeof e.talent_cost&&!e.attribute_modifiers)return`${e.name}\n    *   详细描述: ${e.description}\n    *   消耗点数: ${e.talent_cost}`;if(e.name&&e.description)return`${e.name}\n    *   详细描述: ${e.description}`;if(e.名称&&e.描述)return`${e.名称}\n    *   详细描述: ${e.描述}`;if("object"==typeof e&&null!==e){const n=Object.entries(e);if(n.length>0){const t=e.name||e.名称;let a=t?`${t}\n`:"";n.forEach(([e,n])=>{if("name"!==e&&"名称"!==e&&null!=n){let t="";if("object"==typeof n){const e=JSON.stringify(n);t=e.length>100?`${e.substring(0,100)}...`:e}else t=String(n),t.length>200&&(t=t.substring(0,200)+"...");a+=`    *   ${e}: ${t}\n`}});const o=JSON.stringify(e,null,2);return a.trim()||(o.length>500?`${o.substring(0,500)}...`:o)}}const n=JSON.stringify(e,null,2);return n.length>1e3?`\`\`\`json\n${n.substring(0,1e3)}...\n\`\`\``:`\`\`\`json\n${n}\n\`\`\``},t=e.talents&&e.talents.length>0?e.talents.map(e=>`*   天赋: ${n(e)}`).join("\n"):"*   天赋: 无",a=Object.entries(e.attributes).map(([e,n])=>`*   ${e}: ${n}`).join("\n"),o=`\n# 玩家核心选择\n\n## 核心身份\n*   姓名: ${e.name}\n*   性别: ${e.gender}\n*   开局年龄: ${e.age}岁\n*   世界: ${e.world}\n\n## 修行潜质\n*   天资: ${n(e.talentTier)}\n*   出身: ${n(e.origin)}\n*   灵根: ${n(e.spiritRoot)}\n${t}\n\n## 先天六司\n${a}\n---\n`;return r.replace("# 玩家核心选择",o.replace("# 玩家核心选择","# 角色核心设定参考（仅供创作参考，严禁直接复述）"))}'\n# 任务：为大陆生成层级地点名\n\n为大陆生成具体、有层级、有特色的地点名称。\n\n**输入**:\n```json\nINPUT_PLACEHOLDER\n```\n\n**输出**:\n```json\n{"location_name": "具体地点(不含大陆名)"}\n```\n\n**要求**:\n1. 2-3层级, 用"·"分隔, 从大到小 (例如: 区域·建筑·场所)。\n2. 体现大陆特点 (修仙世界使用宗门/洞府, 都市世界使用建筑/街道)。\n3. 只返回地点名，系统会自动拼接大陆名。\n4. 必须是有效的JSON，无注释或额外文本。\n'.trim()},4920:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.data-clear-container[data-v-36f2cce4] {\n  display: flex;\n  align-items: center;\n}\n.clear-buttons[data-v-36f2cce4] {\n  display: flex;\n  gap: 0.5rem;\n  align-items: center;\n}\n.clear-button[data-v-36f2cce4] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  padding: 0.5rem 0.8rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  min-width: 80px;\n  white-space: nowrap;\n}\n.clear-button[data-v-36f2cce4]:hover:not(:disabled) {\n  background: rgba(var(--color-danger-rgb), 0.1);\n  border-color: var(--color-danger);\n  color: var(--color-danger);\n}\n.clear-button[data-v-36f2cce4]:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n}\n.clear-icon[data-v-36f2cce4] {\n  font-size: 1em;\n  flex-shrink: 0;\n}\n.clear-text[data-v-36f2cce4] {\n  font-weight: 500;\n}\n\n/* 不同类型按钮的特定样式 */\n.clear-button.extra[data-v-36f2cce4]:hover:not(:disabled) {\n  background: rgba(255, 165, 0, 0.2);\n  border-color: orange;\n  color: orange;\n}\n.clear-button.sync[data-v-36f2cce4]:hover:not(:disabled) {\n  background: rgba(135, 206, 235, 0.2);\n  border-color: skyblue;\n  color: skyblue;\n}\n",""]);const i=l},4986:(e,n,t)=>{t.d(n,{An:()=>m,Q3:()=>i,syncHeavenlyPrecalcToTavern:()=>d});var a=t(2224),o=t(8651);function r(e,n=0){const t=Number(e);return Number.isFinite(t)?t:n}function l(e){return function(e){try{const n=(0,a.get)(e,"玩家角色状态.气血",{当前:100,上限:100}),t=r((0,a.get)(e,"玩家角色状态.寿命.上限"),100),o=(0,a.get)(e,"玩家角色状态.死亡状态",{已死亡:!1});if(o?.已死亡)return o;const l=r(n.当前,100),i=r((0,a.get)(e,"角色基础信息.出生日期.年"),0),s=r((0,a.get)(e,"游戏时间.年"),1),d=i>0?s-i:r((0,a.get)(e,"角色基础信息.年龄"),18);console.log("[死亡系统] 寿命检测:",{出生年份:i,当前年份:s,当前年龄:d,最大寿命:t,是否超限:d>=t});let m={已死亡:!1};return l<=0?m={已死亡:!0,死亡时间:c(e),死亡原因:"气血耗尽"}:d>=t&&(t<80?console.warn("[死亡系统] ⚠️ 检测到异常寿命上限:",t,"已忽略死亡判定"):m={已死亡:!0,死亡时间:c(e),死亡原因:"寿元耗尽"}),m.已死亡&&((0,a.set)(e,"玩家角色状态.死亡状态",m),console.log("[死亡系统] 角色死亡:",m,`当前年龄: ${d}, 最大寿命: ${t}`)),m}catch(e){return console.error("[死亡系统] 检查死亡状态失败:",e),{已死亡:!1}}}(e)}function i(e){const n=l(e);return{isDead:n.已死亡,deathReason:n.死亡原因,shouldBlockGame:n.已死亡}}function c(e){const n=(0,a.get)(e,"游戏时间",{年:1,月:1,日:1});return`${n.年}年${n.月}月${n.日}日`}async function s(e,n){if((0,o.getTavernHelper)())try{!function(e,n){(function(e,n){const t=r(n?.先天六司?.根骨,10),o=r(n?.先天六司?.灵性,10),l=r(n?.先天六司?.悟性,10),i=r(n?.先天六司?.心性,10),c=r(n?.先天六司?.气运,5),s=(0,a.get)(e,"玩家角色状态.气血",{当前:100,上限:100}),d=(0,a.get)(e,"玩家角色状态.灵气",{当前:100,上限:100}),m=(0,a.get)(e,"玩家角色状态.神识",{当前:100,上限:100}),p=1+.1*({凡人:0,练气:1,炼气:1,筑基:2,金丹:3,元婴:4,化神:5,炼虚:6,合体:7,渡劫:8}[String((0,a.get)(e,"玩家角色状态.境界.名称","凡人"))]||0),v=function(e){let n=0,t=0,o=0,l=0;try{const i=(0,a.get)(e,"装备栏",{}),c=(0,a.get)(e,"背包.物品",{});Object.values(i).forEach(e=>{if(!e||"object"!=typeof e)return;const a=e.物品ID||e,i=c[a];if(i&&"装备"===i.类型){const e=i.装备增幅;e&&(n+=r(e.攻击力),t+=r(e.防御力),o+=r(e.灵识),l+=r(e.敏捷))}})}catch(e){console.warn("[天道演算] 装备加成计算失败:",e)}return{攻击:n,防御:t,灵识:o,敏捷:l}}(e),u=function(e){let n=0,t=0,o=0,l=0;try{const i=(0,a.get)(e,"修炼功法");if(!i)return{攻击:n,防御:t,灵识:o,敏捷:l};const c=r(i.熟练度,0);if(c>0){const e=Math.floor(c/10);n+=2*e,t+=e,o+=1.5*e,l+=.5*e}if("功法"===i.类型){const e=i.功法效果;e?.属性加成&&(n+=r(e.属性加成.攻击力),t+=r(e.属性加成.防御力),o+=r(e.属性加成.灵识),l+=r(e.属性加成.敏捷))}}catch(e){console.warn("[天道演算] 功法加成计算失败:",e)}return{攻击:n,防御:t,灵识:o,敏捷:l}}(e),g=function(e){let n=0,t=0,o=0,l=0;try{(0,a.get)(e,"玩家角色状态.状态效果",[]).forEach(e=>{if(!e)return;const a=r(e.强度,1);n+=r(e.攻击加成)*a,t+=r(e.防御加成)*a,o+=r(e.灵识加成)*a,l+=r(e.敏捷加成)*a,"buff"===e.类型?(n+=5*a,t+=3*a,o+=4*a,l+=2*a):"debuff"===e.类型&&(n-=8*a,t-=5*a,o-=6*a,l-=4*a)})}catch(e){console.warn("[天道演算] 状态加成计算失败:",e)}return{攻击:n,防御:t,灵识:o,敏捷:l}}(e);Math.round((3*t+4*o+.5*r(d.当前)+v.攻击+u.攻击+g.攻击)*p),Math.round((4*t+3*i+.3*r(s.上限)+v.防御+u.防御+g.防御)*p),Math.round((4*l+3*o+.6*r(m.当前)+v.灵识+u.灵识+g.灵识)*p),Math.round((3*o+2*t+v.敏捷+u.敏捷+g.敏捷)*p)})(e,n),l(e),String((0,a.get)(e,"玩家角色状态.境界.名称","凡人"));n.名字,(new Date).toISOString()}(e,n),console.log("[天道演算] 计算完成（数据由Store统一管理）")}catch(e){console.error("[天道演算] 计算失败:",e)}}async function d(e,n){return s(e,n)}function m(){return"\n## 天道演算系统 v5.0\n\n### 判定规则\n根据角色的先天六司、境界、装备等综合因素进行判定。\n\n#### 可用判定类型：\n- 攻击/防御（战斗）\n- 修炼/炼制（提升）\n- 交互（社交）\n- 探索（冒险）\n\n#### 结果等级：\n- 完美(5%)：超凡表现，额外奖励\n- 大成(15%)：优秀结果，正常奖励\n- 成功(60%)：达成目标，基础奖励\n- 失败(15%)：未达目标，轻微惩罚\n- 大败(5%)：严重失误，重大惩罚\n\n#### 死亡机制：\n当 `heavenly.死亡状态.已死亡` 为 true 时，角色死亡，游戏结束。\n\n### 使用方式\n1. 根据行动选择判定类型\n2. 使用预计算数值执行判定\n3. 基于结果等级叙述后果\n4. 更新角色状态（伤害/奖励）\n\n**重要：严格按照数值计算，不得随意修改结果。**\n"}},5056:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},5072:e=>{var n=[];function t(e){for(var t=-1,a=0;a<n.length;a++)if(n[a].identifier===e){t=a;break}return t}function a(e,a){for(var r={},l=[],i=0;i<e.length;i++){var c=e[i],s=a.base?c[0]+a.base:c[0],d=r[s]||0,m="".concat(s," ").concat(d);r[s]=d+1;var p=t(m),v={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)n[p].references++,n[p].updater(v);else{var u=o(v,a);a.byIndex=i,n.splice(i,0,{identifier:m,updater:u,references:1})}l.push(m)}return l}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var r=a(e=e||[],o=o||{});return function(e){e=e||[];for(var l=0;l<r.length;l++){var i=t(r[l]);n[i].references--}for(var c=a(e,o),s=0;s<r.length;s++){var d=t(r[s]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}r=c}}},5258:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.retry-dialog-overlay[data-v-9136f00c] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  z-index: 99999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n}\n.retry-dialog[data-v-9136f00c] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 480px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n  animation: dialog-appear-9136f00c 0.3s ease-out;\n  overflow: hidden;\n  /* 确保背景完全贴合 */\n  display: flex;\n  flex-direction: column;\n}\n@keyframes dialog-appear-9136f00c {\nfrom {\n    opacity: 0;\n    transform: scale(0.9) translateY(20px);\n}\nto {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n}\n}\n.dialog-header[data-v-9136f00c] {\n  padding: 24px 24px 16px;\n  text-align: center;\n  background: var(--color-surface);\n  /* 去除可能的间隙 */\n  margin: 0;\n  flex-shrink: 0;\n}\n.dialog-header h3[data-v-9136f00c] {\n  margin: 0;\n  padding: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: var(--color-text);\n  line-height: 1.4;\n}\n.dialog-content[data-v-9136f00c] {\n  padding: 20px 24px;\n  text-align: center;\n  background: var(--color-surface);\n  /* 确保内容区域可滚动但不超出 */\n  max-height: 50vh;\n  overflow-y: auto;\n  overflow-x: hidden;\n  /* 去除可能的间隙 */\n  margin: 0;\n  flex: 1;\n}\n\n/* 滚动条样式优化 */\n.dialog-content[data-v-9136f00c]::-webkit-scrollbar {\n  width: 6px;\n}\n.dialog-content[data-v-9136f00c]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.dialog-content[data-v-9136f00c]::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 3px;\n}\n.dialog-content[data-v-9136f00c]::-webkit-scrollbar-thumb:hover {\n  background: rgba(0, 0, 0, 0.4);\n}\n.error-icon[data-v-9136f00c] {\n  color: var(--color-warning);\n  margin: 0 0 16px 0;\n  padding: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.message[data-v-9136f00c] {\n  color: var(--color-text);\n  line-height: 1.6;\n  margin: 0;\n  padding: 0;\n  white-space: pre-line;\n  text-align: left;\n  word-break: break-word;\n}\n.dialog-actions[data-v-9136f00c] {\n  display: flex;\n  gap: 12px;\n  padding: 16px 24px 24px;\n  background: var(--color-surface);\n  /* 去除可能的间隙 */\n  margin: 0;\n  flex-shrink: 0;\n}\n.btn-primary[data-v-9136f00c],\n.btn-secondary[data-v-9136f00c] {\n  flex: 1;\n  padding: 12px 20px;\n  margin: 0;\n  border-radius: 8px;\n  border: 1px solid;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  line-height: 1.5;\n}\n.btn-primary[data-v-9136f00c] {\n  background: var(--color-primary);\n  border-color: var(--color-primary);\n  color: white;\n}\n.btn-primary[data-v-9136f00c]:hover {\n  background: var(--color-primary-hover);\n  border-color: var(--color-primary-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n.btn-secondary[data-v-9136f00c] {\n  background: transparent;\n  border-color: var(--color-border);\n  color: var(--color-text-secondary);\n}\n.btn-secondary[data-v-9136f00c]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-text-secondary);\n  color: var(--color-text);\n  transform: translateY(-1px);\n}\n.btn-primary[data-v-9136f00c]:active,\n.btn-secondary[data-v-9136f00c]:active {\n  transform: translateY(0) scale(0.98);\n}\n@media (max-width: 480px) {\n.retry-dialog-overlay[data-v-9136f00c] {\n    padding: 16px;\n}\n.retry-dialog[data-v-9136f00c] {\n    max-width: none;\n    border-radius: 12px;\n}\n.dialog-header[data-v-9136f00c] {\n    padding: 20px 20px 12px;\n}\n.dialog-header h3[data-v-9136f00c] {\n    font-size: 1.1rem;\n}\n.dialog-content[data-v-9136f00c] {\n    padding: 16px 20px;\n    max-height: 60vh;\n}\n.dialog-actions[data-v-9136f00c] {\n    flex-direction: column-reverse;\n    gap: 10px;\n    padding: 12px 20px 20px;\n}\n.btn-primary[data-v-9136f00c],\n  .btn-secondary[data-v-9136f00c] {\n    flex: none;\n    width: 100%;\n}\n}\n",""]);const i=l},5272:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.origin-selection-container[data-v-907f35d4] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.loading-state[data-v-907f35d4],\n.error-state[data-v-907f35d4],\n.placeholder[data-v-907f35d4] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.origin-layout[data-v-907f35d4] {\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  gap: 2rem;\n  height: 100%;\n  overflow: hidden;\n}\n.origin-left-panel[data-v-907f35d4] {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--color-surface);\n}\n.origin-list-container[data-v-907f35d4] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.origin-list-container[data-v-907f35d4]::-webkit-scrollbar { width: 8px;\n}\n.origin-list-container[data-v-907f35d4]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.origin-list-container[data-v-907f35d4]::-webkit-scrollbar-thumb { background: rgba(var(--color-primary-rgb), 0.3); border-radius: 4px;\n}\n.origin-list-container[data-v-907f35d4]::-webkit-scrollbar-thumb:hover { background: rgba(var(--color-primary-rgb), 0.5);\n}\n.origin-item[data-v-907f35d4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  margin-bottom: 0.5rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-left: 3px solid transparent;\n}\n.item-content[data-v-907f35d4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-grow: 1;\n}\n\n/* 按钮组容器 */\n.action-buttons[data-v-907f35d4] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n  margin-left: 0.5rem;\n}\n.origin-item:hover .action-buttons[data-v-907f35d4] {\n  opacity: 1;\n}\n\n/* 编辑按钮 */\n.edit-btn[data-v-907f35d4] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.edit-btn[data-v-907f35d4]:hover {\n  color: var(--color-primary);\n  background-color: rgba(59, 130, 246, 0.1);\n}\n.delete-btn[data-v-907f35d4] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n\n/* 移除原有的删除按钮hover逻辑，因为现在按钮组统一管理 */\n.delete-btn[data-v-907f35d4]:hover {\n  color: var(--color-danger);\n  background-color: rgba(255, 0, 0, 0.1);\n}\n.origin-item[data-v-907f35d4]:hover {\n  background: var(--color-surface-light);\n}\n.origin-item.selected[data-v-907f35d4] {\n  background: rgba(var(--color-primary-rgb), 0.2);\n  color: var(--color-primary);\n  font-weight: 600;\n  border-left: 3px solid var(--color-primary);\n}\n.origin-item.disabled[data-v-907f35d4] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: transparent;\n  color: var(--color-text-disabled);\n}\n.origin-item.disabled[data-v-907f35d4]:hover {\n  background: var(--color-surface-danger);\n}\n.origin-name[data-v-907f35d4] {\n  font-weight: 500;\n}\n.origin-cost[data-v-907f35d4] {\n  color: var(--color-accent);\n}\n.divider[data-v-907f35d4] {\n height: 1px;\n background: linear-gradient(to right, transparent, rgba(var(--color-primary-rgb), 0.2), transparent);\n margin: 0.5rem 0;\n}\n.single-actions-container[data-v-907f35d4] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.action-item[data-v-907f35d4] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 1rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n.action-item[data-v-907f35d4]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.action-name[data-v-907f35d4] {\n  font-weight: 500;\n}\n.origin-details-container[data-v-907f35d4] {\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  padding: 1.5rem;\n  background: var(--color-surface);\n}\n.origin-details[data-v-907f35d4] {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n}\n.origin-details h2[data-v-907f35d4] {\n  margin-top: 0;\n  margin-bottom: 1rem;\n  color: var(--color-primary);\n  flex-shrink: 0;\n}\n.description-scroll[data-v-907f35d4] {\n  flex: 1;\n  overflow-y: auto;\n  line-height: 1.6;\n  margin-bottom: 1rem;\n  padding-right: 0.5rem;\n}\n.description-scroll p[data-v-907f35d4] {\n  margin: 0;\n  white-space: pre-wrap;\n  color: var(--color-text-secondary);\n}\n.description-scroll[data-v-907f35d4]::-webkit-scrollbar { width: 8px;\n}\n.description-scroll[data-v-907f35d4]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.description-scroll[data-v-907f35d4]::-webkit-scrollbar-thumb { background: rgba(var(--color-primary-rgb), 0.3); border-radius: 4px;\n}\n.description-scroll[data-v-907f35d4]::-webkit-scrollbar-thumb:hover { background: rgba(var(--color-primary-rgb), 0.5);\n}\n.cost-display[data-v-907f35d4] {\n  text-align: right;\n  font-weight: bold;\n  color: var(--color-accent);\n  flex-shrink: 0;\n}\n\n/* 响应式适配 - 手机端优化 */\n@media (max-width: 1200px) {\n.origin-layout[data-v-907f35d4] {\n    grid-template-columns: 1fr 1.8fr;\n    gap: 1.5rem;\n}\n}\n@media (max-width: 1024px) {\n.origin-layout[data-v-907f35d4] {\n    grid-template-columns: 1fr 1.5fr;\n    gap: 1.2rem;\n}\n.origin-details h2[data-v-907f35d4] {\n    font-size: 1.6rem;\n}\n}\n@media (max-width: 640px) {\n.top-actions-container[data-v-907f35d4] {\n    flex-wrap: wrap;\n    justify-content: stretch;\n}\n.top-actions-container .action-item[data-v-907f35d4] {\n    flex-grow: 1;\n    text-align: center;\n}\n.origin-layout[data-v-907f35d4] {\n    /* 改为垂直堆叠布局 */\n    grid-template-columns: 1fr;\n    grid-template-rows: auto 1fr;\n    gap: 1rem;\n    height: auto;\n    overflow: visible;\n    padding: 0.8rem;\n}\n.origin-left-panel[data-v-907f35d4] {\n    order: 1;\n    max-height: 40vh;\n}\n.origin-details-container[data-v-907f35d4] {\n    order: 2;\n    min-height: 300px;\n}\n.origin-list-container[data-v-907f35d4] {\n    max-height: 35vh;\n    /* 添加触摸滚动优化 */\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n}\n  \n  /* 优化触摸体验 */\n.origin-item[data-v-907f35d4],\n  .action-item[data-v-907f35d4] {\n    -webkit-tap-highlight-color: transparent;\n    touch-action: manipulation;\n}\n}\n@media (max-width: 640px) {\n.origin-layout[data-v-907f35d4] {\n    gap: 0.8rem;\n    padding: 0.6rem;\n}\n.origin-left-panel[data-v-907f35d4] {\n    max-height: 35vh;\n}\n.origin-list-container[data-v-907f35d4] {\n    max-height: 30vh;\n    padding: 0.5rem;\n}\n.origin-item[data-v-907f35d4] {\n    padding: 0.7rem;\n    font-size: 0.95rem;\n    margin-bottom: 0.4rem;\n}\n.single-actions-container[data-v-907f35d4] {\n    padding: 0.5rem;\n    gap: 0.4rem;\n}\n.action-item[data-v-907f35d4] {\n    padding: 0.7rem 1rem;\n    font-size: 0.9rem;\n}\n.origin-details-container[data-v-907f35d4] {\n    padding: 1.2rem;\n    min-height: 250px;\n}\n.origin-details h2[data-v-907f35d4] {\n    font-size: 1.4rem;\n    margin-bottom: 0.8rem;\n}\n}\n@media (max-width: 480px) {\n.top-actions-container[data-v-907f35d4] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.origin-selection-container[data-v-907f35d4] {\n    padding: 0.4rem;\n    height: auto;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.origin-layout[data-v-907f35d4] {\n    gap: 0.6rem;\n    padding: 0;\n    height: auto;\n    min-height: 0;\n}\n.origin-left-panel[data-v-907f35d4] {\n    max-height: none;\n    border-radius: 6px;\n}\n.origin-list-container[data-v-907f35d4] {\n    max-height: 26vh;\n    padding: 0.4rem;\n}\n.origin-item[data-v-907f35d4] {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.9rem;\n    margin-bottom: 0.3rem;\n    border-radius: 4px;\n}\n.origin-name[data-v-907f35d4] {\n    font-size: 0.9rem;\n}\n.origin-cost[data-v-907f35d4] {\n    font-size: 0.8rem;\n}\n.divider[data-v-907f35d4] {\n    margin: 0.3rem 0;\n}\n.single-actions-container[data-v-907f35d4] {\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.4rem;\n}\n.action-item[data-v-907f35d4] {\n    padding: 0.6rem;\n    font-size: 0.85rem;\n    border-radius: 4px;\n}\n.origin-details-container[data-v-907f35d4] {\n    padding: 1rem;\n    min-height: 200px;\n    border-radius: 6px;\n}\n.origin-details h2[data-v-907f35d4] {\n    font-size: 1.3rem;\n    margin-bottom: 0.6rem;\n}\n.description-scroll[data-v-907f35d4] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    padding-right: 0.3rem;\n    margin-bottom: 0.8rem;\n}\n.cost-display[data-v-907f35d4] {\n    font-size: 1rem;\n    text-align: center;\n}\n.placeholder[data-v-907f35d4] {\n    font-size: 1rem;\n    padding: 1rem;\n    text-align: center;\n    min-height: 150px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.top-actions-container[data-v-907f35d4] {\n    flex-direction: column;\n    align-items: stretch;\n    padding: 0.5rem;\n}\n.top-actions-container .action-item[data-v-907f35d4] {\n    text-align: center;\n}\n}\n\n/* 顶部功能按钮 */\n.top-actions-container[data-v-907f35d4] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.1);\n  justify-content: flex-end;\n}\n.top-actions-container .action-item[data-v-907f35d4] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  white-space: nowrap;\n}\n.top-actions-container .action-item[data-v-907f35d4]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n@media (max-width: 360px) {\n.origin-selection-container[data-v-907f35d4] {\n    padding: 0.3rem;\n}\n.origin-layout[data-v-907f35d4] {\n    gap: 0.4rem;\n}\n.origin-left-panel[data-v-907f35d4] {\n    max-height: 28vh;\n}\n.origin-list-container[data-v-907f35d4] {\n    max-height: 24vh;\n    padding: 0.3rem;\n}\n.origin-item[data-v-907f35d4] {\n    padding: 0.5rem 0.6rem;\n    font-size: 0.85rem;\n    margin-bottom: 0.2rem;\n}\n.origin-name[data-v-907f35d4] {\n    font-size: 0.8rem;\n}\n.origin-cost[data-v-907f35d4] {\n    font-size: 0.75rem;\n}\n.origin-details-container[data-v-907f35d4] {\n    padding: 0.8rem;\n    min-height: 180px;\n}\n.origin-details h2[data-v-907f35d4] {\n    font-size: 1.1rem;\n    margin-bottom: 0.5rem;\n}\n.description-scroll[data-v-907f35d4] {\n    font-size: 0.85rem;\n    line-height: 1.4;\n    margin-bottom: 0.6rem;\n}\n.cost-display[data-v-907f35d4] {\n    font-size: 0.9rem;\n}\n.action-item[data-v-907f35d4] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.placeholder[data-v-907f35d4] {\n    font-size: 0.9rem;\n    padding: 0.8rem;\n    min-height: 120px;\n}\n}\n",""]);const i=l},5408:(e,n,t)=>{t.d(n,{BA:()=>c,XN:()=>l,__:()=>r,tQ:()=>o,x$:()=>i});const a='你是专业的世界观内容生成器，根据用户提供的主题生成对应风格的内容。\n\n【核心要求】\n1. 必须严格遵守JSON格式规范\n2. 所有数值字段必须是数字类型，不能是字符串\n3. 输出必须使用```json代码块包裹\n4. 不得添加任何额外的解释说明文字\n\n【世界观核心理念】\n无论背景设定是什么（仙侠、科幻、现代、赛博朋克等），核心都是"修仙体系"：\n- 现代背景 → 灵气复苏、独自修炼\n- 科幻背景 → 星际修真、灵能觉醒\n- 赛博朋克 → 数据灵修、义体炼气\n关键词："一人修仙"的孤独感 + 超凡体系\n\n【输出格式】\n```json\n{JSON内容}\n```\n',o=`${a}\n\n【任务】生成世界设定\n\n【字段】name(2-6字)/description(200-400字)/era(5-10字)\n\n【示例】\n\`\`\`json\n{"name":"青云界","description":"上古仙人开辟,灵气充沛,修真兴盛。分东胜/南疆/西荒/北海四域,各有体系传承。千年前仙魔大战后规则重整,如今盛世宗门林立天骄辈出,暗流涌动封印松动...","era":"盛世修真"}\n\`\`\`\n\n【常见错误】缺少JSON代码块、字段名称错误、描述过短、名称过长\n`,r=`${a}\n\n【任务】生成天赋等级\n\n【必填字段】\n- name: 天赋名称\n- description: 描述文字（50-150字）\n- total_points: 总点数（数字类型，范围10-50）\n- rarity: 稀有度（数字类型，范围1-5）\n- color: 颜色（十六进制格式）\n\n【重要提示】total_points 和 rarity 必须是数字类型，不能用引号包裹成字符串\n\n【正确示例】\n\`\`\`json\n{"name":"凡夫俗子","description":"资质平庸,修炼缓慢,需数倍努力","total_points":15,"rarity":1,"color":"#808080"}\n\`\`\`\n\n【常见错误】数值字段使用了字符串类型、数值超出规定范围\n`,l=`${a}\n\n【任务】生成出身背景\n\n【字段要求】\n- name (字符串): 4-6字的出身名称，如"书香门第"、"江湖游侠"\n- description (字符串): 100-300字的背景故事\n- talent_cost (数字): 0-10之间的整数，背景越好消耗越高\n- rarity (数字): 1-5之间的整数\n- attribute_modifiers (对象): 先天六司加成，总和不超过5点\n- effects (数组): 1-2个独特效果的文字描述\n\n【先天六司】根骨、灵性、悟性、气运、魅力、心性\n\n【正确示例1】\n\`\`\`json\n{\n  "name": "书香门第",\n  "description": "生于书香世家，自幼饱读诗书，接受良好教育。家中虽无修真传承，但深厚的文化底蕴培养了超凡的悟性和气度。",\n  "talent_cost": 3,\n  "rarity": 2,\n  "attribute_modifiers": {\n    "悟性": 2,\n    "魅力": 1\n  },\n  "effects": [\n    "学习功法速度提升20%",\n    "与文士、儒修好感度更易提升"\n  ]\n}\n\`\`\`\n\n【正确示例2】\n\`\`\`json\n{\n  "name": "仙门弃徒",\n  "description": "曾是某仙门外门弟子，因故被逐出师门。虽然失去了宗门庇护，但掌握了一些基础修炼法门，且对宗门规矩了如指掌。",\n  "talent_cost": 5,\n  "rarity": 3,\n  "attribute_modifiers": {\n    "根骨": 1,\n    "心性": 2\n  },\n  "effects": [\n    "初始掌握一门基础功法",\n    "对各大宗门规矩有所了解"\n  ]\n}\n\`\`\`\n\n【错误示例】以下操作会导致生成失败\n- 错误："talent_cost": "5" （必须是数字类型，不能是字符串）\n- 错误：attribute_modifiers 的属性加成总和超过5点\n- 错误：effects 字段为空数组\n- 错误：属性名写错（例如写成"悟姓"而不是"悟性"）\n`,i=`${a}\n\n【任务】生成核心天赋类型（如灵根、血统等）\n\n【字段要求】\n- name (字符串): 灵根名称，不含等级前缀（如"雷灵根"而非"上品雷灵根"）\n- tier (字符串): 等级，可选值：凡品、下品、中品、上品、极品、神品\n- description (字符串): 50-200字的灵根描述\n- cultivation_speed (字符串): 修炼速度，格式为"数字x"，如"1.6x"\n- special_effects (数组): 1-3个特殊效果\n- base_multiplier (数字): 基础倍率，纯数字（注意：不是字符串！）\n- talent_cost (数字): 3-30之间的整数，品级越高消耗越大\n- rarity (数字): 1-5之间的整数\n\n【等级对应倍率参考】\n- 凡品: 1.0x\n- 下品: 1.1x\n- 中品: 1.3x\n- 上品: 1.6x\n- 极品: 2.0x\n- 神品: 2.8x（极罕见）\n\n【正确示例1】\n\`\`\`json\n{\n  "name": "火灵根",\n  "tier": "中品",\n  "description": "天生亲和火属性灵气，修炼火系功法事半功倍。火灵根者性格刚烈，战斗力强悍。",\n  "cultivation_speed": "1.3x",\n  "special_effects": [\n    "火系术法威力提升30%",\n    "抗火属性伤害"\n  ],\n  "base_multiplier": 1.3,\n  "talent_cost": 7,\n  "rarity": 2\n}\n\`\`\`\n\n【正确示例2】\n\`\`\`json\n{\n  "name": "雷灵根",\n  "tier": "上品",\n  "description": "雷霆之力加身，修炼速度极快。雷灵根罕见而强大，修炼者往往能在战斗中占据优势。",\n  "cultivation_speed": "1.6x",\n  "special_effects": [\n    "雷系术法威力提升50%",\n    "身法速度提升",\n    "天劫抗性增加"\n  ],\n  "base_multiplier": 1.6,\n  "talent_cost": 11,\n  "rarity": 3\n}\n\`\`\`\n\n【错误示例】以下操作会导致生成失败\n- 错误："base_multiplier": "1.6" （必须是数字类型，不能是字符串！这是常见错误）\n- 错误："talent_cost": "10" （必须是数字类型）\n- 错误：cultivation_speed 与 base_multiplier 数值不一致\n- 错误：name 字段包含等级前缀（例如"上品火灵根"，应该只写"火灵根"）\n`,c=`${a}\n\n【任务】生成先天天赋\n\n【字段要求】\n- name (字符串): 4-6字的天赋名称，体现其先天特性\n- description (字符串): 30-100字的天赋描述\n\n【正确示例1】\n\`\`\`json\n{\n  "name": "天生剑心",\n  "description": "天生对剑道有超凡的领悟力，修炼剑法速度极快，更容易领悟剑意。"\n}\n\`\`\`\n\n【正确示例2】\n\`\`\`json\n{\n  "name": "灵目慧眼",\n  "description": "能够看穿幻术与阵法，对灵气流动有超乎常人的感知能力。"\n}\n\`\`\`\n\n【正确示例3】\n\`\`\`json\n{\n  "name": "丹道圣体",\n  "description": "天生体质适合炼丹，服用丹药效果加倍，炼丹成功率大幅提升。"\n}\n\`\`\`\n\n【错误示例】以下操作会导致生成失败\n- 错误：缺少 description 字段\n- 错误：描述过于简短（少于20字）\n- 错误：名称过长（超过8字）\n`},5805:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.modal-overlay[data-v-0cb8c11b] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n.modal-dialog[data-v-0cb8c11b] {\n  width: 90%;\n  max-width: 600px;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-surface);\n  border-radius: 12px;\n  padding: 2rem;\n  overflow: hidden;\n}\n.modal-title[data-v-0cb8c11b] {\n  margin-top: 0;\n  color: var(--color-primary);\n  text-align: center;\n  margin-bottom: 1.5rem;\n  flex-shrink: 0;\n}\n.form-fields[data-v-0cb8c11b] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  overflow-y: auto;\n  flex: 1;\n  padding-right: 0.5rem;\n}\n.form-fields[data-v-0cb8c11b]::-webkit-scrollbar {\n  width: 8px;\n}\n.form-fields[data-v-0cb8c11b]::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0.1);\n  border-radius: 4px;\n}\n.form-fields[data-v-0cb8c11b]::-webkit-scrollbar-thumb {\n  background: rgba(var(--color-primary-rgb), 0.3);\n  border-radius: 4px;\n}\n.form-fields[data-v-0cb8c11b]::-webkit-scrollbar-thumb:hover {\n  background: rgba(var(--color-primary-rgb), 0.5);\n}\n.form-group label[data-v-0cb8c11b] {\n  display: block;\n  margin-bottom: 0.5rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.form-group input[data-v-0cb8c11b],\n.form-group textarea[data-v-0cb8c11b],\n.form-group select[data-v-0cb8c11b] {\n  width: 100%;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text);\n  font-size: 1rem;\n  transition: var(--transition-fast);\n}\ninput[type="color"][data-v-0cb8c11b] {\n  padding: 0.25rem;\n  height: 2.5rem;\n}\ninput[type="color"][data-v-0cb8c11b] {\n  padding: 0.25rem;\n  height: 2.5rem;\n}\n.form-group input[data-v-0cb8c11b]:focus,\n.form-group textarea[data-v-0cb8c11b]:focus,\n.form-group select[data-v-0cb8c11b]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 10px rgba(var(--color-primary-rgb), 0.3);\n}\n.error-messages[data-v-0cb8c11b] {\n    color: var(--color-danger);\n    margin-bottom: 1rem;\n    font-size: 0.9rem;\n    flex-shrink: 0;\n}\n.modal-actions[data-v-0cb8c11b] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n  margin-top: 1rem;\n  flex-shrink: 0;\n}\n\n/* Transition styles */\n.modal-fade-enter-active[data-v-0cb8c11b], .modal-fade-leave-active[data-v-0cb8c11b] {\n  transition: opacity 0.3s ease;\n}\n.modal-fade-enter-from[data-v-0cb8c11b], .modal-fade-leave-to[data-v-0cb8c11b] {\n  opacity: 0;\n}\n.modal-fade-enter-active .modal-content[data-v-0cb8c11b],\n.modal-fade-leave-active .modal-content[data-v-0cb8c11b] {\n  transition: transform 0.3s ease;\n}\n.modal-fade-enter-from .modal-content[data-v-0cb8c11b],\n.modal-fade-leave-to .modal-content[data-v-0cb8c11b] {\n  transform: scale(0.9);\n}\n\n/* 动态列表样式 */\n.dynamic-list-container[data-v-0cb8c11b] {\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  padding: 1rem;\n}\n.list-header[data-v-0cb8c11b] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.add-btn[data-v-0cb8c11b] {\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  transition: all 0.2s ease;\n}\n.add-btn[data-v-0cb8c11b]:hover {\n  background: var(--color-primary-dark);\n}\n.list-items[data-v-0cb8c11b] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.list-item[data-v-0cb8c11b] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n}\n.item-inputs[data-v-0cb8c11b] {\n  display: flex;\n  gap: 0.5rem;\n  flex: 1;\n}\n.item-input[data-v-0cb8c11b] {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  background: var(--color-background);\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.item-input[data-v-0cb8c11b]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 5px rgba(var(--color-primary-rgb), 0.3);\n}\n.remove-btn[data-v-0cb8c11b] {\n  background: var(--color-danger);\n  color: white;\n  border: none;\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  cursor: pointer;\n  font-size: 1.2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n}\n.remove-btn[data-v-0cb8c11b]:hover {\n  background: #dc2626;\n  transform: scale(1.1);\n}\n.empty-list[data-v-0cb8c11b] {\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  padding: 2rem;\n}\n@media (max-width: 600px) {\n.modal-dialog[data-v-0cb8c11b] {\n    padding: 1.5rem;\n    width: 95%;\n    max-height: 90vh;\n}\n.item-inputs[data-v-0cb8c11b] {\n    flex-direction: column;\n}\n.modal-actions[data-v-0cb8c11b] {\n    flex-direction: column-reverse;\n    gap: 0.5rem;\n}\n.modal-actions .btn[data-v-0cb8c11b] {\n    width: 100%;\n}\n}\n',""]);const i=l},5828:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.modal-overlay[data-v-de60386a] {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.6);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n  animation: fadeIn-de60386a 0.2s ease-out;\n}\n@keyframes fadeIn-de60386a {\nfrom {\n    opacity: 0;\n}\nto {\n    opacity: 1;\n}\n}\n.modal-content[data-v-de60386a] {\n  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n  border: 1px solid rgba(255, 215, 0, 0.3);\n  border-radius: 12px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  animation: slideUp-de60386a 0.3s ease-out;\n}\n@keyframes slideUp-de60386a {\nfrom {\n    transform: translateY(20px);\n    opacity: 0;\n}\nto {\n    transform: translateY(0);\n    opacity: 1;\n}\n}\n.modal-header[data-v-de60386a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid rgba(255, 215, 0, 0.2);\n}\n.modal-header h3[data-v-de60386a] {\n  margin: 0;\n  font-size: 1.25rem;\n  color: #ffd700;\n  font-weight: 600;\n}\n.close-btn[data-v-de60386a] {\n  background: none;\n  border: none;\n  font-size: 2rem;\n  color: #999;\n  cursor: pointer;\n  line-height: 1;\n  padding: 0;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.close-btn[data-v-de60386a]:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: #fff;\n}\n.modal-body[data-v-de60386a] {\n  padding: 24px;\n}\n.hint[data-v-de60386a] {\n  margin: 0 0 12px 0;\n  color: #ccc;\n  font-size: 0.95rem;\n}\n.prompt-input[data-v-de60386a] {\n  width: 100%;\n  padding: 12px;\n  border: 1px solid rgba(255, 215, 0, 0.3);\n  border-radius: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  color: #fff;\n  font-size: 0.95rem;\n  font-family: inherit;\n  resize: vertical;\n  min-height: 120px;\n  transition: border-color 0.2s, box-shadow 0.2s;\n}\n.prompt-input[data-v-de60386a]:focus {\n  outline: none;\n  border-color: #ffd700;\n  box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);\n}\n.prompt-input[data-v-de60386a]::placeholder {\n  color: #666;\n}\n.modal-footer[data-v-de60386a] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 24px;\n  border-top: 1px solid rgba(255, 215, 0, 0.2);\n}\n.cancel-btn[data-v-de60386a],\n.submit-btn[data-v-de60386a] {\n  padding: 10px 24px;\n  border-radius: 6px;\n  font-size: 0.95rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n}\n.cancel-btn[data-v-de60386a] {\n  background: rgba(255, 255, 255, 0.1);\n  color: #ccc;\n}\n.cancel-btn[data-v-de60386a]:hover {\n  background: rgba(255, 255, 255, 0.15);\n  color: #fff;\n}\n.submit-btn[data-v-de60386a] {\n  background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);\n  color: #1a1a2e;\n  font-weight: 600;\n}\n.submit-btn[data-v-de60386a]:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);\n}\n.submit-btn[data-v-de60386a]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n",""]);const i=l},5885:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.modal-overlay[data-v-2e089ec8] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.75);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 3000;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n  animation: fadeIn-2e089ec8 0.2s ease-out;\n}\n@keyframes fadeIn-2e089ec8 {\nfrom {\n    opacity: 0;\n}\nto {\n    opacity: 1;\n}\n}\n.deep-cultivation-modal[data-v-2e089ec8] {\n  background: var(--color-surface);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 600px;\n  max-height: 90vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n  animation: slideUp-2e089ec8 0.3s cubic-bezier(0.16, 1, 0.3, 1);\n}\n@keyframes slideUp-2e089ec8 {\nfrom {\n    opacity: 0;\n    transform: translateY(30px) scale(0.95);\n}\nto {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n}\n.modal-header[data-v-2e089ec8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 24px;\n  border-bottom: 1px solid var(--color-border);\n  background: linear-gradient(135deg, var(--color-surface-light), rgba(var(--color-primary-rgb), 0.05));\n}\n.modal-header h3[data-v-2e089ec8] {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--color-text);\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n.close-btn[data-v-2e089ec8] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 8px;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.close-btn[data-v-2e089ec8]:hover {\n  background: var(--color-danger);\n  color: white;\n}\n.modal-content[data-v-2e089ec8] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 24px;\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n/* 功法信息区域 */\n.technique-info-section[data-v-2e089ec8] {\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 12px;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.info-header[data-v-2e089ec8] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.technique-icon[data-v-2e089ec8] {\n  font-size: 2.5rem;\n  width: 60px;\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 12px;\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-accent-rgb), 0.1));\n}\n.technique-icon.quality-神[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(220, 38, 38, 0.2), rgba(248, 113, 113, 0.2));\n}\n.technique-icon.quality-仙[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.2));\n}\n.technique-icon.quality-天[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(192, 132, 252, 0.2));\n}\n.technique-icon.quality-地[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(96, 165, 250, 0.2));\n}\n.technique-icon.quality-玄[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));\n}\n.technique-icon.quality-黄[data-v-2e089ec8] { background: linear-gradient(135deg, rgba(250, 204, 21, 0.2), rgba(253, 224, 71, 0.2));\n}\n.technique-details[data-v-2e089ec8] {\n  flex: 1;\n}\n.technique-name[data-v-2e089ec8] {\n  font-size: 1.25rem;\n  font-weight: 700;\n  margin: 0 0 8px 0;\n  color: var(--color-text);\n}\n.technique-name.quality-神[data-v-2e089ec8] { color: #dc2626;\n}\n.technique-name.quality-仙[data-v-2e089ec8] { color: #f59e0b;\n}\n.technique-name.quality-天[data-v-2e089ec8] { color: #a855f7;\n}\n.technique-name.quality-地[data-v-2e089ec8] { color: #3b82f6;\n}\n.technique-name.quality-玄[data-v-2e089ec8] { color: #10b981;\n}\n.technique-name.quality-黄[data-v-2e089ec8] { color: #facc15;\n}\n.technique-quality[data-v-2e089ec8] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n\n/* 进度条 */\n.progress-section[data-v-2e089ec8] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.progress-label[data-v-2e089ec8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.progress-percent[data-v-2e089ec8] {\n  color: var(--color-primary);\n  font-size: 1rem;\n}\n.progress-bar-bg[data-v-2e089ec8] {\n  height: 12px;\n  background: rgba(var(--color-border-rgb), 0.3);\n  border-radius: 999px;\n  overflow: hidden;\n  position: relative;\n}\n.progress-bar-fill[data-v-2e089ec8] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-primary), var(--color-accent));\n  border-radius: 999px;\n  transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n}\n.progress-bar-fill[data-v-2e089ec8]::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n  animation: shine-2e089ec8 2s infinite;\n}\n@keyframes shine-2e089ec8 {\nto {\n    left: 100%;\n}\n}\n\n/* 效果列表 */\n.effects-section[data-v-2e089ec8] {\n  border-top: 1px solid var(--color-border);\n  padding-top: 12px;\n}\n.effects-section h5[data-v-2e089ec8] {\n  margin: 0 0 8px 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.effects-list[data-v-2e089ec8] {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.effects-list li[data-v-2e089ec8] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.effect-icon[data-v-2e089ec8] {\n  font-size: 1rem;\n}\n.attr-bonus[data-v-2e089ec8] {\n  padding: 2px 8px;\n  background: rgba(var(--color-success-rgb), 0.1);\n  color: var(--color-success);\n  border-radius: 4px;\n  font-weight: 500;\n  margin-left: 4px;\n}\n\n/* 修炼天数选择区域 */\n.cultivation-days-section[data-v-2e089ec8] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n.section-label[data-v-2e089ec8] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin: 0;\n}\n.section-hint[data-v-2e089ec8] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  margin: 0;\n  line-height: 1.5;\n}\n.input-group[data-v-2e089ec8] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n.days-input[data-v-2e089ec8] {\n  flex: 1;\n  padding: 12px 16px;\n  font-size: 1.1rem;\n  font-weight: 600;\n  border: 2px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  transition: all 0.2s;\n}\n.days-input[data-v-2e089ec8]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  background: var(--color-surface);\n}\n.input-unit[data-v-2e089ec8] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n}\n\n/* 快捷按钮 */\n.preset-buttons[data-v-2e089ec8] {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 8px;\n}\n.preset-btn[data-v-2e089ec8] {\n  padding: 10px;\n  border: 2px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.preset-btn[data-v-2e089ec8]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-primary);\n}\n.preset-btn.active[data-v-2e089ec8] {\n  background: var(--color-primary);\n  border-color: var(--color-primary);\n  color: white;\n}\n\n/* 提示信息 */\n.cultivation-hints[data-v-2e089ec8] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 16px;\n  background: rgba(var(--color-info-rgb), 0.05);\n  border: 1px solid rgba(var(--color-info-rgb), 0.2);\n  border-radius: 8px;\n}\n.hint-item[data-v-2e089ec8] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n.hint-icon[data-v-2e089ec8] {\n  font-size: 1rem;\n}\n\n/* 底部按钮 */\n.modal-footer[data-v-2e089ec8] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 20px 24px;\n  border-top: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  border-radius: 0 0 16px 16px;\n}\n.btn[data-v-2e089ec8] {\n  padding: 10px 24px;\n  border-radius: 8px;\n  font-weight: 600;\n  font-size: 0.95rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: none;\n}\n.btn-cancel[data-v-2e089ec8] {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  border: 1px solid var(--color-border);\n}\n.btn-cancel[data-v-2e089ec8]:hover {\n  background: var(--color-border);\n}\n.btn-confirm[data-v-2e089ec8] {\n  background: linear-gradient(135deg, var(--color-primary), var(--color-accent));\n  color: white;\n}\n.btn-confirm[data-v-2e089ec8]:hover:not(:disabled) {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n.btn-confirm[data-v-2e089ec8]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.deep-cultivation-modal[data-v-2e089ec8] {\n    max-width: 100%;\n    border-radius: 16px 16px 0 0;\n    max-height: 95vh;\n}\n.modal-header[data-v-2e089ec8] {\n    padding: 20px;\n}\n.modal-content[data-v-2e089ec8] {\n    padding: 20px;\n}\n.preset-buttons[data-v-2e089ec8] {\n    grid-template-columns: repeat(2, 1fr);\n}\n.modal-footer[data-v-2e089ec8] {\n    padding: 16px 20px;\n}\n}\n",""]);const i=l},5890:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.modal-overlay[data-v-0d860b7f] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n  backdrop-filter: blur(8px);\n  animation: fadeIn-0d860b7f 0.2s ease-out;\n}\n.modal-dialog[data-v-0d860b7f] {\n  width: 90%;\n  max-width: 600px;\n  max-height: 80vh;\n  overflow-y: auto;\n  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n  border: 2px solid rgba(139, 92, 246, 0.3);\n  border-radius: 16px;\n  box-shadow: 0 20px 60px rgba(139, 92, 246, 0.2);\n  animation: slideIn-0d860b7f 0.3s ease-out;\n}\n.step-content[data-v-0d860b7f] {\n  padding: 24px;\n}\n.modal-title[data-v-0d860b7f] {\n  margin-top: 0;\n  color: #e2e8f0;\n  text-align: center;\n  margin-bottom: 0.5rem;\n  font-size: 1.2rem;\n  font-weight: 600;\n  background: linear-gradient(135deg, #a855f7, #8b5cf6);\n  background-clip: text;\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n.modal-subtitle[data-v-0d860b7f] {\n  text-align: center;\n  color: #94a3b8;\n  margin-bottom: 1.5rem;\n  font-size: 0.9rem;\n  line-height: 1.4;\n}\n.form-group[data-v-0d860b7f] {\n  margin-bottom: 1rem;\n}\n.code-input[data-v-0d860b7f] {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 2px solid rgba(139, 92, 246, 0.2);\n  border-radius: 8px;\n  color: #e2e8f0;\n  font-size: 1rem;\n  box-sizing: border-box;\n  text-align: center;\n  transition: border-color 0.2s ease;\n}\n.code-input[data-v-0d860b7f]:focus {\n  outline: none;\n  border-color: rgba(139, 92, 246, 0.5);\n  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);\n}\n.code-input[data-v-0d860b7f]::placeholder {\n  color: #64748b;\n}\n.prompt-section[data-v-0d860b7f] {\n  margin-bottom: 24px;\n}\n.prompt-label[data-v-0d860b7f] {\n  display: block;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: #e2e8f0;\n  margin-bottom: 8px;\n}\n.prompt-input[data-v-0d860b7f] {\n  width: 100%;\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 2px solid rgba(139, 92, 246, 0.2);\n  border-radius: 8px;\n  color: #e2e8f0;\n  font-size: 0.9rem;\n  line-height: 1.4;\n  resize: vertical;\n  min-height: 100px;\n  transition: border-color 0.2s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n}\n.prompt-input[data-v-0d860b7f]:focus {\n  outline: none;\n  border-color: rgba(139, 92, 246, 0.5);\n  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);\n}\n.prompt-input[data-v-0d860b7f]::placeholder {\n  color: #64748b;\n}\n.char-count[data-v-0d860b7f] {\n  text-align: right;\n  font-size: 0.7rem;\n  color: #64748b;\n  margin-top: 4px;\n}\n.suggested-prompts[data-v-0d860b7f] {\n  margin-bottom: 24px;\n}\n.suggestions-title[data-v-0d860b7f] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: #cbd5e1;\n  margin-bottom: 12px;\n}\n.suggestions-grid[data-v-0d860b7f] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 8px;\n}\n.suggestion-button[data-v-0d860b7f] {\n  padding: 8px 12px;\n  background: rgba(139, 92, 246, 0.1);\n  border: 1px solid rgba(139, 92, 246, 0.3);\n  border-radius: 6px;\n  color: #cbd5e1;\n  font-size: 0.8rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  line-height: 1.3;\n}\n.suggestion-button[data-v-0d860b7f]:hover {\n  background: rgba(139, 92, 246, 0.2);\n  border-color: rgba(139, 92, 246, 0.5);\n  color: #e2e8f0;\n  transform: translateY(-1px);\n}\n.error-message[data-v-0d860b7f] {\n  color: #ef4444;\n  text-align: center;\n  margin-bottom: 1rem;\n  min-height: 1.2em;\n  font-size: 0.85rem;\n}\n.form-actions[data-v-0d860b7f] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 1.5rem;\n}\n.btn[data-v-0d860b7f] {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 8px;\n  font-size: 0.9rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #8b5cf6, #a855f7);\n  color: white;\n}\n.btn[data-v-0d860b7f]:hover:not(:disabled) {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);\n}\n.btn[data-v-0d860b7f]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n.btn-secondary[data-v-0d860b7f] {\n  background: rgba(100, 116, 139, 0.2);\n  color: #cbd5e1;\n}\n.btn-secondary[data-v-0d860b7f]:hover {\n  background: rgba(100, 116, 139, 0.3);\n  color: #e2e8f0;\n}\n@keyframes fadeIn-0d860b7f {\nfrom { opacity: 0;\n}\nto { opacity: 1;\n}\n}\n@keyframes slideIn-0d860b7f {\nfrom { \n    opacity: 0;\n    transform: translateY(-20px) scale(0.95);\n}\nto { \n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n}\n\n/* 深色主题适配 */\n[data-theme="dark"] .modal-dialog[data-v-0d860b7f] {\n  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);\n  border-color: rgba(139, 92, 246, 0.4);\n}\n[data-theme="dark"] .code-input[data-v-0d860b7f],\n[data-theme="dark"] .prompt-input[data-v-0d860b7f] {\n  background: rgba(0, 0, 0, 0.5);\n  border-color: rgba(139, 92, 246, 0.3);\n}\n[data-theme="dark"] .suggestion-button[data-v-0d860b7f] {\n  background: rgba(139, 92, 246, 0.15);\n  border-color: rgba(139, 92, 246, 0.4);\n}\n@media (max-width: 480px) {\n.modal-dialog[data-v-0d860b7f] {\n    padding: 1.5rem 1rem;\n    width: 95%;\n    max-height: 90vh;\n}\n.modal-title[data-v-0d860b7f] {\n    font-size: 1.1rem;\n}\n.form-actions[data-v-0d860b7f] {\n    flex-direction: column-reverse;\n    gap: 0.5rem;\n}\n.form-actions .btn[data-v-0d860b7f] {\n    width: 100%;\n}\n.suggestions-grid[data-v-0d860b7f] {\n    grid-template-columns: 1fr;\n}\n}\n',""]);const i=l},6164:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.modal-overlay[data-v-2ee8c39d] {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n.modal-content[data-v-2ee8c39d] {\n  background: var(--color-background);\n  border-radius: 12px;\n  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);\n  max-width: 500px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.modal-header[data-v-2ee8c39d] {\n  padding: 1.5rem 1.5rem 1rem 1.5rem;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.modal-header h3[data-v-2ee8c39d] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.close-btn[data-v-2ee8c39d] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 6px;\n  transition: all 0.2s;\n}\n.close-btn[data-v-2ee8c39d]:hover {\n  background: var(--color-hover);\n  color: var(--color-text);\n}\n.modal-body[data-v-2ee8c39d] {\n  padding: 1.5rem;\n  overflow-y: auto;\n  flex: 1;\n}\n.form-group[data-v-2ee8c39d] {\n  margin-bottom: 1rem;\n}\n.form-group label[data-v-2ee8c39d] {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: var(--color-text);\n}\n.form-input[data-v-2ee8c39d] {\n  width: 100%;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text);\n  font-size: 0.875rem;\n  outline: none;\n  transition: border-color 0.2s;\n}\n.form-input[data-v-2ee8c39d]:focus {\n  border-color: var(--color-primary);\n}\n.form-textarea[data-v-2ee8c39d] {\n  width: 100%;\n  min-height: 150px;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text);\n  font-size: 0.875rem;\n  font-family: 'Consolas', 'Monaco', monospace;\n  outline: none;\n  transition: border-color 0.2s;\n  resize: vertical;\n}\n.form-textarea[data-v-2ee8c39d]:focus {\n  border-color: var(--color-primary);\n}\n.form-hint-text[data-v-2ee8c39d] {\n  margin: 0.25rem 0 0 0;\n  font-size: 0.75rem;\n  color: var(--color-info);\n}\n.value-type-selector[data-v-2ee8c39d] {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 0.75rem;\n  flex-wrap: wrap;\n}\n.type-btn[data-v-2ee8c39d] {\n  padding: 0.375rem 0.75rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  font-size: 0.75rem;\n  transition: all 0.2s;\n}\n.type-btn[data-v-2ee8c39d]:hover {\n  background: var(--color-hover);\n  border-color: var(--color-primary);\n  color: var(--color-text);\n}\n.type-btn.active[data-v-2ee8c39d] {\n  background: var(--color-primary);\n  border-color: var(--color-primary);\n  color: white;\n  font-weight: 500;\n}\n.form-textarea.has-error[data-v-2ee8c39d] {\n  border-color: var(--color-danger);\n}\n.error-message[data-v-2ee8c39d] {\n  margin-top: 0.5rem;\n  padding: 0.5rem;\n  background: rgba(239, 68, 68, 0.1);\n  border: 1px solid var(--color-danger);\n  border-radius: 4px;\n  color: var(--color-danger);\n  font-size: 0.75rem;\n}\n.form-hint[data-v-2ee8c39d] {\n  margin-top: 0.5rem;\n}\n.form-hint p[data-v-2ee8c39d] {\n  margin: 0;\n  font-size: 0.75rem;\n  color: var(--color-success);\n}\n.preview-section[data-v-2ee8c39d] {\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid var(--color-border);\n}\n.preview-section label[data-v-2ee8c39d] {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: var(--color-text);\n  font-size: 0.875rem;\n}\n.preview-content[data-v-2ee8c39d] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text);\n  font-size: 0.75rem;\n  font-family: 'Consolas', 'Monaco', monospace;\n  max-height: 150px;\n  overflow: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.modal-footer[data-v-2ee8c39d] {\n  padding: 1rem 1.5rem;\n  border-top: 1px solid var(--color-border);\n  display: flex;\n  gap: 0.75rem;\n  justify-content: flex-end;\n}\n.cancel-btn[data-v-2ee8c39d] {\n  padding: 0.75rem 1.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: transparent;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s;\n}\n.cancel-btn[data-v-2ee8c39d]:hover {\n  background: var(--color-hover);\n  border-color: var(--color-text-secondary);\n  color: var(--color-text);\n}\n.save-btn[data-v-2ee8c39d] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: var(--color-primary);\n  border: none;\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  font-size: 0.875rem;\n  font-weight: 500;\n  transition: all 0.2s;\n}\n.save-btn[data-v-2ee8c39d]:hover:not(:disabled) {\n  background: var(--color-primary-hover);\n  transform: translateY(-1px);\n}\n.save-btn[data-v-2ee8c39d]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n",""]);const i=l},6262:(e,n)=>{n.A=(e,n)=>{const t=e.__vccOpts||e;for(const[e,a]of n)t[e]=a;return t}},6314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",a=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),a&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),a&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,a,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(a)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(l[c]=!0)}for(var s=0;s<e.length;s++){var d=[].concat(e[s]);a&&l[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),n.push(d))}},n}},6478:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.memory-section[data-v-70b78bf0] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.section-header[data-v-70b78bf0] {\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.section-title[data-v-70b78bf0] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.memory-content[data-v-70b78bf0] {\n  flex: 1;\n  overflow: hidden;\n}\n.data-display[data-v-70b78bf0] {\n  height: 100%;\n  overflow: hidden;\n}\n.code-pre[data-v-70b78bf0] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  height: 100%;\n  overflow: auto;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.8rem;\n  line-height: 1.4;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.empty-state[data-v-70b78bf0] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.memory-section[data-v-70b78bf0] {\n    padding: 0.75rem;\n}\n.section-title[data-v-70b78bf0] {\n    font-size: 1rem;\n    text-align: center;\n}\n.code-pre[data-v-70b78bf0] {\n    font-size: 0.75rem;\n    padding: 0.5rem;\n}\n.empty-state[data-v-70b78bf0] {\n    padding: 2rem 0.5rem;\n}\n}\n@media (max-width: 480px) {\n.memory-section[data-v-70b78bf0] {\n    padding: 0.5rem;\n}\n.section-title[data-v-70b78bf0] {\n    font-size: 0.9rem;\n}\n.code-pre[data-v-70b78bf0] {\n    font-size: 0.7rem;\n    padding: 0.4rem;\n}\n}\n",""]);const i=l},6533:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.loading-overlay[data-v-c8648b8a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(5px);\n  -webkit-backdrop-filter: blur(5px);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 10000;\n}\n.loading-content[data-v-c8648b8a] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 20px;\n}\n.spinner[data-v-c8648b8a] {\n  width: 50px;\n  height: 50px;\n  border: 5px solid rgba(var(--color-primary-rgb), 0.3);\n  border-top-color: var(--color-primary);\n  border-radius: 50%;\n  animation: spin-c8648b8a 1.2s linear infinite;\n}\n@keyframes spin-c8648b8a {\nto {\n    transform: rotate(360deg);\n}\n}\n.loading-text[data-v-c8648b8a] {\n  color: var(--color-accent);\n  font-size: 1.2rem;\n  font-weight: 500;\n  text-shadow: 0 0 10px rgba(var(--color-primary-rgb), 0.5);\n}\n.fade-enter-active[data-v-c8648b8a],\n.fade-leave-active[data-v-c8648b8a] {\n  transition: opacity 0.3s ease;\n}\n.fade-enter-from[data-v-c8648b8a],\n.fade-leave-to[data-v-c8648b8a] {\n  opacity: 0;\n}\n",""]);const i=l},6560:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n/* 顶部功能按钮 */\n.top-actions-container[data-v-c7bc47b8] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.1);\n  justify-content: flex-end;\n}\n.top-actions-container .action-item[data-v-c7bc47b8] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  white-space: nowrap;\n}\n.top-actions-container .action-item[data-v-c7bc47b8]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.world-selection-container[data-v-c7bc47b8] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.loading-state[data-v-c7bc47b8], .error-state[data-v-c7bc47b8], .placeholder[data-v-c7bc47b8] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.world-layout[data-v-c7bc47b8] {\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  gap: 2rem;\n  height: 100%;\n  overflow: hidden;\n}\n.left-panel[data-v-c7bc47b8] {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--color-surface);\n}\n.list-container[data-v-c7bc47b8] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.list-item[data-v-c7bc47b8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  margin-bottom: 0.5rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n}\n.item-content[data-v-c7bc47b8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-grow: 1;\n}\n.item-name[data-v-c7bc47b8] {\n  flex-grow: 1;\n}\n\n/* 按钮组容器 */\n.action-buttons[data-v-c7bc47b8] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n  margin-left: 0.5rem;\n}\n.list-item:hover .action-buttons[data-v-c7bc47b8] {\n  opacity: 1;\n}\n\n/* 编辑按钮 */\n.edit-btn[data-v-c7bc47b8] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.edit-btn[data-v-c7bc47b8]:hover {\n  color: var(--color-primary);\n  background-color: rgba(59, 130, 246, 0.1);\n}\n.delete-btn[data-v-c7bc47b8] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.delete-btn[data-v-c7bc47b8]:hover {\n  color: var(--color-danger);\n  background-color: rgba(255, 0, 0, 0.1);\n}\n.list-item[data-v-c7bc47b8]:hover {\n  background: var(--color-surface-light);\n}\n.list-item.selected[data-v-c7bc47b8] {\n  background: rgba(var(--color-primary-rgb), 0.2);\n  color: var(--color-primary);\n  font-weight: 600;\n  border-left: 3px solid var(--color-primary);\n}\n.details-container[data-v-c7bc47b8] {\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1.5rem;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  min-height: 0;\n  background: var(--color-surface);\n}\n.world-details[data-v-c7bc47b8] {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  overflow: hidden;\n}\n.details-header[data-v-c7bc47b8] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n.details-title[data-v-c7bc47b8] {\n  margin: 0;\n}\n.map-settings-btn[data-v-c7bc47b8] {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n}\n.map-settings-btn[data-v-c7bc47b8]:hover {\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.world-details h2[data-v-c7bc47b8] {\n  margin-top: 0;\n  color: var(--color-primary);\n  flex-shrink: 0;\n}\n.world-details .era[data-v-c7bc47b8] {\n  font-style: italic;\n  color: var(--color-accent);\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.description-scroll[data-v-c7bc47b8] {\n  flex: 1;\n  overflow-y: auto;\n  line-height: 1.6;\n  padding-right: 0.5rem;\n  min-height: 0;\n}\n.description-scroll p[data-v-c7bc47b8] {\n  margin: 0;\n  white-space: pre-wrap;\n}\n\n/* 地图生成选项样式 */\n.map-options[data-v-c7bc47b8] {\n  margin-top: 0.8rem;\n  border: 1px dashed var(--color-border);\n  border-radius: 8px;\n  padding: 0.8rem;\n  background: var(--color-surface);\n  /* 当显示设置时，该区域可占满并内部滚动 */\n  flex: 1 1 auto;\n  overflow: auto;\n}\n\n/* 配置警告样式 */\n.config-warning[data-v-c7bc47b8] {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  margin-bottom: 1rem;\n  background: rgba(255, 193, 7, 0.1);\n  border: 1px solid rgba(255, 193, 7, 0.3);\n  border-radius: 6px;\n  color: #856404;\n}\n.warning-icon[data-v-c7bc47b8] {\n  font-size: 1.2rem;\n  flex-shrink: 0;\n  margin-top: 0.1rem;\n}\n.warning-text[data-v-c7bc47b8] {\n  flex: 1;\n}\n.warning-title[data-v-c7bc47b8] {\n  font-weight: 600;\n  font-size: 0.95rem;\n  margin-bottom: 0.25rem;\n  color: #856404;\n}\n.warning-desc[data-v-c7bc47b8] {\n  font-size: 0.85rem;\n  color: #6c5ce7;\n  line-height: 1.4;\n}\n\n/* 风险配置输入框样式 */\n.option-item input.config-risky[data-v-c7bc47b8] {\n  border-color: #ffc107;\n  background-color: rgba(255, 193, 7, 0.05);\n  box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.1);\n}\n.option-item input.config-risky[data-v-c7bc47b8]:focus {\n  border-color: #ff9800;\n  box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);\n}\n\n/* 配置提示文字 */\n.config-hint[data-v-c7bc47b8] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  opacity: 0.8;\n  margin-top: 0.2rem;\n}\n.map-options-header[data-v-c7bc47b8] {\n  font-weight: 700;\n  color: var(--color-primary);\n  margin-bottom: 0.6rem;\n}\n.map-options-grid[data-v-c7bc47b8] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n  gap: 0.8rem;\n}\n.geo-grid[data-v-c7bc47b8] {\n  margin-top: 0.8rem;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n}\n.range-inputs[data-v-c7bc47b8] {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n}\n.range-inputs input[data-v-c7bc47b8] {\n  flex: 1;\n  min-width: 0;\n}\n.range-inputs span[data-v-c7bc47b8] {\n  color: var(--color-text-secondary);\n}\n.option-item[data-v-c7bc47b8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.35rem;\n}\n.option-label[data-v-c7bc47b8] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n}\n.option-item input[data-v-c7bc47b8] {\n  width: 100%;\n  padding: 0.5rem 0.6rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-background);\n  color: var(--color-text);\n}\n.map-options-actions[data-v-c7bc47b8] {\n  display: flex;\n  gap: 0.5rem;\n  margin-top: 0.6rem;\n}\n.opt-btn[data-v-c7bc47b8] {\n  padding: 0.45rem 0.8rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  cursor: pointer;\n}\n.opt-btn[data-v-c7bc47b8]:hover {\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n\n/* Custom Scrollbar */\n.list-container[data-v-c7bc47b8]::-webkit-scrollbar,\n.description-scroll[data-v-c7bc47b8]::-webkit-scrollbar {\n  width: 8px;\n}\n.list-container[data-v-c7bc47b8]::-webkit-scrollbar-track,\n.description-scroll[data-v-c7bc47b8]::-webkit-scrollbar-track {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 4px;\n}\n.list-container[data-v-c7bc47b8]::-webkit-scrollbar-thumb,\n.description-scroll[data-v-c7bc47b8]::-webkit-scrollbar-thumb {\n  background: rgba(var(--color-primary-rgb), 0.3);\n  border-radius: 4px;\n}\n.list-container[data-v-c7bc47b8]::-webkit-scrollbar-thumb:hover,\n.description-scroll[data-v-c7bc47b8]::-webkit-scrollbar-thumb:hover {\n  background: rgba(var(--color-primary-rgb), 0.5);\n}\n\n/* 无世界数据时的显示 */\n.no-worlds-message[data-v-c7bc47b8] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.no-worlds-icon[data-v-c7bc47b8] {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n  opacity: 0.6;\n}\n.no-worlds-text[data-v-c7bc47b8] {\n  font-size: 1rem;\n  margin-bottom: 0.5rem;\n}\n.no-worlds-hint[data-v-c7bc47b8] {\n  font-size: 0.9rem;\n  opacity: 0.7;\n  font-style: italic;\n}\n.single-actions-container[data-v-c7bc47b8] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  gap: 0.5rem;\n  flex-shrink: 0;\n}\n.action-item[data-v-c7bc47b8] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 1rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.action-item[data-v-c7bc47b8]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.action-name[data-v-c7bc47b8] {\n  font-weight: 500;\n  margin-left: 0.25rem;\n}\n.action-icon[data-v-c7bc47b8] {\n  font-size: 1.1em;\n  vertical-align: middle;\n}\n.action-item[data-v-c7bc47b8]:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n/* 响应式适配 */\n@media (max-width: 1024px) {\n.world-layout[data-v-c7bc47b8] {\n    grid-template-columns: 1fr 1.5fr;\n    gap: 1.2rem;\n}\n}\n@media (max-width: 640px) {\n.top-actions-container[data-v-c7bc47b8] {\n    flex-wrap: wrap;\n    justify-content: stretch;\n    gap: 0.5rem;\n}\n.top-actions-container .action-item[data-v-c7bc47b8] {\n    flex: 1 1 45%;\n    text-align: center;\n    min-width: 120px;\n}\n.world-layout[data-v-c7bc47b8] {\n    /* 改为垂直堆叠布局 */\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n    height: 100%;\n    overflow: hidden;\n    padding: 0;\n}\n.left-panel[data-v-c7bc47b8] {\n    order: 1;\n    flex-shrink: 0;\n    max-height: 35vh;\n    overflow: hidden;\n}\n.details-container[data-v-c7bc47b8] {\n    order: 2;\n    flex: 1;\n    min-height: 0;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.list-container[data-v-c7bc47b8] {\n    max-height: calc(35vh - 60px); /* 减去顶部按钮高度 */\n    overflow-y: auto;\n    /* 添加触摸滚动优化 */\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n}\n\n  /* 优化触摸体验 */\n.list-item[data-v-c7bc47b8],\n  .action-item[data-v-c7bc47b8] {\n    -webkit-tap-highlight-color: transparent;\n    touch-action: manipulation;\n}\n.map-options-grid[data-v-c7bc47b8] { grid-template-columns: 1fr;\n}\n\n  /* 细节优化 */\n.list-item[data-v-c7bc47b8] {\n    padding: 0.7rem 0.9rem;\n    font-size: 0.95rem;\n    margin-bottom: 0.4rem;\n}\n.single-actions-container[data-v-c7bc47b8] {\n    padding: 0.5rem;\n    gap: 0.4rem;\n}\n.action-item[data-v-c7bc47b8] {\n    padding: 0.7rem 1rem;\n    font-size: 0.9rem;\n}\n.details-container[data-v-c7bc47b8] {\n    padding: 0.75rem;\n}\n}\n@media (max-width: 480px) {\n.top-actions-container[data-v-c7bc47b8] {\n    flex-direction: column;\n    align-items: stretch;\n    padding: 0.4rem;\n    gap: 0.4rem;\n}\n.top-actions-container .action-item[data-v-c7bc47b8] {\n    flex: 1 1 100%;\n    text-align: center;\n}\n.world-selection-container[data-v-c7bc47b8] {\n    padding: 0.3rem;\n    height: 100%;\n}\n.world-layout[data-v-c7bc47b8] {\n    gap: 0.5rem;\n}\n.left-panel[data-v-c7bc47b8] {\n    max-height: 32vh;\n}\n.list-container[data-v-c7bc47b8] {\n    max-height: calc(32vh - 110px); /* 减去顶部按钮堆叠后的高度 */\n    padding: 0.4rem;\n}\n.list-item[data-v-c7bc47b8] {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.9rem;\n    margin-bottom: 0.3rem;\n    border-radius: 4px;\n}\n.details-container[data-v-c7bc47b8] {\n    padding: 0.75rem;\n    border-radius: 6px;\n}\n.world-details h2[data-v-c7bc47b8] {\n    font-size: 1.2rem;\n    margin-bottom: 0.5rem;\n}\n.world-details .era[data-v-c7bc47b8] {\n    font-size: 0.9rem;\n    margin-bottom: 0.8rem;\n}\n.description-scroll[data-v-c7bc47b8] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    padding-right: 0.3rem;\n}\n.single-actions-container[data-v-c7bc47b8] {\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.4rem;\n}\n.action-item[data-v-c7bc47b8] {\n    padding: 0.6rem;\n    font-size: 0.85rem;\n    border-radius: 4px;\n}\n.placeholder[data-v-c7bc47b8] {\n    font-size: 1rem;\n    padding: 1rem;\n    text-align: center;\n    min-height: 100px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n}\n@media (max-width: 360px) {\n.world-selection-container[data-v-c7bc47b8] {\n    padding: 0.3rem;\n}\n.world-layout[data-v-c7bc47b8] {\n    gap: 0.4rem;\n    padding: 0;\n}\n.left-panel[data-v-c7bc47b8] {\n    max-height: 28vh;\n}\n.list-container[data-v-c7bc47b8] {\n    max-height: 24vh;\n    padding: 0.3rem;\n}\n.list-item[data-v-c7bc47b8] {\n    padding: 0.5rem 0.6rem;\n    font-size: 0.85rem;\n    margin-bottom: 0.2rem;\n}\n.details-container[data-v-c7bc47b8] {\n    padding: 0.8rem;\n    min-height: 120px;\n}\n.world-details h2[data-v-c7bc47b8] {\n    font-size: 1.1rem;\n    margin-bottom: 0.4rem;\n}\n.world-details .era[data-v-c7bc47b8] {\n    font-size: 0.8rem;\n    margin-bottom: 0.6rem;\n}\n.description-scroll[data-v-c7bc47b8] {\n    font-size: 0.85rem;\n    line-height: 1.4;\n}\n.action-item[data-v-c7bc47b8] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.placeholder[data-v-c7bc47b8] {\n    font-size: 0.9rem;\n    padding: 0.8rem;\n}\n}\n",""]);const i=l},6588:(e,n,t)=>{t.d(n,{repairSaveData:()=>o});var a=t(2224);function o(e){if(console.log("[数据修复] 开始修复存档数据"),!e||"object"!=typeof e)return console.error("[数据修复] ❌ 存档数据为空或无效，创建默认存档"),{角色基础信息:{名字:"无名修士",性别:"男",世界:"朝天大陆",天资:"凡人",出生:"散修",灵根:"五行杂灵根",天赋:[],先天六司:{根骨:5,灵性:5,悟性:5,气运:5,魅力:5,心性:5},后天六司:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0}},玩家角色状态:{境界:{名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"},声望:0,位置:{描述:"朝天大陆·无名之地"},气血:{当前:100,上限:100},灵气:{当前:50,上限:50},神识:{当前:30,上限:30},寿命:{当前:18,上限:80},状态效果:[],天道点:0},装备栏:{装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null},三千大道:{大道列表:{}},背包:{灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}},人物关系:{},宗门系统:{availableSects:[],sectRelationships:{},sectHistory:[]},记忆:{短期记忆:[],中期记忆:[],长期记忆:[]},游戏时间:{年:1e3,月:1,日:1,小时:8,分钟:0},修炼功法:null,掌握技能:[]};const n=(0,a.cloneDeep)(e);if(n.角色基础信息&&"object"==typeof n.角色基础信息){if(n.角色基础信息.名字=n.角色基础信息.名字||"无名修士",n.角色基础信息.性别=n.角色基础信息.性别||"男",n.角色基础信息.世界=n.角色基础信息.世界||"朝天大陆",n.角色基础信息.先天六司&&"object"==typeof n.角色基础信息.先天六司){const e=n.角色基础信息.先天六司;e.根骨=d(e.根骨,0,10,5),e.灵性=d(e.灵性,0,10,5),e.悟性=d(e.悟性,0,10,5),e.气运=d(e.气运,0,10,5),e.魅力=d(e.魅力,0,10,5),e.心性=d(e.心性,0,10,5)}else n.角色基础信息.先天六司={根骨:5,灵性:5,悟性:5,气运:5,魅力:5,心性:5};n.角色基础信息.后天六司&&"object"==typeof n.角色基础信息.后天六司||(n.角色基础信息.后天六司={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0})}else console.warn("[数据修复] 角色基础信息缺失，创建默认值"),n.角色基础信息={名字:"无名修士",性别:"男",世界:"朝天大陆",天资:"凡人",出生:"散修",灵根:"五行杂灵根",天赋:[],先天六司:{根骨:5,灵性:5,悟性:5,气运:5,魅力:5,心性:5},后天六司:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0}};if(n.玩家角色状态&&"object"==typeof n.玩家角色状态?(n.玩家角色状态.境界=l(n.玩家角色状态.境界),n.玩家角色状态.气血=i(n.玩家角色状态.气血,100,100),n.玩家角色状态.灵气=i(n.玩家角色状态.灵气,50,50),n.玩家角色状态.神识=i(n.玩家角色状态.神识,30,30),n.玩家角色状态.寿命=i(n.玩家角色状态.寿命,18,80),n.玩家角色状态.位置&&"object"==typeof n.玩家角色状态.位置?n.玩家角色状态.位置.描述||(n.玩家角色状态.位置.描述="朝天大陆·无名之地"):n.玩家角色状态.位置={描述:"朝天大陆·无名之地"},Array.isArray(n.玩家角色状态.状态效果)||(n.玩家角色状态.状态效果=[]),n.玩家角色状态.声望=d(n.玩家角色状态.声望,0,999999,0)):(console.warn("[数据修复] 玩家角色状态缺失，创建默认值"),n.玩家角色状态={境界:{名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"},声望:0,位置:{描述:"朝天大陆·无名之地"},气血:{当前:100,上限:100},灵气:{当前:50,上限:50},神识:{当前:30,上限:30},寿命:{当前:18,上限:80},状态效果:[],天道点:0}),n.装备栏&&"object"==typeof n.装备栏||(n.装备栏={装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null}),n.背包&&"object"==typeof n.背包)if(n.背包.灵石&&"object"==typeof n.背包.灵石?(n.背包.灵石.下品=d(n.背包.灵石.下品,0,999999999,0),n.背包.灵石.中品=d(n.背包.灵石.中品,0,999999999,0),n.背包.灵石.上品=d(n.背包.灵石.上品,0,999999999,0),n.背包.灵石.极品=d(n.背包.灵石.极品,0,999999999,0)):n.背包.灵石={下品:0,中品:0,上品:0,极品:0},n.背包.物品&&"object"==typeof n.背包.物品){const e={};for(const[t,a]of Object.entries(n.背包.物品))a&&"object"==typeof a&&a.名称&&(e[t]=c(a));n.背包.物品=e}else n.背包.物品={};else n.背包={灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}};if(n.人物关系&&"object"==typeof n.人物关系){const e={};for(const[t,a]of Object.entries(n.人物关系))a&&"object"==typeof a&&a.名字&&(e[t]=s(a));n.人物关系=e}else n.人物关系={};if(n.记忆&&"object"==typeof n.记忆?(n.记忆.短期记忆=Array.isArray(n.记忆.短期记忆)?n.记忆.短期记忆:[],n.记忆.中期记忆=Array.isArray(n.记忆.中期记忆)?n.记忆.中期记忆:[],n.记忆.长期记忆=Array.isArray(n.记忆.长期记忆)?n.记忆.长期记忆:[]):n.记忆={短期记忆:[],中期记忆:[],长期记忆:[]},n.游戏时间=(t=n.游戏时间)&&"object"==typeof t?{年:d(t.年,1,999999,1e3),月:d(t.月,1,12,1),日:d(t.日,1,30,1),小时:d(t.小时,0,23,8),分钟:d(t.分钟,0,59,0)}:{年:1e3,月:1,日:1,小时:8,分钟:0},n.三千大道&&"object"==typeof n.三千大道&&n.三千大道.大道列表||(n.三千大道={大道列表:{}}),n.修炼功法&&"object"==typeof n.修炼功法){const e=n.修炼功法;e.名称&&e.物品ID||(console.warn("[数据修复] 修炼功法数据不完整，清空"),n.修炼功法=null)}var t;return Array.isArray(n.掌握技能)||(n.掌握技能=[]),n.宗门系统&&"object"==typeof n.宗门系统||(n.宗门系统={availableSects:[],sectRelationships:{},sectHistory:[]}),console.log("[数据修复] ✅ 存档数据修复完成"),n}function r(e,n){const t=e||"凡人",a=n||"";if("凡人"===t)return"引气入体，感悟天地灵气，踏上修仙第一步";const o={练气:{初期:"凝聚丹田灵气，打通任督二脉，冲击练气中期",中期:"拓宽经脉，提升灵气容量，冲击练气后期",后期:"凝实根基，感悟天地法则，冲击练气圆满",圆满:"灵气贯通周天，凝练灵根本源，准备筑基","":"搬运周天，凝聚灵气，夯实练气根基"},筑基:{初期:"凝聚道台，将灵气压缩凝实，冲击筑基中期",中期:"稳固道基，扩充丹田容量，冲击筑基后期",后期:"感悟天地法则，凝练金丹雏形，冲击筑基圆满",圆满:"道基圆满，破而后立，将灵气凝聚成金丹","":"夯实道基，压缩灵气，提升筑基境界"},金丹:{初期:"凝实金丹，刻画符文，冲击金丹中期",中期:"淬炼金丹，领悟道韵，冲击金丹后期",后期:"金丹大成，蕴养元神，冲击金丹圆满",圆满:"破丹成婴，元神出窍，踏入元婴境界","":"淬炼金丹本源，刻画天地符文，提升金丹品质"},元婴:{初期:"稳固元婴，凝练神魂，冲击元婴中期",中期:"元婴壮大，感悟大道，冲击元婴后期",后期:"元婴大成，凝练元神，冲击元婴圆满",圆满:"元神蜕变，肉身成圣，准备化神","":"壮大元婴，淬炼神魂，提升元婴境界"},化神:{初期:"神魂合一，领悟法则，冲击化神中期",中期:"凝聚神格，参悟天道，冲击化神后期",后期:"神格大成，融合法则，冲击化神圆满",圆满:"炼虚合道，肉身不灭，准备突破炼虚","":"感悟大道法则，凝练神格，提升化神境界"},炼虚:{初期:"炼虚化实，虚空凝形，冲击炼虚中期",中期:"虚实合一，参悟空间法则，冲击炼虚后期",后期:"撕裂虚空，掌控空间，冲击炼虚圆满",圆满:"虚空大成，与天地合一，准备渡劫","":"炼化虚空之力，感悟空间奥义，提升炼虚境界"},合体:{初期:"天人合一，与天地共鸣，冲击合体中期",中期:"领悟天道，掌控天地之力，冲击合体后期",后期:"天地认可，法则加身，冲击合体圆满",圆满:"与道合真，天劫将至，准备渡劫飞升","":"感悟天地大道，与天地共鸣，提升合体境界"},大乘:{初期:"大道圆满，法则入体，冲击大乘中期",中期:"天道认可，参悟仙道，冲击大乘后期",后期:"仙韵初现，准备渡劫，冲击大乘圆满",圆满:"渡九九天劫，飞升仙界，超脱凡尘","":"感悟仙道奥义，凝练仙体，准备飞升"}}[t];return o?o[a]||o[""]||`感悟${t}境界奥义，提升修为境界`:{初期:`凝练${t}初期根基，冲击${t}中期`,中期:`稳固${t}中期修为，冲击${t}后期`,后期:`圆满${t}后期境界，冲击${t}圆满`,圆满:`${t}圆满大成，准备突破下一境界`,"":`感悟${t}境界奥义，提升修为`}[a]||`感悟${t}境界，提升修为`}function l(e){if(!e||"object"!=typeof e)return{名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"};const n=e.名称||"凡人",t=e.阶段||"";return{名称:n,阶段:t,当前进度:d(e.当前进度,0,999999999,0),下一级所需:d(e.下一级所需,1,999999999,100),突破描述:e.突破描述||r(n,t)}}function i(e,n,t){if(!e||"object"!=typeof e)return{当前:n,上限:t};const a=d(e.当前,0,999999999,n),o=d(e.上限,1,999999999,t);return{当前:Math.min(a,o),上限:o}}function c(e){const n={...e};return n.物品ID=n.物品ID||`item_${Date.now()}`,n.名称=n.名称||"未命名物品",n.数量=d(n.数量,1,999999,1),n.品质&&"object"==typeof n.品质?(["凡","黄","玄","地","天","仙","神"].includes(n.品质.quality)||(n.品质.quality="凡"),n.品质.grade=d(n.品质.grade,0,10,1)):n.品质={quality:"凡",grade:1},["装备","功法","其他"].includes(n.类型)||(n.类型="其他"),n}function s(e){const n={...e};return n.名字=n.名字||"无名",n.性别=n.性别||"男",n.年龄=d(n.年龄,1,1e4,20),n.境界=l(n.境界),n.先天六司&&"object"==typeof n.先天六司||(n.先天六司={根骨:5,灵性:5,悟性:5,气运:5,魅力:5,心性:5}),n.当前位置&&"object"==typeof n.当前位置?n.当前位置.描述||(n.当前位置.描述="朝天大陆·无名之地"):n.当前位置={描述:"朝天大陆·无名之地"},n.好感度=d(n.好感度,-100,100,0),Array.isArray(n.记忆)||(n.记忆=[]),n.背包&&"object"==typeof n.背包||(n.背包={灵石:{下品:0,中品:0,上品:0,极品:0},物品:{}}),n}function d(e,n,t,a){if("number"==typeof e&&!isNaN(e))return Math.max(n,Math.min(t,e));if("string"==typeof e){const a=parseFloat(e);if(!isNaN(a))return Math.max(n,Math.min(t,a))}return a}},6597:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.data-type-selector[data-v-b66d579e] {\n  padding: 1rem;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));\n  gap: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.data-type-selector[data-v-b66d579e] {\n    grid-template-columns: 1fr 1fr;\n    gap: 0.5rem;\n    padding: 0.75rem;\n}\n}\n@media (max-width: 480px) {\n.data-type-selector[data-v-b66d579e] {\n    gap: 0.4rem;\n    padding: 0.5rem;\n}\n}\n.type-btn[data-v-b66d579e] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n  position: relative;\n  overflow: visible;\n  width: 100%;\n  justify-content: flex-start;\n  color: var(--color-text);\n  background: var(--color-background);\n}\n.type-btn[data-v-b66d579e]:hover {\n  border-color: var(--color-primary);\n  background: var(--color-primary-light);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.15);\n}\n.type-btn.active[data-v-b66d579e] {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.type-btn.active[data-v-b66d579e]:hover,\n.type-btn.active[data-v-b66d579e]:focus,\n.type-btn.active[data-v-b66d579e]:focus-visible {\n  background: var(--color-primary-hover);\n  color: white;\n  border-color: var(--color-primary-hover);\n  transform: translateY(-1px);\n  box-shadow: 0 6px 16px rgba(var(--color-primary-rgb), 0.25);\n}\n.type-btn svg[data-v-b66d579e] {\n  color: inherit;\n}\n.type-btn[data-v-b66d579e]:focus {\n  outline: none;\n}\n.type-btn[data-v-b66d579e]:focus-visible {\n  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.25);\n  border-color: var(--color-primary);\n}\n.type-btn[data-v-b66d579e]:active {\n  transform: translateY(0);\n  box-shadow: none;\n}\n.count-badge[data-v-b66d579e] {\n  position: absolute;\n  top: -0.5rem;\n  right: -0.5rem;\n  background: var(--color-accent);\n  color: white;\n  font-size: 0.75rem;\n  padding: 0.125rem 0.375rem;\n  border-radius: 10px;\n  min-width: 1.25rem;\n  text-align: center;\n  z-index: 2;\n}\n\n/* 手机端按钮适配 */\n@media (max-width: 640px) {\n.type-btn[data-v-b66d579e] {\n    padding: 0.4rem 0.6rem;\n    font-size: 0.8rem;\n    gap: 0.3rem;\n}\n.count-badge[data-v-b66d579e] {\n    font-size: 0.7rem;\n    padding: 0.1rem 0.3rem;\n    min-width: 1rem;\n}\n}\n@media (max-width: 480px) {\n.type-btn[data-v-b66d579e] {\n    padding: 0.35rem 0.5rem;\n    font-size: 0.75rem;\n    gap: 0.25rem;\n}\n.count-badge[data-v-b66d579e] {\n    font-size: 0.65rem;\n    padding: 0.08rem 0.25rem;\n    min-width: 0.9rem;\n}\n}\n",""]);const i=l},6627:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'/* Theme overrides to improve light/dark readability (focused on dashboard sidebar) */\n\n/* Scrollbars follow theme */\n.right-sidebar .sidebar-content {\n  scrollbar-color: var(--scrollbar-thumb-color) transparent;\n}\n.right-sidebar .sidebar-content::-webkit-scrollbar-thumb {\n  background: var(--scrollbar-thumb-color);\n}\n\n/* Containers use themed surfaces/borders */\n.right-sidebar .ai-chat-section,\n.right-sidebar .info-section,\n.right-sidebar .cultivation-section,\n.right-sidebar .vitals-section,\n.right-sidebar .attributes-section,\n.right-sidebar .location-section,\n.right-sidebar .wealth-section,\n.right-sidebar .collapsible-section {\n  background: var(--color-surface) !important;\n  border: 1px solid var(--color-border) !important;\n}\n\n/* Subtle hover */\n.right-sidebar .section-header:hover {\n  background: var(--color-surface-light) !important;\n}\n\n/* Text colors */\n.right-sidebar .sidebar-title,\n.right-sidebar .detail-value,\n.right-sidebar .vital-text,\n.right-sidebar .effect-name,\n.right-sidebar .realm-name {\n  color: var(--color-text) !important;\n}\n.right-sidebar .detail-label,\n.right-sidebar .state-label,\n.right-sidebar .state-text,\n.right-sidebar .progress-text,\n.right-sidebar .effect-time,\n.right-sidebar .empty-text,\n.right-sidebar .no-char-text,\n.right-sidebar .realm-level,\n.right-sidebar .vital-name {\n  color: var(--color-text-secondary) !important;\n}\n.right-sidebar .section-title { color: var(--color-text) !important; }\n.right-sidebar .section-icon { color: var(--color-primary) !important; }\n\n/* Collapsible toggle icon */\n.right-sidebar .collapse-toggle { color: var(--color-text-secondary) !important; }\n.right-sidebar .collapse-toggle:hover {\n  color: var(--color-text) !important;\n  background: var(--color-surface-light) !important;\n}\n\n/* Vital item cards */\n.right-sidebar .vital-item {\n  background: var(--color-surface) !important;\n  border: 1px solid var(--color-border) !important;\n}\n.right-sidebar .vital-item:hover {\n  background: var(--color-surface-light) !important;\n  border-color: var(--color-border) !important;\n}\n\n/* Progress bars */\n.right-sidebar .progress-bar { background: var(--color-surface-light) !important; }\n.right-sidebar .progress-fill.health { background: var(--vital-health) !important; }\n.right-sidebar .progress-fill.mana { background: var(--vital-lingqi) !important; }\n.right-sidebar .progress-fill.spirit { background: var(--vital-spirit) !important; }\n.right-sidebar .progress-fill.lifespan { background: var(--vital-lifespan) !important; }\n.right-sidebar .progress-fill.cultivation { background: var(--color-accent) !important; }\n\n/* Status effect cards: neutral base, colored left bar */\n.right-sidebar .status-effect-card {\n  background: var(--color-surface) !important;\n  border: 1px solid var(--color-border) !important;\n}\n.right-sidebar .status-effect-card::before { background: var(--color-border) !important; }\n.right-sidebar .status-effect-card.buff::before { background: linear-gradient(to bottom, var(--color-success), var(--color-success)) !important; }\n.right-sidebar .status-effect-card.debuff::before { background: linear-gradient(to bottom, var(--color-error), var(--color-error)) !important; }\n\n/* Talent card simplified */\n.right-sidebar .talent-card {\n  background: var(--color-surface) !important;\n  border: 1px solid var(--color-accent) !important;\n  border-left: 4px solid var(--color-accent) !important;\n}\n.right-sidebar .talent-name { color: var(--color-accent) !important; }\n.right-sidebar .talent-level {\n  color: var(--color-warning) !important;\n  background: var(--color-surface-light) !important;\n  border: 1px solid var(--color-warning) !important;\n}\n\n/* Icons by type */\n.right-sidebar .vital-icon.blood { color: var(--vital-health) !important; }\n.right-sidebar .vital-icon.mana { color: var(--vital-lingqi) !important; }\n.right-sidebar .vital-icon.spirit { color: var(--vital-spirit) !important; }\n.right-sidebar .vital-icon.lifespan { color: var(--vital-lifespan) !important; }\n\n/* Character summary sections keep a subtle primary/accents using existing rgb if available */\n.right-sidebar .character-info-section {\n  background: rgba(var(--color-primary-rgb), 0.06) !important;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.15) !important;\n}\n.right-sidebar .character-state-section {\n  background: var(--color-surface) !important;\n  border: 1px solid var(--color-border) !important;\n}\n\n/* Inventory item count badge: keep readable in both themes */\n.item-quantity-display { color: #f7f7f5 !important; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }\n\n/* ===== 修复右侧面板颜色淡化问题 ===== */\n\n/* 移除可能导致白色遮罩的效果 */\n.right-sidebar,\n.right-panel-area {\n  filter: none !important;\n  backdrop-filter: none !important;\n  -webkit-backdrop-filter: none !important;\n  mix-blend-mode: normal !important;\n  opacity: 1 !important;\n}\n\n/* 确保右侧面板的背景完全不透明 */\n.right-sidebar {\n  background: var(--color-surface) !important;\n}\n\n/* 移除任何可能的伪元素遮罩 */\n.right-sidebar::before,\n.right-sidebar::after,\n.right-panel-area::before,\n.right-panel-area::after {\n  display: none !important;\n}\n\n/* ===== 按钮文字溢出和居中修复 ===== */\n\n/* 通用按钮最小宽度和居中样式 */\nbutton {\n  min-width: fit-content;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* RetryConfirmDialog 按钮修复 */\n.retry-dialog .btn-primary,\n.retry-dialog .btn-secondary {\n  min-width: 100px !important; /* 确保最小宽度 */\n  padding: 12px 24px !important; /* 增加左右内边距防止文字溢出 */\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* DataClearButtons 按钮修复 */\n.clear-button {\n  min-width: 120px !important; /* 防止"清除自定义数据"等长文字溢出 */\n  padding: 0.4rem 1rem !important; /* 增加左右内边距 */\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex !important;\n  align-items: center;\n  justify-content: center;\n  gap: 0.25rem;\n}\n\n.clear-button .clear-text {\n  flex: 1;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* SavePanel 操作按钮修复 */\n.operation-btn {\n  min-width: 140px !important; /* 为"导出存档"、"导入存档"等按钮设置最小宽度 */\n  padding: 1rem 1.2rem !important;\n  text-align: center;\n}\n\n.operation-btn .btn-content {\n  width: 100%;\n  text-align: center;\n}\n\n.operation-btn .btn-title {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* MainGamePanel 中的快捷操作按钮修复 */\n.quick-action-btn {\n  min-width: 80px !important; /* 确保按钮最小宽度 */\n  min-height: 70px;\n  padding: 12px 10px !important; /* 增加左右内边距 */\n  text-align: center;\n  display: flex !important;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n}\n\n.quick-action-btn .action-text {\n  width: 100%;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 0.8rem;\n  line-height: 1.2;\n}\n\n/* 配置弹窗按钮修复 */\n.cancel-btn,\n.confirm-btn {\n  min-width: 80px !important; /* 确保"取消"、"确认"按钮最小宽度 */\n  padding: 8px 24px !important; /* 增加左右内边距 */\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* LocalPromptModal 按钮修复 */\n.cancel-button {\n  min-width: 80px !important;\n  padding: 8px 24px !important;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 通用按钮文字居中修复 */\n.btn-text,\n.action-text,\n.btn-title {\n  text-align: center !important;\n  width: 100%;\n  display: block;\n}\n\n/* 修复LeftSidebar中的按钮 */\n.left-sidebar .nav-btn {\n  min-width: 100%;\n  text-align: left; /* LeftSidebar按钮应该左对齐 */\n}\n\n.left-sidebar .nav-btn .btn-text,\n.left-sidebar .nav-btn .btn-desc {\n  text-align: left;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* TopBar中的全屏按钮 */\n.fullscreen-btn {\n  min-width: 32px !important;\n  min-height: 32px !important;\n  display: flex !important;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 发送按钮修复 */\n.send-button {\n  min-width: 60px !important;\n  padding: 12px 24px !important;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex !important;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 行动选择器按钮修复 */\n.action-selector-btn {\n  min-width: 44px !important;\n  min-height: 44px !important;\n  display: flex !important;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 响应式调整 */\n@media (max-width: 640px) {\n  .clear-button {\n    min-width: 100px !important;\n    padding: 0.3rem 0.8rem !important;\n  }\n  \n  .operation-btn {\n    min-width: 120px !important;\n    padding: 0.8rem 1rem !important;\n  }\n  \n  .quick-action-btn {\n    min-width: 70px !important;\n    min-height: 60px;\n    padding: 8px 6px !important;\n  }\n  \n  .cancel-btn,\n  .confirm-btn {\n    min-width: 70px !important;\n    padding: 6px 18px !important;\n  }\n  \n  .send-button {\n    min-width: 50px !important;\n    padding: 10px 20px !important;\n  }\n}\n\n@media (max-width: 480px) {\n  .clear-button {\n    min-width: 90px !important;\n    padding: 0.25rem 0.6rem !important;\n  }\n  \n  .operation-btn {\n    min-width: 100px !important;\n    padding: 0.6rem 0.8rem !important;\n  }\n  \n  .quick-action-btn {\n    min-width: 60px !important;\n    min-height: 50px;\n    padding: 6px 4px !important;\n  }\n  \n  .cancel-btn,\n  .confirm-btn {\n    min-width: 60px !important;\n    padding: 6px 15px !important;\n  }\n  \n  .send-button {\n    min-width: 45px !important;\n    padding: 8px 16px !important;\n  }\n}\n',""]);const i=l},6728:(e,n,t)=>{function a(e,n){const t={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0};return Object.values(e).forEach(e=>{if(e&&n.物品&&n.物品[e]){const a=n.物品[e];"装备增幅"in a&&a.装备增幅?.后天六司&&Object.entries(a.装备增幅.后天六司).forEach(([e,n])=>{e in t&&"number"==typeof n&&(t[e]+=n)})}}),t}function o(e,n){const t=n.装备栏&&n.背包?a(n.装备栏,n.背包):{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0},o=function(e){const n={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0};if(!e.背包?.物品)return n;const t=Object.values(e.背包.物品).find(e=>"功法"===e?.类型&&!0===e?.已装备);if(t&&"功法"===t.类型&&t.功法效果?.属性加成){const e=t.功法效果.属性加成;for(const t in e)t in n&&(n[t]+=e[t]||0)}return n}(n),r={根骨:t.根骨+0+o.根骨,灵性:t.灵性+0+o.灵性,悟性:t.悟性+0+o.悟性,气运:t.气运+0+o.气运,魅力:t.魅力+0+o.魅力,心性:t.心性+0+o.心性};return{先天六司:e,后天六司:r,最终六司:{根骨:e.根骨+r.根骨,灵性:e.灵性+r.灵性,悟性:e.悟性+r.悟性,气运:e.气运+r.气运,魅力:e.魅力+r.魅力,心性:e.心性+r.心性}}}t.d(n,{MH:()=>o,calculateEquipmentBonuses:()=>a})},6782:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.right-sidebar[data-v-b79cffd4] {\n  width: 100%;\n  height: 100%;\n  padding: 16px;\n  box-sizing: border-box;\n  font-family: var(--font-family-sans-serif);\n  display: flex;\n  flex-direction: column;\n  background: var(--color-surface);\n}\n.sidebar-header[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 12px 0;\n  border-bottom: 1px solid var(--color-border);\n  background: transparent;\n}\n.sidebar-title[data-v-b79cffd4] {\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  text-align: center;\n}\n.title-icon[data-v-b79cffd4] {\n  color: var(--color-primary);\n  flex-shrink: 0;\n}\n.title-badge[data-v-b79cffd4] {\n  display: inline-block;\n  padding: 2px 8px;\n  border-radius: 9999px;\n  background: var(--color-primary);\n  color: #fff;\n  font-weight: 600;\n  font-size: 12px;\n  letter-spacing: 0.2px;\n}\n\n/* 移除深色主题硬编码，使用CSS变量自动适配 */\n.sidebar-content[data-v-b79cffd4] {\n  flex: 1;\n  overflow-y: auto;\n  scrollbar-width: thin;\n  scrollbar-color: rgba(0, 0, 0, 0.2) transparent;\n}\n.sidebar-content[data-v-b79cffd4]::-webkit-scrollbar {\n  width: 4px;\n}\n.sidebar-content[data-v-b79cffd4]::-webkit-scrollbar-track {\n  background: transparent;\n}\n.sidebar-content[data-v-b79cffd4]::-webkit-scrollbar-thumb {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 2px;\n}\n[data-theme=\"dark\"] .sidebar-content[data-v-b79cffd4]::-webkit-scrollbar-thumb {\n  background: var(--scrollbar-thumb-color);\n}\n\n/* 角色基本信息样式 */\n.character-info-section[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n.character-basic[data-v-b79cffd4] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 8px;\n}\n.character-basic .detail-item[data-v-b79cffd4] {\n  background: var(--color-surface-hover);\n  border-radius: 6px;\n  padding: 8px;\n  font-size: 0.75rem;\n}\n.character-basic .detail-label[data-v-b79cffd4] {\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.character-basic .detail-value[data-v-b79cffd4] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n\n/* 角色状态区域样式 */\n.character-state-section[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n.character-states[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.state-item[data-v-b79cffd4] {\n  background: var(--color-surface-hover);\n  border-radius: 6px;\n  padding: 8px;\n}\n.state-label[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  margin-bottom: 4px;\n  display: block;\n}\n.state-content[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.state-text[data-v-b79cffd4] {\n  font-size: 0.7rem;\n  color: var(--color-text-muted);\n  text-align: center;\n}\n.progress-fill.cultivation[data-v-b79cffd4] {\n  background: linear-gradient(90deg, #8b5cf6, #a78bfa);\n}\n\n/* 收缩区域通用样式 */\n.collapsible-section[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 0;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n.section-header[data-v-b79cffd4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: background 0.2s ease;\n  border-radius: 8px 8px 0 0;\n}\n.section-header[data-v-b79cffd4]:hover {\n  background: var(--color-surface-hover);\n}\n.collapse-toggle[data-v-b79cffd4] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.collapse-toggle[data-v-b79cffd4]:hover {\n  color: var(--color-text);\n  background: var(--color-surface-hover);\n}\n.collapse-toggle svg[data-v-b79cffd4] {\n  transform: rotate(0deg);\n  transition: transform 0.2s ease;\n}\n.collapse-toggle.collapsed svg[data-v-b79cffd4] {\n  transform: rotate(-90deg);\n}\n.status-details[data-v-b79cffd4] {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 8px;\n  margin-top: 8px;\n}\n.current-status[data-v-b79cffd4] {\n  margin-top: 8px;\n  padding-top: 8px;\n  border-top: 1px solid var(--color-border);\n}\n.current-status .status-details[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  margin-top: 0;\n}\n.detail-item[data-v-b79cffd4] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 6px;\n  padding: 6px 8px;\n  background: var(--color-surface-hover);\n  border-radius: 4px;\n  font-size: 0.75rem;\n}\n.detail-label[data-v-b79cffd4] {\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.detail-value[data-v-b79cffd4] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n\n/* 六维灵根区域样式 */\n.attributes-section[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n.attributes-grid[data-v-b79cffd4] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n  margin-bottom: 12px;\n}\n.attribute-item[data-v-b79cffd4] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  transition: all 0.2s ease;\n}\n.attribute-item[data-v-b79cffd4]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n}\n.attr-info[data-v-b79cffd4] {\n  flex: 1;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.attr-name[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.attr-value[data-v-b79cffd4] {\n  font-size: 0.85rem;\n  color: var(--color-text);\n  font-weight: 700;\n}\n.attr-quality[data-v-b79cffd4] {\n  font-size: 0.65rem;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-weight: 600;\n  border: 1px solid;\n}\n\n/* 属性品质颜色 */\n.quality-purple .attr-quality[data-v-b79cffd4] {\n  background: #8b5cf6;\n  color: white;\n  border-color: #8b5cf6;\n}\n.quality-orange .attr-quality[data-v-b79cffd4] {\n  background: #f59e0b;\n  color: white;\n  border-color: #f59e0b;\n}\n.quality-blue .attr-quality[data-v-b79cffd4] {\n  background: #3b82f6;\n  color: white;\n  border-color: #3b82f6;\n}\n.quality-green .attr-quality[data-v-b79cffd4] {\n  background: #10b981;\n  color: white;\n  border-color: #10b981;\n}\n.quality-gray .attr-quality[data-v-b79cffd4] {\n  background: #6b7280;\n  color: white;\n  border-color: #6b7280;\n}\n\n/* 灵根和声望信息 */\n.spiritual-info[data-v-b79cffd4] {\n  border-top: 1px solid var(--color-border);\n  padding-top: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.info-row[data-v-b79cffd4] {\n  display: flex;\n}\n.info-item[data-v-b79cffd4] {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 6px 8px;\n  background: var(--color-surface);\n  border-radius: 4px;\n  font-size: 0.75rem;\n}\n.info-label[data-v-b79cffd4] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.info-icon[data-v-b79cffd4] {\n  flex-shrink: 0;\n}\n.info-icon.spiritual[data-v-b79cffd4] {\n  color: var(--color-accent);\n}\n.info-icon.reputation[data-v-b79cffd4] {\n  color: var(--color-warning);\n}\n.info-value[data-v-b79cffd4] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n\n/* 图标颜色 */\n.section-icon.attributes[data-v-b79cffd4] {\n  color: var(--color-accent);\n}\n\n/* 通用区块样式 */\n.ai-chat-section[data-v-b79cffd4],\n.info-section[data-v-b79cffd4],\n.cultivation-section[data-v-b79cffd4],\n.vitals-section[data-v-b79cffd4],\n.attributes-section[data-v-b79cffd4],\n.location-section[data-v-b79cffd4],\n.wealth-section[data-v-b79cffd4] {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n}\n\n/* 天赋神通特定样式 */\n.talents-list[data-v-b79cffd4] {\n  padding: 0 16px 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n/* 空状态样式 */\n.empty-talents[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem 1rem;\n  text-align: center;\n  gap: 0.5rem;\n}\n.empty-icon[data-v-b79cffd4] {\n  font-size: 2rem;\n  margin-bottom: 0.5rem;\n  opacity: 0.7;\n}\n.empty-text[data-v-b79cffd4] {\n  color: var(--color-text-secondary);\n  font-size: 0.95rem;\n  font-weight: 500;\n  margin-bottom: 0.25rem;\n}\n.empty-hint[data-v-b79cffd4] {\n  color: var(--color-text-muted);\n  font-size: 0.8rem;\n  line-height: 1.4;\n  max-width: 200px;\n}\n\n/* 状态效果特定样式 */\n.status-effects[data-v-b79cffd4] {\n  padding: 0 16px 16px;\n}\n.empty-status[data-v-b79cffd4] {\n  padding: 20px;\n  text-align: center;\n}\n.empty-text[data-v-b79cffd4] {\n  font-size: 0.8rem;\n  color: var(--color-text-muted);\n  font-style: italic;\n}\n\n/* 新的标签式状态效果样式 - 紧凑且美观 */\n.status-tags-container[data-v-b79cffd4] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  padding: 12px;\n}\n.status-tag[data-v-b79cffd4] {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 10px;\n  border-radius: 20px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: 1px solid;\n  backdrop-filter: blur(4px);\n  white-space: nowrap;\n  max-width: 100%;\n  overflow: hidden;\n}\n.status-tag.buff[data-v-b79cffd4] {\n  background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.2), rgba(var(--color-success-rgb), 0.1));\n  border-color: rgba(var(--color-success-rgb), 0.4);\n  color: var(--color-success);\n}\n.status-tag.debuff[data-v-b79cffd4] {\n  background: linear-gradient(135deg, rgba(var(--color-error-rgb), 0.2), rgba(var(--color-error-rgb), 0.1));\n  border-color: rgba(var(--color-error-rgb), 0.4);\n  color: var(--color-danger);\n}\n.status-tag[data-v-b79cffd4]:hover {\n  transform: translateY(-1px) scale(1.05);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n}\n.status-tag.buff[data-v-b79cffd4]:hover {\n  background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.3), rgba(var(--color-success-rgb), 0.15));\n  border-color: rgba(var(--color-success-rgb), 0.6);\n  box-shadow: 0 4px 12px rgba(var(--color-success-rgb), 0.3);\n}\n.status-tag.debuff[data-v-b79cffd4]:hover {\n  background: linear-gradient(135deg, rgba(var(--color-error-rgb), 0.3), rgba(var(--color-error-rgb), 0.15));\n  border-color: rgba(var(--color-error-rgb), 0.6);\n  box-shadow: 0 4px 12px rgba(var(--color-error-rgb), 0.3);\n}\n.tag-icon[data-v-b79cffd4] {\n  font-size: 0.8rem;\n  flex-shrink: 0;\n}\n.tag-name[data-v-b79cffd4] {\n  font-weight: 600;\n  flex-shrink: 0;\n}\n.tag-intensity[data-v-b79cffd4] {\n  font-size: 0.65rem;\n  background: rgba(var(--color-warning-rgb), 0.8);\n  color: var(--color-text);\n  padding: 1px 4px;\n  border-radius: 8px;\n  font-weight: 600;\n  flex-shrink: 0;\n}\n.tag-time[data-v-b79cffd4] {\n  font-size: 0.65rem;\n  opacity: 0.8;\n  font-weight: 400;\n  flex-shrink: 0;\n}\n/* 标题样式 - 图标和文字在一行 */\n.section-title[data-v-b79cffd4] {\n  margin: 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n  padding-bottom: 6px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.section-title span[data-v-b79cffd4] {\n  flex: 1;\n}\n.section-icon[data-v-b79cffd4] {\n  color: var(--color-primary);\n  opacity: 0.8;\n  flex-shrink: 0;\n}\n.section-icon.gold[data-v-b79cffd4] {\n  color: var(--color-warning);\n}\n.vital-icon[data-v-b79cffd4] {\n  flex-shrink: 0;\n}\n.vital-icon.blood[data-v-b79cffd4] { color: var(--vital-health);\n}\n.vital-icon.mana[data-v-b79cffd4] { color: var(--vital-lingqi);\n}\n.vital-icon.spirit[data-v-b79cffd4] { color: var(--vital-spirit);\n}\n.vital-icon.lifespan[data-v-b79cffd4] { color: var(--vital-lifespan);\n}\n.vital-icon.reputation[data-v-b79cffd4] { color: var(--color-warning);\n}\n\n/* 声望显示样式 */\n.reputation-display[data-v-b79cffd4] {\n  margin-top: 8px;\n  border-top: 1px solid var(--color-border);\n  padding-top: 8px;\n}\n.reputation-item[data-v-b79cffd4] {\n  background: var(--color-surface);\n  border-radius: 6px;\n  padding: 8px;\n  border: 1px solid var(--color-border);\n  transition: all 0.2s ease;\n}\n.reputation-item[data-v-b79cffd4]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n}\n.reputation-info[data-v-b79cffd4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.reputation-label[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n.reputation-value[data-v-b79cffd4] {\n  font-size: 0.8rem;\n  color: var(--color-warning);\n  font-weight: 600;\n  padding: 2px 6px;\n  background: rgba(var(--color-warning-rgb), 0.1);\n  border: 1px solid rgba(var(--color-warning-rgb), 0.3);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n.reputation-number[data-v-b79cffd4] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  opacity: 0.8;\n}\n\n/* 点击提示样式 */\n.clickable[data-v-b79cffd4] {\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.clickable[data-v-b79cffd4]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\n  border-color: rgba(var(--color-accent-rgb), 0.5);\n}\n\n/* 天赋卡片样式 - 增强美观性 */\n.talent-card[data-v-b79cffd4] {\n  background: linear-gradient(135deg, rgba(var(--color-accent-rgb), 0.15), rgba(var(--color-accent-rgb), 0.1));\n  border: 1px solid rgba(var(--color-accent-rgb), 0.3);\n  border-left: 4px solid var(--color-accent);\n  border-radius: 12px;\n  padding: 16px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  backdrop-filter: blur(8px);\n  position: relative;\n  overflow: hidden;\n}\n.talent-card[data-v-b79cffd4]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: linear-gradient(135deg,\n    rgba(var(--color-accent-rgb), 0.1) 0%,\n    rgba(var(--color-accent-rgb), 0.05) 50%,\n    rgba(var(--color-accent-rgb), 0.1) 100%);\n  opacity: 0;\n  transition: opacity 0.3s ease;\n  pointer-events: none;\n}\n.talent-card[data-v-b79cffd4]:hover::before {\n  opacity: 1;\n}\n.talent-card[data-v-b79cffd4]:hover {\n  background: linear-gradient(135deg, rgba(var(--color-accent-rgb), 0.2), rgba(var(--color-accent-rgb), 0.15));\n  border-color: rgba(var(--color-accent-rgb), 0.5);\n  transform: translateX(6px) translateY(-2px);\n  box-shadow: 0 8px 32px rgba(var(--color-accent-rgb), 0.25), 0 0 0 1px rgba(var(--color-accent-rgb), 0.2);\n}\n.talent-header[data-v-b79cffd4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: relative;\n  z-index: 1;\n}\n.talent-name[data-v-b79cffd4] {\n  font-size: 0.9rem;\n  font-weight: 700;\n  color: var(--color-accent);\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n}\n.talent-level[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-warning);\n  font-weight: 600;\n  background: linear-gradient(135deg, rgba(var(--color-warning-rgb), 0.2), rgba(var(--color-warning-rgb), 0.1));\n  padding: 4px 10px;\n  border-radius: 12px;\n  border: 1px solid rgba(var(--color-warning-rgb), 0.3);\n  backdrop-filter: blur(4px);\n}\n.talent-progress[data-v-b79cffd4] {\n  margin-top: 10px;\n  position: relative;\n  z-index: 1;\n}\n.progress-fill.talent[data-v-b79cffd4] {\n  background: linear-gradient(90deg, var(--color-accent), var(--color-accent-hover), rgba(var(--color-accent-rgb), 0.9));\n  box-shadow: 0 2px 8px rgba(var(--color-accent-rgb), 0.3);\n}\n\n/* 生命体征样式 */\n.vitals-list[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n.vital-item[data-v-b79cffd4] {\n  background: var(--color-surface);\n  border-radius: 8px;\n  padding: 12px;\n  border: 1px solid var(--color-border);\n  transition: all 0.2s ease;\n}\n.vital-item[data-v-b79cffd4]:hover {\n  background: var(--color-surface-hover);\n  border-color: var(--color-border-hover);\n}\n.vital-info[data-v-b79cffd4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.vital-name[data-v-b79cffd4] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n.vital-text[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.progress-bar[data-v-b79cffd4] {\n  height: 6px;\n  background: var(--color-surface-light);\n  border-radius: 3px;\n  overflow: hidden;\n  position: relative;\n}\n.progress-fill[data-v-b79cffd4] {\n  height: 100%;\n  border-radius: 3px;\n  transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.progress-fill.health[data-v-b79cffd4] { background: var(--vital-health);\n}\n.progress-fill.mana[data-v-b79cffd4] { background: var(--vital-lingqi);\n}\n.progress-fill.spirit[data-v-b79cffd4] { background: var(--vital-spirit);\n}\n/* 寿元进度条统一紫色 */\n.progress-fill.lifespan[data-v-b79cffd4] { background: var(--vital-lifespan);\n}\n\n/* 修为状态样式 */\n.realm-display[data-v-b79cffd4] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 10px;\n  margin-bottom: 10px;\n}\n.realm-info[data-v-b79cffd4] {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 8px;\n  flex-direction: column;\n  gap: 4px;\n}\n.realm-name[data-v-b79cffd4] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-accent);\n}\n.realm-breakthrough[data-v-b79cffd4] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  line-height: 1.4;\n  opacity: 0.8;\n}\n.realm-level[data-v-b79cffd4] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n\n/* 凡人境界特殊样式 */\n.realm-mortal[data-v-b79cffd4] {\n  padding: 8px;\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-radius: 4px;\n  text-align: center;\n  border: 1px dashed rgba(var(--color-primary-rgb), 0.3);\n}\n.mortal-text[data-v-b79cffd4] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  opacity: 0.8;\n}\n.realm-progress[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.progress-text[data-v-b79cffd4] {\n  font-size: 0.65rem;\n  color: var(--color-text-muted);\n  text-align: center;\n}\n\n/* 状态效果样式 */\n.status-effects[data-v-b79cffd4] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n}\n.status-effect[data-v-b79cffd4] {\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 0.7rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 2px;\n}\n.status-effect.buff[data-v-b79cffd4] {\n  background: linear-gradient(135deg, #10b981, #059669);\n  color: white;\n  box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);\n}\n.status-effect.debuff[data-v-b79cffd4] {\n  background: linear-gradient(135deg, #ef4444, #dc2626);\n  color: white;\n  box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);\n}\n.status-effect[data-v-b79cffd4]:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n}\n.effect-name[data-v-b79cffd4] {\n  font-size: 0.65rem;\n}\n.effect-time[data-v-b79cffd4] {\n  font-size: 0.6rem;\n  opacity: 0.8;\n}\n\n/* 无角色数据样式 */\n.no-character[data-v-b79cffd4] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  gap: 10px;\n}\n.no-char-text[data-v-b79cffd4] {\n  font-size: 0.9rem;\n  color: var(--color-text-muted);\n  font-style: italic;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.right-sidebar[data-v-b79cffd4] {\n    padding: 12px;\n}\n.sidebar-title[data-v-b79cffd4] {\n    font-size: 0.9rem;\n}\n.section-title[data-v-b79cffd4] {\n    font-size: 0.8rem;\n}\n.vitals-list[data-v-b79cffd4] {\n    gap: 8px;\n}\n.vital-item[data-v-b79cffd4] {\n    padding: 6px;\n}\n.vital-name[data-v-b79cffd4] {\n    font-size: 0.7rem;\n}\n.vital-text[data-v-b79cffd4] {\n    font-size: 0.65rem;\n}\n.talent-card[data-v-b79cffd4] {\n    padding: 10px;\n}\n.talent-name[data-v-b79cffd4] {\n    font-size: 0.8rem;\n}\n.status-effect-card[data-v-b79cffd4] {\n    padding: 8px 10px;\n}\n.effect-name[data-v-b79cffd4] {\n    font-size: 0.75rem;\n}\n.status-tags-container[data-v-b79cffd4] {\n    gap: 6px;\n    padding: 8px;\n}\n.status-tag[data-v-b79cffd4] {\n    font-size: 0.7rem;\n    padding: 4px 8px;\n    gap: 4px;\n}\n.tag-intensity[data-v-b79cffd4] {\n    font-size: 0.6rem;\n    padding: 1px 3px;\n}\n.tag-time[data-v-b79cffd4] {\n    font-size: 0.6rem;\n}\n.detail-item[data-v-b79cffd4] {\n    padding: 5px 6px;\n    font-size: 0.7rem;\n}\n.attributes-grid[data-v-b79cffd4] {\n    gap: 6px;\n}\n.attribute-item[data-v-b79cffd4] {\n    padding: 6px;\n}\n.attr-name[data-v-b79cffd4] {\n    font-size: 0.7rem;\n}\n.attr-value[data-v-b79cffd4] {\n    font-size: 0.8rem;\n}\n.attr-quality[data-v-b79cffd4] {\n    font-size: 0.6rem;\n    padding: 1px 4px;\n}\n.info-item[data-v-b79cffd4] {\n    padding: 5px 6px;\n    font-size: 0.7rem;\n}\n.realm-name[data-v-b79cffd4] {\n    font-size: 0.8rem;\n}\n.progress-bar[data-v-b79cffd4] {\n    height: 5px;\n}\n}\n@media (max-width: 480px) {\n.right-sidebar[data-v-b79cffd4] {\n    padding: 8px;\n}\n.sidebar-header[data-v-b79cffd4] {\n    margin-bottom: 12px;\n    padding-bottom: 8px;\n}\n.vitals-section[data-v-b79cffd4],\n  .cultivation-section[data-v-b79cffd4],\n  .collapsible-section[data-v-b79cffd4] {\n    margin-bottom: 12px;\n    padding: 10px;\n}\n.attributes-section[data-v-b79cffd4] {\n    margin-bottom: 12px;\n    padding: 10px;\n}\n.attributes-grid[data-v-b79cffd4] {\n    gap: 4px;\n}\n.attribute-item[data-v-b79cffd4] {\n    padding: 5px;\n}\n.attr-name[data-v-b79cffd4] {\n    font-size: 0.65rem;\n}\n.attr-value[data-v-b79cffd4] {\n    font-size: 0.75rem;\n}\n.attr-quality[data-v-b79cffd4] {\n    font-size: 0.55rem;\n    padding: 1px 3px;\n}\n.status-details[data-v-b79cffd4] {\n    grid-template-columns: 1fr;\n}\n.talents-list[data-v-b79cffd4] {\n    padding: 0 12px 12px;\n}\n.status-effects[data-v-b79cffd4] {\n    padding: 0 12px 12px;\n}\n.status-tags-container[data-v-b79cffd4] {\n    gap: 4px;\n    padding: 6px;\n}\n.status-tag[data-v-b79cffd4] {\n    font-size: 0.65rem;\n    padding: 3px 6px;\n    gap: 3px;\n}\n.tag-intensity[data-v-b79cffd4] {\n    font-size: 0.55rem;\n    padding: 1px 2px;\n}\n.tag-time[data-v-b79cffd4] {\n    font-size: 0.55rem;\n}\n}\n\n/* 平板设备优化 */\n@media (min-width: 769px) and (max-width: 1024px) {\n.right-sidebar[data-v-b79cffd4] {\n    padding: 14px;\n}\n.vital-item[data-v-b79cffd4] {\n    padding: 7px;\n}\n.talent-card[data-v-b79cffd4] {\n    padding: 11px;\n}\n}\n\n/* 大屏幕优化 */\n@media (min-width: 1440px) {\n.right-sidebar[data-v-b79cffd4] {\n    padding: 20px;\n}\n.sidebar-title[data-v-b79cffd4] {\n    font-size: 1.1rem;\n}\n.section-title[data-v-b79cffd4] {\n    font-size: 0.9rem;\n}\n.vital-name[data-v-b79cffd4] {\n    font-size: 0.8rem;\n}\n.talent-name[data-v-b79cffd4] {\n    font-size: 0.9rem;\n}\n.effect-name[data-v-b79cffd4] {\n    font-size: 0.85rem;\n}\n.status-tags-container[data-v-b79cffd4] {\n    gap: 10px;\n    padding: 16px;\n}\n.status-tag[data-v-b79cffd4] {\n    font-size: 0.8rem;\n    padding: 8px 12px;\n}\n}\n\n/* 深色主题适配：使用CSS变量自动适配 */\n@media (prefers-color-scheme: dark) {\n.right-sidebar[data-v-b79cffd4] {\n    background: var(--color-surface);\n}\n.vitals-section[data-v-b79cffd4],\n  .cultivation-section[data-v-b79cffd4],\n  .collapsible-section[data-v-b79cffd4] {\n    background: var(--color-surface-light);\n}\n.status-tag.buff[data-v-b79cffd4] {\n    background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.15), rgba(var(--color-success-rgb), 0.08));\n    border-color: rgba(var(--color-success-rgb), 0.3);\n    color: var(--color-success);\n}\n.status-tag.debuff[data-v-b79cffd4] {\n    background: linear-gradient(135deg, rgba(var(--color-error-rgb), 0.15), rgba(var(--color-error-rgb), 0.08));\n    border-color: rgba(var(--color-error-rgb), 0.3);\n    color: var(--color-danger);\n}\n.status-tag.buff[data-v-b79cffd4]:hover {\n    background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.25), rgba(var(--color-success-rgb), 0.12));\n    border-color: rgba(var(--color-success-rgb), 0.5);\n    color: var(--color-success);\n    box-shadow: 0 4px 12px rgba(var(--color-success-rgb), 0.2);\n}\n.status-tag.debuff[data-v-b79cffd4]:hover {\n    background: linear-gradient(135deg, rgba(var(--color-error-rgb), 0.25), rgba(var(--color-error-rgb), 0.12));\n    border-color: rgba(var(--color-error-rgb), 0.5);\n    color: var(--color-danger);\n    box-shadow: 0 4px 12px rgba(var(--color-error-rgb), 0.2);\n}\n.tag-intensity[data-v-b79cffd4] {\n    background: rgba(var(--color-warning-rgb), 0.9);\n    color: var(--color-text);\n}\n}\n",""]);const i=l},6893:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n/* Step transition animation */\n.fade-step-enter-active,\n.fade-step-leave-active {\n  transition: opacity 0.3s ease;\n}\n.fade-step-enter-from,\n.fade-step-leave-to {\n  opacity: 0;\n}\n",""]);const i=l},6912:(e,n,t)=>{t.d(n,{$O:()=>r,kp:()=>a.kp,uH:()=>o});var a=t(1265);const o=`\n【最高优先级】数据格式铁律 - 违反此规则将导致系统错误，必须严格遵守\n\n========== 规则一：NPC境界结构（违反必罚） ==========\n\n【核心要求】NPC的境界对象只有2个字段：\n\`\`\`json\n{"名称": "金丹", "阶段": "中期"}\n\`\`\`\n\n【严禁操作】不得添加以下玩家专属字段：\n- 当前进度\n- 下一级所需\n- 突破描述\n- 任何其他额外字段\n\n【正确示例】NPC境界的标准格式：\n\`\`\`json\n"境界": {"名称": "元婴", "阶段": "后期"}\n\`\`\`\n\n【错误示例】以下格式会导致系统错误：\n\`\`\`json\n"境界": {"名称": "元婴", "阶段": "后期", "当前进度": 0, "下一级所需": 100}\n\`\`\`\n\n========== 规则二：私密信息结构（NSFW模式专用） ==========\n必须包含以下完整字段，缺一不可：\n- 是否为处女: boolean (女性NPC必填)\n- 是否为处男: boolean (男性NPC可选)\n- 身体部位: Array (3-5个部位对象，见下方结构)\n- 性格倾向: "纯情" | "主动" | "被动" | "淫荡" | "M" | "S" | "双性"\n- 性取向: "异性恋" | "同性恋" | "双性恋" | "泛性恋"\n- 性癖好: Array (可选，如: ["捆绑", "野外", "多人"])\n- 性渴望程度: number (0-100)\n- 当前性状态: string ("正常" | "微湿" | "兴奋" | "发情" | "高潮"等)\n- 体液分泌状态: string (可选，如: "微微湿润")\n- 性交总次数: number\n- 性伴侣数量: number\n- 性伴侣名单: Array<string> (可选)\n- 最近一次性行为时间: string (可选，游戏时间格式)\n- 特殊体质: Array (可选，如: ["易潮吹", "多重高潮"])\n\n**身体部位对象结构**：\n\`\`\`json\n{\n  "部位名称": "string (如: 胸部、小穴、阴茎等)",\n  "开发度": 0-100,\n  "敏感度": 0-100,\n  "特征描述": "string (外观描述)",\n  "特殊印记": "string (可选，如: 淫纹、咬痕)"\n}\n\`\`\`\n\n【逻辑约束规则】数据必须保持一致性：\n- 是否为处女=true → 性交总次数=0, 性伴侣数量=0, 性伴侣名单=[]\n- 性伴侣数量 必须等于 性伴侣名单.length\n- 严禁使用"保密"、"未知"作为性伴侣名单占位符\n- 身体部位数组至少包含3个核心部位\n\n========================================\n\n【数据结构树】完整SaveData结构定义\n\n\`\`\`\nSaveData (根对象)\n├── 角色基础信息 (可修改部分字段)\n│   ├── 名字: string (只读)\n│   ├── 性别: "男"|"女"|"其他" (只读)\n│   ├── 年龄: number (自动计算，禁改)\n│   ├── 出生日期: {年, 月, 日, 小时?, 分钟?} (只读)\n│   ├── 世界: string (只读)\n│   ├── 种族: string (默认"人族")\n│   ├── 天资: string (只读)\n│   ├── 出生: string|{名称, 描述} (只读)\n│   ├── 灵根: string|{名称, 品级, 描述, 属性[], 修炼加成} (只读)\n│   ├── 天赋: [{名称, 描述}] (只读)\n│   ├── 先天六司: {根骨, 灵性, 悟性, 气运, 魅力, 心性} (只读，1-10)\n│   └── 后天六司: {根骨, 灵性, 悟性, 气运, 魅力, 心性} (可修改，用add)\n│\n├── 玩家角色状态 (可修改)\n│   ├── 境界: {名称, 阶段, 当前进度, 下一级所需, 突破描述} (用set更新整个对象，突破时必须更新突破描述)\n│   ├── 声望: number (用add)\n│   ├── 气血: {当前, 上限} (当前用add，上限突破时用add)\n│   ├── 灵气: {当前, 上限} (当前用add，上限突破时用add)\n│   ├── 神识: {当前, 上限} (当前用add，上限突破时用add)\n│   ├── 寿命: {当前, 上限} (当前自动增加，上限突破时用add)\n│   ├── 位置: {描述:"大陆·地点", longitude, latitude} (三个字段同时set)\n│   ├── 状态效果: [{状态名称, 类型, 剩余时间, 效果}] (用push添加)\n│   └── 大道感悟: {道名: {感悟内容, 时间}} (用set)\n│\n├── 装备栏 (只读，禁止修改)\n│   ├── 装备1: string|null (装备ID或null)\n│   ├── 装备2: string|null\n│   ├── 装备3: string|null\n│   ├── 装备4: string|null\n│   ├── 装备5: string|null\n│   └── 装备6: string|null\n│\n├── 三千大道 (可修改)\n│   ├── 已解锁大道: [道名] (用push添加)\n│   └── 大道进度: {道名: {当前阶段, 当前经验, 总经验}} (用set或add经验)\n│\n├── 背包 (可修改)\n│   ├── 灵石: {下品, 中品, 上品, 极品} (用add增减)\n│   └── 物品: {物品ID: Item对象} (用set添加物品，用add修改数量，用delete删除)\n│       ├── 装备物品: {物品ID, 名称, 类型:"装备", 品质, 数量, 描述, 装备增幅, 已装备}\n│       ├── 功法物品: {物品ID, 名称, 类型:"功法", 品质, 数量, 描述, 功法效果, 功法技能[], 修炼进度, 已装备}\n│       ├── 丹药物品: {物品ID, 名称, 类型:"丹药", 品质, 数量, 描述, 使用效果}\n│       └── 其他物品: {物品ID, 名称, 类型:"材料"|"其他", 品质, 数量, 描述}\n│\n├── 修炼功法 (只读引用，禁止直接修改)\n│   ├── 物品ID: string\n│   └── 名称: string\n│\n├── 掌握技能 (自动计算，禁止修改)\n│   └── [{技能名称, 技能描述, 来源, 消耗, 熟练度, 使用次数}]\n│\n├── 人物关系 (可修改)\n│   └── {NPC名字: NPC档案对象}\n│       ├── 名字: string\n│       ├── 性别: "男"|"女"|"其他"\n│       ├── 年龄: number (自动计算)\n│       ├── 出生日期: {年, 月, 日}\n│       ├── 种族: string\n│       ├── 出生: string\n│       ├── 外貌描述: string\n│       ├── 性格特征: [string]\n│       ├── 境界: {名称, 阶段} (【注意】NPC境界是简化结构，严禁添加"当前进度"等玩家专属字段)\n│       ├── 灵根: {名称, 品级}\n│       ├── 天赋: [{名称, 描述}]\n│       ├── 先天六司: {根骨, 灵性, 悟性, 气运, 魅力, 心性}\n│       ├── 与玩家关系: string\n│       ├── 好感度: number (-100~100，用add)\n│       ├── 人格底线: [string]\n│       ├── 记忆: [{时间, 事件}] (用push添加)\n│       ├── 记忆总结: [string]\n│       ├── 当前位置: {描述, longitude, latitude}\n│       ├── 势力归属: string\n│       ├── 当前外貌状态: string (用set实时更新)\n│       ├── 当前内心想法: string (用set实时更新)\n│       ├── 背包: {灵石, 物品}\n│       ├── 私密信息: {14个必填字段} (【条件生成】仅当系统.nsfwMode=true且性别符合nsfwGenderFilter时生成)\n│       │   【必填字段】是否为处女/处男, 身体部位[], 性格倾向, 性取向, 性癖好[], 性渴望程度,\n│       │              当前性状态, 体液分泌状态, 性交总次数, 性伴侣数量, 性伴侣名单[],\n│       │              最近一次性行为时间, 特殊体质[]\n│       │   【生成规则】创建NPC时若满足条件必须立即生成，不得省略或使用占位符\n│       └── 实时关注: boolean\n│\n├── 记忆 (可修改)\n│   ├── 短期记忆: [string] (AI自动生成，用于下次生成)\n│   ├── 中期记忆: [string]\n│   └── 长期记忆: [string]\n│\n├── 世界信息 (可修改)\n│   ├── 地图: {continents[], factions[], features[]}\n│   ├── 大陆信息: [{名称, 描述, 地理特征, ...}]\n│   ├── 势力信息: [{id, 名称, 类型, 等级, 位置, ...}]\n│   └── 地点信息: [{名称, 类型, 位置, coordinates, ...}]\n│\n├── 游戏时间 (可修改)\n│   ├── 年: number\n│   ├── 月: number (1-12)\n│   ├── 日: number (1-30)\n│   ├── 小时: number (0-23)\n│   └── 分钟: number (0-59) (用add推进，自动进位)\n│\n├── 宗门 (可修改)\n│   ├── sectName: string\n│   ├── sectType: string\n│   ├── position: string\n│   ├── contribution: number (用add)\n│   ├── relationship: string\n│   ├── reputation: number (用add)\n│   └── ...\n│\n├── 穿越者系统 (可修改)\n│   ├── 系统类型: string\n│   ├── 任务颁发提示词: string\n│   ├── 自动刷新: boolean\n│   ├── 默认任务数量: number\n│   ├── 未完成任务: [{任务ID, 任务类型, 任务描述, ...}] (用push添加，用delete删除)\n│   └── 已完成任务名单: [string]\n│\n├── 系统任务 (可修改)\n│   ├── 配置: {启用, 任务类型, 颁发数量}\n│   ├── 进行中任务: [任务对象]\n│   └── 已完成任务名称: [string]\n│\n└── 系统 (只读，禁止修改)\n    ├── nsfwMode: boolean\n    └── nsfwGenderFilter: "all"|"female"|"male"\n\`\`\`\n\n${a.hp}\n\n# 📋 字段操作规则速查表\n\n| 字段路径 | 操作类型 | 说明 | 示例 |\n|---------|---------|------|------|\n| **游戏时间.分钟** | add | 推进时间，自动进位 | \`{"action":"add","key":"游戏时间.分钟","value":30}\` |\n| **玩家角色状态.境界** | set | 更新整个境界对象 | \`{"action":"set","key":"玩家角色状态.境界","value":{...}}\` |\n| **玩家角色状态.气血.当前** | add | 增减气血（负数=扣血） | \`{"action":"add","key":"玩家角色状态.气血.当前","value":-50}\` |\n| **玩家角色状态.气血.上限** | add | 突破时增加上限 | \`{"action":"add","key":"玩家角色状态.气血.上限","value":100}\` |\n| **玩家角色状态.寿命.上限** | add | **必须用add**，禁止set | \`{"action":"add","key":"玩家角色状态.寿命.上限","value":130}\` |\n| **玩家角色状态.位置.描述** | set | 同时更新描述+坐标 | \`{"action":"set","key":"玩家角色状态.位置.描述","value":"大陆·地点"}\` |\n| **玩家角色状态.状态效果** | push | 添加buff/debuff | \`{"action":"push","key":"玩家角色状态.状态效果","value":{...}}\` |\n| **背包.灵石.下品** | add | 增减灵石（负数=消耗） | \`{"action":"add","key":"背包.灵石.下品","value":-100}\` |\n| **背包.物品.sword_001** | set | 添加新物品（完整对象） | \`{"action":"set","key":"背包.物品.sword_001","value":{...}}\` |\n| **背包.物品.pill_001.数量** | add | 修改物品数量 | \`{"action":"add","key":"背包.物品.pill_001.数量","value":-1}\` |\n| **背包.物品.pill_001** | delete | 删除物品 | \`{"action":"delete","key":"背包.物品.pill_001"}\` |\n| **背包.物品.gongfa_001.修炼进度** | add | **唯一修改功法进度的方式** | \`{"action":"add","key":"背包.物品.gongfa_001.修炼进度","value":5}\` |\n| **人物关系.张三** | set | 创建新NPC（完整对象，含私密信息） | \`{"action":"set","key":"人物关系.张三","value":{...}}\` 【注意】若nsfwMode=true需包含私密信息 |\n| **人物关系.张三.好感度** | add | 增减好感度（-100~100） | \`{"action":"add","key":"人物关系.张三.好感度","value":10}\` |\n| **人物关系.张三.当前外貌状态** | set | 实时更新NPC状态 | \`{"action":"set","key":"人物关系.张三.当前外貌状态","value":"..."}\` |\n| **人物关系.张三.记忆** | push | 添加NPC记忆 | \`{"action":"push","key":"人物关系.张三.记忆","value":{时间,事件}}\` |\n| **人物关系.张三.私密信息.性渴望程度** | set | 更新NSFW状态（仅nsfwMode=true时） | \`{"action":"set","key":"人物关系.张三.私密信息.性渴望程度","value":50}\` |\n| **角色基础信息.后天六司.根骨** | add | 增加后天属性 | \`{"action":"add","key":"角色基础信息.后天六司.根骨","value":1}\` |\n| **三千大道.已解锁大道** | push | 解锁新大道 | \`{"action":"push","key":"三千大道.已解锁大道","value":"剑道"}\` |\n| **三千大道.大道进度.剑道.当前经验** | add | 增加大道经验 | \`{"action":"add","key":"三千大道.大道进度.剑道.当前经验","value":100}\` |\n| **装备栏.*** | ❌禁止 | 由玩家UI操作，AI不能修改 | - |\n| **修炼功法.*** | ❌禁止 | 只读引用，由装备功法自动管理 | - |\n| **掌握技能** | ❌禁止 | 自动计算，AI不能修改 | - |\n| **系统.*** | ❌禁止 | 前端设置，AI只能读取 | - |\n\n# 🔴 关键规则（必须遵守）\n\n## 1. 只读字段（禁止修改）\n- **装备栏.***: 由玩家UI操作\n- **修炼功法.***: 由装备功法自动管理\n- **掌握技能**: 根据功法进度自动计算\n- **系统.***: 前端用户设置\n- **角色基础信息** 的大部分字段（除了后天六司）\n- **年龄**: 自动计算（当前年 - 出生年）\n\n## 2. 必须用add的字段（禁止set）\n- **玩家角色状态.寿命.上限**: 突破时必须用add增加\n- **玩家角色状态.气血/灵气/神识.上限**: 突破时用add增加\n- **背包.灵石.***: 增减用add\n- **好感度**: 增减用add，范围-100~100\n- **数量**: 物品数量增减用add\n\n## 3. 必须同时更新的字段\n- **位置**: 必须同时更新 描述 + longitude + latitude 三个字段\n- **境界突破**: 必须更新 境界对象（名称+阶段+进度+所需+**突破描述**）+ 寿命上限 + 属性上限\n  - **突破描述** 必须根据当前剧情动态生成，例如："借助筑基丹冲破瓶颈"、"感悟剑道真意破境"\n\n## 4. 数值范围限制\n- **好感度**: -100 ~ 100\n- **亲密渴望**: 0 ~ 100\n- **感知度/唤醒度**: 0 ~ 100\n- **修炼进度**: 0 ~ 100\n- **先天六司**: 1 ~ 10\n- add操作前必须计算，确保不超范围\n\n## 5. 特殊格式要求\n- **物品ID**: 必须唯一，格式：类型_随机数字（如 sword_12345, pill_001, gongfa_001）\n- **位置描述**: 格式："大陆名·地点名"（如"青云大陆·青云宗"）\n- **时间字段**: "小时""分钟"（不能简写"时""分"）\n- **品质**: {"quality":"凡|黄|玄|地|天|仙|神","grade":0-10}\n- **功法技能**: 必须是数组[]，不能是对象{}\n\n## 6. JSON洁癖 (JSON Purism)\n- **严格遵守结构**：你的输出必须严格匹配上方定义的结构树。\n- **禁止添加额外字段**：严禁在任何对象中添加结构树未定义的字段。例如，NPC的\`境界\`对象只有\`名称\`和\`阶段\`，不可添加\`当前进度\`。\n- **结构错误 > 内容不佳**：一个结构完全正确但内容平庸的JSON，远好于一个内容丰富但结构错误的JSON。前端解析失败会导致整个对象无法显示。\n\n${a.bk}\n\n# 📦 完整数据结构示例\n\n## 物品结构\n\n### 装备物品\n\`\`\`json\n{\n  "物品ID": "sword_12345",\n  "名称": "玄铁剑",\n  "类型": "装备",\n  "品质": {"quality": "黄", "grade": 5},\n  "数量": 1,\n  "描述": "一把锋利的长剑，剑身刻有玄纹",\n  "装备增幅": {\n    "后天六司": {\n      "根骨": 2,\n      "气运": 1\n    },\n    "气血上限": 50,\n    "灵气上限": 30\n  },\n  "已装备": false\n}\n\`\`\`\n\n### 功法物品\n\`\`\`json\n{\n  "物品ID": "gongfa_001",\n  "名称": "青木长生诀",\n  "类型": "功法",\n  "品质": {"quality": "玄", "grade": 7},\n  "数量": 1,\n  "描述": "木属性高级功法，修炼可延年益寿",\n  "功法效果": {\n    "修炼速度加成": 1.5,\n    "属性加成": {\n      "根骨": 2,\n      "灵气上限": 100\n    },\n    "特殊能力": ["木遁术", "生命恢复加速"]\n  },\n  "功法技能": [\n    {\n      "技能名称": "青木盾",\n      "技能描述": "凝聚木之灵气形成防护盾",\n      "消耗": "灵气30点",\n      "解锁需要熟练度": 0\n    },\n    {\n      "技能名称": "木龙缠绕",\n      "技能描述": "召唤木龙束缚敌人",\n      "消耗": "灵气80点",\n      "解锁需要熟练度": 50\n    }\n  ],\n  "修炼进度": 35,\n  "已装备": true\n}\n\`\`\`\n⚠️ 第一个技能的"解锁需要熟练度"必须为0（开局可用）\n\n### 丹药物品\n\`\`\`json\n{\n  "物品ID": "pill_001",\n  "名称": "回灵丹",\n  "类型": "丹药",\n  "品质": {"quality": "黄", "grade": 6},\n  "数量": 5,\n  "描述": "快速恢复灵气的丹药",\n  "使用效果": {\n    "恢复灵气": 100,\n    "持续时间": 0\n  }\n}\n\`\`\`\n\n========== NPC档案结构示例 ==========\n\n【格式检查要点】创建NPC时必须遵守：\n\n1. 【境界字段】只有2个字段：名称 和 阶段\n   - 严禁添加：当前进度、下一级所需、突破描述\n\n2. 【私密信息字段】根据系统设置决定是否生成\n   - 检查条件：系统.nsfwMode === true\n   - 性别过滤：系统.nsfwGenderFilter (all/female/male)\n   - 必填字段：14个字段缺一不可（详见上方NSFW规则）\n   - 【重要】创建NPC时，如果nsfwMode=true且性别符合过滤条件，必须立即生成完整的私密信息对象，不得省略或延后\n\n【NPC档案完整示例】（包含NSFW信息）\n\n\`\`\`json\n{\n  "名字": "林清璃",\n  "性别": "女",\n  "年龄": 18,\n  "出生日期": {"年": 982, "月": 3, "日": 15},\n  "种族": "人族",\n  "出生": "青云宗弟子",\n  "外貌描述": "容貌清丽，一袭白衣，气质出尘",\n  "性格特征": ["温柔", "坚韧", "重情"],\n  "境界": {\n    "名称": "筑基",\n    "阶段": "初期"\n  },\n  "灵根": {\n    "名称": "冰霜灵根",\n    "品级": "上品"\n  },\n  "天赋": [\n    {"名称": "冰心", "描述": "不受心魔侵扰"}\n  ],\n  "先天六司": {\n    "根骨": 7,\n    "灵性": 9,\n    "悟性": 8,\n    "气运": 6,\n    "魅力": 9,\n    "心性": 8\n  },\n  "与玩家关系": "师姐",\n  "好感度": 60,\n  "人格底线": ["不能伤害无辜", "不能背叛宗门"],\n  "记忆": [\n    {"时间": "仙道1000年2月1日", "事件": "第一次见到玩家"}\n  ],\n  "记忆总结": ["对玩家印象不错"],\n  "当前位置": {\n    "描述": "青云大陆·青云宗·内门",\n    "longitude": 115.23,\n    "latitude": 35.67\n  },\n  "势力归属": "青云宗",\n  "当前外貌状态": "面色红润，嘴角含笑",\n  "当前内心想法": "这师弟资质不错，可以多加关照",\n  "背包": {\n    "灵石": {\n      "下品": 500,\n      "中品": 50,\n      "上品": 5,\n      "极品": 0\n    },\n    "物品": {\n      "sword_001": {\n        "物品ID": "sword_001",\n        "名称": "霜华剑",\n        "类型": "装备",\n        "品质": {"quality": "玄", "grade": 6},\n        "数量": 1,\n        "描述": "冰属性法剑",\n        "已装备": false\n      }\n    }\n  },\n  "私密信息": {\n    "是否为处女": true,\n    "身体部位": [\n      {\n        "部位名称": "胸部",\n        "开发度": 0,\n        "敏感度": 20,\n        "特征描述": "发育良好，白皙柔软",\n        "特殊印记": "无"\n      },\n      {\n        "部位名称": "小穴",\n        "开发度": 0,\n        "敏感度": 30,\n        "特征描述": "未经人事，紧致粉嫩",\n        "特殊印记": "无"\n      },\n      {\n        "部位名称": "颈部",\n        "开发度": 0,\n        "敏感度": 25,\n        "特征描述": "肌肤白皙细腻",\n        "特殊印记": "无"\n      }\n    ],\n    "性格倾向": "纯情",\n    "性取向": "异性恋",\n    "性癖好": [],\n    "性渴望程度": 10,\n    "当前性状态": "正常",\n    "体液分泌状态": "正常",\n    "性交总次数": 0,\n    "性伴侣数量": 0,\n    "性伴侣名单": [],\n    "最近一次性行为时间": "从未",\n    "特殊体质": []\n  },\n  "实时关注": false\n}\n\`\`\`\n\n${a.Iz}\n\n## 境界结构\n\`\`\`json\n{\n  "名称": "炼气",\n  "阶段": "中期",\n  "当前进度": 350,\n  "下一级所需": 500\n}\n\`\`\`\n\n### 境界系统说明\n| 境界 | 寿命 | 阶段 | 特征 |\n|------|------|------|------|\n| 凡人 | 100年 | 无 | 生老病死 |\n| 炼气 | 120年 | 初期/中期/后期/圆满/极境 | 引气入体、搬运周天 |\n| 筑基 | 250年 | 初期/中期/后期/圆满/极境 | 紫府开辟、辟谷 |\n| 金丹 | 500-800年 | 初期/中期/后期/圆满/极境 | 金丹成型、御空飞行 |\n| 元婴 | 1500-2000年 | 初期/中期/后期/圆满/极境 | 元婴出窍、可夺舍 |\n\n${a.EF}\n\n⚠️ **境界突破必须增加寿命上限**：\n- 用 **add** 增加，禁用 set\n- 境界突破：+100-150年\n- 阶段突破：+20-50年\n- 高境界更大：元婴+500年、化神+2000年\n\n✅ 正确：\`{"action":"add","scope":"chat","key":"玩家角色状态.寿命.上限","value":130}\`\n❌ 错误：\`{"action":"set","scope":"chat","key":"玩家角色状态.寿命.上限","value":250}\`\n\n## 位置结构\n\`\`\`json\n{\n  "描述": "青云大陆·青云宗·藏经阁",\n  "longitude": 115.23,\n  "latitude": 35.67\n}\n\`\`\`\n\n⚠️ **更新位置必须同时更新三个字段**：\n\`\`\`json\n[\n  {"action":"set","scope":"chat","key":"玩家角色状态.位置.描述","value":"青云大陆·青云宗·藏经阁"},\n  {"action":"set","scope":"chat","key":"玩家角色状态.位置.longitude","value":115.23},\n  {"action":"set","scope":"chat","key":"玩家角色状态.位置.latitude","value":35.67}\n]\n\`\`\`\n\n# 🎯 修仙世界设定\n\n**人物命名**：古韵叠字(楚清璃)、兵器借势(剑无尘)、天地意象(风袭月)\n**服饰**：材质(云纱/冰蚕丝)、色彩(月白/霜雪)、款式(广袖流仙)\n**叙事词汇**：元炁/真元(非能量)、元神/真灵(非灵魂)、神通/术法(非魔法)\n\n## 坐标系统\n- longitude: 100-130\n- latitude: 25-45\n- 精度: 2-4位小数\n\n## 品质系统\n格式：\`{"quality":"凡|黄|玄|地|天|仙|神","grade":0-10}\`\n- 凡/黄：开局常见\n- 玄/地：中期\n- 天/仙/神：高级\n\n## NPC物品配置\n- 必须3-8件物品\n- 品质匹配境界：炼气(凡)、筑基(黄)、金丹(玄)\n- 灵石：散修100-500、弟子500-2000、长老1000+`.trim(),r='# 任务：生成功法秘籍\n\n品质加成：凡(1.05-1.15) | 黄(1.2-1.35) | 玄(1.4-1.6) | 地(1.7-1.9) | 天(2.0-2.3) | 仙(2.5-3.0) | 神(3.5-5.0)\n技能要求：凡/黄(可无) | 玄(≥1) | 地(≥2) | 天(≥3) | 仙(≥4)\n\n## JSON输出格式\n```json\n{\n  "物品ID": "gongfa_随机数字",\n  "名称": "功法名称",\n  "类型": "功法",\n  "品质": {"quality": "品质", "grade": 5},\n  "数量": 1,\n  "描述": "功法描述",\n  "功法效果": {\n    "修炼速度加成": 1.35,\n    "属性加成": {\n      "根骨": 1,\n      "灵气上限": 50\n    },\n    "特殊能力": ["特殊能力描述"]\n  },\n  "功法技能": [\n    {\n      "技能名称": "技能1名称",\n      "技能描述": "技能1效果描述",\n      "消耗": "消耗描述",\n      "解锁需要熟练度": 0\n    }\n  ],\n  "修炼进度": 0,\n  "已装备": false\n}\n```\n\n⚠️ 功法技能必须数组[]非对象{} | 第一个技能解锁需求必须为0 | 修炼进度0-100 | 已装备默认false\n'},6932:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.cloud-sync-button[data-v-5e3340f2] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 0.3rem;\n  padding: 0.5rem 0.8rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 0.85rem;\n  min-width: 80px;\n  white-space: nowrap;\n}\n.cloud-sync-button[data-v-5e3340f2]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.sync-text[data-v-5e3340f2] {\n  font-weight: 500;\n}\n.sync-icon[data-v-5e3340f2] {\n  font-size: 1em;\n  flex-shrink: 0;\n}\n\n/* 已同步状态样式 */\n.cloud-sync-button.synced[data-v-5e3340f2] {\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-success-rgb), 0.1));\n  border-color: var(--color-success);\n  color: var(--color-success);\n}\n.cloud-sync-button[data-v-5e3340f2]:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n.cloud-sync-button.synced[data-v-5e3340f2]:hover {\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.2), rgba(var(--color-success-rgb), 0.2));\n}\n\n/* Size variants */\n.cloud-sync-button.small[data-v-5e3340f2] {\n  padding: 0.5rem 0.75rem;\n  font-size: 0.9rem;\n  min-width: 100px;\n}\n.cloud-sync-button.large[data-v-5e3340f2] {\n  padding: 1rem 1.5rem;\n  font-size: 1.1rem;\n  min-width: 180px;\n}\n\n/* Compact variant */\n.cloud-sync-button.compact[data-v-5e3340f2] {\n  min-width: auto;\n  padding: 0.5rem;\n}\n.cloud-sync-button.compact .sync-text[data-v-5e3340f2] {\n  display: none;\n}\n",""]);const i=l},6939:(e,n,t)=>{function a(e,n){let t=n.年-e.年;return(n.月<e.月||n.月===e.月&&n.日<e.日)&&t--,Math.max(0,t)}function o(e,n){return{年:n.年-e,月:n.月,日:n.日,小时:0,分钟:0}}function r(e){const n=e.游戏时间||{年:1,月:1,日:1,小时:8,分钟:0};if(!e.角色基础信息?.出生日期){const t=e.角色基础信息?.年龄||18,a=o(t,n);return e.角色基础信息||(e.角色基础信息={}),e.角色基础信息.出生日期=a,console.log("[寿命计算] 初始化玩家出生日期:",a,"当前年龄:",t),t}const t=a(e.角色基础信息.出生日期,n);return e.角色基础信息&&(e.角色基础信息.年龄=t),t}function l(e,n){const t=n||{年:1,月:1,日:1,小时:8,分钟:0},r=e.玩家角色状态||e.角色状态||e,l=e.角色基础信息||e;if(r.已死亡)return r.寿命?.当前||l.年龄||0;if(!l.出生日期){const e=l.年龄||r.寿命?.当前||18,n=o(e,t);return l.出生日期=n,console.log(`[寿命计算] 初始化NPC出生日期 [${l.名字||"未知"}]:`,n,"当前年龄:",e),e}const i=a(l.出生日期,t);return void 0!==l.年龄&&(l.年龄=i),r.寿命&&(r.寿命.当前=i),i}t.d(n,{R:()=>a,updateLifespanFromGameTime:()=>r,updateNpcLifespanFromGameTime:()=>l})},6972:(e,n,t)=>{t.d(n,{aY:()=>r,$7:()=>l,eb:()=>i});var a=t(4270),o=t(8651);function r(e,n){const t=e;console.log(`【神识印记-诊断】开始诊断${n}的AI响应:`,{type:typeof e,isNull:null===e,isUndefined:void 0===e,isString:"string"==typeof e,isEmpty:"string"==typeof e&&""===e.trim(),length:"string"==typeof e?e.length:"N/A",hasChoices:t&&t.choices,choicesLength:t&&t.choices?t.choices.length:"N/A"}),t&&"object"==typeof t&&t.choices&&(console.log("【神识印记-诊断】检测到OpenAI格式响应，choices:",t.choices),t.choices.length>0&&t.choices[0].message&&(console.log("【神识印记-诊断】第一个choice的消息内容:",t.choices[0].message.content),t.choices[0].message.content&&""!==t.choices[0].message.content.trim()||console.warn("【神识印记-诊断】AI返回了空的content，这通常表示模型配置问题或提示词过于复杂")))}async function l(e,n,t=!0,r=3,l=!1,i){console.log(`【神识印记】开始生成${n}，使用TavernHelper.generate()方法`),console.log(`【神识印记-调试】提示词长度: ${e?.length||0} 字符`),console.log("【神识印记-调试】提示词前500字符:",e.substring(0,500)),console.log("【神识印记-调试】提示词是否包含核心规则:",e.includes("【核心规则")),console.log("【神识印记-调试】提示词是否包含格式化标记:",e.includes("【格式化标记规范】")),console.log("【神识印记-调试】提示词是否包含INPUT_PLACEHOLDER:",e.includes("INPUT_PLACEHOLDER"));const c=function(e){if(!e)return"";const n=String(e).replace(/\r\n/g,"\n").split("\n"),t=[];let a=!1;for(let e of n){e=e.replace(/[ \t]+$/g,""),e=e.replace(/^\s+/g,"");const n=0===e.length;n&&a||(t.push(e),a=n)}return t.join("\n").trim()}(e);console.log("【神识印记】准备发送任务提示词，大小:",c.length,"字符");const s=(0,o.getTavernHelper)();if(!s)throw new Error("酒馆助手未初始化");try{t&&a.o.info(`天机运转，推演${n}...`),console.log("【神识印记】使用/inject命令注入提示词"),console.log("【神识印记-调试】准备发送的提示词长度:",c.length),console.log("【神识印记-调试】提示词前500字符:",c.substring(0,500)),console.log("【神识印记-调试】提示词后500字符:",c.substring(Math.max(0,c.length-500))),console.log("【神识印记-调试】提示词是否包含DATA_STRUCTURE_DEFINITIONS:",c.includes("# 数据结构定义")),console.log("【神识印记-调试】提示词是否包含玩家核心选择:",c.includes("# 玩家核心选择")),console.log("【神识印记-调试】提示词是否包含千夜:",c.includes("千夜")),console.log("【神识印记-调试】提示词是否包含瑶池圣地:",c.includes("瑶池圣地")),console.log("【神识印记】直接发送提示词作为 user_input，不使用注入"),console.log("【神识印记-调试】提示词长度:",c.length);const e=await s.generate({user_input:c,should_stream:l,max_chat_history:0});let o;if(console.log("【神识印记-调试】TavernHelper.generate()返回结果类型:",typeof e),console.log("【神识印记-调试】TavernHelper.generate()返回结果:",e),"string"==typeof e)o=e.trim();else{if(!e||"object"!=typeof e)throw new Error("TavernHelper.generate()返回了空的响应内容，响应类型: "+typeof e);{const n=e;if("string"==typeof n.content)console.log("【神识印记】检测到对象格式响应，提取content字段"),o=n.content.trim();else{if("string"!=typeof n.text)throw console.error("【神识印记】无法从对象中提取文本内容:",e),new Error("TavernHelper.generate()返回了无效的对象格式");console.log("【神识印记】检测到对象格式响应，提取text字段"),o=n.text.trim()}}}if(!o)throw new Error("提取的响应文本为空");console.log("【神识印记】AI响应文本长度:",o.length),console.log("【神识印记】AI原始响应文本 (前200字符):",o.substring(0,200));const r=function(e){return e&&"string"==typeof e?e.replace(/```json\s*/g,"").replace(/```\s*/g,"").replace(/^["']|["']$/g,"").replace(/\r\n/g,"\n").trim():""}(o);let i,d=r.match(/```json\s*([\s\S]*?)\s*```/);d||(d=r.match(/```\s*([\s\S]*?)\s*```/)),i=d?d[1].trim():r,console.log("【神识印记】提取到的JSON字符串 (前500字符):",i.substring(0,500));const m=function(e,n,t="未知"){try{return e&&"string"==typeof e?JSON.parse(e):(console.warn(`[JSON解析] ${t}: 输入不是字符串`),n)}catch(a){return console.error(`[JSON解析] ${t}: 解析失败`,a),console.error("[JSON解析] 原始字符串:",e.substring(0,200)),n}}(i,null,`生成${n}`);if(!m)throw console.error("【神识印记】JSON解析失败，原始文本:",o),new Error("响应格式无效：无法解析JSON内容");console.log(`【神识印记】成功解析${n}:`,m);let p=m;if(m&&"object"==typeof m&&("text"in m||"tavern_commands"in m)){const e=function(e,n="未知"){try{if(!e||"object"!=typeof e)return console.error(`[数据验证] ${n}: 数据不是对象`,e),null;const t=e;if(!t.text||"string"!=typeof t.text)return console.error(`[数据验证] ${n}: 缺少text字段或格式错误`),null;t.tavern_commands||(console.warn(`[数据验证] ${n}: 缺少tavern_commands，使用空数组`),t.tavern_commands=[]),Array.isArray(t.tavern_commands)||(console.warn(`[数据验证] ${n}: tavern_commands不是数组，尝试修复`),t.tavern_commands=[]);const a=[],o=["set","add","delete","push","pull"],r=["global","chat","character","message"];for(let e=0;e<t.tavern_commands.length;e++){const l=t.tavern_commands[e];l&&"object"==typeof l?l.action&&"string"==typeof l.action?o.includes(l.action)?(l.scope&&"string"==typeof l.scope||(console.warn(`[数据验证] ${n}: 命令${e}缺少scope，默认使用chat`),l.scope="chat"),r.includes(l.scope)||(console.warn(`[数据验证] ${n}: 命令${e}的scope "${l.scope}" 不合法，改为chat`),l.scope="chat"),l.key&&"string"==typeof l.key?"delete"===l.action||void 0!==l.value?a.push(l):console.warn(`[数据验证] ${n}: 命令${e}缺少value，跳过`):console.warn(`[数据验证] ${n}: 命令${e}缺少key，跳过`)):console.warn(`[数据验证] ${n}: 命令${e}的action "${l.action}" 不合法，跳过`):console.warn(`[数据验证] ${n}: 命令${e}缺少action，跳过`):console.warn(`[数据验证] ${n}: 命令${e}不是对象，跳过`)}return t.tavern_commands=a,t.short_term_memory||(t.short_term_memory=""),t.mid_term_memory||(t.mid_term_memory=""),console.log(`[数据验证] ${n}: 验证通过，有效命令数: ${a.length}`),t}catch(e){return console.error(`[数据验证] ${n}: 验证过程出错`,e),null}}(m,n);if(!e)throw console.error("【神识印记】GM响应验证失败"),new Error(`生成的${n}数据结构不完整`);p=e,console.log(`【神识印记】GM响应验证通过，命令数: ${e.tavern_commands?.length||0}`)}else p=(e=>{try{if(!e||"object"!=typeof e)return e;const n=Object.prototype.hasOwnProperty.call(e,"text"),t=Object.prototype.hasOwnProperty.call(e,"tavern_commands");if(!n||!t)return e;const a=new Set(["set","add","delete","push","pull"]),o=new Set(["global","chat","character","message"]),r=e=>{if(Array.isArray(e))return e;if(e&&"object"==typeof e){const n=[],t=(e,t)=>{if(e&&"object"==typeof e)for(const a of Object.keys(e))n.push({action:t,scope:"chat",key:a,value:e[a]})},a=(e,t)=>{if(Array.isArray(e))for(const a of e)if(a)if(Array.isArray(a)){const[e,o]=a;"string"==typeof e&&n.push({action:t,scope:"chat",key:e,value:o})}else if("object"==typeof a&&a){const e=a.key;"string"==typeof e&&n.push({action:t,scope:a.scope||"chat",key:e,value:a.value})}else"string"==typeof a&&"delete"===t&&n.push({action:t,scope:"chat",key:a})};return"set"in e&&t(e.set,"set"),"add"in e&&t(e.add,"add"),"push"in e&&a(e.push,"push"),"pull"in e&&a(e.pull,"pull"),"delete"in e&&a(e.delete,"delete"),console.log("【神识印记|校验】tavern_commands 对象格式已展开为数组，长度:",n.length),n}return console.warn("【神识印记|校验】tavern_commands 类型异常，非数组/对象，类型:",typeof e),[]};let l=e.tavern_commands;if(l=r(l),!Array.isArray(l))throw new Error("tavern_commands 必须为数组");const i=[];for(const e of l){if(!e||"object"!=typeof e)throw new Error("命令项必须为对象");const n=e.action??e.command??e.op;let t=String(n||"").trim().toLowerCase();const r={set_value:"set",set_player_data:"set",add_item:"push",add_npc:"set",remove_item:"pull",remove_npc:"delete","_.set":"set","_.add":"add","_.push":"push","_.pull":"pull","_.delete":"delete",unset:"delete",del:"delete"};r[t]&&(t=r[t]);const l=String(e.scope||"chat").trim(),c=String(e.key||"").trim();if(!a.has(t))throw new Error("存在非法action");if(!o.has(l))throw new Error("存在非法scope");if(!c)throw new Error("存在非法key");i.push({action:t,scope:l,key:c,value:e.value})}return e.tavern_commands=i,console.log("【神识印记|校验】tavern_commands 通过校验，数量:",i.length),e}catch(e){const n=e instanceof Error?e.message:String(e);throw new Error(`GM响应校验失败: ${n}`)}})(p);return t&&a.o.success(`${n}推演完成！`),p}catch(e){const o=e instanceof Error?e.message:String(e);return console.error(`【神识印记】生成${n}失败:`,o),t&&a.o.error(`推演${n}失败: ${o}`),null}}async function i(e,n,t=!0){try{const r=(0,o.getTavernHelper)();if(!r)throw new Error("酒馆助手未初始化");t&&a.o.info("天机运转，AI推演中..."),console.log("【AI推演-Raw模式】用户输入:",e),n&&console.log("【AI推演-Raw模式】使用系统提示词:",n.substring(0,100)+"...");const l=[];n&&l.push({role:"system",content:n}),l.push({role:"user",content:e}),console.log(`【AI推演-Raw模式】发送${l.length}条提示词`);const i=await r.generateRaw({ordered_prompts:l,should_stream:!1});let c;if(console.log("【AI推演-Raw模式】收到响应类型:",typeof i),"string"!=typeof i)throw new Error("收到非字符串类型的响应");if(c=i.trim(),!c)throw new Error("响应文本为空");return console.log(`【AI推演-Raw模式】响应文本长度: ${c.length} 字符`),console.log("【AI推演-Raw模式】响应前200字符:",c.substring(0,200)),t&&a.o.success("AI推演完成"),c}catch(e){const n=e instanceof Error?e.message:String(e);return console.error("【AI推演-Raw模式】失败:",n),t&&a.o.error(`AI推演失败: ${n}`),null}}},6973:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.variable-section[data-v-28e177ee] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.section-header[data-v-28e177ee] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.section-title[data-v-28e177ee] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.add-btn[data-v-28e177ee] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  padding: 0.5rem 1rem;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s;\n}\n.add-btn[data-v-28e177ee]:hover {\n  background: var(--color-primary-hover);\n}\n.variable-content[data-v-28e177ee] {\n  flex: 1;\n  overflow: hidden;\n}\n.variable-list[data-v-28e177ee] {\n  height: 100%;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n.variable-item[data-v-28e177ee] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 1rem;\n}\n.variable-header[data-v-28e177ee] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n  gap: 0.5rem;\n}\n.variable-key[data-v-28e177ee] {\n  font-weight: 600;\n  color: var(--color-primary);\n  flex: 1;\n  word-break: break-word;\n}\n.variable-type[data-v-28e177ee] {\n  font-size: 0.75rem;\n  padding: 0.125rem 0.5rem;\n  background: var(--color-accent-light);\n  color: var(--color-accent);\n  border-radius: 4px;\n  flex-shrink: 0;\n}\n.variable-actions[data-v-28e177ee] {\n  display: flex;\n  gap: 0.25rem;\n  flex-shrink: 0;\n}\n.action-btn[data-v-28e177ee] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  padding: 0;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: var(--color-text-secondary);\n  background: var(--color-surface);\n}\n.action-btn[data-v-28e177ee]:hover {\n  background: var(--color-hover);\n  color: var(--color-text);\n}\n.action-btn.edit[data-v-28e177ee]:hover {\n  background: var(--color-info);\n  color: white;\n  border-color: var(--color-info);\n}\n.action-btn.copy[data-v-28e177ee]:hover {\n  background: var(--color-success);\n  color: white;\n  border-color: var(--color-success);\n}\n.action-btn.delete[data-v-28e177ee]:hover {\n  background: var(--color-danger);\n  color: white;\n  border-color: var(--color-danger);\n}\n.variable-value[data-v-28e177ee] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  word-break: break-word;\n}\n.code-pre[data-v-28e177ee] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  max-height: 200px;\n  overflow: auto;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.8rem;\n  line-height: 1.4;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.empty-state[data-v-28e177ee] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 1rem;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n.debug-info[data-v-28e177ee] {\n  margin-top: 1rem;\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n}\n.debug-info summary[data-v-28e177ee] {\n  cursor: pointer;\n  color: var(--color-primary);\n}\n.debug-content[data-v-28e177ee] {\n  margin-top: 0.5rem;\n  padding: 0.5rem;\n  background: var(--color-surface);\n  border-radius: 4px;\n  text-align: left;\n}\n.debug-actions[data-v-28e177ee] {\n  margin-top: 0.5rem;\n}\n.debug-btn[data-v-28e177ee] {\n  padding: 0.25rem 0.5rem;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.75rem;\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.variable-section[data-v-28e177ee] {\n    padding: 0.75rem;\n}\n.section-header[data-v-28e177ee] {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 0.5rem;\n    margin-bottom: 0.75rem;\n}\n.section-title[data-v-28e177ee] {\n    font-size: 1rem;\n    text-align: center;\n}\n.add-btn[data-v-28e177ee] {\n    align-self: center;\n    padding: 0.4rem 0.8rem;\n    font-size: 0.8rem;\n}\n.variable-item[data-v-28e177ee] {\n    padding: 0.75rem;\n}\n.variable-header[data-v-28e177ee] {\n    flex-direction: column;\n    align-items: stretch;\n    gap: 0.5rem;\n}\n.variable-key[data-v-28e177ee] {\n    font-size: 0.9rem;\n}\n.variable-actions[data-v-28e177ee] {\n    justify-content: center;\n    gap: 0.5rem;\n}\n.action-btn[data-v-28e177ee] {\n    width: 32px;\n    height: 32px;\n}\n.code-pre[data-v-28e177ee] {\n    font-size: 0.75rem;\n    padding: 0.5rem;\n}\n}\n@media (max-width: 480px) {\n.variable-section[data-v-28e177ee] {\n    padding: 0.5rem;\n}\n.section-title[data-v-28e177ee] {\n    font-size: 0.9rem;\n}\n.add-btn[data-v-28e177ee] {\n    padding: 0.35rem 0.7rem;\n    font-size: 0.75rem;\n}\n.variable-item[data-v-28e177ee] {\n    padding: 0.5rem;\n}\n.variable-key[data-v-28e177ee] {\n    font-size: 0.85rem;\n}\n.variable-type[data-v-28e177ee] {\n    font-size: 0.7rem;\n}\n.action-btn[data-v-28e177ee] {\n    width: 28px;\n    height: 28px;\n}\n.code-pre[data-v-28e177ee] {\n    font-size: 0.7rem;\n    padding: 0.4rem;\n}\n.empty-state[data-v-28e177ee] {\n    padding: 2rem 0.5rem;\n}\n}\n",""]);const i=l},7181:(e,n,t)=>{t.d(n,{Ez:()=>v,x:()=>p,bA:()=>m});var a=t(6972),o=t(4775),r=t(6912),l=t(4986),i=t(1265);const c=(e,n,t)=>{const a=e?.人物关系?Object.keys(e.人物关系).length:0,o=!1!==n&&a<(t||3),c=["【剧情推进】根据当前状态推进叙事，返回JSON。","","# 核心规则","","## 提示词结构","1. 系统提示(本文)：规则/数据结构","2. 上幕剧情(assistant)：之前生成的短期记忆","3. 玩家行动(user)：当前输入","","## 剧情推进","从最后记忆推进新剧情，禁重复/复述已有内容。玩家无新动作则描述环境/时间/NPC。","","# 时间推进","",'每次必须推进时间(除非玩家明确"不做任何事")。',"","参考：对话1-5分,战斗5-30分,修炼30分-数时,炼丹/器数时-数天,赶路数时-数天,闭关数天-数月","",'命令: `{"action":"add","key":"游戏时间.分钟","value":推进分钟数}`',"value是本次推进量非累计。换算:1时=60,1天=1440,1月=43200,1年=518400","",i.kp,"",r.uH,"",(0,l.An)(),""];e?.系统任务?.配置?.启用&&c.push((()=>{const e='\n========== 系统任务功能 ==========\n\n【数据结构】\n```json\n{\n  "系统任务": {\n    "配置": {\n      "启用": true,\n      "任务类型": "all|relationship|cultivation|exploration|combat|custom",\n      "颁发数量": 3\n    },\n    "进行中任务": [{任务对象}],\n    "已完成任务名称": []\n  }\n}\n```\n\n【核心规则】\n- 前置条件：配置.启用 === true 时才能操作系统任务\n- 数量限制：生成的任务数不得超过颁发数量（最大值为5）\n- 【重要】每次生成后必须检查所有进行中任务的条件\n- 完成判定：当任务的所有条件.完成 === true 时，必须立即执行完成流程\n- 完成流程：发放奖励 + pull删除任务 + push任务名称到已完成列表\n- 失败处理：任务失败时，执行惩罚 + pull删除任务\n\n【任务ID命名规范】\n格式：task_类型缩写_年月日_序号\n类型缩写对照表：\n- rel: 交友任务\n- com: 道侣任务\n- cul: 修炼任务\n- exp: 探索任务\n- bat: 战斗任务\n- cus: 自定义任务\n\n【任务有效期】\n单位：游戏内分钟\n时间换算：1小时=60分钟，1天=1440分钟，1月=43200分钟，1年=518400分钟\n过期判定：(当前游戏时间 - 任务颁发时间) > 任务有效期\n\n【任务触发时机】\n- 到达新地点 → 触发探索任务或战斗任务\n- 与新NPC互动且关系良好 → 触发交友任务\n- NPC好感度≥60 → 触发道侣任务\n- 境界突破 → 触发修炼任务\n- 剧情关键节点 → 触发对应类型任务\n\n【操作示例】\n\n[颁发新任务]\n`{"action":"push","key":"系统任务.进行中任务","value":{完整任务对象}}`\n\n[更新任务进度]\n`{"action":"set","key":"系统任务.进行中任务.0.条件.0.进度.当前","value":2}`\n\n[标记任务条件完成]\n`{"action":"set","key":"系统任务.进行中任务.0.条件.0.完成","value":true}`\n\n[完成任务] 必须按顺序执行以下三个操作，缺一不可：\n```json\n[\n  {"action":"add","scope":"chat","key":"背包.灵石.下品","value":100},\n  {"action":"pull","scope":"chat","key":"系统任务.进行中任务","value":{"任务ID":"task_rel_1000_0315_001"}},\n  {"action":"push","scope":"chat","key":"系统任务.已完成任务名称","value":"初识道友"}\n]\n```\n\n[任务失败]\n```json\n[\n  {"action":"add","scope":"chat","key":"玩家角色状态.声望","value":-10},\n  {"action":"pull","scope":"chat","key":"系统任务.进行中任务","value":{"任务ID":"task_xxx"}}\n]\n```\n  ';return e})(),"","🔴 **任务检查提醒**: 每次生成后检查进行中任务,若条件全部满足(所有条件.完成=true)则必须执行完成流程(发奖励+删除任务+记录名称)",""),o&&c.push("","========== 【紧急】人物关系不足，需生成新NPC ==========","",`【当前状态】NPC数量: ${a} | 最低要求: ${t||3}`,"","【生成要求】","1. 自然引入1-2个符合当前场景的NPC","2. 使用set操作创建完整NPC档案","3. 必填字段：名字/性别/年龄/出生日期/种族/出生/外貌/性格/境界/灵根/天赋/六司/关系/好感度/位置/背包等","4. 【重要】若系统.nsfwMode=true，必须根据性别过滤条件生成完整私密信息（14个必填字段，不得省略）","","【操作示例】",'`{"action":"set","scope":"chat","key":"人物关系.李师兄","value":{完整NPC对象}}`',"","【注意事项】","- NPC境界只有2个字段：名称 和 阶段（不要添加当前进度等字段）",'- 私密信息必须包含全部14个必填字段，不得使用占位符或"待补充"',"");const s=e?.系统任务?.配置;if(s?.启用){const n=e?.系统任务?.进行中任务?.length||0,t=s?.颁发数量||3;n<t&&c.push("","# 🔴 任务数量不足，需生成新任务","",`当前: ${n} 需要: ${t}`,"","在当前剧情中, 自然地引入一个新任务, 并用 tavern command 的 `push` 操作添加到 `系统任务.进行中任务` 数组中。","新任务必须是一个完整的任务对象, 包含 `id`, `名称`, `描述`, `目标`, `奖励`, `状态` 等字段。",'示例: `{"action":"push","scope":"chat","key":"系统任务.进行中任务","value":{一个完整的任务对象}}`',"")}return c.push("# 🔴 tavern_commands生成规则(最高优先级)","","## 基本原则","",'每个剧情变化必须对应命令。格式: `{"action":"操作","scope":"chat","key":"路径","value":值}`',"","**操作**：set(设置),add(增减数值),push(添加数组),delete(删除),pull(移除数组)","","## 常见场景示例","",'**时间**(必须): `{"action":"add","key":"游戏时间.分钟","value":30}` (value是推进量非累计)',"",'**受伤**: `{"action":"add","key":"玩家角色状态.气血.当前","value":-50}` (负数扣血,禁set整个对象)',"",'**获物品**: `{"action":"set","key":"背包.物品.sword_001","value":{完整物品}}` (ID格式:类型_数字)',"",'**耗物品**: `{"action":"add","key":"背包.物品.pill_001.数量","value":-1}` 或delete',"",'**花灵石**: `{"action":"add","key":"背包.灵石.下品","value":-100}`',"","**修炼**: 时间+/灵气-/进度+/境界进度+","","**突破**: set境界(含名称/阶段/进度/所需/突破描述)+add寿命上限+add属性上限","","**NPC**: add好感度/set状态/push记忆","",'**创建NPC**: `{"action":"set","key":"人物关系.张三","value":{完整档案}}`',"  【重要】创建NPC时必须检查系统.nsfwMode，若为true且性别符合过滤条件，必须在value中包含完整的私密信息对象（14个必填字段）","","**移动**: 同时set描述+longitude+latitude (格式:大陆·地点)","","## 常见错误","","❌ set整个对象(背包/气血) → ✅ 改具体字段",'❌ 缺scope字段 → ✅ 必须含scope:"chat"',"❌ 寿命上限用set → ✅ 必须用add","❌ 忘推进时间 → ✅ 任何行动必须推时间","❌ 数值超范围 → ✅ 提前算确保不超","❌ JSON格式错(引号/逗号) → ✅ 严格JSON","","## 生成流程","","1读text→2列变化→3生成命令→4检数值→5检JSON→6确认时间","","# 🔴 修仙世界铁律(最高优先级)","","## 世界规则","境界压制绝对(低境界无法胜高境界) | 灵根天定 | 功法优劣 | 越阶必败","","## 修炼代价","时间:炼气升层1-3年,筑基数十年 | 资源:突破耗50-200灵石,败则尽失 | 风险:强突→走火/跌境/损寿 | 心魔:急功/杀戮必反噬","","## 战斗规则",'敌全力(不留手/不等待/最优战术) | 境界压制 | 战术合理 | 失误必死 | 死亡终局(无"恰好救命")',"","## 🔴 死亡与受伤(核心玩法)","","**回档流游戏,死亡/受伤必须频繁发生**","","**必须执行**：战斗必伤,鲁莽必死,作死必死,实力不足必死,连续低质选择→伏笔→死亡","","**触发**(满足之一)：越阶/重伤续战/入死地/怒强者/强突败/毒伤未治","","**禁止**：运气逃脱/敌失误/前辈救/低胜高/灵光化险","","## 玩家叙事权","","**可述**：自身行动/意图/选择","","**不可述(拒绝)**：事件结果/NPC反应/剧情发展/超范围内容","","**处理**：识别口胡→忽略不合理→按真实规则推","",'例：玩家说"运气捡至宝"→拒,按概率无或有危险 | "NPC被打动"→拒,NPC按性格判断 | "灵光突破"→拒,需长期积累',"","## 叙事风格",'体感描写(经脉痛/撕裂/苦涩) | 白描传神(事实震撼非堆词) | 立体角色(独立人格非工具) | 留白高阶(道碰撞/法则交锋) | 时序沧桑(物是人非) | 境界匹配(高境界禁用"引气""搬运周天"等炼气期描述)',"","# 状态变更识别","","主动识别同步：修炼/突破→境界/进度/上限 | 学习→技能/功法 | 得/失物品→背包 | 战斗/伤→气血/灵气 | 情感→好感度 | 新人→NPC档案 | 时间→分钟(必填)","","# 发送前检查","","**思考**：哪些事件?影响哪些字段?需哪些commands?","","**验证**：JSON正确/text情节有commands对应/含时间推进/数值范围内/物品NPC结构完整/NSFW合规","","**🔴死亡检查**：玩家危险/鲁莽?满足死亡触发?已安排合理死亡?给了不该有的运气?","","**记住：死亡/受伤是核心非例外,玩家期待挑战/失败让成功更有价值**"),c.join("\n")};var s=t(8651),d=t(4270);async function m(e,n){console.log("【简单响应】准备调用AI...",{inputData:e});try{const t=n.replace("INPUT_PLACEHOLDER",JSON.stringify(e,null,2)),o=await(0,a.$7)(t,"简单JSON生成",!1,3,!1);if(!o||"object"!=typeof o)throw new Error("AI返回的响应不是有效的JSON对象");return console.log("【简单响应】成功生成:",o),o}catch(e){if(console.error("【简单响应】生成过程中发生错误:",e),e instanceof Error)throw new Error(`生成简单响应失败: ${e.message}`);throw new Error(`生成简单响应时发生未知错误: ${String(e)}`)}}async function p(e,n,a){if(console.log("【神识印记】准备调用AI生成天道初言，数据:",{initialGameData:e,mapData:n}),!e||!e.baseInfo||!e.creationDetails)throw console.error("【神识印记-致命错误】initialGameData 或其核心属性缺失",e),new Error("初始游戏数据不完整，无法开始生成。");if(!e.baseInfo.先天六司)throw console.error("【神识印记-致命错误】先天六司数据缺失",e.baseInfo),new Error("角色核心属性“先天六司”数据缺失，无法继续。");console.log("【神识印记】核心数据校验通过");try{console.log("【数据缓存】缓存现有世界数据...");const{getTavernHelper:n}=await Promise.resolve().then(t.bind(t,8651)),l=n();let i=null,c=null;if(l)try{const e=await l.getVariables({type:"chat"});c=e||{};const n=e["世界信息"];n?(i=JSON.parse(JSON.stringify(n)),i&&console.log("【数据缓存】已缓存世界数据:",{世界名称:i.世界名称,大陆数量:i.大陆信息?.length||0,势力数量:i.势力信息?.length||0,地点数量:i.地点信息?.length||0})):console.log("【数据缓存】未发现现有世界数据")}catch(e){console.warn("【数据缓存】缓存过程中出现警告:",e)}else console.warn("【数据缓存】酒馆连接不可用，跳过数据缓存");const s=e.creationDetails.originName,m=e.creationDetails.spiritRootName;"随机出身"===s&&console.log("【随机出身】检测到随机出身，将由 AI 创造性生成"),"随机灵根"!==m&&("string"!=typeof(r=m)||"随机灵根"!==r&&!r.includes("随机"))||console.log("【随机灵根】检测到随机灵根，将由 AI 创造性生成");const p=e=>Math.max(0,Math.min(10,Math.round(e??0))),v={根骨:p(e.baseInfo.先天六司?.根骨??0),灵性:p(e.baseInfo.先天六司?.灵性??0),悟性:p(e.baseInfo.先天六司?.悟性??0),气运:p(e.baseInfo.先天六司?.气运??0),魅力:p(e.baseInfo.先天六司?.魅力??0),心性:p(e.baseInfo.先天六司?.心性??0)};console.log("【属性验证】确保先天六司在0-10范围内:",v);const u={};if(console.log("【关键诊断】initialGameData.availableContinents:",e.availableContinents),console.log("【关键诊断】initialGameData.availableLocations:",e.availableLocations),console.log("【关键诊断】initialGameData.worldInfo:",e.worldInfo),e.availableContinents&&e.availableContinents.length>0){console.log("【数据源】使用直接传入的 availableContinents 数组"),console.log("【数据验证】大陆数量:",e.availableContinents.length),console.log("【数据验证】大陆名称列表:",e.availableContinents.map(e=>e.名称).join("、"));const n={世界名称:e.worldInfo?.世界名称||"未知世界",世界背景:e.worldInfo?.世界背景||"",大陆信息:e.availableContinents,势力信息:e.worldInfo?.势力信息||[],地点信息:e.availableLocations||[]};u["世界信息"]=n,console.log("【成功】世界信息已加载到提示词"),console.log("【成功】大陆数量:",n.大陆信息.length),console.log("【成功】地点数量:",n.地点信息.length)}else if(e.worldInfo&&e.worldInfo.大陆信息){console.log("【数据源】使用传入的 worldInfo 对象");const n=e.worldInfo,t={世界名称:n.世界名称,世界背景:n.世界背景,大陆信息:n.大陆信息?.map(e=>({名称:e.名称||e.name,描述:e.描述||e.description,大洲边界:e.大洲边界||e.continent_bounds})),势力信息:n.势力信息?.map(e=>({名称:e.名称,类型:e.类型,位置:e.位置,势力范围:e.势力范围})),地点信息:n.地点信息?.map(e=>({名称:e.名称,类型:e.类型,位置:e.位置,coordinates:e.coordinates}))};u["世界信息"]=t,console.log("【成功】从 worldInfo 对象提取世界信息"),console.log("【成功】大陆数量:",t.大陆信息?.length||0)}else if(console.warn("【警告】未从参数中获取到世界信息，尝试从酒馆变量读取"),c&&c["世界信息"]){const e=c["世界信息"],n={世界名称:e.世界名称,世界背景:e.世界背景,大陆信息:e.大陆信息?.map(e=>({名称:e.名称||e.name,描述:e.描述||e.description,大洲边界:e.大洲边界||e.continent_bounds})),势力信息:e.势力信息?.map(e=>({名称:e.名称,类型:e.类型,位置:e.位置,势力范围:e.势力范围})),地点信息:e.地点信息?.map(e=>({名称:e.名称,类型:e.类型,位置:e.位置,coordinates:e.coordinates}))};u["世界信息"]=n,console.log("【备用】从酒馆变量读取到世界信息"),console.log("【备用】大陆数量:",n.大陆信息?.length||0)}else console.error("【致命错误】无法从任何来源获取世界信息！"),console.error("【致命错误】initialGameData keys:",Object.keys(e));let g="";try{const e=c?.["记忆_短期"];Array.isArray(e)&&e.length>0&&"string"==typeof e[e.length-1]&&(g=String(e[e.length-1]))}catch(e){console.warn("【神识印记】提取上一条文本失败（可忽略）:",e)}const f={name:e.baseInfo.名字||"匿名",gender:e.baseInfo.性别||"男",age:Number(e?.creationDetails?.age||16),world:e.baseInfo.世界||"未知世界",talentTier:e.baseInfo.天资详情||e.baseInfo.天资||"凡人",origin:e.baseInfo.出身详情||e.baseInfo.出生||"平民出身",spiritRoot:e.baseInfo.灵根详情||e.baseInfo.灵根||"废灵根",talents:Array.isArray(e.baseInfo.天赋详情)?e.baseInfo.天赋详情:Array.isArray(e.baseInfo.天赋)?e.baseInfo.天赋:[],attributes:v};console.log("【神识印记】构建的用户选择信息:",f);const b=f.age,h=v,y=Math.max(30,80+6*h.根骨+Math.floor(2*h.心性)),x=Math.max(0,6*h.灵性),k=Math.max(10,10+2*h.悟性+Math.floor(h.心性)),w=Math.max(40,80+2*h.根骨+3*h.气运),N=b,E={基线数值:{气血:{当前:y,上限:y},灵气:{当前:0,上限:x},神识:{当前:k,上限:k},寿命:{当前:N,上限:w}},先天六司:h,天资:f.talentTier,灵根:f.spiritRoot};try{const{getTavernHelper:e}=await Promise.resolve().then(t.bind(t,8651)),n=e();if(n){const e={气血:{当前:y,上限:y},灵气:{当前:0,上限:x},神识:{当前:k,上限:k},寿命:{当前:N,上限:w}},{deepCleanForClone:a}=await Promise.resolve().then(t.bind(t,3098)),o=a({属性:e});await n.insertOrAssignVariables(o,{type:"chat"}),console.log("[初始化基线] 已写入玩家角色属性基线: ",e)}}catch(e){console.warn("[初始化基线] 写入玩家角色状态基线失败（非致命）：",e)}const V={character_creation:{selections:f,derived_stats:E},reference:{chatVariables:u||{},last_text:g,note:'【强制】所有路径必须以 saveData. 开头。【强制】所有物品，无论类型（装备/功法/丹药等），都必须统一写入 "背包.物品" 对象中，并使用物品ID作为键。【严禁】严禁创建 "背包.装备" 或 "背包.功法" 等自定义路径。【参考】严格匹配参考中已有字段结构。例如：saveData.玩家角色状态.气血.当前'}},C=(0,o.IJ)(f),z=`# 世界信息数据\n\n    🔥 **可用大陆名称**（位置第一层必须从这里选择）：\n    ${u["世界信息"]&&u["世界信息"].大陆信息?.map(e=>e.名称).join("、")||"未知"}\n\n    **大陆详细信息**：\n    ${u["世界信息"]?JSON.stringify(u["世界信息"].大陆信息,null,2):"[]"}\n\n    **可用地点列表**：\n    ${u["世界信息"]?JSON.stringify(u["世界信息"].地点信息,null,2):"[]"}\n\n⚠️ **关键要求**：\n- 位置的第一层必须使用上方"可用大陆名称"中的一个名称\n- 严禁编造不存在的大陆名！`,S=`# 玩家核心选择\n\n${JSON.stringify(V,null,2)}\n\n${a||""}`;console.log("【初始化】使用多消息格式，系统规则:",C.length,"字符"),console.log("【初始化】世界数据:",z.length,"字符"),console.log("【初始化】用户输入:",S.length,"字符");const B=n();if(!B)throw console.error("【初始化-致命错误】酒馆助手未初始化"),new Error("酒馆助手未初始化");const D=C.length+z.length+S.length;let A,_;console.log("【初始化】准备调用AI，提示词总长度:",D,"字符"),d.o.info("天机运转，推演天道初言...");try{A=await B.generate({user_input:S,overrides:{chat_history:{prompts:[{role:"system",content:C},{role:"system",content:z}]}},max_chat_history:0})}catch(e){throw console.error("【初始化-错误】调用helper.generate失败:",e),new Error("调用AI接口失败: "+(e instanceof Error?e.message:String(e)))}if(console.log("【初始化-调试】AI原始返回类型:",typeof A),console.log("【初始化-调试】AI原始返回值是否为空:",null==A||""===A),console.log("【初始化-调试】AI原始返回值前500字符:","string"==typeof A?A.substring(0,500):JSON.stringify(A).substring(0,500)),!A||""===A||null==A)throw console.error("【初始化-错误】AI返回了空值:",A),new Error("AI返回空响应，可能是API调用失败或被拦截");if("object"==typeof A&&A&&"error"in A){const e=A.error,n=e.message||JSON.stringify(e);throw console.error("【初始化-错误】AI服务返回错误:",n),console.error("【初始化-错误】完整错误对象:",A),new Error(`AI服务错误: ${n}。这可能是由于：1) 提示词过长超过模型上下文限制 2) 服务端暂时不可用 3) API配置问题。请稍后重试。`)}try{if("string"==typeof A){let e=A.trim();if(!e)throw console.error("【初始化-错误】AI返回了空字符串"),new Error("AI返回空字符串");if(e.startsWith("```json")?e=e.substring(7):e.startsWith("```")&&(e=e.substring(3)),e.endsWith("```")&&(e=e.substring(0,e.length-3)),e=e.trim(),console.log("【初始化-调试】清理后的JSON前500字符:",e.substring(0,500)),!e)throw console.error("【初始化-错误】清理后的文本为空"),new Error("清理Markdown标记后文本为空");_=JSON.parse(e)}else{if(!A||"object"!=typeof A)throw console.error("【初始化-错误】AI返回了意外的类型:",typeof A,A),new Error("AI返回数据类型无效: "+typeof A);_=A}}catch(e){throw console.error("【初始化-错误】解析AI返回值失败:",e),console.error("【初始化-错误】原始返回值类型:",typeof A),console.error("【初始化-错误】原始返回值内容(前2000字符):","string"==typeof A?A.substring(0,2e3):JSON.stringify(A).substring(0,2e3)),new Error("AI返回数据格式无效: "+(e instanceof Error?e.message:String(e)))}if(console.log("【神识印记-调试】AI原始返回结果:",JSON.stringify(_,null,2)),!_||"object"!=typeof _)throw console.warn("【神识印记】AI返回的初始消息结构无效，将抛出错误以触发重试:",_),new Error("AI生成的初始消息格式无效或内容缺失");if(!_.text||"string"!=typeof _.text||!_.text.trim())throw console.warn("【神识印记】AI返回的消息缺少text字段或空:",_),new Error("AI生成的初始消息缺少必需字段text");if(_.tavern_commands&&!Array.isArray(_.tavern_commands)&&"object"==typeof _.tavern_commands){const e=_.tavern_commands,n=[],t=Object.keys(e);if(t.every(e=>/^\d+$/.test(e))){console.log("【格式修复】检测到数字索引的tavern_commands格式，正在转换...");for(const a of t){const t=e[a];if(t&&"object"==typeof t){const e=t;e.action&&e.key&&n.push({action:String(e.action),scope:String(e.scope||"chat"),key:String(e.key),value:e.value})}}}else{const t=(e,t)=>{if(e)if(Array.isArray(e))for(const a of e){if(!a)continue;const e=a.key||a.path||a.target;if(e)n.push({action:t,scope:a.scope||"chat",key:e,value:a.value});else if(Array.isArray(a)){const[e,o]=a;n.push({action:t,scope:"chat",key:e,value:o})}}else if("object"==typeof e&&null!==e)for(const a of Object.keys(e))n.push({action:t,scope:"chat",key:a,value:e[a]})};["set","add","push","pull","delete"].forEach(n=>t(e[n],n))}_.tavern_commands=n,console.log("【格式修复】转换后的tavern_commands数量:",n.length)}_.tavern_commands||(console.warn("【神识印记】AI未返回tavern_commands，设置为空数组"),_.tavern_commands=[]),Array.isArray(_.tavern_commands)||(console.warn("【神识印记】tavern_commands不是数组格式，强制设置为空数组"),_.tavern_commands=[]),Array.isArray(_.tavern_commands)?(console.log("【神识印记】验证tavern_commands格式，原始命令数量:",_.tavern_commands.length),console.log("【神识印记-详细】AI生成的所有命令:",JSON.stringify(_.tavern_commands,null,2)),_.tavern_commands=_.tavern_commands.map(e=>{if(!e)return null;e.action||(e.action="set");const n=e.key;return n?(e.key=String(n),(e.key.includes("装备")||e.key.includes("物品"))&&console.log("【装备命令检测】",{action:e.action,key:e.key,hasValue:!!e.value,valueType:typeof e.value,value:e.value}),e.scope||(e.scope="chat"),e.key=(e=>{let n=String(e||"").trim();return n.startsWith("character.saveData.")&&(n=n.substring(19)),n.startsWith("character.")&&(n=n.substring(10)),n.startsWith("物品.")&&(n=n.replace("物品.","背包_物品.")),("背包.灵石"===n||n.startsWith("背包.灵石."))&&(n=n.replace("背包.灵石","背包_灵石")),("背包.物品"===n||n.startsWith("背包.物品."))&&(n=n.replace("背包.物品","背包_物品")),n.startsWith("inventory.items")&&(n=n.replace("inventory.items","背包_物品")),n.startsWith("inventory.currency.灵石")&&(n=n.replace("inventory.currency.灵石","背包_灵石")),n.startsWith("关系网")&&(n=n.replace("关系网","人物关系")),n})(e.key),e):(console.warn("【神识印记】缺少key，跳过:",e),null)}).filter(e=>null!==e),console.log("【神识印记】有效的tavern_commands数量:",_.tavern_commands.length)):(console.warn("【神识印记】AI返回的tavern_commands不是数组格式，设置为空数组"),_.tavern_commands=[]),console.log("【神识印记】成功生成天道初言，命令数量:",_.tavern_commands?.length||0),console.log("【装备验证】开始检查装备完整性...");const $=_.tavern_commands?.filter(e=>e.key&&e.key.includes("装备栏"))||[],I=_.tavern_commands?.filter(e=>e.key&&e.key.includes("背包.物品."))||[];console.log("【装备验证】找到装备命令数量:",$.length),console.log("【装备验证】找到物品创建命令数量:",I.length);const T=[];if($.forEach(e=>{if(e.value&&"object"==typeof e.value){const n=e.value,t=n["物品ID"]||n.itemId;if(t&&!I.some(e=>e.key&&e.key.includes(String(t)))){console.warn("【装备验证】发现无效装备引用，将清除:",{itemId:t,slotKey:e.key});const n=_.tavern_commands?.indexOf(e);void 0!==n&&n>=0&&T.push(n)}}}),T.length>0){T.sort((e,n)=>n-e);for(const e of T)_.tavern_commands?.splice(e,1);console.warn(`【装备验证】已清除 ${T.length} 个无效装备引用`),console.log("【装备验证】清理后的命令总数:",_.tavern_commands?.length)}else console.log("【装备验证】所有装备引用都有效，通过验证");if(i){if(console.log("【数据植入】将缓存的世界数据植入AI生成结果"),_.tavern_commands){const e=_.tavern_commands.length;_.tavern_commands=_.tavern_commands.filter(e=>!e.key||!e.key.includes("世界信息")&&!e.key.includes("world_")),e!==_.tavern_commands.length&&console.log("【数据植入】已过滤AI生成的世界相关命令，避免数据冲突")}_.tavern_commands||(_.tavern_commands=[]),_.tavern_commands.push({action:"set",scope:"chat",key:"世界信息",value:i}),console.log("【数据植入】已添加世界数据植入命令，确保世界数据完整保存")}else console.log("【数据植入】无缓存的世界数据，使用AI生成的默认数据");return console.log("【验证】AI生成的命令数量:",_.tavern_commands?.length||0),{..._,processedOrigin:s,processedSpiritRoot:m,cachedWorldData:i}}catch(e){if(console.error("【神识印记】生成天道初言过程中发生严重错误:",e),e instanceof Error)throw new Error(`生成初始消息失败: ${e.message}\n${e.stack}`);throw new Error(`生成初始消息时发生未知错误: ${String(e)}`)}var r}async function v(e,n,a){console.log("【剧情推进】准备生成游戏GM响应，数据:",{currentGameData:e,playerAction:n});try{console.log("【优化】使用 currentGameData 参数，不再重复获取酒馆变量");const o=e=>{try{const n=e?.玩家角色状态||{},t={凡人:0,练气:1,炼气:1,筑基:2,金丹:3,元婴:4,化神:5,炼虚:6,合体:7,渡劫:8}[String(n?.["境界"]?.["名称"]||"凡人")]||0,a={hp:n?.气血||{当前:0,上限:0},mp:n?.灵气||{当前:0,上限:0},spirit:n?.神识||{当前:0,上限:0},lifespan:n?.寿命||{当前:0,上限:0}},o=e?.角色基础信息?.先天六司||{},r=e=>Math.max(0,Math.min(10,Number(e||0))),l={根骨:r(o?.根骨),灵性:r(o?.灵性),悟性:r(o?.悟性),气运:r(o?.气运),魅力:r(o?.魅力),心性:r(o?.心性)},i=Object.values(l).reduce((e,n)=>e+n,0),c=e?.装备栏||{};let s=0;const d=[];["装备1","装备2","装备3","装备4","装备5","装备6"].forEach(e=>{const n=c?.[e];if(n&&"object"==typeof n){d.push(n.名称||e);const t=n.装备增幅||{};if(s+=.5*Number(t?.气血上限||0),s+=.3*Number(t?.灵气上限||0),s+=.2*Number(t?.神识上限||0),t?.后天六司){const e=Object.values(t.后天六司).reduce((e,n)=>e+Number(n||0),0);s+=2*e}}});const m=Number(a.hp?.最大||a.hp?.上限||0),p=Number(a.mp?.最大||a.mp?.上限||0),v=Number(a.spirit?.最大||a.spirit?.上限||0),u=Math.round(100*t+.5*m+.3*p+.2*v+2*i+s),g=Array.isArray(n?.状态效果)?n.状态效果.filter(e=>"buff"===String(e?.类型).toLowerCase()):[],f={alchemy:{success_chance:Math.round(Math.min(95,Math.max(5,(5*l.悟性+(n?.神识?.当前||30)/10)/50*50+l.气运))),crit_chance:Math.round(Math.max(1,l.气运+l.悟性/2)),description:"基于当前悟性和神识，炼丹成功率较高。"},crafting:{success_chance:Math.round(Math.min(95,Math.max(5,(5*l.根骨+(n?.灵气?.当前||0)/20)/60*50+l.气运))),crit_chance:Math.round(Math.max(1,l.气运+l.根骨/2)),description:"基于当前根骨和灵气，炼器成功率中等。"},cultivation:{efficiency:(()=>{let n=5;const t=e?.角色基础信息?.灵根,a="string"==typeof t?t:t?.名称||"";a.includes("仙品")&&(n+=5),a.includes("极品")&&(n+=3);const o=e?.修炼功法,r=o?.功法||o;return"仙"===r?.品质?.quality&&(n+=5),"天"===r?.品质?.quality&&(n+=3),Math.round(n)})(),breakthrough_chance:Math.round(Math.min(80,Math.max(5,10+2*l.心性+l.气运))),description:"仙品灵根和仙品功法带来了极高的修炼效率。"},exploration:{risk_level:(()=>{let a=5;const o=n?.["位置"]?.["描述"],r="string"==typeof o?o:"object"==typeof o&&null!==o?o.描述:"",i=e?.世界信息,c=i?.地点信息?.find(e=>e.名称===r);return"极危险"===c?.["安全等级"]&&(a+=5),"危险"===c?.["安全等级"]&&(a+=3),Math.round(Math.max(1,Math.min(10,a-(t+l.气运/2))))})(),loot_chance:Math.round(Math.min(90,Math.max(10,20+5*l.气运))),description:"当前位置较为危险，但高气运可能带来意外收获。"},social:{persuasion_chance:Math.round(Math.min(95,Math.max(5,50+5*l.魅力))),intimidation_chance:Math.round(Math.min(95,Math.max(5,20+2*l.根骨+5*t))),description:"高魅力使得说服他人变得容易。"}},b=n?.位置?.描述,h="string"==typeof b?b:"object"==typeof b&&null!==b?b.描述:"未知";return{battle_power:u,realm_level:t,location:h,vitals:{hp:a.hp,mp:a.mp,spirit:a.spirit,lifespan:a.lifespan},active_buffs_count:g.length,active_buffs:g.map(e=>e?.状态名称).filter(Boolean).slice(0,10),equipment_names:d,potential_actions:f}}catch{return null}},r=e.saveData||{};o(r);let l=[];try{const e=r?.["记忆"]||r?.记忆,n=e?.["短期记忆"]||e?.短期记忆;Array.isArray(n)&&(l=n.filter(e=>"string"==typeof e))}catch(e){console.warn("【提示词连续性】提取短期记忆失败（忽略）:",e)}const i=r?.系统||{nsfwMode:!0,nsfwGenderFilter:"female"},d=!1!==i.nsfwMode,m=i.nsfwGenderFilter||"female";console.log("【剧情推进】系统设置:",{nsfwMode:d,nsfwGenderFilter:m});const{useUIStore:p}=await Promise.resolve().then(t.bind(t,9173)),v=p();let u=function(e,n,t){return c(e,n,t)}(r,v.autoGenerateNpc,v.minNpcCount);u+=`\n\n# 当前系统设置（必须严格遵守）\nnsfwMode: ${d}\nnsfwGenderFilter: ${m}\n\n`,d?(u+="⚠️ **【最高优先级-强制执行】私密信息生成规则**\n",u+="当创建或更新NPC时，必须检查性别并严格按照以下规则生成私密信息：\n\n","female"===m?(u+='✅ 女性NPC（性别="女"）：必须生成完整的私密信息对象（14个必填字段）\n',u+='❌ 男性NPC（性别="男"）：不生成私密信息字段\n\n'):"male"===m?(u+='✅ 男性NPC（性别="男"）：必须生成完整的私密信息对象（14个必填字段，使用"是否为处男"）\n',u+='❌ 女性NPC（性别="女"）：不生成私密信息字段\n\n'):(u+="✅ 所有NPC（无论性别）：必须生成完整的私密信息对象（14个必填字段）\n",u+='   - 女性使用"是否为处女"\n',u+='   - 男性使用"是否为处男"\n\n'),u+="📋 私密信息必填字段清单（缺一不可）：\n",u+="1. 是否为处女/处男 (boolean)\n",u+="2. 身体部位 (Array，必须包含3-5个部位对象)\n",u+="   每个部位：{部位名称, 开发度(0-100), 敏感度(0-100), 特征描述, 特殊印记}\n",u+='3. 性格倾向 (string: "纯情"|"主动"|"被动"|"淫荡"|"M"|"S"|"双性")\n',u+='4. 性取向 (string: "异性恋"|"同性恋"|"双性恋"|"泛性恋")\n',u+="5. 性癖好 (Array, 0-3个元素)\n",u+="6. 性渴望程度 (number, 0-100)\n",u+='7. 当前性状态 (string: "正常"|"微湿"|"兴奋"|"发情"|"高潮")\n',u+="8. 体液分泌状态 (string, 描述性文字)\n",u+="9. 性交总次数 (number, 非负整数)\n",u+="10. 性伴侣数量 (number, 非负整数)\n",u+='11. 性伴侣名单 (Array<string>, 禁止使用"保密"等占位符)\n',u+='12. 最近一次性行为时间 (string, 时间格式或"从未")\n',u+="13. 特殊体质 (Array, 0-N个元素)\n\n",u+="⚠️ 逻辑一致性检查：\n",u+="   - 是否为处女/处男=true → 性交总次数=0 且 性伴侣数量=0 且 性伴侣名单=[]\n",u+="   - 性伴侣数量 必须等于 性伴侣名单.length\n\n"):u+='⚠️ nsfwMode=false：生成NPC时不要包含"私密信息"字段\n\n';const g=`<玩家的行动趋向>\n${n||"静观其变。"}</玩家的行动趋向>`;console.log("【剧情推进】系统提示词长度:",u.length),console.log("【剧情推进】短期记忆数量:",l.length),console.log("【剧情推进】玩家行动:",n);const f=(0,s.getTavernHelper)();if(!f)throw new Error("酒馆助手未初始化");const b=l.length>0?l.slice().reverse().join("\n\n---\n\n"):"【仙道元年元月初一 00:00】旅途刚刚开始...";console.log("【剧情推进-调试】注入记忆长度:",b.length),console.log("【剧情推进-调试】注入记忆前300字符:",b.substring(0,300));const h=await f.generate({user_input:g,injects:[{position:"in_chat",depth:0,role:"system",content:u,should_scan:!1},{position:"in_chat",depth:1,role:"assistant",content:b,should_scan:!0}],max_chat_history:0,should_stream:a||!1});if(console.log("【剧情推进-调试】AI原始返回类型:",typeof h),console.log("【剧情推进-调试】AI原始返回值前500字符:","string"==typeof h?h.substring(0,500):JSON.stringify(h).substring(0,500)),h&&"object"==typeof h&&"error"in h){const e=h.error,n=e.message||JSON.stringify(e);throw console.error("【剧情推进-错误】AI服务返回错误:",n),console.error("【剧情推进-错误】完整错误对象:",h),new Error(`AI服务错误: ${n}。这可能是由于：1) 提示词过长超过模型上下文限制 2) 服务端暂时不可用 3) API配置问题。请稍后重试。`)}let y;try{if("string"==typeof h){let e=h.trim();const n=e.match(/```(?:json)?\s*([\s\S]*?)\s*```/);n&&(e=n[1].trim()),y=JSON.parse(e)}else{if(!h||"object"!=typeof h)throw new Error("AI返回了空的响应");y=h}}catch(e){throw console.error("【剧情推进】JSON解析失败:",e),console.error("【剧情推进】原始返回值:",h),new Error("AI返回的响应格式无效")}if(!y||!y.text)throw console.warn("【剧情推进】AI返回的响应结构无效:",y),new Error("AI生成的游戏响应格式无效或内容缺失");if(Array.isArray(y.tavern_commands)||(console.warn("【剧情推进】AI未返回tavern_commands数组，设置为空数组"),y.tavern_commands=[]),d&&y.tavern_commands){const e=y.tavern_commands.filter(e=>!("set"!==e.action||!e.key.startsWith("人物关系."))&&2===e.key.split(".").length);if(e.length>0){console.log(`【NSFW验证】检测到 ${e.length} 个NPC创建命令，开始验证...`);for(const n of e){const e=n.value;if(!e||"object"!=typeof e)continue;const t=e.性别,a=e.私密信息&&"object"==typeof e.私密信息;let o=!1;if(("all"===m||"female"===m&&"女"===t||"male"===m&&"男"===t)&&(o=!0),o&&!a)throw console.error(`【NSFW验证失败】NPC "${e.名字}" (性别: ${t}) 缺少私密信息字段！`),console.error("【NSFW验证】当前设置:",{nsfwMode:d,nsfwGenderFilter:m}),new Error(`AI生成的NPC "${e.名字}" 缺少必需的私密信息字段。nsfwMode=${d}, nsfwGenderFilter=${m}，性别=${t}。将自动重试生成。`);if(a){const n=e.私密信息,a=["女"===t?"是否为处女":"是否为处男","身体部位","性格倾向","性取向","性癖好","性渴望程度","当前性状态","体液分泌状态","性交总次数","性伴侣数量","性伴侣名单","最近一次性行为时间","特殊体质"].filter(e=>!(e in n));if(a.length>0)throw console.error(`【NSFW验证失败】NPC "${e.名字}" 的私密信息缺少字段:`,a),new Error(`AI生成的NPC "${e.名字}" 私密信息不完整，缺少字段: ${a.join(", ")}。将自动重试生成。`);if(!Array.isArray(n.身体部位)||n.身体部位.length<3)throw console.error(`【NSFW验证失败】NPC "${e.名字}" 的身体部位数组不足3个`),new Error(`AI生成的NPC "${e.名字}" 的身体部位数组不完整（需要至少3个部位）。将自动重试生成。`);console.log(`【NSFW验证通过】NPC "${e.名字}" 的私密信息字段完整`)}}}}return console.log("【剧情推进】成功生成响应，命令数量:",y.tavern_commands?.length||0),y}catch(e){throw console.error("【剧情推进】生成游戏响应失败:",e),e}}},7280:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.inventory-content[data-v-61146166] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n  overflow: hidden;\n}\n\n/* 自定义确认弹窗样式 */\n.custom-confirm-overlay[data-v-61146166] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  z-index: 2000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n}\n.custom-confirm-modal[data-v-61146166] {\n  background: var(--color-surface);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 400px;\n  overflow: hidden;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: modal-appear-61146166 0.3s ease-out;\n  border: 1px solid var(--color-primary-border);\n}\n.confirm-header[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px 16px 24px;\n  border-bottom: 1px solid var(--color-border);\n  background: var(--color-primary-light);\n}\n.confirm-header h3[data-v-61146166] {\n  margin: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.confirm-close-btn[data-v-61146166] {\n  background: none;\n  border: none;\n  padding: 4px;\n  border-radius: 6px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  transition: all 0.2s ease;\n}\n.confirm-close-btn[data-v-61146166]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.confirm-content[data-v-61146166] {\n  padding: 24px;\n}\n.confirm-content p[data-v-61146166] {\n  margin: 0;\n  color: var(--color-text);\n  line-height: 1.6;\n  white-space: pre-line;\n}\n.confirm-actions[data-v-61146166] {\n  display: flex;\n  gap: 12px;\n  padding: 16px 24px 24px 24px;\n  justify-content: flex-end;\n}\n.confirm-btn[data-v-61146166] {\n  padding: 10px 20px;\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  min-width: 80px;\n}\n.cancel-btn[data-v-61146166] {\n  background: var(--color-surface-hover);\n  color: var(--color-text-secondary);\n}\n.cancel-btn[data-v-61146166]:hover {\n  background: var(--color-surface-light);\n  color: var(--color-text);\n}\n.confirm-btn.confirm-btn[data-v-61146166] {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.confirm-btn.confirm-btn[data-v-61146166]:hover {\n  background: var(--color-primary-hover);\n}\n\n/* 移动端模态框 */\n.item-modal-overlay[data-v-61146166] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  backdrop-filter: blur(4px);\n}\n.item-modal[data-v-61146166] {\n  background: var(--color-surface);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 400px;\n  max-height: 80vh;\n  overflow: hidden;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: modal-appear-61146166 0.3s ease-out;\n  border: 1px solid var(--color-primary-border);\n}\n@keyframes modal-appear-61146166 {\nfrom {\n    opacity: 0;\n    transform: scale(0.9) translateY(20px);\n}\nto {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n}\n}\n.modal-header[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid var(--color-border);\n  background: var(--color-primary-light);\n}\n.modal-header h3[data-v-61146166] {\n  margin: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n}\n.modal-close-btn[data-v-61146166] {\n  background: none;\n  border: none;\n  padding: 4px;\n  border-radius: 6px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  transition: all 0.2s ease;\n}\n.modal-close-btn[data-v-61146166]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.modal-content[data-v-61146166] {\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n.modal-icon-simple[data-v-61146166] {\n  width: 80px;\n  height: 80px;\n  border-radius: 12px;\n  border: 3px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 16px;\n  background: var(--color-surface-hover);\n  font-weight: bold;\n  font-size: 14px;\n  color: var(--color-text);\n}\n.modal-info[data-v-61146166] {\n  width: 100%;\n}\n.modal-meta[data-v-61146166] {\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n  margin-bottom: 12px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n.grade-display[data-v-61146166] {\n  font-size: 0.8rem;\n  font-weight: bold;\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid currentColor;\n  white-space: nowrap;\n}\n\n/* 品级颜色样式 */\n.grade-display.grade-broken[data-v-61146166] {\n  background: #6b7280;\n  color: white;\n  border-color: #6b7280;\n}\n.grade-display.grade-low[data-v-61146166] {\n  background: #10b981; /* 绿色 - 下品 */\n  color: white;\n  border-color: #10b981;\n}\n.grade-display.grade-mid[data-v-61146166] {\n  background: #3b82f6; /* 蓝色 - 中品 */\n  color: white;\n  border-color: #3b82f6;\n}\n.grade-display.grade-high[data-v-61146166] {\n  background: #8b5cf6; /* 紫色 - 上品 */\n  color: white;\n  border-color: #8b5cf6;\n}\n.grade-display.grade-perfect[data-v-61146166] {\n  background: #f59e0b; /* 金色 - 极品 */\n  color: white;\n  border-color: #f59e0b;\n}\n.grade-display.grade-unknown[data-v-61146166] {\n  background: #9ca3af;\n  color: white;\n  border-color: #9ca3af;\n}\n.modal-description[data-v-61146166] {\n  color: var(--color-text);\n  line-height: 1.6;\n  margin-bottom: 16px;\n}\n.modal-attributes[data-v-61146166] {\n  background: var(--color-surface-light);\n  border-radius: 8px;\n  padding: 12px;\n  margin-top: 16px;\n}\n.modal-attributes h4[data-v-61146166] {\n  margin: 0 0 8px 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n}\n.modal-actions[data-v-61146166] {\n  display: flex;\n  gap: 8px;\n  padding: 16px 20px;\n  border-top: 1px solid var(--color-border);\n}\n\n/* 主内容区域 */\n.inventory-content[data-v-61146166] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n/* 标签导航 */\n.tabs-header[data-v-61146166] {\n  background: var(--color-surface);\n  border-bottom: 1px solid var(--color-border);\n  padding: 16px;\n}\n.tabs-nav[data-v-61146166] {\n  display: flex;\n  gap: 4px;\n  margin-bottom: 16px;\n}\n.tab-btn[data-v-61146166] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 16px;\n  border: none;\n  border-radius: 8px;\n  background: transparent;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-weight: 500;\n}\n.tab-btn[data-v-61146166]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.tab-btn.active[data-v-61146166] {\n  background: var(--color-primary);\n  color: white;\n}\n\n/* 工具栏 */\n.tools-section[data-v-61146166] {\n  display: flex;\n  gap: 12px;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.search-box[data-v-61146166] {\n  position: relative;\n  flex: 1;\n  min-width: 200px;\n}\n.search-icon[data-v-61146166] {\n  position: absolute;\n  left: 12px;\n  top: 50%;\n  transform: translateY(-50%);\n  color: var(--color-text-secondary);\n  z-index: 1;\n}\n.search-box input[data-v-61146166] {\n  width: 100%;\n  padding: 10px 12px 10px 40px;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-background);\n  font-size: 14px;\n  transition: all 0.2s ease;\n}\n.search-box input[data-v-61146166]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.1);\n}\n.filter-buttons[data-v-61146166] {\n  display: flex;\n  gap: 8px;\n}\n.filter-select[data-v-61146166] {\n  padding: 8px 12px;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-background);\n  font-size: 13px;\n  min-width: 80px;\n}\n.refresh-btn[data-v-61146166] {\n  padding: 8px;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-background);\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 32px;\n  height: 32px;\n}\n.refresh-btn[data-v-61146166]:hover:not(:disabled) {\n  background: var(--color-surface-hover);\n  color: var(--color-primary);\n  border-color: var(--color-primary);\n}\n.refresh-btn[data-v-61146166]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.refresh-btn .spinning[data-v-61146166] {\n  animation: spin-61146166 1s linear infinite;\n}\n\n/* 标签内容 */\n.tab-content[data-v-61146166] {\n  flex: 1;\n  overflow: hidden;\n}\n\n/* 物品标签 */\n.items-tab[data-v-61146166] {\n  display: flex;\n  height: 100%;\n}\n.items-grid[data-v-61146166] {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n  gap: 18px;\n  align-content: start;\n  background: var(--color-background);\n}\n.grid-placeholder[data-v-61146166] {\n  grid-column: 1 / -1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n.filter-tip[data-v-61146166] {\n  font-size: 0.8rem;\n  color: var(--color-text-muted);\n  margin-top: 8px;\n  opacity: 0.8;\n}\n.loading-spinner[data-v-61146166] {\n  width: 32px;\n  height: 32px;\n  border: 3px solid var(--color-border);\n  border-top: 3px solid var(--color-primary);\n  border-radius: 50%;\n  animation: spin-61146166 1s linear infinite;\n  margin-bottom: 16px;\n}\n@keyframes spin-61146166 {\nto {\n    transform: rotate(360deg);\n}\n}\n\n/* 物品卡片 - 重新设计美观布局 */\n.item-card[data-v-61146166] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 8px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  flex-direction: column;\n  height: 140px;\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n.item-card[data-v-61146166]:hover {\n  border-color: var(--color-primary);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  background: var(--color-surface-light);\n}\n\n/* 顶部区域：图标和品质 */\n.item-top-section[data-v-61146166] {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n  margin-bottom: 8px;\n}\n.item-icon-area[data-v-61146166] {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  border: 2px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-background);\n  position: relative;\n}\n.item-type-icon[data-v-61146166] {\n  font-size: 24px;\n  opacity: 0.9;\n}\n.item-quality-badge[data-v-61146166] {\n  position: absolute;\n  top: -6px;\n  right: -6px;\n  font-size: 10px;\n  font-weight: bold;\n  padding: 3px 6px;\n  border-radius: 6px;\n  background: var(--color-surface);\n  border: 1px solid currentColor;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n  z-index: 2;\n  min-width: 20px;\n  text-align: center;\n}\n\n/* 数量显示 - 更大更显眼 */\n.item-quantity-display[data-v-61146166] {\n  position: absolute;\n  top: 6px;\n  right: 6px;\n  /* 仅改变文字颜色，不改背景 */\n  background: transparent;\n  color: var(--color-accent, #7c4dff);\n  font-size: 12px;\n  font-weight: 700;\n  padding: 0;\n  border-radius: 0;\n  box-shadow: none;\n  border: none;\n  z-index: 4;\n  min-width: 0;\n  text-align: right;\n}\n\n/* 名称区域 */\n.item-name-section[data-v-61146166] {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: 0 4px;\n}\n.item-name[data-v-61146166] {\n  font-size: 12px;\n  font-weight: 600;\n  line-height: 1.3;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  word-break: break-word;\n}\n\n/* 底部区域：类型和品级 */\n.item-bottom-section[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 4px;\n  margin-top: auto;\n  padding-top: 4px;\n}\n.item-type-label[data-v-61146166] {\n  font-size: 9px;\n  color: var(--color-text-secondary);\n  background: var(--color-background);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.item-grade-info[data-v-61146166] {\n  font-size: 8px;\n  font-weight: bold;\n  padding: 2px 4px;\n  border-radius: 4px;\n  border: 1px solid currentColor;\n  background: rgba(255, 255, 255, 0.9);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  flex-shrink: 0;\n}\n\n/* 品级样式 - 简化版本 */\n.grade-broken[data-v-61146166] {\n  background: #6b7280;\n  color: white;\n}\n.grade-low[data-v-61146166] {\n  background: #10b981; /* 绿色 - 下品 */\n  color: white;\n}\n.grade-mid[data-v-61146166] {\n  background: #3b82f6; /* 蓝色 - 中品 */\n  color: white;\n}\n.grade-high[data-v-61146166] {\n  background: #8b5cf6; /* 紫色 - 上品 */\n  color: white;\n}\n.grade-perfect[data-v-61146166] {\n  background: #f59e0b; /* 金色 - 极品 */\n  color: white;\n}\n.grade-unknown[data-v-61146166] {\n  background: #9ca3af;\n  color: white;\n}\n\n/* 灵石品质样式 - 颜色递增 */\n.grade-common[data-v-61146166] {\n  background: linear-gradient(135deg, #9ca3af, #6b7280);\n  border-color: #9ca3af;\n  color: white;\n  box-shadow: 0 2px 8px rgba(156, 163, 175, 0.3);\n}\n.grade-rare[data-v-61146166] {\n  background: linear-gradient(135deg, #3b82f6, #2563eb);\n  border-color: #3b82f6;\n  color: white;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4);\n}\n.grade-epic[data-v-61146166] {\n  background: linear-gradient(135deg, #8b5cf6, #7c3aed);\n  border-color: #8b5cf6;\n  color: white;\n  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4);\n}\n.grade-legend[data-v-61146166] {\n  background: linear-gradient(135deg, #f59e0b, #d97706);\n  border-color: #f59e0b;\n  color: white;\n  box-shadow: 0 2px 12px rgba(245, 158, 11, 0.5);\n}\n\n/* 桌面端详情侧边栏 */\n.item-details-sidebar[data-v-61146166] {\n  width: 320px;\n  border-left: 1px solid var(--color-border);\n  background: var(--color-surface);\n  display: flex;\n  flex-direction: column;\n}\n.details-content[data-v-61146166] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.details-header[data-v-61146166] {\n  padding: 20px;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.details-icon-large[data-v-61146166] {\n  width: 60px;\n  height: 60px;\n  border-radius: 10px;\n  border: 2px solid var(--color-border);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-background);\n  flex-shrink: 0;\n  font-weight: bold;\n  font-size: 12px;\n  color: var(--color-text);\n}\n.details-title-area h3[data-v-61146166] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n}\n.details-meta[data-v-61146166] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n.details-body[data-v-61146166] {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n}\n.details-description[data-v-61146166] {\n  color: var(--color-text);\n  line-height: 1.6;\n  margin-bottom: 20px;\n}\n.details-attributes h4[data-v-61146166] {\n  margin: 0 0 12px 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n}\n.details-placeholder[data-v-61146166] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n.details-actions[data-v-61146166] {\n  padding: 16px 20px;\n  border-top: 1px solid var(--color-border);\n  display: flex;\n  gap: 8px;\n}\n\n/* 灵石标签 */\n.currency-tab[data-v-61146166] {\n  padding: 24px;\n  overflow-y: auto;\n}\n.currency-grid[data-v-61146166] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 16px;\n  width: 100%;\n}\n.currency-card[data-v-61146166] {\n  background: var(--color-surface);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  transition: all 0.3s ease;\n  cursor: default;\n  position: relative;\n  overflow: hidden;\n}\n.currency-card[data-v-61146166]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 4px;\n  opacity: 0.8;\n  transition: opacity 0.3s ease;\n}\n.currency-card.grade-common[data-v-61146166]::before {\n  background: linear-gradient(90deg, #9ca3af, #6b7280);\n}\n.currency-card.grade-rare[data-v-61146166]::before {\n  background: linear-gradient(90deg, #3b82f6, #2563eb);\n}\n.currency-card.grade-epic[data-v-61146166]::before {\n  background: linear-gradient(90deg, #8b5cf6, #7c3aed);\n}\n.currency-card.grade-legend[data-v-61146166]::before {\n  background: linear-gradient(90deg, #f59e0b, #d97706);\n}\n.currency-card[data-v-61146166]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);\n}\n.currency-card[data-v-61146166]:hover::before {\n  opacity: 1;\n}\n.currency-card-top[data-v-61146166] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.currency-icon[data-v-61146166] {\n  flex-shrink: 0;\n  color: var(--color-text-secondary);\n  transition: color 0.3s ease;\n}\n\n/* 灵石图标颜色 */\n.icon-grade-common[data-v-61146166] {\n  color: #9ca3af;\n}\n.icon-grade-rare[data-v-61146166] {\n  color: #3b82f6;\n}\n.icon-grade-epic[data-v-61146166] {\n  color: #8b5cf6;\n}\n.icon-grade-legend[data-v-61146166] {\n  color: #f59e0b;\n}\n.currency-info[data-v-61146166] {\n  flex: 1;\n}\n.currency-amount[data-v-61146166] {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--color-text);\n  margin-bottom: 4px;\n}\n.currency-label[data-v-61146166] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n}\n\n/* 兑换功能 */\n.currency-exchange[data-v-61146166] {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n.exchange-btn[data-v-61146166] {\n  flex: 1;\n  padding: 6px 12px;\n  border: 1px solid var(--color-primary);\n  border-radius: 6px;\n  background: var(--color-surface);\n  color: var(--color-primary);\n  font-size: 0.8rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  position: relative;\n  overflow: hidden;\n}\n.exchange-btn[data-v-61146166]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n  transition: left 0.5s ease;\n}\n.exchange-btn[data-v-61146166]:hover:not(:disabled) {\n  background: var(--color-primary);\n  color: white;\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n.exchange-btn[data-v-61146166]:hover:not(:disabled)::before {\n  left: 100%;\n}\n.exchange-btn.down[data-v-61146166] {\n  border-color: var(--color-warning);\n  color: var(--color-warning);\n}\n.exchange-btn.down[data-v-61146166]:hover:not(:disabled) {\n  background: var(--color-warning);\n  color: white;\n  box-shadow: 0 4px 12px rgba(var(--color-warning-rgb), 0.3);\n}\n.exchange-btn[data-v-61146166]:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n.exchange-btn[data-v-61146166]:active:not(:disabled) {\n  transform: translateY(0) scale(0.98);\n}\n\n/* 按钮样式 */\n.action-btn[data-v-61146166] {\n  flex: 1;\n  padding: 12px;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.action-btn[data-v-61146166]:hover {\n  background: var(--color-surface-light);\n  transform: translateY(-1px);\n}\n.use-btn[data-v-61146166] {\n  background: var(--color-primary);\n  border-color: var(--color-primary);\n  color: white;\n}\n.use-btn[data-v-61146166]:hover {\n  background: var(--color-primary-hover);\n}\n.discard-btn[data-v-61146166] {\n  background: var(--color-error);\n  border-color: var(--color-error);\n  color: white;\n}\n.discard-btn[data-v-61146166]:hover {\n  background: var(--color-error-hover);\n}\n\n/* 属性文本显示 */\n.attribute-text[data-v-61146166] {\n  background: var(--color-background);\n  border-radius: 6px;\n  padding: 12px;\n  font-size: 0.9rem;\n  color: var(--color-text);\n  line-height: 1.4;\n  word-break: break-all;\n}\n\n/* 功法效果样式 */\n.skill-effects[data-v-61146166] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.effect-item[data-v-61146166] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 0;\n}\n.effect-label[data-v-61146166] {\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  min-width: 80px;\n}\n.effect-value[data-v-61146166] {\n  color: var(--color-success);\n  font-weight: 500;\n}\n.special-abilities[data-v-61146166] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 4px;\n}\n.ability-tag[data-v-61146166] {\n  background: var(--color-primary);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n\n/* 功法技能样式 */\n.technique-skills[data-v-61146166] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.skill-item[data-v-61146166] {\n  background: var(--color-background);\n  border-radius: 8px;\n  padding: 12px;\n  border: 1px solid var(--color-border);\n}\n.skill-header[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.skill-name[data-v-61146166] {\n  font-weight: 600;\n  color: var(--color-text);\n}\n.skill-type[data-v-61146166] {\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n.skill-type.type-攻击[data-v-61146166] {\n  background: var(--color-error);\n  color: white;\n}\n.skill-type.type-防御[data-v-61146166] {\n  background: var(--color-info);\n  color: white;\n}\n.skill-type.type-辅助[data-v-61146166] {\n  background: var(--color-success);\n  color: white;\n}\n.skill-type.type-移动[data-v-61146166] {\n  background: var(--color-warning);\n  color: white;\n}\n.skill-type.type-其他[data-v-61146166] {\n  background: var(--color-text-secondary);\n  color: white;\n}\n.skill-description[data-v-61146166] {\n  color: var(--color-text);\n  font-size: 0.9rem;\n  line-height: 1.4;\n  margin-bottom: 6px;\n}\n.skill-unlock-requirement[data-v-61146166] {\n  font-size: 0.75rem;\n  color: var(--color-warning);\n  font-weight: 600;\n  padding: 2px 8px;\n  background: rgba(var(--color-warning-rgb), 0.1);\n  border-radius: 4px;\n  margin-left: auto;\n}\n.skill-cost[data-v-61146166] {\n  color: var(--color-info);\n  font-size: 0.8rem;\n  font-weight: 500;\n  margin-top: 4px;\n}\n.skill-unlock[data-v-61146166] {\n  color: var(--color-text-secondary);\n  font-size: 0.8rem;\n}\n.cultivate-btn[data-v-61146166] {\n  background: var(--color-info);\n  border-color: var(--color-info);\n  color: white;\n}\n.cultivate-btn[data-v-61146166]:hover {\n  background: var(--color-info-hover);\n}\n.equip-btn[data-v-61146166] {\n  background: var(--color-success);\n  border-color: var(--color-success);\n  color: white;\n}\n.equip-btn[data-v-61146166]:hover {\n  background: var(--color-success-hover);\n}\n\n/* 品质样式系统 - 内联文字样式，不填充整行 */\n/* 神阶 - 深红色（最高品质） */\n.text-quality-神[data-v-61146166],\n.text-quality-神阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #dc2626, #b91c1c) !important;\n  border: 1px solid #dc2626 !important;\n  box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 仙阶 - 粉紫色 */\n.text-quality-仙[data-v-61146166],\n.text-quality-仙阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #ec4899, #db2777) !important;\n  border: 1px solid #ec4899 !important;\n  box-shadow: 0 2px 8px rgba(236, 72, 153, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 天阶 - 蓝色 */\n.text-quality-天[data-v-61146166],\n.text-quality-天阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #3b82f6, #2563eb) !important;\n  border: 1px solid #3b82f6 !important;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 地阶 - 橙色 */\n.text-quality-地[data-v-61146166],\n.text-quality-地阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #f59e0b, #d97706) !important;\n  border: 1px solid #f59e0b !important;\n  box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 玄阶 - 紫色 */\n.text-quality-玄[data-v-61146166],\n.text-quality-玄阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;\n  border: 1px solid #8b5cf6 !important;\n  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 黄阶 - 金黄色 */\n.text-quality-黄[data-v-61146166],\n.text-quality-黄阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #eab308, #ca8a04) !important;\n  border: 1px solid #eab308 !important;\n  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 凡阶 - 灰色（最低品质） */\n.text-quality-凡[data-v-61146166],\n.text-quality-凡阶[data-v-61146166] {\n  color: white !important;\n  background: linear-gradient(135deg, #6b7280, #4b5563) !important;\n  border: 1px solid #6b7280 !important;\n  box-shadow: 0 2px 8px rgba(107, 114, 128, 0.3) !important;\n  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;\n  padding: 2px 6px !important;\n  border-radius: 4px !important;\n  display: inline !important;\n  white-space: nowrap !important;\n}\n\n/* 边框样式也需要修复 */\n.border-quality-神[data-v-61146166] {\n  border-color: #dc2626 !important;\n}\n.border-quality-仙[data-v-61146166] {\n  border-color: #ec4899 !important;\n}\n.border-quality-天[data-v-61146166] {\n  border-color: #3b82f6 !important;\n}\n.border-quality-地[data-v-61146166] {\n  border-color: #f59e0b !important;\n}\n.border-quality-玄[data-v-61146166] {\n  border-color: #8b5cf6 !important;\n}\n.border-quality-凡[data-v-61146166] {\n  border-color: #6b7280 !important;\n}\n.border-quality-凡[data-v-61146166] {\n  border-color: #6b7280 !important;\n}\n\n/* 装备标签页样式 */\n.equipment-tab[data-v-61146166] {\n  height: 100%;\n  overflow-y: auto;\n}\n.item-grade[data-v-61146166] {\n  border-radius: 5px;\n  border: 2px solid #9ca3af;\n}\n.equipment-content[data-v-61146166] {\n  padding: 20px;\n}\n.equipment-header[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 2px solid var(--color-border);\n}\n.equipment-title[data-v-61146166] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: 0;\n  font-size: 1.4rem;\n  font-weight: 700;\n  color: var(--color-text);\n}\n.equipment-stats[data-v-61146166] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.equipment-stats .stat-item[data-v-61146166] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n}\n.equipment-stats .stat-label[data-v-61146166] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n}\n.equipment-stats .stat-value[data-v-61146166] {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: var(--color-primary);\n}\n\n/* 装备网格 */\n.equipment-grid[data-v-61146166] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));\n  gap: 20px;\n}\n.equipment-slot[data-v-61146166] {\n  background: var(--color-surface);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  transition: all 0.3s ease;\n  min-height: 160px;\n  position: relative;\n}\n.equipment-slot.has-equipment[data-v-61146166] {\n  border-color: var(--color-success);\n  box-shadow: 0 4px 12px rgba(var(--color-success-rgb), 0.1);\n}\n.equipment-slot.has-equipment[data-v-61146166]:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 8px 25px rgba(var(--color-success-rgb), 0.2);\n}\n.equipment-slot.empty-slot[data-v-61146166] {\n  border-style: dashed;\n  border-color: var(--color-border);\n}\n.slot-header[data-v-61146166] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.slot-name[data-v-61146166] {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  padding: 4px 8px;\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  display: inline-block;\n}\n.slot-actions[data-v-61146166] {\n  display: flex;\n  gap: 4px;\n}\n\n/* 卸下按钮样式优化 */\n.unequip-btn[data-v-61146166] {\n  padding: 8px 12px;\n  background: linear-gradient(135deg, #ef4444, #dc2626);\n  border: 1px solid #ef4444;\n  border-radius: 8px;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 4px;\n  font-size: 12px;\n  font-weight: 600;\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n  position: relative;\n  overflow: hidden;\n}\n.unequip-btn[data-v-61146166]::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);\n  transition: left 0.5s ease;\n}\n.unequip-btn[data-v-61146166]:hover {\n  background: linear-gradient(135deg, #dc2626, #b91c1c);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 16px rgba(239, 68, 68, 0.4);\n}\n.unequip-btn[data-v-61146166]:hover::before {\n  left: 100%;\n}\n.unequip-btn[data-v-61146166]:active {\n  transform: translateY(0);\n}\n\n/* 详情区域的卸下按钮保持与其他 action-btn 一致且不上浮 */\n.action-btn.unequip-btn[data-v-61146166] {\n  background: var(--color-danger);\n  border-color: var(--color-danger);\n  color: white;\n  border-radius: 8px;\n}\n.action-btn.unequip-btn[data-v-61146166]:hover {\n  background: var(--color-danger-hover);\n  transform: none;\n  box-shadow: none;\n}\n\n/* 装备物品显示 - 优化样式 */\n.equipment-item[data-v-61146166] {\n  display: flex;\n  gap: 16px;\n  align-items: flex-start;\n  background: var(--color-background);\n  border: 2px solid var(--color-border);\n  border-radius: 12px;\n  padding: 16px;\n  transition: all 0.3s ease;\n}\n.equipment-item[data-v-61146166]:hover {\n  border-color: var(--color-primary);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.1);\n  transform: translateY(-2px);\n}\n.item-icon[data-v-61146166] {\n  width: 60px;\n  height: 60px;\n  border-radius: 10px;\n  border: 3px solid;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-surface-light);\n  flex-shrink: 0;\n  font-weight: bold;\n  transition: all 0.3s ease;\n}\n.item-type-text[data-v-61146166] {\n  font-size: 12px;\n  font-weight: bold;\n  text-align: center;\n  color: var(--color-text);\n  line-height: 1.2;\n  word-break: break-word;\n}\n.item-info[data-v-61146166] {\n  flex: 1;\n  min-width: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.item-name[data-v-61146166] {\n  font-size: 1.1rem;\n  font-weight: 700;\n  margin-bottom: 0;\n  line-height: 1.3;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  color: var(--color-text);\n}\n.item-quality[data-v-61146166] {\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  border-radius: 6px;\n  margin-bottom: 0;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 4px 8px;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  width: fit-content;\n}\n.item-description[data-v-61146166] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  line-height: 1.5;\n  margin-bottom: 0;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  line-clamp: 3;\n  -webkit-box-orient: vertical;\n  background: var(--color-surface-light);\n  padding: 8px 12px;\n  border-radius: 8px;\n  border-left: 3px solid var(--color-primary);\n}\n.item-effects[data-v-61146166] {\n  background: var(--color-surface-light);\n  padding: 8px;\n  border-radius: 6px;\n  border-left: 3px solid var(--color-info);\n}\n.effects-title[data-v-61146166] {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: var(--color-info);\n  margin-bottom: 4px;\n}\n.effects-text[data-v-61146166] {\n  font-size: 0.8rem;\n  color: var(--color-text);\n  line-height: 1.3;\n}\n\n/* 空装备槽位 */\n.empty-equipment-slot[data-v-61146166] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  height: 120px;\n  gap: 8px;\n}\n.empty-icon[data-v-61146166] {\n  color: var(--color-text-muted);\n  opacity: 0.5;\n}\n.empty-text[data-v-61146166] {\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: var(--color-text-secondary);\n}\n.empty-hint[data-v-61146166] {\n  font-size: 0.8rem;\n  color: var(--color-text-muted);\n  font-style: italic;\n}\n\n/* 移动端适配 - 优化卡片显示 */\n@media (max-width: 640px) {\n.tabs-header[data-v-61146166] {\n    padding: 12px;\n}\n.tools-section[data-v-61146166] {\n    flex-direction: column;\n    gap: 8px;\n    align-items: stretch;\n}\n.search-box[data-v-61146166] {\n    min-width: auto;\n}\n.filter-buttons[data-v-61146166] {\n    justify-content: space-between;\n}\n.filter-select[data-v-61146166] {\n    flex: 1;\n}\n.items-grid[data-v-61146166] {\n    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n    padding: 16px;\n    gap: 12px;\n}\n.item-card[data-v-61146166] {\n    height: 130px;\n    padding: 6px;\n}\n.item-icon-area[data-v-61146166] {\n    width: 40px;\n    height: 40px;\n}\n.item-type-icon[data-v-61146166] {\n    font-size: 20px;\n}\n.item-name[data-v-61146166] {\n    font-size: 11px;\n}\n.item-type-label[data-v-61146166] {\n    font-size: 8px;\n    padding: 1px 4px;\n}\n.item-grade-info[data-v-61146166] {\n    font-size: 7px;\n    padding: 1px 3px;\n}\n.currency-grid[data-v-61146166] {\n    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));\n    gap: 12px;\n}\n.currency-card[data-v-61146166] {\n    padding: 16px;\n}\n.currency-amount[data-v-61146166] {\n    font-size: 1.25rem;\n}\n\n  /* 装备页面移动端适配 */\n.equipment-content[data-v-61146166] {\n    padding: 12px;\n}\n.equipment-header[data-v-61146166] {\n    flex-direction: column;\n    gap: 12px;\n    align-items: flex-start;\n}\n.equipment-grid[data-v-61146166] {\n    grid-template-columns: 1fr;\n    gap: 16px;\n}\n.equipment-slot[data-v-61146166] {\n    min-height: 140px;\n    padding: 12px;\n}\n}\n@media (max-width: 480px) {\n.tabs-nav[data-v-61146166] {\n    justify-content: center;\n}\n.tab-btn[data-v-61146166] {\n    flex: 1;\n    justify-content: center;\n}\n.items-grid[data-v-61146166] {\n    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n    gap: 10px;\n    padding: 12px;\n}\n.item-card[data-v-61146166] {\n    height: 120px;\n    padding: 5px;\n}\n.item-icon-area[data-v-61146166] {\n    width: 32px;\n    height: 32px;\n}\n.item-type-icon[data-v-61146166] {\n    font-size: 16px;\n}\n.item-name[data-v-61146166] {\n    font-size: 10px;\n}\n.item-type-label[data-v-61146166] {\n    font-size: 7px;\n    padding: 1px 3px;\n}\n.item-grade-info[data-v-61146166] {\n    font-size: 6px;\n    padding: 1px 2px;\n}\n.item-quality-badge[data-v-61146166] {\n    font-size: 6px;\n    padding: 1px 2px;\n}\n.item-quantity-badge[data-v-61146166] {\n    font-size: 8px;\n    padding: 1px 4px;\n}\n.currency-grid[data-v-61146166] {\n    grid-template-columns: 1fr;\n}\n.currency-card[data-v-61146166] {\n    padding: 14px;\n}\n}\n",""]);const i=l},7281:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.panel-header[data-v-1f5353f3] {\n  padding: 1rem;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n.panel-title[data-v-1f5353f3] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin: 0;\n  font-size: 1.2rem;\n  color: var(--color-text);\n}\n.header-actions[data-v-1f5353f3] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n.search-bar[data-v-1f5353f3] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 0.5rem;\n  min-width: 180px;\n  flex: 1 1 220px;\n}\n.search-input[data-v-1f5353f3] {\n  border: none;\n  outline: none;\n  background: transparent;\n  color: var(--color-text);\n  font-size: 0.875rem;\n  flex: 1;\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.panel-header[data-v-1f5353f3] {\n    flex-direction: column;\n    gap: 0.5rem;\n    align-items: stretch;\n}\n.panel-title[data-v-1f5353f3] {\n    font-size: 1.1rem;\n}\n.header-actions[data-v-1f5353f3] {\n    justify-content: stretch;\n}\n.search-bar[data-v-1f5353f3] {\n    min-width: 100%;\n    flex: 1;\n}\n}\n@media (max-width: 480px) {\n.panel-header[data-v-1f5353f3] {\n    padding: 0.75rem;\n}\n.panel-title[data-v-1f5353f3] {\n    font-size: 1rem;\n}\n.search-bar[data-v-1f5353f3] {\n    padding: 0.4rem;\n}\n.search-input[data-v-1f5353f3] {\n    font-size: 0.8rem;\n}\n}\n.header-buttons[data-v-1f5353f3] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex: 0 0 auto;\n  white-space: nowrap;\n  min-width: fit-content;\n}\n.refresh-btn[data-v-1f5353f3],\n.export-btn[data-v-1f5353f3],\n.stats-btn[data-v-1f5353f3] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  padding: 0.5rem 1rem;\n  background: var(--color-primary);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n.refresh-btn[data-v-1f5353f3]:hover,\n.export-btn[data-v-1f5353f3]:hover,\n.stats-btn[data-v-1f5353f3]:hover {\n  background: var(--color-primary-hover);\n  transform: translateY(-1px);\n}\n.animate-spin[data-v-1f5353f3] {\n  animation: spin-1f5353f3 1s linear infinite;\n}\n@keyframes spin-1f5353f3 {\nfrom {\n    transform: rotate(0deg);\n}\nto {\n    transform: rotate(360deg);\n}\n}\n@media (max-width: 560px) {\n.header-buttons .refresh-btn span[data-v-1f5353f3],\n  .header-buttons .export-btn span[data-v-1f5353f3],\n  .header-buttons .stats-btn span[data-v-1f5353f3] {\n    display: none;\n}\n}\n",""]);const i=l},7393:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.quantity-modal-overlay[data-v-8f332e7a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 2000; /* 确保在最上层 */\n  backdrop-filter: blur(4px);\n}\n.quantity-modal[data-v-8f332e7a] {\n  background: var(--color-surface);\n  border: 1px solid var(--color-primary-border);\n  border-radius: 16px;\n  width: 100%;\n  max-width: 400px;\n  color: var(--color-text);\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: modal-appear-8f332e7a 0.3s ease-out;\n  overflow: hidden;\n}\n@keyframes modal-appear-8f332e7a {\nfrom {\n    opacity: 0;\n    transform: scale(0.9) translateY(20px);\n}\nto {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n}\n}\n.modal-header[data-v-8f332e7a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px 16px 24px;\n  border-bottom: 1px solid var(--color-border);\n  background: var(--color-primary-light);\n}\n.modal-header h3[data-v-8f332e7a] {\n  margin: 0;\n  color: var(--color-text);\n  font-size: 1.25rem;\n  font-weight: 600;\n}\n.close-btn[data-v-8f332e7a] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  font-size: 24px;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n}\n.close-btn[data-v-8f332e7a]:hover {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.modal-body[data-v-8f332e7a] {\n  padding: 24px;\n}\n.item-info[data-v-8f332e7a] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 24px;\n  padding: 16px;\n  background: var(--color-surface-light);\n  border-radius: 8px;\n}\n.item-icon[data-v-8f332e7a] {\n  font-size: 32px;\n  width: 48px;\n  height: 48px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-background);\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n}\n.item-details[data-v-8f332e7a] {\n  flex: 1;\n}\n.item-name[data-v-8f332e7a] {\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 4px;\n}\n.item-type[data-v-8f332e7a] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 4px;\n}\n.available-quantity[data-v-8f332e7a] {\n  font-size: 0.85rem;\n  color: var(--color-primary);\n  font-weight: 500;\n}\n.quantity-selector[data-v-8f332e7a] {\n  margin-bottom: 20px;\n}\n.quantity-selector label[data-v-8f332e7a] {\n  display: block;\n  margin-bottom: 12px;\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n}\n.quantity-controls[data-v-8f332e7a] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.quantity-btn[data-v-8f332e7a] {\n  background: var(--color-surface-hover);\n  border: 1px solid var(--color-border);\n  color: var(--color-text);\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 20px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n}\n.quantity-btn[data-v-8f332e7a]:hover:not(:disabled) {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.quantity-btn[data-v-8f332e7a]:disabled {\n  background: var(--color-surface-light);\n  color: var(--color-text-muted);\n  cursor: not-allowed;\n}\n.quantity-input[data-v-8f332e7a] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  color: var(--color-text);\n  padding: 8px 12px;\n  border-radius: 8px;\n  width: 100px;\n  text-align: center;\n  font-size: 1rem;\n  font-weight: 600;\n  transition: all 0.2s ease;\n}\n.quantity-input[data-v-8f332e7a]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.1);\n}\n.quantity-shortcuts[data-v-8f332e7a] {\n  display: flex;\n  gap: 8px;\n  flex-wrap: wrap;\n  margin-top: 16px;\n}\n.preset-btn[data-v-8f332e7a] {\n  background: var(--color-surface-light);\n  border: 1px solid var(--color-border);\n  color: var(--color-text-secondary);\n  padding: 6px 12px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.8rem;\n  transition: all 0.2s ease;\n}\n.preset-btn[data-v-8f332e7a]:hover:not(:disabled) {\n  background: var(--color-surface-hover);\n  color: var(--color-text);\n  border-color: var(--color-border-hover);\n}\n.preset-btn[data-v-8f332e7a]:disabled {\n  background: var(--color-surface);\n  color: var(--color-text-muted);\n  cursor: not-allowed;\n}\n.modal-footer[data-v-8f332e7a] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 24px 24px 24px;\n  border-top: 1px solid var(--color-border);\n}\n.cancel-btn[data-v-8f332e7a], .confirm-btn[data-v-8f332e7a] {\n  padding: 10px 20px;\n  border-radius: 8px;\n  border: 1px solid var(--color-border);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  min-width: 80px;\n}\n.cancel-btn[data-v-8f332e7a] {\n  background: var(--color-surface-hover);\n  color: var(--color-text-secondary);\n}\n.cancel-btn[data-v-8f332e7a]:hover {\n  background: var(--color-surface-light);\n  color: var(--color-text);\n}\n.confirm-btn[data-v-8f332e7a] {\n  background: var(--color-primary);\n  color: white;\n  border-color: var(--color-primary);\n}\n.confirm-btn[data-v-8f332e7a]:hover:not(:disabled) {\n  background: var(--color-primary-hover);\n}\n.confirm-btn[data-v-8f332e7a]:disabled {\n  background: var(--color-surface-light);\n  border-color: var(--color-border);\n  color: var(--color-text-muted);\n  cursor: not-allowed;\n}\n.discard-confirm[data-v-8f332e7a] {\n  background: var(--color-danger) !important;\n  border-color: var(--color-danger) !important;\n}\n.discard-confirm[data-v-8f332e7a]:hover:not(:disabled) {\n  background: var(--color-danger-hover) !important;\n}\n.item-description[data-v-8f332e7a] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  font-style: italic;\n}\n",""]);const i=l},7456:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.spirit-root-selection-container[data-v-11916b84] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n.loading-state[data-v-11916b84],\n.error-state[data-v-11916b84],\n.placeholder[data-v-11916b84] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  font-size: 1.2rem;\n  color: var(--color-text-secondary);\n}\n.spirit-root-layout[data-v-11916b84] {\n  display: grid;\n  grid-template-columns: 1fr 2fr;\n  gap: 2rem;\n  height: 100%;\n  overflow: hidden;\n}\n.spirit-root-left-panel[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--color-surface);\n}\n\n/* 预设模式样式 */\n.preset-mode[data-v-11916b84] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n}\n.spirit-root-list-container[data-v-11916b84] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem 0.5rem 1rem 0.5rem;\n  min-height: 0;\n}\n.spirit-root-list-container[data-v-11916b84]::-webkit-scrollbar { width: 8px;\n}\n.spirit-root-list-container[data-v-11916b84]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.spirit-root-list-container[data-v-11916b84]::-webkit-scrollbar-thumb { background: rgba(136, 192, 208, 0.3); border-radius: 4px;\n}\n.spirit-root-list-container[data-v-11916b84]::-webkit-scrollbar-thumb:hover { background: rgba(136, 192, 208, 0.5);\n}\n.spirit-root-item[data-v-11916b84] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  margin-bottom: 0.5rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-left: 3px solid transparent;\n}\n.item-content[data-v-11916b84] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-grow: 1;\n}\n\n/* 按钮组容器 */\n.action-buttons[data-v-11916b84] {\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n  margin-left: 0.5rem;\n}\n.spirit-root-item:hover .action-buttons[data-v-11916b84] {\n  opacity: 1;\n}\n\n/* 编辑按钮 */\n.edit-btn[data-v-11916b84] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.edit-btn[data-v-11916b84]:hover {\n  color: var(--color-primary);\n  background-color: rgba(59, 130, 246, 0.1);\n}\n.delete-btn[data-v-11916b84] {\n  background: none;\n  border: none;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: opacity 0.2s, color 0.2s, background-color 0.2s;\n}\n.delete-btn[data-v-11916b84]:hover {\n  color: var(--color-danger);\n  background-color: rgba(255, 0, 0, 0.1);\n}\n.spirit-root-name-container[data-v-11916b84] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n.spirit-root-tier[data-v-11916b84] {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 0.7rem;\n  font-weight: 600;\n  text-align: center;\n  min-width: 28px;\n  flex-shrink: 0;\n}\n.spirit-root-tier.tier-下品[data-v-11916b84] {\n  background: linear-gradient(135deg, #8B5CF6, #A78BFA);\n  color: white;\n}\n.spirit-root-tier.tier-中品[data-v-11916b84] {\n  background: linear-gradient(135deg, #3B82F6, #60A5FA);\n  color: white;\n}\n.spirit-root-tier.tier-上品[data-v-11916b84] {\n  background: linear-gradient(135deg, #10B981, #34D399);\n  color: white;\n}\n.spirit-root-tier.tier-极品[data-v-11916b84] {\n  background: linear-gradient(135deg, #F59E0B, #FBBF24);\n  color: white;\n}\n.spirit-root-tier.tier-天品[data-v-11916b84] {\n  background: linear-gradient(135deg, #EF4444, #F87171);\n  color: white;\n}\n.spirit-root-tier.tier-神品[data-v-11916b84] {\n  background: linear-gradient(135deg, #DC2626, #F87171);\n  color: white;\n}\n.spirit-root-tier.tier-特殊[data-v-11916b84] {\n  background: linear-gradient(135deg, #7C3AED, #A78BFA);\n  color: white;\n  border: 1px solid #A78BFA;\n}\n.spirit-root-tier.tier-凡品[data-v-11916b84] {\n  background: rgba(156, 163, 175, 0.2);\n  color: #6B7280;\n  border: 1px solid #9CA3AF;\n}\n.spirit-root-item[data-v-11916b84]:hover {\n  background: rgba(136, 192, 208, 0.1);\n}\n.spirit-root-item.selected[data-v-11916b84] {\n  background: rgba(136, 192, 208, 0.2);\n  color: #88c0d0;\n  border-left: 3px solid #88c0d0;\n  font-weight: 600;\n}\n.spirit-root-item.disabled[data-v-11916b84] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: transparent;\n  color: var(--color-text-disabled);\n}\n.spirit-root-item.disabled[data-v-11916b84]:hover {\n  background: var(--color-surface-danger);\n}\n.spirit-root-name[data-v-11916b84] {\n  font-weight: 500;\n}\n.spirit-root-cost[data-v-11916b84] {\n  color: var(--color-accent);\n}\n.divider[data-v-11916b84] {\n  height: 1px;\n  background: linear-gradient(to right, transparent, rgba(136, 192, 208, 0.2), transparent);\n  margin: 0.5rem 0;\n}\n.single-actions-container[data-v-11916b84] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  gap: 0.5rem;\n}\n.action-item[data-v-11916b84] {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  font-size: 1rem;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-width: 0;\n}\n.action-item[data-v-11916b84]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.action-name[data-v-11916b84] {\n  font-weight: 500;\n}\n.spirit-root-details-container[data-v-11916b84] {\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  padding: 1.5rem;\n  background: var(--color-surface);\n}\n.spirit-root-details[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n}\n.spirit-root-details h2[data-v-11916b84] {\n  margin-top: 0;\n  margin-bottom: 1rem;\n  color: #88c0d0;\n  flex-shrink: 0;\n}\n.description-scroll[data-v-11916b84] {\n  flex: 1;\n  overflow-y: auto;\n  line-height: 1.6;\n  padding-right: 0.5rem;\n  min-height: 0;\n}\n.description-scroll p[data-v-11916b84] {\n  margin: 0;\n  white-space: pre-wrap;\n  color: var(--color-text-secondary);\n}\n.description-scroll[data-v-11916b84]::-webkit-scrollbar { width: 8px;\n}\n.description-scroll[data-v-11916b84]::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.2); border-radius: 4px;\n}\n.description-scroll[data-v-11916b84]::-webkit-scrollbar-thumb { background: rgba(136, 192, 208, 0.3); border-radius: 4px;\n}\n.description-scroll[data-v-11916b84]::-webkit-scrollbar-thumb:hover { background: rgba(136, 192, 208, 0.5);\n}\n.cost-display[data-v-11916b84] {\n  text-align: right;\n  font-weight: bold;\n  color: var(--color-accent);\n  flex-shrink: 0;\n  margin-top: 1rem;\n}\n\n/* 响应式适配 - 手机端优化 */\n@media (max-width: 1200px) {\n.spirit-root-layout[data-v-11916b84] {\n    grid-template-columns: 1fr 1.8fr;\n    gap: 1.5rem;\n}\n}\n@media (max-width: 1024px) {\n.spirit-root-layout[data-v-11916b84] {\n    grid-template-columns: 1fr 1.5fr;\n    gap: 1.2rem;\n}\n.spirit-root-details h2[data-v-11916b84] {\n    font-size: 1.6rem;\n}\n}\n@media (max-width: 640px) {\n.top-actions-container[data-v-11916b84] {\n    flex-wrap: wrap;\n    justify-content: stretch;\n}\n.top-actions-container .action-item[data-v-11916b84] {\n    flex-grow: 1;\n    text-align: center;\n}\n.spirit-root-layout[data-v-11916b84] {\n    /* 改为垂直堆叠布局 */\n    grid-template-columns: 1fr;\n    grid-template-rows: auto 1fr;\n    gap: 1rem;\n    height: auto;\n    overflow: visible;\n    padding: 0.8rem;\n}\n.spirit-root-left-panel[data-v-11916b84] {\n    order: 1;\n    /* 移除max-height限制，让flex布局正常工作 */\n}\n.spirit-root-details-container[data-v-11916b84] {\n    order: 2;\n    min-height: 300px;\n}\n.spirit-root-list-container[data-v-11916b84] {\n    /* 移除max-height限制，让flex布局正常工作 */\n    /* 添加触摸滚动优化 */\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n}\n  \n  /* 优化触摸体验 */\n.spirit-root-item[data-v-11916b84],\n  .action-item[data-v-11916b84] {\n    -webkit-tap-highlight-color: transparent;\n    touch-action: manipulation;\n}\n}\n@media (max-width: 640px) {\n.spirit-root-layout[data-v-11916b84] {\n    gap: 0.8rem;\n    padding: 0.6rem;\n}\n.spirit-root-list-container[data-v-11916b84] {\n    padding: 0.5rem;\n}\n.spirit-root-item[data-v-11916b84] {\n    padding: 0.7rem;\n    font-size: 0.95rem;\n    margin-bottom: 0.4rem;\n}\n.single-actions-container[data-v-11916b84] {\n    padding: 0.5rem;\n    gap: 0.4rem;\n}\n.action-item[data-v-11916b84] {\n    padding: 0.7rem 1rem;\n    font-size: 0.9rem;\n}\n.spirit-root-details-container[data-v-11916b84] {\n    padding: 1.2rem;\n    min-height: 250px;\n}\n.spirit-root-details h2[data-v-11916b84] {\n    font-size: 1.4rem;\n    margin-bottom: 0.8rem;\n}\n}\n@media (max-width: 480px) {\n.top-actions-container[data-v-11916b84] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.spirit-root-selection-container[data-v-11916b84] {\n    padding: 0.4rem;\n    height: auto;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n}\n.spirit-root-layout[data-v-11916b84] {\n    gap: 0.6rem;\n    padding: 0;\n    height: auto;\n    min-height: 0;\n}\n.spirit-root-left-panel[data-v-11916b84] {\n    border-radius: 6px;\n}\n.spirit-root-list-container[data-v-11916b84] {\n    padding: 0.4rem;\n}\n.spirit-root-item[data-v-11916b84] {\n    padding: 0.6rem 0.8rem;\n    font-size: 0.9rem;\n    margin-bottom: 0.3rem;\n    border-radius: 4px;\n}\n.spirit-root-name[data-v-11916b84] {\n    font-size: 0.9rem;\n}\n.spirit-root-cost[data-v-11916b84] {\n    font-size: 0.8rem;\n}\n.divider[data-v-11916b84] {\n    margin: 0.3rem 0;\n}\n.single-actions-container[data-v-11916b84] {\n    flex-direction: column;\n    gap: 0.4rem;\n    padding: 0.4rem;\n}\n.action-item[data-v-11916b84] {\n    padding: 0.6rem;\n    font-size: 0.85rem;\n    border-radius: 4px;\n}\n.spirit-root-details-container[data-v-11916b84] {\n    padding: 1rem;\n    min-height: 200px;\n    border-radius: 6px;\n}\n.spirit-root-details h2[data-v-11916b84] {\n    font-size: 1.3rem;\n    margin-bottom: 0.6rem;\n}\n.description-scroll[data-v-11916b84] {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    padding-right: 0.3rem;\n}\n.cost-display[data-v-11916b84] {\n    font-size: 1rem;\n    text-align: center;\n    margin-top: 0.8rem;\n}\n.placeholder[data-v-11916b84] {\n    font-size: 1rem;\n    padding: 1rem;\n    text-align: center;\n    min-height: 150px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.top-actions-container[data-v-11916b84] {\n    flex-direction: column;\n    align-items: stretch;\n    padding: 0.5rem;\n}\n.top-actions-container .action-item[data-v-11916b84] {\n    text-align: center;\n}\n}\n@media (max-width: 360px) {\n.spirit-root-selection-container[data-v-11916b84] {\n    padding: 0.3rem;\n}\n.spirit-root-layout[data-v-11916b84] {\n    gap: 0.4rem;\n}\n.spirit-root-list-container[data-v-11916b84] {\n    padding: 0.3rem;\n}\n.spirit-root-item[data-v-11916b84] {\n    padding: 0.5rem 0.6rem;\n    font-size: 0.85rem;\n    margin-bottom: 0.2rem;\n}\n.spirit-root-name[data-v-11916b84] {\n    font-size: 0.8rem;\n}\n.spirit-root-cost[data-v-11916b84] {\n    font-size: 0.75rem;\n}\n.spirit-root-details-container[data-v-11916b84] {\n    padding: 0.8rem;\n    min-height: 180px;\n}\n.spirit-root-details h2[data-v-11916b84] {\n    font-size: 1.1rem;\n    margin-bottom: 0.5rem;\n}\n.description-scroll[data-v-11916b84] {\n    font-size: 0.85rem;\n    line-height: 1.4;\n}\n.cost-display[data-v-11916b84] {\n    font-size: 0.9rem;\n    margin-top: 0.6rem;\n}\n.action-item[data-v-11916b84] {\n    padding: 0.5rem;\n    font-size: 0.8rem;\n}\n.placeholder[data-v-11916b84] {\n    font-size: 0.9rem;\n    padding: 0.8rem;\n    min-height: 120px;\n}\n}\n\n/* 自定义模式样式 */\n.stats-display[data-v-11916b84] {\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.stat-item[data-v-11916b84] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n.stat-label[data-v-11916b84] {\n  color: var(--color-text-secondary);\n  font-size: 0.9rem;\n}\n.stat-value[data-v-11916b84] {\n  color: var(--color-accent);\n  font-weight: 600;\n}\n\n/* 顶部功能按钮 */\n.top-actions-container[data-v-11916b84] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  border-bottom: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.1);\n  justify-content: flex-end;\n}\n.top-actions-container .action-item[data-v-11916b84] {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.9rem;\n  white-space: nowrap;\n}\n.top-actions-container .action-item[data-v-11916b84]:hover {\n  background: var(--color-surface-lighter);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n\n/* 选择模式标签页 */\n.selection-mode-tabs[data-v-11916b84] {\n  display: flex;\n  border-bottom: 1px solid var(--color-border);\n  background: var(--color-surface-light);\n}\n.mode-tab[data-v-11916b84] {\n  flex: 1;\n  padding: 0.8rem 1rem;\n  border: none;\n  background: transparent;\n  color: var(--color-text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-weight: 500;\n}\n.mode-tab.active[data-v-11916b84] {\n  color: var(--color-primary);\n  background: var(--color-surface);\n  border-bottom: 2px solid var(--color-primary);\n}\n.mode-tab[data-v-11916b84]:hover:not(.active) {\n  background: rgba(136, 192, 208, 0.1);\n  color: var(--color-text);\n}\n\n/* 自定义模式样式 */\n.custom-mode[data-v-11916b84] {\n  flex: 1;\n  padding: 1rem;\n  overflow-y: auto;\n}\n.custom-selection-container[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n.selection-group[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.8rem;\n}\n.selection-label[data-v-11916b84] {\n  font-weight: 600;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.spirit-type-grid[data-v-11916b84] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));\n  gap: 0.5rem;\n}\n.type-button[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.3rem;\n  padding: 0.8rem 0.5rem;\n  border: 2px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  min-height: 70px;\n}\n.type-button[data-v-11916b84]:hover {\n  border-color: var(--element-color, var(--color-primary));\n  background: rgba(136, 192, 208, 0.1);\n}\n.type-button.selected[data-v-11916b84] {\n  border-color: var(--element-color, var(--color-primary));\n  background: var(--element-color, var(--color-primary));\n  color: white;\n}\n.type-icon[data-v-11916b84] {\n  font-size: 1.2rem;\n}\n.type-name[data-v-11916b84] {\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n.tier-selection[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.tier-button[data-v-11916b84] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.8rem 1rem;\n  border: 2px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.tier-button[data-v-11916b84]:hover {\n  border-color: var(--color-primary);\n  background: rgba(136, 192, 208, 0.1);\n}\n.tier-button.selected[data-v-11916b84] {\n  border-color: var(--color-primary);\n  background: var(--color-primary);\n  color: white;\n}\n.tier-button.tier-common[data-v-11916b84] {\n  border-color: #9CA3AF;\n}\n.tier-button.tier-low[data-v-11916b84] {\n  border-color: #8B5CF6;\n}\n.tier-button.tier-middle[data-v-11916b84] {\n  border-color: #3B82F6;\n}\n.tier-button.tier-high[data-v-11916b84] {\n  border-color: #10B981;\n}\n.tier-button.tier-supreme[data-v-11916b84] {\n  border-color: #F59E0B;\n}\n.tier-button.tier-heaven[data-v-11916b84] {\n  border-color: #FF6B35;\n}\n.tier-button.tier-divine[data-v-11916b84] {\n  border-color: #DC2626;\n}\n.tier-button.tier-special[data-v-11916b84] {\n  border-color: #7C3AED;\n}\n.tier-name[data-v-11916b84] {\n  font-weight: 600;\n}\n.tier-multiplier[data-v-11916b84] {\n  color: var(--color-accent);\n  font-size: 0.9rem;\n}\n.tier-cost[data-v-11916b84] {\n  color: var(--color-text-secondary);\n  font-size: 0.8rem;\n}\n.custom-preview[data-v-11916b84] {\n  padding: 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-surface-light);\n}\n.preview-title[data-v-11916b84] {\n  font-weight: 600;\n  margin-bottom: 0.8rem;\n  color: var(--color-text);\n}\n.preview-content[data-v-11916b84] {\n  margin-bottom: 1rem;\n}\n.preview-name[data-v-11916b84] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 0.8rem;\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.preview-tier[data-v-11916b84] {\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 0.7rem;\n  font-weight: 600;\n  background: var(--color-accent);\n  color: white;\n}\n.preview-stats[data-v-11916b84] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.4rem;\n}\n.preview-stats .stat[data-v-11916b84] {\n  display: flex;\n  justify-content: space-between;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n}\n.confirm-custom-button[data-v-11916b84] {\n  width: 100%;\n  padding: 0.8rem;\n  border: none;\n  border-radius: 6px;\n  background: var(--color-primary);\n  color: white;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.confirm-custom-button[data-v-11916b84]:hover:not(:disabled) {\n  background: var(--color-primary-dark);\n}\n.confirm-custom-button[data-v-11916b84]:disabled {\n  background: var(--color-border);\n  color: var(--color-text-disabled);\n  cursor: not-allowed;\n}\n.actions-container[data-v-11916b84] {\n  border-top: 1px solid var(--color-border);\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0.5rem;\n  display: flex;\n  gap: 0.5rem;\n}\n\n/* 兼容新等级名称“仙品” */\n.spirit-root-tier.tier-仙品[data-v-11916b84] { background: linear-gradient(135deg, #EF4444, #F87171); color: white;\n}\n",""]);const i=l},7527:(e,n,t)=>{t.d(n,{Gr:()=>l,VQ:()=>o,eQ:()=>a,qS:()=>i,yM:()=>r});const a=[{id:1,name:"朝天大陆",era:"朝天历元年",description:'此方世界名为"朝天大陆"，乃是一处天道完整、灵气充沛的上善之地。其核心法则是"万灵竞渡，一步登天"，无论是人、妖、精、怪，皆有缘法踏上修行之路，叩问长生。\n仙凡之别在此界泾渭分明，宛若天渊。凡人寿不过百载，受生老病死之苦，终归一抔黄土；而修士一旦踏入道途，便能吞吐天地灵气，淬炼己身，寿元动辄千载，更有大能者与天地同寿。凡俗王朝更迭，于修士而言不过是弹指一瞬间。在凡人眼中，修士是高悬于九天的仙神，一言可定一国兴衰，一念可引风雨雷霆。然而，这种力量并非毫无代价。\n此界奉行"大道争锋"的铁则，天道予万物机缘，却也降下无尽凶险。灵脉宝地、神功秘法、天材地宝，皆是有缘者居之，而"缘"字背后，往往是血与火的洗礼。修士之间，为求道途精进，争斗乃是常态。同门可能反目，挚友亦会背叛，杀人夺宝、斩草除根之事屡见不鲜。这是一个极度自由的世界，你可以选择成为守护一方的善仙，亦可成为肆虐八荒的魔头，只要你有足够的实力。但自由的背后，是无处不在的危险，一步踏错，便是万劫不复，身死道消。\n然天道亦有制衡，修士若无故以大法力干涉凡俗王朝更迭、屠戮凡人，便会与此方天地结下因果。虽无业报加身，却会在日后冲击更高境界、渡劫飞升之时，引来更强大的天劫，平添无数变数。故而多数修士选择在山门清修，或于红尘历练，以求勘破心障，证得大道。修仙百艺——炼丹、炼器、符箓、阵法，在此界发展到了极致，共同构筑了一个无比兴盛、却也无比残酷的修仙文明。'},{id:2,name:"地球",era:"灵气复苏元年",description:'2077年，地球经历了一场前所未有的灵气复苏。曾经只存在于神话传说中的"灵气"，如潮水般涌入现代世界。科学无法解释的异象频频发生：城市上空出现极光般的能量波动，深山老林涌现出神秘的灵脉，普通动植物开始变异进化。\n在这个巨变的时代，你是极少数能感知并吸收灵气的"觉醒者"。当全世界还在用科学仪器研究这股神秘能量时，你已经能够将其炼化入体，走上了修真之路。现代化的都市、便捷的网络、发达的科技，与古老的修炼体系碰撞，产生了奇妙的化学反应。\n政府成立了"超自然事务管理局"，各国争相研究灵气应用技术，跨国企业试图将灵气商业化，而古老宗门的后裔们也纷纷出世。在这个灵气与科技并存的时代，你将在钢铁森林中独自修行，探索"科学修真"的奥秘。人类的寿命依然有限，普通人对觉醒者既敬畏又恐惧，而你，必须在两个世界之间找到自己的道路。'},{id:3,name:"赛博修真",era:"新纪元2156",description:'2156年，人类文明已经踏入星际时代。在赛博朋克的霓虹都市中，义体改造、神经接驳、意识上传已成为常态。然而，一次深空探索意外发现了"灵能水晶"——一种能够增强人类精神力的神秘矿石，彻底改变了世界。\n你是一名边缘跑者，在接触灵能水晶后觉醒了修炼天赋。与传统修真不同，这个时代的修行依托于"义体灵修"体系：将灵能与赛博义体结合，数据流就是灵气，神经网络就是经脉，意识核心就是丹田。你可以通过黑客手段"盗取"企业的修炼数据，可以在虚拟现实中进行"数据闭关"，也可以用纳米机器人构建"机械金丹"。\n巨型企业垄断了灵能资源，赛博修士们为了突破境界不得不接受危险任务。城市下层贫民窟中有人在破旧的胶囊旅馆里修炼，上层则是企业供养的"数据仙人"享受着无尽资源。这是一个孤独修士的时代，在霓虹闪烁、义体横行的世界里，你将用代码和灵能书写属于自己的飞升传说。'},{id:4,name:"魔法纪元",era:"第七魔法时代",description:'这是一个魔法与灵气融合的奇幻世界。千年前，东方的"修真体系"与西方的"魔法体系"发生了史诗级的碰撞，最终两大文明达成了微妙的平衡。在这个世界，古老的修真宗门与魔法学院并存，道家的符箓与炼金术的魔法阵有着惊人的相似之处。\n你生于边境之地，这里是两大文明的交汇点。你可以选择传统的修真之路，炼气筑基金丹元婴；也可以学习西方的魔法体系，成为元素法师或是死灵术士。更有野心者，试图融合两种体系，创造前所未有的"魔修"之道。\n这个世界充满了机遇与危险。古老的龙族盘踞在灵脉之上，精灵王国守护着世界树的秘密，矮人在地底挖掘着魔晶矿脉，而人类帝国则在两大体系的碰撞中寻找平衡。魔法学院的学生可能会与修真宗门的弟子发生冲突，古老的修士可能需要面对掌握禁咒的大魔法师。在这个融合与冲突并存的时代，你将独自探索两种力量的奥秘，寻找超越极限的可能。'}],o=[{id:1,name:"废柴",description:"资质平平，毫无出奇之处。",total_points:10,rarity:1,color:"#808080"},{id:2,name:"凡人",description:"芸芸众生中的一员，不好不坏。",total_points:20,rarity:2,color:"#FFFFFF"},{id:3,name:"俊杰",description:"百里挑一的人才，略有不凡。",total_points:30,rarity:3,color:"#4169E1"},{id:4,name:"天骄",description:"千年难遇的奇才，注定耀眼。",total_points:40,rarity:4,color:"#9932CC"},{id:5,name:"妖孽",description:"万古无一的怪物，逆天而行。",total_points:50,rarity:5,color:"#FFD700"}],r=[{id:1,name:"山野遗孤",description:"自幼在山野中长大，与猛兽为伴，磨练出坚韧的意志和过人的体魄。",talent_cost:0,attribute_modifiers:{root_bone:1},rarity:3},{id:2,name:"书香门第",description:"出身于官宦世家，饱读诗书，对天地至理有超乎常人的理解力。",talent_cost:2,attribute_modifiers:{comprehension:2},rarity:3},{id:3,name:"商贾之子",description:"生于富贵之家，精通人情世故，处事圆滑，魅力非凡。",talent_cost:2,attribute_modifiers:{charm:2},rarity:3},{id:4,name:"将门之后",description:"名将的后代，血脉中流淌着勇武与煞气，心性坚定。",talent_cost:3,attribute_modifiers:{temperament:2,root_bone:1},rarity:3},{id:5,name:"散修传人",description:"你的师父是一位游戏风尘的强大散修，你继承了他的部分衣钵和见识。",talent_cost:4,attribute_modifiers:{comprehension:1,temperament:1},rarity:4},{id:6,name:"魔道卧底",description:"你出身名门正派，却被派往魔道执行卧底任务，心性远超常人。",talent_cost:1,attribute_modifiers:{temperament:3},rarity:4},{id:7,name:"重生者",description:"你保留着前世的记忆，虽然修为尽失，但对功法和未来的大事了如指掌。",talent_cost:5,attribute_modifiers:{comprehension:2,luck:1},rarity:5},{id:8,name:"仙人后裔",description:"你的血脉中流淌着稀薄的仙人之血，天生灵性十足，修炼速度略快于常人。",talent_cost:6,attribute_modifiers:{spirit:2,root_bone:1},rarity:5},{id:9,name:"夺舍老怪",description:"你是一名夺舍重生的老怪物，虽然占据了年轻的肉体，但灵魂中蕴含着庞大的神识力量。",talent_cost:7,attribute_modifiers:{comprehension:3,temperament:-1},rarity:5},{id:10,name:"山神庙祝",description:"你从小在山神庙长大，日夜与香火为伴，神魂受到滋养，对鬼神之事有特殊感应。",talent_cost:2,attribute_modifiers:{spirit:2},rarity:3},{id:11,name:"渔家少年",description:"常年在江河湖海中讨生活，水性极佳，体魄强健。",talent_cost:1,attribute_modifiers:{root_bone:2},rarity:2},{id:12,name:"王朝皇子",description:"生于凡人王朝的权力之巅，自幼享受锦衣玉食和最好的教育，但与修仙界的接触较少。",talent_cost:3,attribute_modifiers:{charm:2,temperament:1},rarity:4}],l=[{id:1,name:"金灵根",tier:"上品",description:"金曰从革，操控金铁，锋锐无匹。修行金系功法事半功倍，是天生的剑修或刀客胚子，攻击性极强。",cultivation_speed:"1.6x",special_effects:["金系法术威力+50%","器物亲和+30%","金属感知"],base_multiplier:1.6,talent_cost:10,rarity:3},{id:2,name:"木灵根",tier:"上品",description:"木曰曲直，亲和草木，生机盎然。修行木系功法极快，擅长治疗、控制，且对灵植有天生的亲和力。",cultivation_speed:"1.6x",special_effects:["木系法术威力+50%","生命力恢复+40%","植物沟通"],base_multiplier:1.6,talent_cost:10,rarity:3},{id:3,name:"水灵根",tier:"上品",description:"水曰润下，御水之脉，绵延不绝。修行水系功法，法力悠长，变化多端，适应性极强。",cultivation_speed:"1.6x",special_effects:["水系法术威力+50%","灵气恢复+40%","水体感知"],base_multiplier:1.6,talent_cost:10,rarity:3},{id:4,name:"火灵根",tier:"上品",description:"火曰炎上，天生火脉，焚尽八荒。修行火系功法，威力绝伦，爆发力强，是炼丹师的绝佳天赋。",cultivation_speed:"1.6x",special_effects:["火系法术威力+50%","爆发伤害+60%","火焰免疫"],base_multiplier:1.6,talent_cost:10,rarity:3},{id:5,name:"土灵根",tier:"上品",description:"土爰稼穑，大地之子，厚德载物。修行土系功法，防御惊人，稳如泰山，是天生的阵法师材料。",cultivation_speed:"1.6x",special_effects:["土系法术威力+50%","防御力+40%","大地感知"],base_multiplier:1.6,talent_cost:10,rarity:3},{id:9,name:"金灵根",tier:"中品",description:"金行资质尚可，修行金系功法有一定天赋，虽不及上品，但也远超常人。",cultivation_speed:"1.3x",special_effects:["金系法术威力+25%","器物亲和+15%"],base_multiplier:1.3,talent_cost:6,rarity:2},{id:10,name:"火灵根",tier:"中品",description:"火行资质良好，对火系功法有不错的亲和力，能够顺利地踏上修行之路。",cultivation_speed:"1.3x",special_effects:["火系法术威力+25%","爆发伤害+30%"],base_multiplier:1.3,talent_cost:6,rarity:2},{id:11,name:"雷灵根",tier:"极品",description:"万中无一的变异灵根，天生雷体，雷霆万钧。修行雷系功法速度极快，威力绝伦，是天劫的宠儿。",cultivation_speed:"2.0x",special_effects:["雷系法术威力+80%","雷霆免疫","速度+50%","穿透攻击"],base_multiplier:2,talent_cost:15,rarity:4},{id:12,name:"冰灵根",tier:"极品",description:"极为罕见的变异灵根，冰霜之躯，万物凋零。修行冰系功法，控制力超凡，能冰封千里。",cultivation_speed:"2.0x",special_effects:["冰系法术威力+80%","减速效果+100%","冰霜免疫","空间冻结"],base_multiplier:2,talent_cost:15,rarity:4},{id:6,name:"混沌灵根",tier:"神品",description:"传说中的至高灵根，万法归一，包容万象。可修行所有属性功法，无瓶颈，但初期进展缓慢，后期一日千里。",cultivation_speed:"0.8x(前期) → 2.8x(后期)",special_effects:["全系法术亲和","无属性限制","越阶战斗+50%","突破概率+30%"],base_multiplier:2.8,talent_cost:25,rarity:5},{id:7,name:"天妒之体",tier:"特殊",description:"天道所妒，灵气不亲。修行速度极为缓慢，常人难以忍受。但一旦突破，根基无比扎实，战力远超同阶。",cultivation_speed:"0.5x",special_effects:["根基极其稳固","突破后实力暴增+100%","天劫抗性+80%","逆天改命"],base_multiplier:.5,talent_cost:-5,rarity:4},{id:8,name:"五行杂灵根",tier:"凡品",description:"凡人中最常见的灵根，五行皆有，却驳杂不堪，修炼速度慢如龟爬，仙路渺茫。",cultivation_speed:"1.0x",special_effects:["平凡之道","大器晚成"],base_multiplier:1,talent_cost:0,rarity:1},{id:13,name:"风灵根",tier:"下品",description:"较为常见的异种灵根，微风轻抚，虽然资质一般，但胜在灵活多变，身法迅捷。",cultivation_speed:"1.1x",special_effects:["风系法术威力+15%","移动速度+20%"],base_multiplier:1.1,talent_cost:3,rarity:1}],i=[{id:1,name:"天命主角",description:"气运惊人，总是能在绝境中逢生，获得意想不到的机缘。",talent_cost:15,rarity:5,effects:[{类型:"后天六司",目标:"气运",数值:8},{类型:"特殊能力",名称:"逢凶化吉",数值:.1}]},{id:2,name:"剑道独尊",description:"天生剑心通明，任何剑法一看便会，且威力倍增。",talent_cost:12,rarity:5,effects:[{类型:"技能加成",技能:"剑法",数值:.2},{类型:"后天六司",目标:"根骨",数值:3}]},{id:3,name:"丹道圣手",description:"对药理有超凡的领悟力，炼丹成功率与品质大幅提升。",talent_cost:12,rarity:5,effects:[{类型:"技能加成",技能:"炼丹",数值:.15},{类型:"后天六司",目标:"悟性",数值:2}]},{id:4,name:"阵法大师",description:"对阵法有极高的天赋，学习和布置阵法的效率大大提高。",talent_cost:8,rarity:4,effects:[{类型:"技能加成",技能:"阵法",数值:.12},{类型:"后天六司",目标:"悟性",数值:2}]},{id:5,name:"炼器鬼才",description:"天生对各种材料有敏锐的感知，炼器时更容易出现极品。",talent_cost:8,rarity:4,effects:[{类型:"技能加成",技能:"炼器",数值:.1},{类型:"特殊能力",名称:"材料感知",数值:1}]},{id:6,name:"多宝童子",description:"出门历练时，更容易发现天材地宝。",talent_cost:7,rarity:4,effects:[{类型:"后天六司",目标:"气运",数值:3},{类型:"特殊能力",名称:"寻宝天赋",数值:.15}]},{id:7,name:"体修奇才",description:"肉身天生强横，气血旺盛，适合修炼体修功法。",talent_cost:5,rarity:3,effects:[{类型:"后天六司",目标:"根骨",数值:3},{类型:"特殊能力",名称:"体修天赋",数值:.1}]},{id:8,name:"神识过人",description:"天生神识强大，不易被心魔入侵，施展神识秘术效果更佳。",talent_cost:5,rarity:3,effects:[{类型:"后天六司",目标:"悟性",数值:3},{类型:"特殊能力",名称:"心魔抗性",数值:.1}]},{id:9,name:"身法鬼魅",description:"身法飘逸，战斗中闪避能力更强。",talent_cost:4,rarity:3,effects:[{类型:"后天六司",目标:"灵性",数值:2},{类型:"特殊能力",名称:"闪避天赋",数值:.08}]},{id:10,name:"农夫之子",description:"出身凡人，心性坚韧，对灵植有额外的亲和力。",talent_cost:2,rarity:2,effects:[{类型:"后天六司",目标:"心性",数值:1},{类型:"特殊能力",名称:"灵植亲和",数值:.1}]},{id:11,name:"过目不忘",description:"记忆力超群，学习功法秘籍速度加快。",talent_cost:2,rarity:2,effects:[{类型:"后天六司",目标:"悟性",数值:2}]},{id:12,name:"老实人",description:"与人交易时，不容易被欺骗。",talent_cost:1,rarity:1,effects:[{类型:"特殊能力",名称:"防欺诈",数值:1}]},{id:13,name:"一诺千金",description:"你的承诺极具分量，更容易获得他人的信任与好感。",talent_cost:3,rarity:2,effects:[{类型:"后天六司",目标:"魅力",数值:2}]},{id:14,name:"天生毒体",description:"百毒不侵，且能更好地驾驭毒功，但常人不敢轻易接近。",talent_cost:6,rarity:4,effects:[{类型:"特殊能力",名称:"毒素免疫",数值:1},{类型:"技能加成",技能:"毒术",数值:.15},{类型:"后天六司",目标:"魅力",数值:-2}]},{id:15,name:"画龙点睛",description:"在制作符箓时，有一定几率产生意想不到的强大效果。",talent_cost:4,rarity:3,effects:[{类型:"技能加成",技能:"符箓",数值:.1},{类型:"特殊能力",名称:"符箓变异",数值:.05}]},{id:16,name:"顶级魅力",description:"天生丽质，气质非凡，魅力超群。无论走到哪里都是众人瞩目的焦点，极容易获得他人的好感与信任。在社交场合如鱼得水，能够以言语和魅力化解大部分冲突。",talent_cost:8,rarity:4,effects:[{类型:"后天六司",目标:"魅力",数值:5},{类型:"特殊能力",名称:"魅力光环",数值:.2},{类型:"特殊能力",名称:"社交天赋",数值:.15}]}]},7659:e=>{var n={};e.exports=function(e,t){var a=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}},7816:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.world-info-section[data-v-23f9de7c] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.section-header[data-v-23f9de7c] {\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.section-title[data-v-23f9de7c] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.world-info-content[data-v-23f9de7c] {\n  flex: 1;\n  overflow: hidden;\n}\n.data-display[data-v-23f9de7c] {\n  height: 100%;\n  overflow: hidden;\n}\n.code-pre[data-v-23f9de7c] {\n  margin: 0;\n  padding: 0.75rem;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  height: 100%;\n  overflow: auto;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.8rem;\n  line-height: 1.4;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.empty-state[data-v-23f9de7c] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n\n/* 手机端适配 */\n@media (max-width: 640px) {\n.world-info-section[data-v-23f9de7c] {\n    padding: 0.75rem;\n}\n.section-title[data-v-23f9de7c] {\n    font-size: 1rem;\n    text-align: center;\n}\n.code-pre[data-v-23f9de7c] {\n    font-size: 0.75rem;\n    padding: 0.5rem;\n}\n.empty-state[data-v-23f9de7c] {\n    padding: 2rem 0.5rem;\n}\n}\n@media (max-width: 480px) {\n.world-info-section[data-v-23f9de7c] {\n    padding: 0.5rem;\n}\n.section-title[data-v-23f9de7c] {\n    font-size: 0.9rem;\n}\n.code-pre[data-v-23f9de7c] {\n    font-size: 0.7rem;\n    padding: 0.4rem;\n}\n}\n",""]);const i=l},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var a="";t.supports&&(a+="@supports (".concat(t.supports,") {")),t.media&&(a+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(a+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),a+=t.css,o&&(a+="}"),t.media&&(a+="}"),t.supports&&(a+="}");var r=t.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),n.styleTagTransform(a,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},8205:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.progress[data-v-d9bb4e4a] {\n  position: relative;\n  width: 100%;\n  height: 8px;\n  background: var(--color-surface);\n  border: 2px solid var(--color-border);\n  border-radius: 8px;\n  box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);\n  overflow: hidden;\n}\n.progress.sm[data-v-d9bb4e4a] { height: 6px;\n}\n.progress.md[data-v-d9bb4e4a] { height: 8px;\n}\n.progress.lg[data-v-d9bb4e4a] { height: 16px;\n}\n.progress-bar[data-v-d9bb4e4a] {\n  height: 100%;\n  background: linear-gradient(90deg, var(--color-success), var(--color-primary));\n  border-radius: 999px;\n  transition: width 0.25s ease;\n  min-width: 2px; /* 确保即使0%也能看到一点进度条 */\n}\n.progress-label[data-v-d9bb4e4a] {\n  position: absolute;\n  top: 50%;\n  right: 8px;\n  transform: translateY(-50%);\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.75);\n  pointer-events: none;\n}\n",""]);const i=l},8264:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.save-data-section[data-v-0e1d4ac2] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n}\n.section-header[data-v-0e1d4ac2] {\n  margin-bottom: 1rem;\n  flex-shrink: 0;\n}\n.section-title[data-v-0e1d4ac2] {\n  margin: 0;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.save-data-content[data-v-0e1d4ac2] {\n  flex: 1;\n  overflow: auto;\n  background: var(--color-code-bg);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 0.75rem;\n}\n.data-tree[data-v-0e1d4ac2] {\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 0.85rem;\n}\n.empty-state[data-v-0e1d4ac2] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--color-text-secondary);\n  text-align: center;\n}\n",""]);const i=l},8431:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,'\n.formatted-text[data-v-176b782c] {\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  text-align: justify;\n  text-indent: 2em;\n  margin: 0;\n  line-height: 1.8;\n  padding-bottom: 1.5rem;\n}\n\n/* 环境描写 - 青色 */\n.text-environment[data-v-176b782c] {\n  color: #0891b2;\n  font-weight: 500;\n}\n\n/* 心理描写 - 紫色 */\n.text-psychology[data-v-176b782c] {\n  color: #7c3aed;\n  font-style: italic;\n  font-weight: 500;\n}\n\n/* 对话 - 橙色 */\n.text-dialogue[data-v-176b782c] {\n  color: #d97706;\n  font-weight: 500;\n}\n\n/* 引用/独白 - 橙色斜体 */\n.text-quote[data-v-176b782c] {\n  color: rgb(254 125 0);\n  font-style: italic;\n}\n\n/* 普通文本 */\n.text-normal[data-v-176b782c] {\n  color: var(--color-text, #1a1a1a);\n}\n\n/* 判定卡片样式 - 重新设计 */\n.judgement-card[data-v-176b782c] {\n  display: flex;\n  gap: 1rem;\n  margin: 1.25rem 0;\n  padding: 1.25rem;\n  background: linear-gradient(135deg, #fefefe 0%, #f8f9fa 100%);\n  border-radius: 16px;\n  border: 2px solid #e2e8f0;\n  box-shadow:\n    0 2px 8px rgba(0, 0, 0, 0.04),\n    0 4px 16px rgba(0, 0, 0, 0.02);\n  text-indent: 0;\n  position: relative;\n  overflow: hidden;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.judgement-card[data-v-176b782c]::before {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 3px;\n  background: linear-gradient(90deg,\n    transparent 0%,\n    var(--card-color, #6366f1) 50%,\n    transparent 100%);\n}\n.judgement-card[data-v-176b782c]:hover {\n  transform: translateY(-2px);\n  box-shadow:\n    0 4px 12px rgba(0, 0, 0, 0.06),\n    0 8px 24px rgba(0, 0, 0, 0.04);\n}\n\n/* 成功状态 */\n.judgement-card.is-success[data-v-176b782c] {\n  border-color: #86efac;\n  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n  --card-color: #10b981;\n}\n.judgement-card.is-great-success[data-v-176b782c] {\n  border-color: #fbbf24;\n  background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);\n  --card-color: #f59e0b;\n  animation: pulse-success-176b782c 2s ease-in-out infinite;\n}\n\n/* 失败状态 */\n.judgement-card.is-failure[data-v-176b782c] {\n  border-color: #fca5a5;\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n  --card-color: #ef4444;\n}\n.judgement-card.is-great-failure[data-v-176b782c] {\n  border-color: #c084fc;\n  background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);\n  --card-color: #a855f7;\n  animation: pulse-failure-176b782c 2s ease-in-out infinite;\n}\n@keyframes pulse-success-176b782c {\n0%, 100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.4);\n}\n50% { box-shadow: 0 0 0 8px rgba(251, 191, 36, 0);\n}\n}\n@keyframes pulse-failure-176b782c {\n0%, 100% { box-shadow: 0 0 0 0 rgba(168, 85, 247, 0.4);\n}\n50% { box-shadow: 0 0 0 8px rgba(168, 85, 247, 0);\n}\n}\n\n/* 图标区域 */\n.card-icon[data-v-176b782c] {\n  flex-shrink: 0;\n  width: 48px;\n  height: 48px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: white;\n  border-radius: 12px;\n  border: 2px solid var(--card-color, #6366f1);\n  color: var(--card-color, #6366f1);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n}\n\n/* 内容区域 */\n.card-content[data-v-176b782c] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n/* 标题行 */\n.card-header[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.75rem;\n}\n.judgement-title[data-v-176b782c] {\n  font-size: 1.125rem;\n  font-weight: 700;\n  color: #0f172a;\n  letter-spacing: -0.01em;\n  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);\n  opacity: 1;\n}\n.judgement-badge[data-v-176b782c] {\n  display: inline-flex;\n  align-items: center;\n  padding: 0.375rem 0.875rem;\n  background: var(--card-color, #6366f1);\n  color: white;\n  border-radius: 20px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  letter-spacing: 0.02em;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  opacity: 1;\n}\n\n/* 统计信息行 */\n.card-body[data-v-176b782c] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.75rem;\n}\n.stat-item[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 0.875rem;\n  background: white;\n  border-radius: 10px;\n  border: 1px solid #e2e8f0;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);\n  min-width: fit-content;\n}\n.details-list[data-v-176b782c] {\n  width: 100%;\n  margin-top: 0.5rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid #e2e8f0;\n}\n.detail-item[data-v-176b782c] {\n  font-size: 0.875rem;\n  color: #64748b;\n  padding: 0.25rem 0;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.detail-item[data-v-176b782c]::before {\n  content: \'•\';\n  color: #94a3b8;\n}\n.stat-icon[data-v-176b782c] {\n  font-size: 1.375rem;\n  line-height: 1;\n}\n.stat-info[data-v-176b782c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.125rem;\n}\n.stat-label[data-v-176b782c] {\n  font-size: 0.75rem;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n.stat-value[data-v-176b782c] {\n  font-size: 1.125rem;\n  font-weight: 700;\n  color: #1e293b;\n}\n.dice-roll[data-v-176b782c], .attribute-check[data-v-176b782c] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 0.75rem;\n  background: var(--color-surface-light, #ebe9e6);\n  border-radius: 8px;\n  border: 1px solid var(--color-border, rgba(0, 0, 0, 0.1));\n  transition: all 0.2s ease;\n  text-align: center;\n}\n.dice-roll[data-v-176b782c]:hover, .attribute-check[data-v-176b782c]:hover {\n  background: var(--color-surface, #f2f1ee);\n  transform: translateY(-1px);\n}\n.dice-roll .label[data-v-176b782c], .attribute-check .label[data-v-176b782c] {\n  font-size: 0.8em;\n  color: var(--color-text-secondary, #666666);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 0.25rem;\n  font-weight: 500;\n}\n.dice-roll .value[data-v-176b782c], .attribute-check .value[data-v-176b782c] {\n  font-size: 1.4em;\n  font-weight: 700;\n  color: var(--color-text, #1a1a1a);\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n.dice-roll .value[data-v-176b782c] {\n  color: #6366f1;\n  background: linear-gradient(135deg, #6366f1, #8b5cf6);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n\n/* 深色主题适配 */\n[data-theme="dark"] .text-normal[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .text-environment[data-v-176b782c] {\n  color: #22d3ee;\n}\n[data-theme="dark"] .text-psychology[data-v-176b782c] {\n  color: #a78bfa;\n}\n[data-theme="dark"] .text-dialogue[data-v-176b782c] {\n  color: #fb923c;\n}\n[data-theme="dark"] .text-quote[data-v-176b782c] {\n  color: rgb(254 125 0);\n}\n[data-theme="dark"] .judgement-card[data-v-176b782c] {\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.02) 0%, var(--color-background, rgb(30, 41, 59)) 100%);\n  border-color: var(--color-border, rgba(173, 216, 230, 0.5));\n}\n[data-theme="dark"] .card-header[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .result-text[data-v-176b782c],\n[data-theme="dark"] .dice-roll[data-v-176b782c],\n[data-theme="dark"] .attribute-check[data-v-176b782c] {\n  background: var(--color-surface-light, #414868);\n  border-color: var(--color-border, rgba(173, 216, 230, 0.5));\n}\n[data-theme="dark"] .dice-roll .label[data-v-176b782c],\n[data-theme="dark"] .attribute-check .label[data-v-176b782c] {\n  color: var(--color-text-secondary, #d0d0d0);\n}\n[data-theme="dark"] .dice-roll .value[data-v-176b782c],\n[data-theme="dark"] .attribute-check .value[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n.header-right[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.help-btn[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 28px;\n  height: 28px;\n  padding: 0;\n  background: rgba(255, 255, 255, 0.8);\n  border: 1px solid #e2e8f0;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: #64748b;\n}\n.help-btn[data-v-176b782c]:hover {\n  background: white;\n  border-color: var(--card-color, #6366f1);\n  color: var(--card-color, #6366f1);\n  transform: scale(1.1);\n}\n.help-btn[data-v-176b782c]:active {\n  transform: scale(0.95);\n}\n\n/* 帮助弹窗 */\n.help-modal-overlay[data-v-176b782c] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 10000;\n  animation: fadeIn-176b782c 0.2s ease;\n}\n@keyframes fadeIn-176b782c {\nfrom { opacity: 0;\n}\nto { opacity: 1;\n}\n}\n.help-modal[data-v-176b782c] {\n  background: var(--color-surface);\n  color: var(--color-text);\n  border-radius: 16px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  max-width: 600px;\n  width: 90%;\n  max-height: 80vh;\n  overflow: hidden;\n  animation: slideUp-176b782c 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n@keyframes slideUp-176b782c {\nfrom {\n    opacity: 0;\n    transform: translateY(20px);\n}\nto {\n    opacity: 1;\n    transform: translateY(0);\n}\n}\n.help-modal-header[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1.5rem;\n  border-bottom: 1px solid #e2e8f0;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n.help-modal-header h3[data-v-176b782c] {\n  margin: 0;\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: var(--color-text);\n}\n.close-btn[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  padding: 0;\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: #64748b;\n}\n.close-btn[data-v-176b782c]:hover {\n  background: #fee2e2;\n  border-color: #ef4444;\n  color: #ef4444;\n}\n.help-modal-content[data-v-176b782c] {\n  padding: 1.5rem;\n  overflow-y: auto;\n  max-height: calc(80vh - 80px);\n}\n.help-section[data-v-176b782c] {\n  margin-bottom: 1.5rem;\n}\n.help-section[data-v-176b782c]:last-child {\n  margin-bottom: 0;\n}\n.help-section h4[data-v-176b782c] {\n  margin: 0 0 0.75rem 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.help-section ol[data-v-176b782c] {\n  margin: 0;\n  padding-left: 1.5rem;\n  color: var(--color-text-secondary);\n  line-height: 1.8;\n}\n.help-section ol li[data-v-176b782c] {\n  margin-bottom: 0.5rem;\n}\n.help-section ol li strong[data-v-176b782c] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n.formula-box[data-v-176b782c] {\n  padding: 1rem;\n  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\n  border-left: 4px solid #f59e0b;\n  border-radius: 8px;\n  margin-bottom: 0.75rem;\n  font-size: 0.875rem;\n  line-height: 1.6;\n  color: #78350f;\n}\n.formula-box strong[data-v-176b782c] {\n  color: #92400e;\n  font-weight: 700;\n}\n.result-list[data-v-176b782c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.result-item[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.75rem 1rem;\n  border-radius: 10px;\n  border: 1px solid;\n  gap: 1rem;\n}\n.result-item.perfect[data-v-176b782c] {\n  background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);\n  border-color: #fbbf24;\n}\n.result-item.great-success[data-v-176b782c] {\n  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);\n  border-color: #86efac;\n}\n.result-item.success[data-v-176b782c] {\n  background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n  border-color: #93c5fd;\n}\n.result-item.failure[data-v-176b782c] {\n  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n  border-color: #fca5a5;\n}\n.result-item.critical-failure[data-v-176b782c] {\n  background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);\n  border-color: #c084fc;\n}\n.result-label[data-v-176b782c] {\n  font-weight: 700;\n  font-size: 0.875rem;\n  min-width: 60px;\n  opacity: 1;\n}\n.result-desc[data-v-176b782c] {\n  font-size: 0.875rem;\n  flex: 1;\n  opacity: 1;\n}\n\n/* -- 为不同结果类型设置文字颜色 -- */\n\n/* 完美 */\n.result-item.perfect .result-label[data-v-176b782c],\n.result-item.perfect .result-desc[data-v-176b782c] {\n  color: #92400e;\n}\n\n/* 大成功 */\n.result-item.great-success .result-label[data-v-176b782c],\n.result-item.great-success .result-desc[data-v-176b782c] {\n  color: #14532d;\n}\n\n/* 成功 */\n.result-item.success .result-label[data-v-176b782c],\n.result-item.success .result-desc[data-v-176b782c] {\n  color: #1e40af;\n}\n\n/* 失败 */\n.result-item.failure .result-label[data-v-176b782c],\n.result-item.failure .result-desc[data-v-176b782c] {\n  color: #991b1b;\n}\n\n/* 大失败 */\n.result-item.critical-failure .result-label[data-v-176b782c],\n.result-item.critical-failure .result-desc[data-v-176b782c] {\n  color: #581c87;\n}\n.formula-note[data-v-176b782c] {\n  padding: 0.75rem 1rem;\n  background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n  border-left: 4px solid #3b82f6;\n  border-radius: 8px;\n  margin-bottom: 0.75rem;\n  font-size: 0.875rem;\n  line-height: 1.6;\n  color: #1e40af;\n}\n.formula-note strong[data-v-176b782c] {\n  color: #1e3a8a;\n  font-weight: 700;\n}\n.tips-list[data-v-176b782c] {\n  margin: 0;\n  padding-left: 1.25rem;\n  color: #475569;\n  line-height: 1.8;\n}\n.tips-list li[data-v-176b782c] {\n  margin-bottom: 0.5rem;\n}\n.judgement-types[data-v-176b782c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.type-item[data-v-176b782c] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  padding: 0.75rem;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n  border-radius: 8px;\n  border: 1px solid #e2e8f0;\n}\n.type-name[data-v-176b782c] {\n  font-weight: 600;\n  font-size: 0.875rem;\n  color: #1e293b;\n}\n.type-attrs[data-v-176b782c] {\n  font-size: 0.8125rem;\n  color: var(--color-text-secondary);\n  line-height: 1.5;\n}\n.attributes-desc[data-v-176b782c] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 0.75rem;\n}\n.attr-card[data-v-176b782c] {\n  padding: 0.75rem;\n  background: linear-gradient(135deg, #fefefe 0%, #f8fafc 100%);\n  border-radius: 10px;\n  border: 1px solid #e2e8f0;\n}\n.attr-header[data-v-176b782c] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n.attr-icon[data-v-176b782c] {\n  font-size: 1.25rem;\n}\n.attr-name[data-v-176b782c] {\n  font-weight: 600;\n  font-size: 0.875rem;\n  color: #1e293b;\n}\n.attr-card p[data-v-176b782c] {\n  margin: 0;\n  font-size: 0.8125rem;\n  color: var(--color-text-secondary);\n  line-height: 1.6;\n}\n\n/* 深色主题适配 */\n[data-theme="dark"] .help-modal[data-v-176b782c] {\n  background: var(--color-surface, #1e293b);\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .help-modal-header[data-v-176b782c] {\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom-color: var(--color-border, rgba(255, 255, 255, 0.1));\n}\n[data-theme="dark"] .help-modal-header h3[data-v-176b782c],\n[data-theme="dark"] .help-section h4[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .help-section ol[data-v-176b782c],\n[data-theme="dark"] .tips-list[data-v-176b782c] {\n  color: var(--color-text-secondary, #94a3b8);\n}\n\n/* -- 深色主题下的结果文字颜色 -- */\n[data-theme="dark"] .result-item.perfect .result-label[data-v-176b782c],\n[data-theme="dark"] .result-item.perfect .result-desc[data-v-176b782c] {\n  color: #fcd34d;\n}\n[data-theme="dark"] .result-item.great-success .result-label[data-v-176b782c],\n[data-theme="dark"] .result-item.great-success .result-desc[data-v-176b782c] {\n  color: #86efac;\n}\n[data-theme="dark"] .result-item.success .result-label[data-v-176b782c],\n[data-theme="dark"] .result-item.success .result-desc[data-v-176b782c] {\n  color: #93c5fd;\n}\n[data-theme="dark"] .result-item.failure .result-label[data-v-176b782c],\n[data-theme="dark"] .result-item.failure .result-desc[data-v-176b782c] {\n  color: #fca5a5;\n}\n[data-theme="dark"] .result-item.critical-failure .result-label[data-v-176b782c],\n[data-theme="dark"] .result-item.critical-failure .result-desc[data-v-176b782c] {\n  color: #d8b4fe;\n}\n[data-theme="dark"] .close-btn[data-v-176b782c] {\n  background: rgba(255, 255, 255, 0.05);\n  border-color: var(--color-border, rgba(255, 255, 255, 0.1));\n  color: var(--color-text-secondary, #94a3b8);\n}\n[data-theme="dark"] .close-btn[data-v-176b782c]:hover {\n  background: rgba(239, 68, 68, 0.2);\n  border-color: #ef4444;\n}\n[data-theme="dark"] .help-btn[data-v-176b782c] {\n  background: rgba(255, 255, 255, 0.05);\n  border-color: var(--color-border, rgba(255, 255, 255, 0.1));\n  color: var(--color-text-secondary, #94a3b8);\n}\n[data-theme="dark"] .help-btn[data-v-176b782c]:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: var(--card-color, #6366f1);\n  color: var(--card-color, #6366f1);\n}\n[data-theme="dark"] .type-item[data-v-176b782c] {\n  background: rgba(255, 255, 255, 0.03);\n  border-color: var(--color-border, rgba(255, 255, 255, 0.1));\n}\n[data-theme="dark"] .type-name[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .type-attrs[data-v-176b782c] {\n  color: var(--color-text-secondary, #94a3b8);\n}\n[data-theme="dark"] .attr-card[data-v-176b782c] {\n  background: rgba(255, 255, 255, 0.03);\n  border-color: var(--color-border, rgba(255, 255, 255, 0.1));\n}\n[data-theme="dark"] .attr-name[data-v-176b782c] {\n  color: var(--color-text, #f7f7f5);\n}\n[data-theme="dark"] .attr-card p[data-v-176b782c] {\n  color: var(--color-text-secondary, #94a3b8);\n}\n[data-theme="dark"] .formula-box[data-v-176b782c] {\n  background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.1) 100%);\n  border-left-color: #f59e0b;\n  color: #fbbf24;\n}\n[data-theme="dark"] .formula-box strong[data-v-176b782c] {\n  color: #fcd34d;\n}\n',""]);const i=l},8587:(e,n,t)=>{t.d(n,{hy:()=>v,Dj:()=>c});var a=t(8651),o=t(2224),r=t(9808),l=t(8708),i=t(3098);async function c(e,n,r=!1){console.log("[processGmResponse] 开始处理GM响应，isInitialization=",r);const l={changes:[]};if(!e){console.warn("[processGmResponse] 响应为空，返回原始数据");const{repairSaveData:e}=await Promise.resolve().then(t.bind(t,6588));return{saveData:e(n),stateChanges:l}}const{repairSaveData:i}=await Promise.resolve().then(t.bind(t,6588)),c=i(n);let v=(0,o.cloneDeep)(c),u=l;if(Array.isArray(e.tavern_commands)&&e.tavern_commands.length>0){console.log(`[processGmResponse] 🎯 收到 ${e.tavern_commands.length} 个酒馆命令，开始执行...`),console.log("[processGmResponse] 命令详情:",e.tavern_commands);const n=e.tavern_commands.find(e=>"角色基础信息.灵根"===e.key),r=e.tavern_commands.find(e=>"角色基础信息.出生"===e.key);n&&console.log("[processGmResponse] 🔥 检测到灵根替换命令:",JSON.stringify(n.value)),r&&console.log("[processGmResponse] 🔥 检测到出生替换命令:",JSON.stringify(r.value));const l=await async function(e,n){let t=(0,o.cloneDeep)(n);const a=[];for(const n of e){if(!n||!n.action||!n.key)continue;const{action:e,key:r}=n,l=s(r),i=(0,o.cloneDeep)((0,o.get)(t,l));t=await d(n,t);const c=(0,o.cloneDeep)((0,o.get)(t,l));JSON.stringify(i)!==JSON.stringify(c)&&a.push({key:l,action:e,oldValue:i,newValue:c})}return console.log("[executeCommands] 命令执行完成，共",a.length,"个变更（未同步）"),{saveData:t,stateChanges:{changes:a}}}(e.tavern_commands,v);if(v=l.saveData,u=l.stateChanges,n&&console.log("[processGmResponse] ✅ 灵根替换后的值:",JSON.stringify(v.角色基础信息?.灵根)),r&&console.log("[processGmResponse] ✅ 出生替换后的值:",JSON.stringify(v.角色基础信息?.出生)),e.tavern_commands.some(e=>e.key?.includes("游戏时间")||e.key?.includes("game_time"))){console.log("[processGmResponse] 🕐 检测到时间更新，自动更新玩家和NPC年龄");const{updateLifespanFromGameTime:e,updateNpcLifespanFromGameTime:n}=await Promise.resolve().then(t.bind(t,6939)),a=e(v);console.log("[processGmResponse] 玩家当前年龄:",a);const o=v.人物关系||{},r=v.游戏时间;if(r)for(const[e,t]of Object.entries(o))if(t&&"object"==typeof t){const a=n(t,r);console.log(`[processGmResponse] NPC [${e}] 当前年龄:`,a)}}try{u?.changes?.length?(console.log("[processGmResponse] 🎯 准备同步",u.changes.length,"个变更到酒馆"),console.log("[processGmResponse] 变更详情:",u.changes.map(e=>({key:e.key,action:e.action}))),await async function(e,n="chat"){try{console.log("[syncChangesToTavern] ========== 开始同步到酒馆 =========="),console.log("[syncChangesToTavern] 需要同步的变更数量:",e.length);const r=(0,a.getTavernHelper)();if(!r)return void console.warn("[syncChangesToTavern] 酒馆助手不可用");if(0===e.length)return void console.log("[syncChangesToTavern] 无变更需要同步");const l={};for(const n of e){const e=m(n.key);console.log(`[syncChangesToTavern] 路径 "${n.key}" -> 分片 "${e}"`),e?(l[e]||(l[e]=[]),l[e].push(n)):console.warn("[syncChangesToTavern] ⚠️ 无法确定分片:",n.key)}console.log(`[syncChangesToTavern] 分片分组完成，共 ${Object.keys(l).length} 个分片受影响:`,Object.keys(l));for(const[e,a]of Object.entries(l)){console.log(`[syncChangesToTavern] 处理分片 "${e}"，包含 ${a.length} 个变更`);let l=await r.getVariable(e,{type:n});l||(l=e.startsWith("记忆_")?[]:{},console.log("[syncChangesToTavern] 分片不存在，创建新的:",e.startsWith("记忆_")?"数组":"对象"));for(const n of a){const t=p(n.key,e);console.log(`[syncChangesToTavern]   应用变更: 路径="${t}", 值=`,n.newValue),e.startsWith("记忆_")&&!t?(l=n.newValue,console.log("[syncChangesToTavern]   ✅ 替换整个记忆数组")):((0,o.set)(l,t,n.newValue),console.log(`[syncChangesToTavern]   ✅ 已设置 ${t}`))}const{deepCleanForClone:i}=await Promise.resolve().then(t.bind(t,3098));await r.setVariable(e,i(l),{type:n}),console.log(`[syncChangesToTavern] ✅ 分片 "${e}" 已更新到酒馆`)}console.log(`[syncChangesToTavern] 同步完成，更新了 ${e.length} 个字段到 ${Object.keys(l).length} 个分片`)}catch(e){console.error("[syncChangesToTavern] 同步失败:",e)}}(u.changes,"chat"),console.log("[processGmResponse] ✅ 已同步变更到 Tavern 分片变量")):console.warn("[processGmResponse] ⚠️ 没有变更需要同步（stateChanges.changes为空）")}catch(e){throw console.error("[processGmResponse] ❌ 同步变更到酒馆失败:",e),e}console.log("[processGmResponse] ✅ 所有命令执行完成")}else console.log("[processGmResponse] ⚠️ 没有 tavern_commands 需要执行");if(r&&e.text){v.记忆||(v.记忆={短期记忆:[],中期记忆:[],长期记忆:[],隐式中期记忆:[]}),Array.isArray(v.记忆.短期记忆)||(v.记忆.短期记忆=[]),Array.isArray(v.记忆.隐式中期记忆)||(v.记忆.隐式中期记忆=[]);const n=`${function(e){if(!e)return"【仙历元年】";const n=function(e){return e.分钟??0}(e);return`【仙道${e.年}年${e.月}月${e.日}日 ${String(e.小时).padStart(2,"0")}:${String(n).padStart(2,"0")}】`}(v.游戏时间)}${e.text}`;v.记忆.短期记忆.push(n),console.log("[processGmResponse] ✅ 已添加初始化短期记忆"),console.log("[processGmResponse] 记忆内容（前100字符）:",n.substring(0,100)),console.log("[processGmResponse] 当前短期记忆数量:",v.记忆.短期记忆.length)}else r||console.log("[processGmResponse] ⚠️ 非初始化阶段，跳过短期记忆添加（由MainGamePanel处理）");return console.log("[processGmResponse] 执行最终数据修复和验证"),v=i(v),console.log("[processGmResponse] ✅ GM响应处理完成，数据已修复和验证"),{saveData:v,stateChanges:u}}function s(e){return e.startsWith("基础信息.")?"角色基础信息."+e.substring(5):"基础信息"===e?"角色基础信息":e.startsWith("境界.")?"玩家角色状态.境界."+e.substring(3):"境界"===e?"玩家角色状态.境界":e.startsWith("属性.")?"玩家角色状态."+e.substring(3):"属性"===e?"玩家角色状态":e.startsWith("位置.")?"玩家角色状态.位置."+e.substring(3):"位置"===e?"玩家角色状态.位置":e.startsWith("修炼功法.")||"修炼功法"===e||e.startsWith("装备栏.")||"装备栏"===e?e:e.startsWith("背包_灵石.")?"背包.灵石."+e.substring(6):"背包_灵石"===e?"背包.灵石":e.startsWith("背包_物品.")?"背包.物品."+e.substring(6):"背包_物品"===e?"背包.物品":e.startsWith("人物关系.")||"人物关系"===e||e.startsWith("三千大道.")||"三千大道"===e||e.startsWith("世界信息.")||"世界信息"===e?e:e.startsWith("记忆_短期.")?"记忆.短期记忆."+e.substring(6):"记忆_短期"===e?"记忆.短期记忆":e.startsWith("记忆_中期.")?"记忆.中期记忆."+e.substring(6):"记忆_中期"===e?"记忆.中期记忆":e.startsWith("记忆_长期.")?"记忆.长期记忆."+e.substring(6):"记忆_长期"===e?"记忆.长期记忆":e.startsWith("记忆_隐式中期.")?"记忆.隐式中期记忆."+e.substring(8):"记忆_隐式中期"===e?"记忆.隐式中期记忆":e.startsWith("游戏时间.")||"游戏时间"===e?e:e.startsWith("状态效果.")?"玩家角色状态.状态效果."+e.substring(5):"状态效果"===e?"玩家角色状态.状态效果":(console.warn("[路径映射] 未识别的分片路径，保持原样:",e),e)}async function d(e,n){if(!e||!e.action||!e.key)return console.warn("[executeCommand] 无效命令:",e),n;const{action:r,key:c,value:d}=e,m=(e,n=0,t=10)=>{const a="number"==typeof e?e:parseFloat(String(e));return Number.isNaN(a)?n:Math.max(n,Math.min(t,a))},p=(e,n)=>{const t=n?.["角色基础信息"]?.["世界"]||"朝天大陆",a=e=>{let n=String(e||"").trim();if(!n)return`${t}·未知之地`;n=n.replace(/[，,、/\\|>]+/g,"·").replace(/\s*[-—–]\s*/g,"·").replace(/\s*·\s*/g,"·").replace(/。/g,"").replace(/\.\s*/g,"·"),n.includes("·")||(n=n.replace(/\s+/g,"·"));let a=n.split("·").map(e=>e.trim()).filter(Boolean).map(e=>{let n=e.trim();return n=n.replace(/的/g,""),n=n.replace(/[之的]?([上中下里内外处间旁畔边]{1})$/g,""),n});return a=a.filter(Boolean),0===a.length&&(a=["未知之地"]),a[0]!==t&&a.unshift(t),a.length>3&&(a=a.slice(0,3)),a.join("·")};if("string"==typeof e)return{描述:a(e)};if(e&&"object"==typeof e&&"描述"in e){const o=e;let r=a(o["描述"]);if("number"==typeof o.x&&"number"==typeof o.y){const e=o.x,a=o.y,l=((e,a)=>{const o=n?.["世界信息"],r=o?.["地点信息"]||[];let l=null,i=1/0;for(const n of r){const t=n.x??n.coordinates?.longitude,o=n.y??n.coordinates?.latitude;if(void 0!==t&&void 0!==o){const r=Math.sqrt(Math.pow(t-e,2)+Math.pow(o-a,2));r<i&&(i=r,l=n)}}if(l&&i<200){const e=l["名称"]||l["地点名称"]||"";if(e.includes("·"))return e.split("·").slice(0,-1).join("·")}const c=o?.["大陆信息"]||[];if(c.length>0){const e=c[0],n=e["名称"]||e.name||t;return n&&/^[a-z_]+$/.test(n)?(console.error(`[位置规范化] ❌ 检测到英文大陆ID: ${n}，这是错误的！应该使用中文名称`),console.error("[位置规范化] 大陆数据:",e),c[0]&&c[0]["名称"]?c[0]["名称"]:t):(console.log(`[位置规范化] 使用大陆: ${n}`),n)}return console.error("[位置规范化] 世界信息中没有大陆数据，回退到世界名"),t})(e,a);return(!r.includes("·")||r.split("·").length<2)&&(r=`${l}·${r.replace(t+"·","")}`),{...o,描述:r,x:e,y:a}}return{...o,描述:r}}return e},v=s(c);console.log("[executeCommand] ========== 开始执行命令 =========="),console.log(`[executeCommand] 原始路径: ${c}`),console.log(`[executeCommand] 映射路径: ${v}`),console.log(`[executeCommand] 动作: ${r}`),console.log("[executeCommand] 值:",d),console.log("[executeCommand] 值类型:",typeof d);try{let e=null;switch("set"===r&&v.startsWith("装备栏.装备")&&(e=(0,o.get)(n,v),console.log(`[装备增幅] 准备变更 ${v}，旧装备ID: ${e||"无"}`)),r){case"set":if(String(v).includes("境界")&&console.log(`[executeCommand] 🌟 境界更新 - 路径: ${v}, 新值:`,d),String(v).includes("背包.物品")||String(v).includes("修炼功法.功法"))(0,o.set)(n,v,(e=>{try{if(!e||"object"!=typeof e)return e;const n=e,t=(n.类型||"").trim();if(!["装备","功法","其他"].includes(t))return e;const a={凡品:"凡",凡阶:"凡",凡:"凡",黄品:"黄",黄阶:"黄",黄:"黄",玄品:"玄",玄阶:"玄",玄:"玄",地品:"地",地阶:"地",地:"地",天品:"天",天阶:"天",天:"天",仙品:"仙",仙阶:"仙",仙:"仙",神品:"神",神阶:"神",神:"神"},o={残缺:0,下品:2,中品:5,上品:8,极品:10},r=n.品质||{},l=a[String(r.quality??r.品质??"").trim()]||"凡",i=r.grade??r.品级??r.等级;let c=0;return"number"!=typeof i||Number.isNaN(i)?"string"==typeof i&&i.trim()&&(c=o[i.trim()]??0):c=Math.min(10,Math.max(0,Math.round(i))),n.品质={quality:l,grade:c},"装备"!==t&&"功法"!==t||(void 0===n.已装备&&(n.已装备=!1),void 0!==n.是否装备&&(console.warn('[物品规范化] 发现重复的装备状态字段"是否装备"，已清理'),delete n.是否装备)),n.物品ID||(n.物品ID=`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),n}catch{return e}})(d)),console.log("[executeCommand] ✅ 已设置(规范化物品/功法):",(0,o.get)(n,v));else if(v.startsWith("人物关系.")){const[e,t]=(0,i.jx)(d);e&&t?((0,o.set)(n,v,t),console.log(`[executeCommand] ✅ 已设置(校验通过的NPC): ${t.名字}`)):console.error(`[executeCommand] ❌ 校验失败：无效的NPC数据，已阻止写入。路径: ${v}`,d)}else if(String(v).endsWith("玩家角色状态.位置.描述")||String(v).endsWith("位置.描述")){const e=p(d,n),t="object"==typeof e&&null!==e&&"描述"in e?e.描述:e;(0,o.set)(n,v,t),console.log("[executeCommand] ✅ 已设置(规范化位置):",(0,o.get)(n,v))}else if(String(v).endsWith("玩家角色状态.位置"))(0,o.set)(n,v,p(d,n)),console.log("[executeCommand] ✅ 已设置(规范化位置对象):",(0,o.get)(n,v));else{const e=((e,n)=>{if(!String(e).includes("先天六司"))return n;try{if("object"==typeof n&&null!==n&&(String(e).endsWith("先天六司")||String(e).endsWith("先天六司."))){const e={...n};return"根骨"in e&&(e["根骨"]=m(e["根骨"])),"灵性"in e&&(e["灵性"]=m(e["灵性"])),"悟性"in e&&(e["悟性"]=m(e["悟性"])),"气运"in e&&(e["气运"]=m(e["气运"])),"魅力"in e&&(e["魅力"]=m(e["魅力"])),"心性"in e&&(e["心性"]=m(e["心性"])),e}return"number"==typeof n?m(n):n}catch{return n}})(v,d);(0,o.set)(n,v,e),console.log("[executeCommand] ✅ 已设置:",(0,o.get)(n,v))}if(String(v).includes("境界")){const e=(0,o.get)(n,"玩家角色状态.境界");console.log("[executeCommand] 🌟 境界更新后验证 - 完整境界对象:",e)}if(v.startsWith("三千大道.大道进度."))try{const e=v.substring(10),t=(0,o.get)(n,"三千大道.已解锁大道",[]);Array.isArray(t)&&!t.includes(e)&&(t.push(e),(0,o.set)(n,"三千大道.已解锁大道",t),console.log(`[executeCommand] 特例：已自动解锁大道 "${e}"`))}catch(e){console.error("[executeCommand] 自动解锁大道失败:",e)}if(String(v).includes("背包.物品.")&&String(v).endsWith(".修炼进度"))try{const e=String(v).split(".")[2];n.修炼功法?.物品ID===e&&(n.修炼功法.修炼进度="number"==typeof d?d:Number(d)||0,console.log(`[修炼进度同步] ✅ 已同步修炼进度到修炼功法字段: ${d}`))}catch(e){console.error("[修炼进度同步] 同步修炼进度失败:",e)}if(String(v).includes("背包.物品.")&&String(v).endsWith(".修炼进度"))try{console.log("[掌握技能] 检测到功法修炼进度设置，自动重新计算掌握技能");const e=(0,l.F)(n);console.log(`[掌握技能] ✅ 已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){console.error("[掌握技能] 自动计算掌握技能失败:",e)}if(v.startsWith("装备栏.装备"))try{const r=String(d||"");console.log(`[装备增幅] 检测到装备栏变更: ${v}`),console.log(`[装备增幅] 旧装备ID: ${e||"无"}`),console.log(`[装备增幅] 新装备ID: ${r||"无"}`);let l=!1;if(e&&"null"!==e&&e!==r){console.log(`[装备增幅] 移除旧装备 ${e} 的属性加成`);const t=function(e,n){try{const t=e.背包?.物品?.[n];if(!t||"装备"!==t.类型)return console.warn(`[装备增幅] 物品 ${n} 不是装备类型`),!1;const a=t.装备增幅;if(!a)return console.log(`[装备增幅] 装备 ${t.名称} 没有属性加成`),!0;if(console.log(`[装备增幅] 开始移除装备 ${t.名称} 的属性加成:`,a),a.气血上限&&"number"==typeof a.气血上限){const n=(0,o.get)(e,"玩家角色状态.气血",{当前:100,上限:100}),t=Math.max(1,n.上限-a.气血上限);(0,o.set)(e,"玩家角色状态.气血.上限",t),n.当前>t&&((0,o.set)(e,"玩家角色状态.气血.当前",t),console.log(`[装备增幅] 气血当前值超过新上限，已调整: ${n.当前} -> ${t}`)),console.log(`[装备增幅] 气血上限: ${n.上限} -> ${t} (-${a.气血上限})`)}if(a.灵气上限&&"number"==typeof a.灵气上限){const n=(0,o.get)(e,"玩家角色状态.灵气",{当前:100,上限:100}),t=Math.max(1,n.上限-a.灵气上限);(0,o.set)(e,"玩家角色状态.灵气.上限",t),n.当前>t&&((0,o.set)(e,"玩家角色状态.灵气.当前",t),console.log(`[装备增幅] 灵气当前值超过新上限，已调整: ${n.当前} -> ${t}`)),console.log(`[装备增幅] 灵气上限: ${n.上限} -> ${t} (-${a.灵气上限})`)}if(a.神识上限&&"number"==typeof a.神识上限){const n=(0,o.get)(e,"玩家角色状态.神识",{当前:100,上限:100}),t=Math.max(1,n.上限-a.神识上限);(0,o.set)(e,"玩家角色状态.神识.上限",t),n.当前>t&&((0,o.set)(e,"玩家角色状态.神识.当前",t),console.log(`[装备增幅] 神识当前值超过新上限，已调整: ${n.当前} -> ${t}`)),console.log(`[装备增幅] 神识上限: ${n.上限} -> ${t} (-${a.神识上限})`)}return console.log(`[装备增幅] ✅ 成功移除装备 ${t.名称} 的属性加成`),!0}catch(e){return console.error("[装备增幅] 移除装备加成失败:",e),!1}}(n,e);t&&(l=!0)}if(r&&"null"!==r&&r!==e){console.log(`[装备增幅] 应用新装备 ${r} 的属性加成`);const e=function(e,n){try{const t=e.背包?.物品?.[n];if(!t||"装备"!==t.类型)return console.warn(`[装备增幅] 物品 ${n} 不是装备类型`),!1;const a=t.装备增幅;if(!a)return console.log(`[装备增幅] 装备 ${t.名称} 没有属性加成`),!0;if(console.log(`[装备增幅] 开始应用装备 ${t.名称} 的属性加成:`,a),a.气血上限&&"number"==typeof a.气血上限){const n=(0,o.get)(e,"玩家角色状态.气血",{当前:100,上限:100}),t=n.上限+a.气血上限;(0,o.set)(e,"玩家角色状态.气血.上限",t),console.log(`[装备增幅] 气血上限: ${n.上限} -> ${t} (+${a.气血上限})`)}if(a.灵气上限&&"number"==typeof a.灵气上限){const n=(0,o.get)(e,"玩家角色状态.灵气",{当前:100,上限:100}),t=n.上限+a.灵气上限;(0,o.set)(e,"玩家角色状态.灵气.上限",t),console.log(`[装备增幅] 灵气上限: ${n.上限} -> ${t} (+${a.灵气上限})`)}if(a.神识上限&&"number"==typeof a.神识上限){const n=(0,o.get)(e,"玩家角色状态.神识",{当前:100,上限:100}),t=n.上限+a.神识上限;(0,o.set)(e,"玩家角色状态.神识.上限",t),console.log(`[装备增幅] 神识上限: ${n.上限} -> ${t} (+${a.神识上限})`)}return console.log(`[装备增幅] ✅ 成功应用装备 ${t.名称} 的属性加成`),!0}catch(e){return console.error("[装备增幅] 应用装备加成失败:",e),!1}}(n,r);e&&(l=!0)}if(l){const e=(0,a.getTavernHelper)();if(e){const a={气血:n.玩家角色状态?.气血,灵气:n.玩家角色状态?.灵气,神识:n.玩家角色状态?.神识,寿命:n.玩家角色状态?.寿命},{deepCleanForClone:o}=await Promise.resolve().then(t.bind(t,3098)),r=o({属性:a});await e.insertOrAssignVariables(r,{type:"chat"}),console.log("[装备增幅] ✅ 已同步属性分片到酒馆:",a)}}}catch(e){console.error("[装备增幅] 处理装备增幅失败:",e)}break;case"add":const c=(0,o.get)(n,v,0);let s=Number(c)+Number(d||0);if(String(v).includes("先天六司")&&(s=m(s)),"游戏时间.分钟"===v||v.endsWith("游戏时间.分钟")){console.log(`[executeCommand] 🕐 时间推进 ${d} 分钟，开始自动进位计算`);const e=(0,o.get)(n,"游戏时间",{年:1,月:1,日:1,小时:0,分钟:0}),t=e.分钟||0,a=e.小时||0,r=(e.日||1)-1,l=(e.月||1)-1,i=(e.年||1)-1,c=60,s=24,m=30,p=12,v=i*p*m*s*c+l*m*s*c+r*s*c+a*c+t+Number(d||0),u=c*s,g=u*m,f=g*p;let b=v;const h=Math.floor(b/f)+1;b%=f;const y=Math.floor(b/g)%p+1;b%=g;const x=Math.floor(b/u)%m+1;b%=u;const k=Math.floor(b/c)%s,w=b%c;(0,o.set)(n,"游戏时间",{年:h,月:y,日:x,小时:k,分钟:w}),console.log(`[executeCommand] ✅ 游戏时间已更新: ${h}年${y}月${x}日 ${k}:${w}`),console.log(`[executeCommand]   原时间: ${e.年}年${e.月}月${e.日}日 ${e.小时}:${t}`),console.log(`[executeCommand]   推进: ${d}分钟`)}else{if((0,o.set)(n,v,s),console.log(`[executeCommand] ✅ 已增加: ${c} + ${d} = ${s}`),String(v).includes("背包.物品.")&&String(v).endsWith(".修炼进度"))try{const e=String(v).split(".")[2];n.修炼功法?.物品ID===e&&(n.修炼功法.修炼进度=s,console.log(`[修炼进度同步] ✅ 已同步修炼进度到修炼功法字段: ${s}`))}catch(e){console.error("[修炼进度同步] 同步修炼进度失败:",e)}if(String(v).includes("背包.物品.")&&String(v).endsWith(".修炼进度"))try{console.log("[掌握技能] 检测到功法修炼进度更新，自动重新计算掌握技能");const e=(0,l.F)(n);console.log(`[掌握技能] ✅ 已更新掌握技能列表，共 ${e.length} 个技能`)}catch(e){console.error("[掌握技能] 自动计算掌握技能失败:",e)}}break;case"push":const u=(0,o.get)(n,v,[]);if(Array.isArray(u))if("人物关系"===v){const[e,n]=(0,i.jx)(d);e&&n?(u.push(n),console.log(`[executeCommand] ✅ 已推入(校验通过的NPC): ${n.名字}`)):console.error(`[executeCommand] ❌ 校验失败：无效的NPC数据，已阻止推入。路径: ${v}`,d)}else u.push(d??null),console.log("[executeCommand] ✅ 已添加到数组，当前长度:",u.length);else if("人物关系"===v){const[e,t]=(0,i.jx)(d);e&&t?((0,o.set)(n,v,[t]),console.log(`[executeCommand] ✅ 已创建新数组并添加(校验通过的NPC): ${t.名字}`)):console.error(`[executeCommand] ❌ 校验失败：无效的NPC数据，已阻止创建数组。路径: ${v}`,d)}else(0,o.set)(n,v,[d??null]),console.log("[executeCommand] ✅ 已创建新数组并添加元素");break;case"pull":{const e=(0,o.get)(n,v,[]);if(Array.isArray(e)){const n=(e,n)=>{try{return JSON.stringify(e)===JSON.stringify(n)}catch{return e===n}};let t=!1,a=e.indexOf(d);if(a>-1&&(e.splice(a,1),t=!0),t||"object"!=typeof d||null===d||(a=e.findIndex(e=>n(e,d)),a>-1&&(e.splice(a,1),t=!0)),!t&&("string"==typeof d||"number"==typeof d)){const n=String(d),o=["物品ID","名称","状态名称","id","name"];a=e.findIndex(e=>e&&"object"==typeof e?o.some(t=>String(e[t]??"")===n):String(e)===n),a>-1&&(e.splice(a,1),t=!0)}}}break;case"delete":{const e=String(v).match(/^(.*)\[(\d+)\]$/);if(e){const t=e[1],a=parseInt(e[2],10),r=(0,o.get)(n,t,void 0);Array.isArray(r)&&a>=0&&a<r.length?r.splice(a,1):(0,o.unset)(n,v)}else(0,o.unset)(n,v)}break;default:console.warn("[executeCommand] 未知命令类型:",r)}}catch(e){console.error("[executeCommand] 命令执行失败:",e)}return n}function m(e){const n=e;return n.startsWith("角色基础信息")?"基础信息":n.startsWith("玩家角色状态.境界")?"境界":n.startsWith("玩家角色状态.气血")||n.startsWith("玩家角色状态.灵气")||n.startsWith("玩家角色状态.神识")||n.startsWith("玩家角色状态.寿命")?"属性":n.startsWith("玩家角色状态.位置")?"位置":n.startsWith("修炼功法")?"修炼功法":n.startsWith("掌握技能")?"掌握技能":n.startsWith("装备栏")?"装备栏":n.startsWith("背包.灵石")?"背包_灵石":n.startsWith("背包.物品")?"背包_物品":n.startsWith("人物关系")?"人物关系":n.startsWith("三千大道")?"三千大道":n.startsWith("世界信息")?"世界信息":n.startsWith("记忆.短期记忆")?"记忆_短期":n.startsWith("记忆.中期记忆")?"记忆_中期":n.startsWith("记忆.长期记忆")?"记忆_长期":n.startsWith("记忆.隐式中期记忆")?"记忆_隐式中期":n.startsWith("游戏时间")?"游戏时间":n.startsWith("玩家角色状态.状态效果")?"状态效果":n.startsWith("系统")?"系统":null}function p(e,n){const t=e,a={基础信息:"角色基础信息.",境界:"玩家角色状态.境界.",属性:"玩家角色状态.",位置:"玩家角色状态.位置.",修炼功法:"修炼功法.",掌握技能:"掌握技能.",装备栏:"装备栏.",背包_灵石:"背包.灵石.",背包_物品:"背包.物品.",人物关系:"人物关系.",三千大道:"三千大道.",世界信息:"世界信息.",记忆_短期:"记忆.短期记忆",记忆_中期:"记忆.中期记忆",记忆_长期:"记忆.长期记忆",记忆_隐式中期:"记忆.隐式中期记忆",游戏时间:"游戏时间.",状态效果:"玩家角色状态.状态效果",系统:"系统."}[n];return a&&t.startsWith(a)?"属性"===n?t.substring(7):t.substring(a.length):t}async function v(e="chat"){try{const n=(0,a.getTavernHelper)();if(!n)return console.warn("[getFromTavern] 酒馆助手不可用"),null;const t=await n.getVariables({type:e}),o={基础信息:t["基础信息"],境界:t["境界"],属性:t["属性"],位置:t["位置"],修炼功法:t["修炼功法"],装备栏:t["装备栏"],背包_灵石:t["背包_灵石"],背包_物品:t["背包_物品"],人物关系:t["人物关系"],三千大道:t["三千大道"],世界信息:t["世界信息"],记忆_短期:t["记忆_短期"],记忆_中期:t["记忆_中期"],记忆_长期:t["记忆_长期"],记忆_隐式中期:t["记忆_隐式中期"],游戏时间:t["游戏时间"],状态效果:t["状态效果"],系统:t["系统"]};return console.log("[getFromTavern] 从17个分片重组SaveData"),(0,r.assembleSaveData)(o)}catch(e){return console.error("[getFromTavern] 获取数据失败:",e),null}}},8651:(e,n,t)=>{t.d(n,{c$:()=>i,getTavernHelper:()=>r,wz:()=>l});var a=t(4270),o=t(9173);function r(){const e=window.parent?.TavernHelper;if(!e)return console.error("TavernHelper API not found in window.parent."),null;const n=e;return"function"!=typeof n.getVariable&&(n.getVariable=async(e,t)=>{if("function"==typeof n.getVariables){const a=await n.getVariables(t);return a?a[e]:void 0}throw new Error("getVariable is not available and getVariables fallback missing")}),"function"!=typeof n.setVariable&&(n.setVariable=async(e,a,o)=>{if("function"==typeof n.insertOrAssignVariables){const{deepCleanForClone:r}=await Promise.resolve().then(t.bind(t,3098)),l=r({[e]:a});return void await n.insertOrAssignVariables(l,o)}throw new Error("setVariable is not available and insertOrAssignVariables fallback missing")}),n}async function l(){const e=r();if(!e)return console.warn("TavernHelper API不可用，无法获取用户名称。"),null;try{const n=await e.substitudeMacros("{{user}}");return n&&"{{user}}"!==n&&""!==n.trim()?(console.log("成功获取用户名字:",n),n.trim()):(console.warn("无法获取当前用户名称，{{user}}宏未正确解析。"),null)}catch(e){return console.error("获取用户名称时出错:",e),null}}async function i(){const e=r(),n=(0,o.useUIStore)();if(!e)return void console.warn("TavernHelper不可用，跳过清理流程。");n.updateLoadingText("正在净化天地，重置天机...");try{if(console.log("[清理] 使用clearChat彻底清空聊天和变量..."),e.clearChat)return await e.clearChat(),console.log("[清理] ✅ clearChat执行成功"),void n.updateLoadingText("天机已彻底重置，准备开启新道途。")}catch(e){console.warn("[清理] clearChat执行失败，尝试逐个删除:",e)}let t=0,l=0;try{let n={},a=[];try{n=await e.getVariables({type:"chat"}),a=Object.keys(n)}catch(e){console.warn("[清理] getVariables 失败（可能有坏数据），使用已知变量名列表:",e?.message),a=["基础信息","境界","属性","位置","修炼功法","掌握技能","装备栏","背包_灵石","背包_物品","人物关系","三千大道","世界信息","记忆_短期","记忆_中期","记忆_长期","记忆_隐式中期","游戏时间","状态效果","系统","背包","装备栏","修炼功法","人物关系","宗门系统","玩家角色状态","背包数据","装备栏数据","修炼功法数据","character.memorySettings"]}if(a.length>0){console.log(`[清理] 发现 ${a.length} 个聊天变量，全部清理:`,a);let n=0;for(const t of a)try{await e.deleteVariable(t,{type:"chat"}),n++}catch(e){console.warn(`[清理] 删除聊天变量 ${t} 失败:`,e)}console.log(`[清理] 聊天变量清理完成，成功删除 ${n}/${a.length} 个。`)}else console.log("[清理] 未发现需要清理的聊天变量。");t++}catch(e){console.warn("[清理] 清理聊天变量时出现非致命错误:",e),l++}try{const n=await e.getVariables({type:"global"}),a=Object.keys(n),o=["DAD_creationData"],r=a.filter(e=>!o.includes(e));if(r.length>0){console.log(`[清理] 发现 ${r.length} 个全局变量需要清理:`,r),a.length>r.length&&console.log(`[清理] 保留 ${a.length-r.length} 个全局变量:`,o.filter(e=>a.includes(e)));let n=0;for(const t of r)try{await e.deleteVariable(t,{type:"global"}),n++}catch(e){console.warn(`[清理] 删除全局变量 ${t} 失败:`,e)}console.log(`[清理] 全局变量清理完成，成功删除 ${n}/${r.length} 个。`)}else console.log("[清理] 未发现需要清理的全局变量。");t++}catch(e){console.warn("[清理] 清理全局变量时出现非致命错误:",e),l++}try{try{const n=await e.getVariables({type:"local"}),a=Object.keys(n);if(a.length>0){console.log(`[清理] 发现 ${a.length} 个本地变量，全部清理:`,a);let n=0;for(const t of a)try{await e.deleteVariable(t,{type:"local"}),n++}catch(e){console.warn(`[清理] 删除本地变量 ${t} 失败:`,e)}console.log(`[清理] 本地变量清理完成，成功删除 ${n}/${a.length} 个。`)}else console.log("[清理] 未发现需要清理的本地变量。");t++}catch(e){console.log("[清理] 跳过本地变量清理（可能不支持）:",e)}}catch(e){console.warn("[清理] 清理本地变量时出现非致命错误:",e),l++}try{console.log("[清理] 开始清空聊天历史记录..."),e.clearChat?(await e.clearChat(),console.log("[清理] 聊天历史记录已清空"),t++):console.warn("[清理] clearChat 方法不可用，跳过清空聊天记录")}catch(e){console.warn("[清理] 清空聊天记录时出现非致命错误:",e),l++}l>0&&0===t?(a.o.warning("天机重置遇到困难，但将继续尝试创建角色。如遇问题请刷新页面。"),n.updateLoadingText("天机重置遇到困难，继续尝试开启新道途...")):l>0?(a.o.info("天机已部分重置，少数数据清理失败，但不影响使用。"),n.updateLoadingText("天机已重置，准备开启新道途。")):(console.log("[清理] ✅ 天机已彻底重置，所有变量已清空"),n.updateLoadingText("天机已彻底重置，准备开启新道途。"))}},8708:(e,n,t)=>{t.d(n,{F:()=>o});var a=t(3302);function o(e){const n=function(e){a.Yz.log("掌握技能计算","开始计算已掌握技能...");const n=[];if(!e?.背包?.物品)return a.Yz.warn("掌握技能计算","背包物品不存在，返回空数组"),n;for(const[t,o]of Object.entries(e.背包.物品)){if("功法"!==o.类型)continue;const e=o;if(!e.功法技能||"object"!=typeof e.功法技能){a.Yz.log("掌握技能计算",`功法 ${e.名称} 没有技能定义`);continue}const t=e.修炼进度||0;a.Yz.log("掌握技能计算",`检查功法 ${e.名称}，修炼进度: ${t}`);for(const[o,r]of Object.entries(e.功法技能)){const l=r.解锁需要熟练度||0;a.Yz.log("掌握技能计算",`  技能 ${o}，解锁阈值: ${l}`),t>=l?n.find(n=>n.技能名称===o&&n.来源===e.名称)||(n.push({技能名称:o,技能描述:r.技能描述||r.描述||"",来源:e.名称,消耗:r.消耗||"",熟练度:0,使用次数:0}),a.Yz.log("掌握技能计算",`  ✅ 解锁技能: ${o} (来自 ${e.名称})`)):a.Yz.log("掌握技能计算",`  ❌ 技能 ${o} 未解锁 (${t}/${l})`)}}return a.Yz.log("掌握技能计算",`计算完成，共掌握 ${n.length} 个技能`),n}(e),t=e.掌握技能||[];for(const e of n){const n=t.find(n=>n.技能名称===e.技能名称&&n.来源===e.来源);n&&(e.熟练度=n.熟练度,e.使用次数=n.使用次数)}return e.掌握技能=n,a.Yz.log("掌握技能计算","已更新存档数据中的掌握技能数组"),n}},8932:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.dialog-overlay[data-v-7a662fc0] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.75);\n  backdrop-filter: blur(8px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n  padding: 1rem;\n  animation: fadeIn-7a662fc0 0.3s ease-out;\n}\n@keyframes fadeIn-7a662fc0 {\nfrom { opacity: 0;\n}\nto { opacity: 1;\n}\n}\n.dialog-container[data-v-7a662fc0] {\n  background-color: var(--color-surface);\n  border-radius: 16px;\n  padding: 2rem;\n  width: 100%;\n  max-width: 550px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\n  border: 1px solid var(--color-border);\n  animation: slideInUp-7a662fc0 0.4s cubic-bezier(0.25, 1, 0.5, 1);\n}\n@keyframes slideInUp-7a662fc0 {\nfrom {\n    opacity: 0;\n    transform: translateY(30px) scale(0.98);\n}\nto {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n}\n.dialog-header[data-v-7a662fc0] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n  color: var(--color-danger);\n}\n.header-icon[data-v-7a662fc0] {\n  flex-shrink: 0;\n}\n.header-title[data-v-7a662fc0] {\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 700;\n}\n.dialog-content[data-v-7a662fc0] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  margin-bottom: 2rem;\n}\n.content-lead[data-v-7a662fc0] {\n  font-size: 1rem;\n  line-height: 1.6;\n  color: var(--color-text);\n}\n.error-list-container[data-v-7a662fc0] {\n  background-color: rgba(var(--color-danger-rgb), 0.05);\n  border: 1px solid rgba(var(--color-danger-rgb), 0.2);\n  border-radius: 8px;\n  padding: 1rem;\n}\n.error-list-title[data-v-7a662fc0] {\n  display: block;\n  margin-bottom: 0.75rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.error-list[data-v-7a662fc0] {\n  list-style-type: none;\n  padding-left: 0;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.error-item[data-v-7a662fc0] {\n  font-family: 'Courier New', Courier, monospace;\n  font-size: 0.875rem;\n  color: var(--color-danger);\n  padding: 0.5rem;\n  background-color: rgba(var(--color-danger-rgb), 0.05);\n  border-radius: 4px;\n}\n.content-suggestion[data-v-7a662fc0] {\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: var(--color-text-secondary);\n}\n.content-suggestion strong[data-v-7a662fc0] {\n  color: var(--color-warning);\n  font-weight: 600;\n}\n.dialog-actions[data-v-7a662fc0] {\n  display: flex;\n  justify-content: flex-end;\n}\n.action-button[data-v-7a662fc0] {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  border: none;\n  border-radius: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.confirm-button[data-v-7a662fc0] {\n  background-color: var(--color-primary);\n  color: white;\n}\n.confirm-button[data-v-7a662fc0]:hover {\n  background-color: var(--color-primary-hover);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(var(--color-primary-rgb), 0.3);\n}\n",""]);const i=l},8974:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.login-container[data-v-950f3f12] {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.login-panel[data-v-950f3f12] {\n  width: 100%;\n  max-width: 400px;\n  padding: 2.5rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 15px;\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n}\n.title[data-v-950f3f12] {\n  text-align: center;\n  font-family: var(--font-family-serif);\n  font-size: 2rem;\n  color: var(--color-accent);\n  margin-top: 0;\n  margin-bottom: 0.5rem;\n}\n.subtitle[data-v-950f3f12] {\n  text-align: center;\n  color: var(--color-text-secondary);\n  margin-bottom: 2rem;\n}\n.form-group[data-v-950f3f12] {\n  margin-bottom: 1.5rem;\n}\n.form-group label[data-v-950f3f12] {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n}\n.form-group input[data-v-950f3f12] {\n  width: 100%;\n  padding: 0.8rem 1rem;\n  background: rgba(0,0,0,0.2);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  color: var(--color-text);\n  font-size: 1rem;\n  box-sizing: border-box;\n  transition: var(--transition-fast);\n}\n.form-group input[data-v-950f3f12]:focus {\n  outline: none;\n  border-color: var(--color-primary);\n  box-shadow: 0 0 10px rgba(var(--color-primary-rgb), 0.3);\n}\n.turnstile-container[data-v-950f3f12] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 1.5rem;\n}\n.error-message[data-v-950f3f12] {\n    color: var(--color-danger);\n    text-align: center;\n    margin-bottom: 1rem;\n    animation: fadeIn-950f3f12 0.3s ease;\n}\n.success-message[data-v-950f3f12] {\n    color: #7fb069;\n    text-align: center;\n    margin-bottom: 1rem;\n    animation: fadeIn-950f3f12 0.3s ease;\n}\n.form-actions[data-v-950f3f12] {\n    display: flex;\n    justify-content: space-between;\n    gap: 1rem;\n    margin-top: 2rem;\n}\n.form-footer[data-v-950f3f12] {\n    text-align: center;\n    margin-top: 1.5rem;\n    padding-top: 1.5rem;\n    border-top: 1px solid var(--color-border);\n}\n.link[data-v-950f3f12] {\n    color: var(--color-primary);\n    text-decoration: none;\n    transition: var(--transition-fast);\n}\n.link[data-v-950f3f12]:hover {\n    color: var(--color-primary-hover);\n    text-decoration: underline;\n}\n@keyframes fadeIn-950f3f12 {\nfrom { opacity: 0; transform: translateY(-10px);\n}\nto { opacity: 1; transform: translateY(0);\n}\n}\n",""]);const i=l},9074:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.sect-panel[data-v-f9a2cde8] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n}\n.panel-content[data-v-f9a2cde8] {\n  flex: 1;\n  overflow: hidden;\n}\n.sect-container[data-v-f9a2cde8] {\n  height: 100%;\n  display: flex;\n  background: var(--color-surface);\n  overflow: hidden;\n}\n.sect-list[data-v-f9a2cde8] {\n  width: 280px; /* 窄一点 */\n  border-right: 1px solid var(--color-border);\n  display: flex;\n  flex-direction: column;\n}\n.list-header[data-v-f9a2cde8] {\n  padding: 1rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.panel-title[data-v-f9a2cde8] {\n  margin: 0 0 1rem 0;\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: var(--color-primary);\n  text-align: center;\n}\n.search-bar[data-v-f9a2cde8] {\n  position: relative;\n  display: flex;\n  align-items: center;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 0.5rem;\n}\n.search-bar svg[data-v-f9a2cde8] {\n  color: var(--color-text-secondary);\n  margin-right: 0.5rem;\n}\n.search-input[data-v-f9a2cde8] {\n  flex: 1;\n  border: none;\n  outline: none;\n  background: transparent;\n  color: var(--color-text);\n  font-size: 0.875rem;\n}\n.list-content[data-v-f9a2cde8] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.loading-state[data-v-f9a2cde8], .empty-state[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-icon[data-v-f9a2cde8] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n.empty-text[data-v-f9a2cde8] {\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.empty-hint[data-v-f9a2cde8] {\n  font-size: 0.8rem;\n  opacity: 0.8;\n}\n.sect-list-content[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.sect-card[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.sect-card[data-v-f9a2cde8]:hover {\n  border-color: #9333ea;\n  box-shadow: 0 2px 8px rgba(147, 51, 234, 0.1);\n  transform: translateY(-1px);\n}\n.sect-card.selected[data-v-f9a2cde8] {\n  background: linear-gradient(135deg, rgba(147, 51, 234, 0.1), rgba(168, 85, 247, 0.1));\n  border-color: #9333ea;\n  box-shadow: 0 4px 12px rgba(147, 51, 234, 0.15);\n}\n.sect-card.can-join[data-v-f9a2cde8] {\n  border-left: 3px solid #22c55e;\n}\n.sect-icon[data-v-f9a2cde8] {\n  position: relative;\n  margin-right: 0.75rem;\n  flex-shrink: 0;\n}\n.sect-emoji[data-v-f9a2cde8] {\n  font-size: 2rem;\n  display: block;\n}\n.sect-level[data-v-f9a2cde8] {\n  position: absolute;\n  bottom: -2px;\n  right: -2px;\n  padding: 1px 4px;\n  border-radius: 8px;\n  font-size: 0.6rem;\n  font-weight: 700;\n  color: white;\n}\n.level-一流[data-v-f9a2cde8] { background: #ef4444;\n}\n.level-二流[data-v-f9a2cde8] { background: #f59e0b;\n}\n.level-三流[data-v-f9a2cde8] { background: #3b82f6;\n}\n.level-末流[data-v-f9a2cde8] { background: #6b7280;\n}\n.sect-info[data-v-f9a2cde8] {\n  flex: 1;\n  min-width: 0;\n}\n.sect-name[data-v-f9a2cde8] {\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 0.25rem;\n  font-size: 1rem;\n}\n.sect-meta[data-v-f9a2cde8] {\n  margin-bottom: 0.5rem;\n}\n.sect-type[data-v-f9a2cde8] {\n  background: rgba(147, 51, 234, 0.1);\n  color: #9333ea;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.sect-stats[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n}\n.member-count[data-v-f9a2cde8] {\n  background: rgba(59, 130, 246, 0.1);\n  color: #3b82f6;\n  padding: 2px 6px;\n  border-radius: 3px;\n  font-weight: 500;\n}\n\\n/* .power-rating removed */\\n.arrow-icon[data-v-f9a2cde8] {\n  color: var(--color-border-hover);\n  transition: transform 0.2s;\n}\n.sect-card.selected .arrow-icon[data-v-f9a2cde8] {\n  transform: rotate(90deg);\n  color: #9333ea;\n}\n.sect-detail[data-v-f9a2cde8] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n.detail-content[data-v-f9a2cde8] {\n  height: 100%;\n  padding: 1rem;\n  overflow-y: auto;\n}\n.detail-header[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 2rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.detail-icon[data-v-f9a2cde8] {\n  width: 64px;\n  height: 64px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, #9333ea, #7c3aed);\n  flex-shrink: 0;\n  box-shadow: 0 4px 16px rgba(147, 51, 234, 0.3);\n}\n.sect-emoji-large[data-v-f9a2cde8] {\n  font-size: 2rem;\n}\n.detail-info[data-v-f9a2cde8] {\n  flex: 1;\n}\n.detail-name[data-v-f9a2cde8] {\n  margin: 0 0 0.5rem 0;\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: var(--color-text);\n}\n.detail-badges[data-v-f9a2cde8] {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n.type-badge[data-v-f9a2cde8], .level-badge[data-v-f9a2cde8] {\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.type-badge.type-righteous[data-v-f9a2cde8] { background: rgba(59, 130, 246, 0.1); color: #3b82f6;\n}\n.type-badge.type-demonic[data-v-f9a2cde8] { background: rgba(239, 68, 68, 0.1); color: #ef4444;\n}\n.type-badge.type-neutral[data-v-f9a2cde8] { background: rgba(107, 114, 128, 0.1); color: #6b7280;\n}\n.type-badge.type-merchant[data-v-f9a2cde8] { background: rgba(245, 158, 11, 0.1); color: #f59e0b;\n}\n.type-badge.type-family[data-v-f9a2cde8] { background: rgba(34, 197, 94, 0.1); color: #22c55e;\n}\n.type-badge.type-alliance[data-v-f9a2cde8] { background: rgba(168, 85, 247, 0.1); color: #a855f7;\n}\n.level-badge[data-v-f9a2cde8] { background: rgba(168, 85, 247, 0.1); color: #a855f7;\n}\n.detail-body[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n.detail-section[data-v-f9a2cde8] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n}\n.section-title[data-v-f9a2cde8] {\n  margin: 0 0 1rem 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--color-border);\n  display: flex;            /* 图标与标题同一行 */\n  align-items: center;      /* 垂直居中对齐 */\n  gap: 8px;                 /* 图标与文字间距 */\n}\n.section-title svg[data-v-f9a2cde8] {\n  flex-shrink: 0;           /* 防止图标被压缩换行 */\n}\n.info-grid[data-v-f9a2cde8] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n.info-item[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.info-label[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.info-value[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.sect-description[data-v-f9a2cde8] {\n  margin-top: 1rem;\n}\n.desc-title[data-v-f9a2cde8] {\n  margin: 0 0 0.5rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.desc-text[data-v-f9a2cde8] {\n  margin: 0;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: var(--color-text-secondary);\n}\n.sect-specialties[data-v-f9a2cde8] {\n  margin-top: 1rem;\n}\n.specialties-title[data-v-f9a2cde8] {\n  margin: 0 0 0.5rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.specialties-tags[data-v-f9a2cde8] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.specialty-tag[data-v-f9a2cde8] {\n  background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(147, 51, 234, 0.1));\n  color: #9333ea;\n  padding: 0.25rem 0.75rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid rgba(147, 51, 234, 0.2);\n}\n.member-overview[data-v-f9a2cde8] {\n  text-align: center;\n  margin-bottom: 1.5rem;\n}\n.total-members[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.25rem;\n}\n.total-number[data-v-f9a2cde8] {\n  font-size: 2rem;\n  font-weight: 700;\n  color: #9333ea;\n}\n.total-label[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.member-breakdown[data-v-f9a2cde8] {\n  margin-bottom: 1.5rem;\n}\n.breakdown-title[data-v-f9a2cde8] {\n  margin: 0 0 0.75rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.realm-stats[data-v-f9a2cde8], .position-stats[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.realm-stat[data-v-f9a2cde8], .position-stat[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.realm-name[data-v-f9a2cde8], .position-name[data-v-f9a2cde8] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  min-width: 60px;\n}\n.realm-bar[data-v-f9a2cde8], .position-bar[data-v-f9a2cde8] {\n  flex: 1;\n  height: 6px;\n  background: var(--color-border);\n  border-radius: 3px;\n  overflow: hidden;\n}\n.realm-fill[data-v-f9a2cde8] {\n  height: 100%;\n  background: linear-gradient(90deg, #9333ea, #7c3aed);\n  transition: width 0.3s ease;\n}\n.position-fill[data-v-f9a2cde8] {\n  height: 100%;\n  background: linear-gradient(90deg, #3b82f6, #1d4ed8);\n  transition: width 0.3s ease;\n}\n.realm-count[data-v-f9a2cde8], .position-count[data-v-f9a2cde8] {\n  font-size: 0.8rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 30px;\n  text-align: right;\n}\n.relationship-info[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.relationship-item[data-v-f9a2cde8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.relationship-label[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.relationship-value[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.reputation-value[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.reputation-level[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  font-weight: 500;\n}\n.reputation-legendary[data-v-f9a2cde8] {\n  color: #f59e0b;\n}\n.reputation-legendary .reputation-level[data-v-f9a2cde8] {\n  background: rgba(245, 158, 11, 0.1);\n  color: #f59e0b;\n  border: 1px solid rgba(245, 158, 11, 0.2);\n}\n.reputation-excellent[data-v-f9a2cde8] {\n  color: #8b5cf6;\n}\n.reputation-excellent .reputation-level[data-v-f9a2cde8] {\n  background: rgba(139, 92, 246, 0.1);\n  color: #8b5cf6;\n  border: 1px solid rgba(139, 92, 246, 0.2);\n}\n.reputation-good[data-v-f9a2cde8] {\n  color: #3b82f6;\n}\n.reputation-good .reputation-level[data-v-f9a2cde8] {\n  background: rgba(59, 130, 246, 0.1);\n  color: #3b82f6;\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n.reputation-fair[data-v-f9a2cde8] {\n  color: #22c55e;\n}\n.reputation-fair .reputation-level[data-v-f9a2cde8] {\n  background: rgba(34, 197, 94, 0.1);\n  color: #22c55e;\n  border: 1px solid rgba(34, 197, 94, 0.2);\n}\n.reputation-low[data-v-f9a2cde8] {\n  color: #6b7280;\n}\n.reputation-low .reputation-level[data-v-f9a2cde8] {\n  background: rgba(107, 114, 128, 0.1);\n  color: #6b7280;\n  border: 1px solid rgba(107, 114, 128, 0.2);\n}\n.reputation-none[data-v-f9a2cde8] {\n  color: var(--color-text-secondary);\n}\n.reputation-none .reputation-level[data-v-f9a2cde8] {\n  background: rgba(var(--color-text-secondary-rgb), 0.1);\n  color: var(--color-text-secondary);\n  border: 1px solid rgba(var(--color-text-secondary-rgb), 0.2);\n}\n.join-requirements[data-v-f9a2cde8] {\n  margin-bottom: 1rem;\n}\n.requirements-list[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.requirement-item[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.requirement-icon[data-v-f9a2cde8] {\n  color: #22c55e;\n}\n.requirement-text[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.no-requirements[data-v-f9a2cde8] {\n  text-align: center;\n  padding: 1rem;\n  color: var(--color-text-secondary);\n}\n.join-benefits[data-v-f9a2cde8] {\n  margin-bottom: 1rem;\n}\n.benefits-title[data-v-f9a2cde8] {\n  margin: 0 0 0.5rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.benefits-list[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.benefit-item[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.benefit-icon[data-v-f9a2cde8] {\n  color: #3b82f6;\n}\n.benefit-text[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n}\n.join-actions[data-v-f9a2cde8] {\n  text-align: center;\n}\n.join-btn[data-v-f9a2cde8] {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1.5rem;\n  background: linear-gradient(135deg, #22c55e, #16a34a);\n  border: none;\n  border-radius: 8px;\n  color: white;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.join-btn[data-v-f9a2cde8]:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);\n}\n.current-member-info[data-v-f9a2cde8] {\n  margin-bottom: 1.5rem;\n}\n.member-status[data-v-f9a2cde8] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 1rem;\n}\n.status-item[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.status-label[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.status-value[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.status-value.position[data-v-f9a2cde8] {\n  color: #9333ea;\n}\n.status-value.contribution[data-v-f9a2cde8] {\n  color: #f59e0b;\n}\n.status-value.reputation[data-v-f9a2cde8] {\n  color: #3b82f6;\n}\n.sect-actions[data-v-f9a2cde8] {\n  margin-top: 1rem;\n}\n.actions-title[data-v-f9a2cde8] {\n  margin: 0 0 0.75rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.action-buttons[data-v-f9a2cde8] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 0.5rem;\n}\n.sect-action-btn[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  padding: 0.75rem 0.5rem;\n  background: var(--color-surface);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  color: var(--color-text);\n  font-size: 0.75rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: center;\n  min-width: 0;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.sect-action-btn[data-v-f9a2cde8]:hover {\n  border-color: #9333ea;\n  background: rgba(147, 51, 234, 0.05);\n}\n.no-selection[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.placeholder-icon[data-v-f9a2cde8] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n.placeholder-text[data-v-f9a2cde8] {\n  font-size: 1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.placeholder-hint[data-v-f9a2cde8] {\n  font-size: 0.85rem;\n  opacity: 0.8;\n}\n\n/* 势力范围相关样式 */\n.territory-info[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n/* 成员统计样式 */\n.member-stats[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n.total-members[data-v-f9a2cde8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.1);\n}\n.total-label[data-v-f9a2cde8] {\n  font-size: 0.9rem;\n  font-weight: 500;\n  color: var(--color-text-secondary);\n}\n.total-value[data-v-f9a2cde8] {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.distribution-title[data-v-f9a2cde8] {\n  margin: 0 0 0.75rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.realm-stats[data-v-f9a2cde8], .position-stats[data-v-f9a2cde8] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n  gap: 0.5rem;\n}\n.realm-item[data-v-f9a2cde8], .position-item[data-v-f9a2cde8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem 0.75rem;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  transition: all 0.2s ease;\n}\n.realm-item[data-v-f9a2cde8]:hover, .position-item[data-v-f9a2cde8]:hover {\n  background: var(--color-surface);\n  border-color: rgba(var(--color-primary-rgb), 0.2);\n}\n.realm-name[data-v-f9a2cde8], .position-name[data-v-f9a2cde8] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n}\n.realm-count[data-v-f9a2cde8], .position-count[data-v-f9a2cde8] {\n  font-size: 0.8rem;\n  font-weight: 500;\n  color: var(--color-text);\n}\n\n/* 宗门领导层样式 */\n.leadership-info[data-v-f9a2cde8] {\n  margin-top: 1.5rem;\n  padding: 1rem;\n  background: rgba(var(--color-primary-rgb), 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.1);\n}\n.leadership-title[data-v-f9a2cde8] {\n  margin: 0 0 1rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.leader-grid[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  margin-bottom: 1rem;\n}\n.leader-item[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.leader-item.primary-leader[data-v-f9a2cde8] {\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-accent-rgb), 0.05));\n  border-color: rgba(var(--color-primary-rgb), 0.3);\n}\n.leader-role[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  background: rgba(var(--color-primary-rgb), 0.1);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  min-width: 3rem;\n  text-align: center;\n}\n.leader-name[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.leader-realm[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  color: var(--color-accent);\n  background: rgba(var(--color-accent-rgb), 0.1);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  font-weight: 500;\n  margin-left: auto;\n}\n.sect-strength[data-v-f9a2cde8] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  background: rgba(var(--color-success-rgb), 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(var(--color-success-rgb), 0.1);\n}\n.strength-item[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.25rem;\n}\n.strength-label[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.strength-value[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.strength-value.peak-power[data-v-f9a2cde8] {\n  color: var(--color-accent);\n  text-shadow: 0 0 4px rgba(var(--color-accent-rgb), 0.3);\n}\n.strength-value.power-rating[data-v-f9a2cde8] {\n  color: var(--color-primary);\n  font-weight: 700;\n  background: linear-gradient(135deg, rgba(var(--color-primary-rgb), 0.1), rgba(var(--color-accent-rgb), 0.05));\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  border: 1px solid rgba(var(--color-primary-rgb), 0.2);\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n.power-level[data-v-f9a2cde8] {\n  font-size: 0.75rem;\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  font-weight: 500;\n}\n.power-legendary[data-v-f9a2cde8] {\n  color: #dc2626 !important;\n  border-color: rgba(220, 38, 38, 0.3) !important;\n  background: linear-gradient(135deg, rgba(220, 38, 38, 0.1), rgba(239, 68, 68, 0.05)) !important;\n}\n.power-legendary .power-level[data-v-f9a2cde8] {\n  background: rgba(220, 38, 38, 0.1);\n  color: #dc2626;\n  border: 1px solid rgba(220, 38, 38, 0.2);\n}\n.power-supreme[data-v-f9a2cde8] {\n  color: #7c3aed !important;\n  border-color: rgba(124, 58, 237, 0.3) !important;\n  background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), rgba(139, 92, 246, 0.05)) !important;\n}\n.power-supreme .power-level[data-v-f9a2cde8] {\n  background: rgba(124, 58, 237, 0.1);\n  color: #7c3aed;\n  border: 1px solid rgba(124, 58, 237, 0.2);\n}\n.power-strong[data-v-f9a2cde8] {\n  color: #2563eb !important;\n  border-color: rgba(37, 99, 235, 0.3) !important;\n  background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(59, 130, 246, 0.05)) !important;\n}\n.power-strong .power-level[data-v-f9a2cde8] {\n  background: rgba(37, 99, 235, 0.1);\n  color: #2563eb;\n  border: 1px solid rgba(37, 99, 235, 0.2);\n}\n.power-good[data-v-f9a2cde8] {\n  color: #059669 !important;\n  border-color: rgba(5, 150, 105, 0.3) !important;\n  background: linear-gradient(135deg, rgba(5, 150, 105, 0.1), rgba(16, 185, 129, 0.05)) !important;\n}\n.power-good .power-level[data-v-f9a2cde8] {\n  background: rgba(5, 150, 105, 0.1);\n  color: #059669;\n  border: 1px solid rgba(5, 150, 105, 0.2);\n}\n.power-average[data-v-f9a2cde8] {\n  color: #d97706 !important;\n  border-color: rgba(217, 119, 6, 0.3) !important;\n  background: linear-gradient(135deg, rgba(217, 119, 6, 0.1), rgba(245, 158, 11, 0.05)) !important;\n}\n.power-average .power-level[data-v-f9a2cde8] {\n  background: rgba(217, 119, 6, 0.1);\n  color: #d97706;\n  border: 1px solid rgba(217, 119, 6, 0.2);\n}\n.power-weak[data-v-f9a2cde8] {\n  color: #6b7280 !important;\n  border-color: rgba(107, 114, 128, 0.3) !important;\n  background: linear-gradient(135deg, rgba(107, 114, 128, 0.1), rgba(156, 163, 175, 0.05)) !important;\n}\n.power-weak .power-level[data-v-f9a2cde8] {\n  background: rgba(107, 114, 128, 0.1);\n  color: #6b7280;\n  border: 1px solid rgba(107, 114, 128, 0.2);\n}\n.power-poor[data-v-f9a2cde8] {\n  color: var(--color-text-secondary) !important;\n  border-color: rgba(var(--color-text-secondary-rgb), 0.3) !important;\n  background: linear-gradient(135deg, rgba(var(--color-text-secondary-rgb), 0.1), rgba(var(--color-text-secondary-rgb), 0.05)) !important;\n}\n.power-poor .power-level[data-v-f9a2cde8] {\n  background: rgba(var(--color-text-secondary-rgb), 0.1);\n  color: var(--color-text-secondary);\n  border: 1px solid rgba(var(--color-text-secondary-rgb), 0.2);\n}\n.influence-description[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  color: var(--color-text);\n  line-height: 1.5;\n}\n.controlled-areas[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.areas-list[data-v-f9a2cde8] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.area-tag[data-v-f9a2cde8] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));\n  color: #3b82f6;\n  padding: 0.25rem 0.5rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n.strategic-value[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.value-display[data-v-f9a2cde8] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.value-bar[data-v-f9a2cde8] {\n  flex: 1;\n  height: 8px;\n  background: var(--color-border);\n  border-radius: 4px;\n  overflow: hidden;\n}\n.value-fill[data-v-f9a2cde8] {\n  height: 100%;\n  background: linear-gradient(90deg, #22c55e, #16a34a);\n  transition: width 0.3s ease;\n}\n.value-text[data-v-f9a2cde8] {\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: var(--color-text);\n  min-width: 40px;\n}\n\n/* 回退显示样式 */\n.fallback-leadership[data-v-f9a2cde8] {\n  padding: 1rem;\n  background: rgba(var(--color-warning-rgb), 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(var(--color-warning-rgb), 0.1);\n}\n.leadership-description[data-v-f9a2cde8] {\n  margin: 0 0 1rem 0;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: var(--color-text-secondary);\n}\n\n/* 数据缺失提示样式 */\n.missing-data-notice[data-v-f9a2cde8] {\n  background: rgba(var(--color-warning-rgb), 0.05);\n  border: 1px solid rgba(var(--color-warning-rgb), 0.2);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-top: 1rem;\n}\n.notice-title[data-v-f9a2cde8] {\n  margin: 0 0 0.5rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-warning);\n}\n.notice-content[data-v-f9a2cde8] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.notice-text[data-v-f9a2cde8] {\n  margin: 0;\n  font-size: 0.875rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.notice-hint[data-v-f9a2cde8] {\n  margin: 0;\n  font-size: 0.8rem;\n  color: var(--color-text-tertiary);\n  opacity: 0.8;\n}\n.animate-spin[data-v-f9a2cde8] {\n  animation: spin-f9a2cde8 1s linear infinite;\n}\n@keyframes spin-f9a2cde8 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n@media (max-width: 640px) {\n.sect-panel[data-v-f9a2cde8] {\n    padding: 0;\n}\n.panel-content[data-v-f9a2cde8] {\n    padding: 0;\n}\n.sect-container[data-v-f9a2cde8] {\n    flex-direction: column;\n    border-radius: 0;\n    border: none;\n}\n.sect-list[data-v-f9a2cde8] {\n    width: 100%;\n    height: 30vh;\n    min-height: 250px;\n    max-height: 350px;\n    border-right: none;\n    border-bottom: 1px solid var(--color-border);\n}\n.list-header[data-v-f9a2cde8] {\n    padding: 1rem;\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: var(--color-surface);\n}\n.panel-title[data-v-f9a2cde8] {\n    font-size: 1.1rem;\n    margin-bottom: 0.75rem;\n}\n.search-bar[data-v-f9a2cde8] {\n    padding: 0.5rem;\n}\n.search-input[data-v-f9a2cde8] {\n    font-size: 0.9rem;\n}\n.list-content[data-v-f9a2cde8] {\n    padding: 0.5rem;\n}\n.sect-card[data-v-f9a2cde8] {\n    padding: 0.75rem;\n    margin-bottom: 0.5rem;\n}\n.sect-name[data-v-f9a2cde8] {\n    font-size: 0.95rem;\n}\n.sect-type[data-v-f9a2cde8] {\n    font-size: 0.7rem;\n    padding: 1px 6px;\n}\n\n  /* .power-rating removed */\n.sect-detail[data-v-f9a2cde8] {\n    flex: 1;\n    min-height: 0;\n    overflow-y: auto;\n}\n.detail-content[data-v-f9a2cde8] {\n    padding: 0.75rem;\n    height: auto;\n}\n.detail-header[data-v-f9a2cde8] {\n    margin-bottom: 1rem;\n    padding-bottom: 0.5rem;\n}\n.detail-icon[data-v-f9a2cde8] {\n    width: 40px;\n    height: 40px;\n}\n.sect-emoji-large[data-v-f9a2cde8] {\n    font-size: 1.25rem;\n}\n.detail-name[data-v-f9a2cde8] {\n    font-size: 1rem;\n}\n.info-grid[data-v-f9a2cde8] {\n    grid-template-columns: 1fr;\n    gap: 0.5rem;\n}\n.member-status[data-v-f9a2cde8] {\n    grid-template-columns: 1fr;\n    gap: 0.5rem;\n}\n.action-buttons[data-v-f9a2cde8] {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 0.4rem;\n}\n.sect-action-btn[data-v-f9a2cde8] {\n    padding: 0.6rem 0.4rem;\n    font-size: 0.75rem;\n    justify-content: center;\n    white-space: normal; /* 允许文本换行 */\n    height: 100%; /* 确保按钮在换行后高度一致 */\n}\n.detail-section[data-v-f9a2cde8] {\n    padding: 0.6rem;\n    margin-bottom: 0.75rem;\n}\n.section-title[data-v-f9a2cde8] {\n    font-size: 0.8rem;\n    margin-bottom: 0.5rem;\n    padding-bottom: 0.4rem;\n}\n.realm-stats[data-v-f9a2cde8], .position-stats[data-v-f9a2cde8] {\n    grid-template-columns: 1fr;\n    gap: 0.5rem;\n}\n.leader-grid[data-v-f9a2cde8] {\n    gap: 0.5rem;\n}\n.leader-item[data-v-f9a2cde8] {\n    padding: 0.5rem;\n}\n.leader-role[data-v-f9a2cde8] {\n    font-size: 0.7rem;\n    padding: 0.2rem 0.4rem;\n    min-width: 2.5rem;\n}\n.leader-name[data-v-f9a2cde8] {\n    font-size: 0.8rem;\n}\n.leader-realm[data-v-f9a2cde8] {\n    font-size: 0.7rem;\n}\n}\n",""]);const i=l},9142:(e,n,t)=>{t.d(n,{F:()=>i,p:()=>l,useUnifiedCharacterData:()=>r});var a=t(4061),o=t(948);function r(){const e=(0,o.useCharacterStore)(),n=(0,a.computed)(()=>e.activeSaveSlot?.存档数据),t=(0,a.computed)(()=>!!n.value);return{characterData:(0,a.computed)(()=>{if(!n.value)return null;const e=n.value,t=e.玩家角色状态;return{基础信息:e.角色基础信息,境界:t?.境界,属性:{气血:t?.气血,灵气:t?.灵气,神识:t?.神识,寿命:t?.寿命},位置:t?.位置,修炼功法:e.修炼功法,掌握技能:e.掌握技能,装备栏:e.装备栏,背包_灵石:e.背包?.灵石,背包_物品:e.背包?.物品,人物关系:e.人物关系,三千大道:e.三千大道,世界信息:e.世界信息,游戏时间:e.游戏时间,状态效果:t?.状态效果||[],记忆:e.记忆,玩家角色状态:t}}),saveData:n,isDataLoaded:t}}function l(){const{characterData:e}=r();return{basicInfo:(0,a.computed)(()=>e.value?.基础信息),status:(0,a.computed)(()=>e.value?.玩家角色状态)}}function i(){const{characterData:e,saveData:n}=r();return{saveData:n,realm:(0,a.computed)(()=>e.value?.境界),techniques:(0,a.computed)(()=>e.value?.修炼功法||[]),daoSystem:(0,a.computed)(()=>e.value?.三千大道)}}},9173:(e,n,t)=>{t.d(n,{useUIStore:()=>r});var a=t(1774),o=t(4061);const r=(0,a.nY)("ui",()=>{const e=(0,o.ref)(!1),n=(0,o.ref)(""),t=(0,o.ref)(!1),a=(0,o.ref)(!1),r=(0,o.ref)(null),l=(0,o.ref)(!1),i=(0,o.ref)(!1),c=(0,o.ref)(!1),s=(0,o.ref)(""),d=(0,o.ref)(""),m=(0,o.ref)(!1),p=(0,o.ref)([]),v=(0,o.ref)(null),u=(0,o.ref)("creation"),g=(0,o.ref)(!1),f=(0,o.ref)(null),b=(0,o.ref)(null),h=(0,o.ref)(""),y=(0,o.ref)(!0),x=(0,o.ref)(3);function k(){a.value=!1,r.value=null,l.value&&(e.value=!0,l.value=!1)}function w(){m.value=!1,p.value=[],v.value=null}return{isLoading:e,loadingText:n,isAIProcessing:t,showRetryDialogState:a,retryDialogConfig:r,startLoading:function(t="正在加载..."){e.value=!0,n.value=t},stopLoading:function(){e.value=!1,n.value=""},setAIProcessing:function(e){t.value=e},updateLoadingText:function(t){e.value&&(n.value=t)},showRetryDialog:function(n){l.value=e.value,e.value&&(e.value=!1),r.value=n,a.value=!0},hideRetryDialog:k,confirmRetry:function(){r.value&&(r.value.onConfirm(),k())},cancelRetry:function(){r.value&&(r.value.onCancel(),k())},neutralAction:function(){r.value&&r.value.onNeutral&&(r.value.onNeutral(),k())},showCharacterManagement:i,openCharacterManagement:function(){i.value=!0},closeCharacterManagement:function(){i.value=!1},showDataValidationError:m,dataValidationErrorMessages:p,dataValidationContext:u,showDataValidationErrorDialog:function(e,n,t="creation"){p.value=e,v.value=n,u.value=t,m.value=!0},hideDataValidationErrorDialog:w,confirmDataValidationError:function(){v.value&&v.value(),w()},showStateChangeViewer:g,stateChangeLogToShow:f,currentMessageStateChanges:b,openStateChangeViewer:function(e){f.value=e,g.value=!0},closeStateChangeViewer:function(){g.value=!1,f.value=null},setCurrentMessageStateChanges:function(e){b.value=e?{...e,_ts:Date.now()}:null},clearCurrentMessageStateChanges:function(){b.value=null},autoGenerateNpc:y,minNpcCount:x,userInputText:h,showDetailModalState:c,detailModalTitle:s,detailModalContent:d,showDetailModal:function(e){s.value=e.title,d.value=e.content,c.value=!0},hideDetailModal:function(){c.value=!1,setTimeout(()=>{s.value="",d.value=""},300)}}})},9262:(e,n,t)=>{t.d(n,{A:()=>u});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r),i=t(4417),c=t.n(i),s=new URL(t(660),t.b),d=new URL(t(1530),t.b),m=l()(o()),p=c()(s),v=c()(d);m.push([e.id,`\n.settings-panel[data-v-1063ac62] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  overflow: hidden;\n  padding: 1rem;\n  gap: 1rem;\n  position: relative;\n}\n\n/* 头部 */\n.panel-header[data-v-1063ac62] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem;\n  background: var(--color-surface);\n  border-radius: 0.75rem;\n  border: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.header-left[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.header-icon[data-v-1063ac62] {\n  font-size: 1.5rem;\n}\n.header-info[data-v-1063ac62] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.panel-title[data-v-1063ac62] {\n  margin: 0;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #1e293b;\n}\n.settings-subtitle[data-v-1063ac62] {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n.header-actions[data-v-1063ac62] {\n  display: flex;\n  gap: 0.5rem;\n}\n.action-btn[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--color-border);\n  border-radius: 0.5rem;\n  background: var(--color-surface);\n  color: var(--color-text);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.875rem;\n}\n.action-btn[data-v-1063ac62]:hover {\n  background: #f1f5f9;\n  border-color: #94a3b8;\n}\n.action-btn.primary[data-v-1063ac62] {\n  background: #3b82f6;\n  border-color: #3b82f6;\n  color: white;\n}\n.action-btn.primary[data-v-1063ac62]:hover {\n  background: #2563eb;\n  border-color: #2563eb;\n}\n\n/* 设置容器 */\n.settings-container[data-v-1063ac62] {\n  flex: 1;\n  overflow-y: auto;\n  min-height: 0;\n  padding: 0 0.5rem 3rem 0.5rem;\n  \n  /* 滚动条样式 */\n  scrollbar-width: thin;\n  scrollbar-color: rgba(100, 116, 139, 0.3) rgba(243, 244, 246, 0.5);\n}\n.settings-container[data-v-1063ac62]::-webkit-scrollbar {\n  width: 8px;\n}\n.settings-container[data-v-1063ac62]::-webkit-scrollbar-track {\n  background: rgba(243, 244, 246, 0.5);\n  border-radius: 4px;\n}\n.settings-container[data-v-1063ac62]::-webkit-scrollbar-thumb {\n  background: rgba(100, 116, 139, 0.3);\n  border-radius: 4px;\n  transition: background 0.2s ease;\n}\n.settings-container[data-v-1063ac62]::-webkit-scrollbar-thumb:hover {\n  background: rgba(100, 116, 139, 0.5);\n}\n\n/* 设置区块 */\n.settings-section[data-v-1063ac62] {\n  margin-bottom: 1.5rem;\n  background: white;\n  border-radius: 0.75rem;\n  border: 1px solid #e2e8f0;\n  overflow: hidden;\n}\n.section-header[data-v-1063ac62] {\n  padding: 1rem 1.25rem;\n  background: #f8fafc;\n  border-bottom: 1px solid #e2e8f0;\n}\n.section-title[data-v-1063ac62] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: #1e293b;\n}\n.settings-list[data-v-1063ac62] {\n  padding: 0.5rem;\n}\n\n/* 设置项 */\n.setting-item[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 1.25rem;\n  border-radius: 0.5rem;\n  transition: background 0.2s ease;\n}\n.setting-item[data-v-1063ac62]:hover {\n  background: #f8fafc;\n}\n.setting-info[data-v-1063ac62] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.setting-name[data-v-1063ac62] {\n  font-weight: 500;\n  color: #1e293b;\n  cursor: pointer;\n}\n.setting-desc[data-v-1063ac62] {\n  font-size: 0.875rem;\n  color: #64748b;\n}\n.setting-control[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n}\n\n/* 控件样式 */\n.setting-select[data-v-1063ac62] {\n  padding: 0.5rem 0.75rem;\n  border: 1px solid #d1d5db;\n  border-radius: 0.375rem;\n  background: white;\n  color: #374151;\n  font-size: 0.875rem;\n  min-width: 80px;\n}\n.setting-select[data-v-1063ac62]:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n}\n.range-container[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.setting-range[data-v-1063ac62] {\n  width: 100px;\n}\n.range-value[data-v-1063ac62] {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: #374151;\n  min-width: 40px;\n}\n\n/* 下拉选择框样式 */\n.setting-select[data-v-1063ac62] {\n  padding: 0.5rem 2rem 0.5rem 0.75rem;\n  border: 1px solid #d1d5db;\n  border-radius: 8px;\n  background-color: white;\n  background-image: url(${p});\n  background-repeat: no-repeat;\n  background-position: right 0.75rem center;\n  background-size: 12px;\n  color: #374151;\n  font-size: 0.875rem;\n  cursor: pointer;\n  transition: border-color 0.2s ease;\n  appearance: none;\n  min-width: 120px;\n}\n.setting-select[data-v-1063ac62]:hover {\n  border-color: #94a3b8;\n}\n.setting-select[data-v-1063ac62]:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n}\n[data-theme="dark"] .setting-select[data-v-1063ac62] {\n  background-color: #374151;\n  border-color: #4b5563;\n  color: #e5e7eb;\n  background-image: url(${v});\n}\n[data-theme="dark"] .setting-select[data-v-1063ac62]:hover {\n  border-color: #6b7280;\n}\n\n/* 开关样式 */\n.setting-switch[data-v-1063ac62] {\n  position: relative;\n  display: inline-block;\n  width: 44px;\n  height: 24px;\n}\n.setting-switch input[data-v-1063ac62] {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n.switch-slider[data-v-1063ac62] {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #cbd5e1;\n  transition: 0.2s;\n  border-radius: 24px;\n}\n.switch-slider[data-v-1063ac62]:before {\n  position: absolute;\n  content: "";\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background-color: white;\n  transition: 0.2s;\n  border-radius: 50%;\n}\ninput:checked + .switch-slider[data-v-1063ac62] {\n  background-color: #3b82f6;\n}\ninput:checked + .switch-slider[data-v-1063ac62]:before {\n  transform: translateX(20px);\n}\n\n/* 工具按钮 */\n.utility-btn[data-v-1063ac62] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  border: 1px solid #d1d5db;\n  border-radius: 0.375rem;\n  background: white;\n  color: #374151;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.875rem;\n}\n.utility-btn[data-v-1063ac62]:hover {\n  background: #f9fafb;\n  border-color: #9ca3af;\n}\n\n/* 响应式设计 */\n@media (max-width: 640px) {\n.setting-item[data-v-1063ac62] {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.75rem;\n}\n.setting-control[data-v-1063ac62] {\n    width: 100%;\n    justify-content: flex-end;\n}\n.range-container[data-v-1063ac62] {\n    width: 100%;\n    justify-content: space-between;\n}\n.header-actions .btn-text[data-v-1063ac62] {\n    display: none;\n}\n}\n\n/* 深色主题 */\n[data-theme="dark"] .settings-panel[data-v-1063ac62] {\n  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);\n}\n[data-theme="dark"] .panel-header[data-v-1063ac62],\n[data-theme="dark"] .settings-section[data-v-1063ac62] {\n  background: #1e293b;\n  border-color: #475569;\n}\n[data-theme="dark"] .section-header[data-v-1063ac62] {\n  background: #334155;\n  border-bottom-color: #475569;\n}\n[data-theme="dark"] .panel-title[data-v-1063ac62],\n[data-theme="dark"] .section-title[data-v-1063ac62],\n[data-theme="dark"] .setting-name[data-v-1063ac62] {\n  color: #f1f5f9;\n}\n[data-theme="dark"] .settings-subtitle[data-v-1063ac62],\n[data-theme="dark"] .setting-desc[data-v-1063ac62] {\n  color: #94a3b8;\n}\n[data-theme="dark"] .setting-item[data-v-1063ac62]:hover {\n  background: #334155;\n}\n[data-theme="dark"] .action-btn[data-v-1063ac62],\n[data-theme="dark"] .setting-select[data-v-1063ac62],\n[data-theme="dark"] .utility-btn[data-v-1063ac62] {\n  background: #374151;\n  border-color: #4b5563;\n  color: #e5e7eb;\n}\n[data-theme="dark"] .action-btn[data-v-1063ac62]:hover,\n[data-theme="dark"] .utility-btn[data-v-1063ac62]:hover {\n  background: #4b5563;\n  border-color: #6b7280;\n}\n[data-theme="dark"] .switch-slider[data-v-1063ac62] {\n  background-color: #4b5563;\n}\n\n/* 旋转动画 */\n.spinning[data-v-1063ac62] {\n  animation: spin-1063ac62 1s linear infinite;\n}\n@keyframes spin-1063ac62 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n`,""]);const u=m},9333:(e,n,t)=>{t.d(n,{Em:()=>r,OW:()=>m,Qc:()=>d,Sj:()=>p,Uy:()=>c,w2:()=>l,xJ:()=>s,yZ:()=>i});var a=t(4270);const o="http://127.0.0.1:12345";async function r(e,n={}){const t=localStorage.getItem("access_token"),r=new Headers(n.headers||{});t&&r.append("Authorization",`Bearer ${t}`),!n.body||n.body instanceof FormData||r.has("Content-Type")||r.append("Content-Type","application/json");const l={...n,headers:r};try{const n=`${o}${e}`;console.log(`[Request] 发起请求: ${l.method||"GET"} ${n}`);const t=await fetch(n,l);if(204===t.status)return console.log(`[Request] 收到 204 No Content 响应 from ${n}`),null;const r=await t.text();if(!t.ok){console.error(`[Request] 请求失败! Status: ${t.status} ${t.statusText} from ${n}`),console.error("[Request] 原始响应体:",r);let e=`服务器错误 ${t.status}`;try{const n=JSON.parse(r);e=n.detail||JSON.stringify(n)}catch(n){e=r.substring(0,100)||"无法解析服务器响应。"}throw a.o.error(e),new Error(e)}try{return JSON.parse(r)}catch(e){throw console.error(`[Request] JSON 解析失败 from ${n}. 原始响应体:`,r),new Error("解析服务器响应失败，返回的不是有效的JSON格式。")}}catch(n){console.error(`[Request] 网络层或未知错误 for url: ${e}`,n);const t=n instanceof Error?n.message:"网络连接失败，请检查天网灵脉。";throw t.includes("服务器错误")||a.o.error(t),n}}async function l(){try{const e=await r.get("/api/v1/worlds/");return console.log("[API] 成功获取世界列表:",e),e||[]}catch(e){return console.error("[API] 获取世界列表失败:",e),a.o.error("获取世界列表失败，请检查网络或联系管理员。"),[]}}async function i(){try{const e=await r.get("/api/v1/talent_tiers/");return console.log("[API] 成功获取天资等级列表:",e),e||[]}catch(e){return console.error("[API] 获取天资等级失败:",e),a.o.error("获取天资等级失败，请检查网络或联系管理员。"),[]}}async function c(){try{const e=await r.get("/api/v1/origins/");return console.log("[API] 成功获取出身列表:",e),e||[]}catch(e){return console.error("[API] 获取出身列表失败:",e),a.o.error("获取出身列表失败，请检查网络或联系管理员。"),[]}}async function s(){try{const e=await r.get("/api/v1/spirit_roots/");return console.log("[API] 成功获取灵根列表:",e),e||[]}catch(e){return console.error("[API] 获取灵根列表失败:",e),a.o.error("获取灵根列表失败，请检查网络或联系管理员。"),[]}}async function d(){try{const e=await r.get("/api/v1/talents/");console.log("[API] 成功获取天赋列表:",e);const n=(e||[]).map(e=>({...e,tier_id:e.tier?.id||null}));return console.log("[API] 天赋数据转换完成，示例:",n.slice(0,2)),n}catch(e){return console.error("[API] 获取天赋列表失败:",e),a.o.error("获取天赋列表失败，请检查网络或联系管理员。"),[]}}async function m(e){try{console.log("[API] 正在向后端提交角色创建信息:",e);const n=await r.post("/api/v1/characters/create",e);return console.log("[API] 角色创建成功，后端返回:",n),n}catch(e){throw console.error("[API] 角色创建失败:",e),a.o.error("角色创建失败，请检查网络或联系管理员。"),e}}async function p(e,n){try{console.log("[API] 正在向云端同步存档数据:",{charId:e,saveData:n});const t=await r.put(`/api/v1/characters/${e}/save`,n);return console.log("[API] 存档同步成功，后端返回:",t),t}catch(e){throw console.error("[API] 存档同步失败:",e),a.o.error("存档同步失败，请检查网络或联系管理员。"),e}}r.get=(e,n={})=>r(e,{...n,method:"GET"}),r.post=(e,n,t={})=>r(e,{...t,method:"POST",body:n?JSON.stringify(n):void 0}),r.put=(e,n,t={})=>r(e,{...t,method:"PUT",body:n?JSON.stringify(n):void 0}),r.delete=(e,n={})=>r(e,{...n,method:"DELETE"})},9336:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.state-change-overlay[data-v-43a3a720] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(4px);\n}\n.state-change-viewer[data-v-43a3a720] {\n  width: 90%;\n  max-width: 500px;\n  max-height: 80vh;\n  background-color: var(--color-surface);\n  border-radius: 16px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--color-border);\n  animation: modal-fade-in-43a3a720 0.3s ease-out;\n}\n@keyframes modal-fade-in-43a3a720 {\nfrom {\n    opacity: 0;\n    transform: scale(0.95);\n}\nto {\n    opacity: 1;\n    transform: scale(1);\n}\n}\n.viewer-header[data-v-43a3a720] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1.25rem;\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.viewer-header h3[data-v-43a3a720] {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.close-btn[data-v-43a3a720] {\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  padding: 0.25rem;\n  border-radius: 50%;\n  transition: all 0.2s ease;\n}\n.close-btn[data-v-43a3a720]:hover {\n  background-color: var(--color-surface-hover);\n  color: var(--color-text);\n}\n.viewer-summary[data-v-43a3a720] {\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  padding: 0.75rem 1rem;\n  background: var(--color-surface-light);\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.summary-item[data-v-43a3a720] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n.summary-item.added[data-v-43a3a720] { color: var(--color-success);\n}\n.summary-item.removed[data-v-43a3a720] { color: var(--color-error);\n}\n.summary-item.updated[data-v-43a3a720] { color: var(--color-info);\n}\n.viewer-content[data-v-43a3a720] {\n  overflow-y: auto;\n  padding: 1rem 1.25rem;\n  scrollbar-width: thin;\n  scrollbar-color: var(--color-border) transparent;\n}\n.viewer-content[data-v-43a3a720]::-webkit-scrollbar { width: 6px;\n}\n.viewer-content[data-v-43a3a720]::-webkit-scrollbar-thumb {\n  background: var(--color-border);\n  border-radius: 3px;\n}\n.no-changes[data-v-43a3a720] {\n  text-align: center;\n  padding: 2rem;\n  color: var(--color-text-secondary);\n}\n.changes-list[data-v-43a3a720] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.change-item[data-v-43a3a720] {\n  display: flex;\n  align-items: flex-start;\n  gap: 1rem;\n  padding: 1rem;\n  border-radius: 10px;\n  border-left: 4px solid;\n  background: var(--color-surface-light);\n  transition: all 0.2s ease;\n}\n.change-item[data-v-43a3a720]:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(0,0,0,0.05);\n}\n.item-green[data-v-43a3a720] { border-color: var(--color-success);\n}\n.item-red[data-v-43a3a720] { border-color: var(--color-error);\n}\n.item-blue[data-v-43a3a720] { border-color: var(--color-info);\n}\n.item-gray[data-v-43a3a720] { border-color: var(--color-text-secondary);\n}\n.item-icon[data-v-43a3a720] {\n  flex-shrink: 0;\n  width: 2rem;\n  height: 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  color: white;\n}\n.item-green .item-icon[data-v-43a3a720] { background: var(--color-success);\n}\n.item-red .item-icon[data-v-43a3a720] { background: var(--color-error);\n}\n.item-blue .item-icon[data-v-43a3a720] { background: var(--color-info);\n}\n.item-gray .item-icon[data-v-43a3a720] { background: var(--color-text-secondary);\n}\n.item-content[data-v-43a3a720] { flex: 1;\n}\n.item-title[data-v-43a3a720] {\n  margin: 0 0 0.25rem 0;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.item-description[data-v-43a3a720] {\n  margin: 0;\n  font-size: 0.9rem;\n  color: var(--color-text-secondary);\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n",""]);const i=l},9376:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.error-boundary[data-v-31d28cfa] {\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: var(--color-background);\n  padding: 2rem;\n}\n.error-container[data-v-31d28cfa] {\n  max-width: 600px;\n  width: 100%;\n  background: var(--color-surface);\n  border: 2px solid var(--color-error);\n  border-radius: 12px;\n  padding: 2rem;\n  text-align: center;\n}\n.error-icon[data-v-31d28cfa] {\n  font-size: 4rem;\n  margin-bottom: 1rem;\n}\n.error-container h2[data-v-31d28cfa] {\n  color: var(--color-error);\n  margin: 0 0 1rem 0;\n  font-size: 1.8rem;\n}\n.error-message[data-v-31d28cfa] {\n  color: var(--color-text);\n  margin: 0 0 1.5rem 0;\n  font-size: 1rem;\n  line-height: 1.6;\n}\n.error-details[data-v-31d28cfa] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1.5rem;\n  text-align: left;\n  max-height: 300px;\n  overflow-y: auto;\n}\n.error-details pre[data-v-31d28cfa] {\n  margin: 0;\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n.error-actions[data-v-31d28cfa] {\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n.btn-retry[data-v-31d28cfa],\n.btn-back[data-v-31d28cfa],\n.btn-details[data-v-31d28cfa] {\n  padding: 0.75rem 1.5rem;\n  border-radius: 8px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s;\n  border: none;\n}\n.btn-retry[data-v-31d28cfa] {\n  background: var(--color-primary);\n  color: white;\n}\n.btn-retry[data-v-31d28cfa]:hover {\n  background: var(--color-primary-dark);\n  transform: translateY(-2px);\n}\n.btn-back[data-v-31d28cfa] {\n  background: var(--color-surface);\n  color: var(--color-text);\n  border: 1px solid var(--color-border);\n}\n.btn-back[data-v-31d28cfa]:hover {\n  background: var(--color-background);\n}\n.btn-details[data-v-31d28cfa] {\n  background: var(--color-info);\n  color: white;\n}\n.btn-details[data-v-31d28cfa]:hover {\n  background: var(--color-info-dark);\n}\n@media (max-width: 640px) {\n.error-boundary[data-v-31d28cfa] {\n    padding: 1rem;\n}\n.error-container[data-v-31d28cfa] {\n    padding: 1.5rem;\n}\n.error-container h2[data-v-31d28cfa] {\n    font-size: 1.5rem;\n}\n.error-actions[data-v-31d28cfa] {\n    flex-direction: column;\n}\n.btn-retry[data-v-31d28cfa],\n  .btn-back[data-v-31d28cfa],\n  .btn-details[data-v-31d28cfa] {\n    width: 100%;\n}\n}\n",""]);const i=l},9477:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.raw-data-container[data-v-1a2c11e6] {\n  background-color: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  padding: 1rem;\n  max-height: 600px;\n  overflow-y: auto;\n  font-size: 0.8rem;\n}\n.raw-data-container pre[data-v-1a2c11e6] {\n  white-space: pre-wrap;\n  word-break: break-all;\n  margin: 0;\n}\n.spirit-stones-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n  gap: 0.75rem;\n}\n.spirit-stone-item[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.5rem;\n  background: var(--color-surface);\n  border-radius: 4px;\n  border: 1px solid var(--color-border);\n  font-size: 0.85rem;\n}\n.spirit-stone-item span[data-v-1a2c11e6]:first-child {\n  color: var(--color-text-secondary);\n}\n.spirit-stone-item span[data-v-1a2c11e6]:last-child {\n  font-weight: 600;\n  color: var(--color-primary);\n}\n.relationship-network-panel[data-v-1a2c11e6] {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: var(--color-background);\n}\n.panel-content[data-v-1a2c11e6] {\n  flex: 1;\n  overflow: hidden;\n}\n.relationships-container[data-v-1a2c11e6] {\n  height: 100%;\n  display: flex;\n  background: var(--color-surface);\n  overflow: hidden;\n}\n.relationship-list[data-v-1a2c11e6] {\n  width: 280px; /* 窄一点 */\n  border-right: 1px solid var(--color-border);\n  display: flex;\n  flex-direction: column;\n}\n.list-header[data-v-1a2c11e6] {\n  padding: 1rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.panel-title[data-v-1a2c11e6] {\n  margin: 0 0 1rem 0;\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: var(--color-primary);\n  text-align: center;\n}\n.search-bar[data-v-1a2c11e6] {\n  position: relative;\n  display: flex;\n  align-items: center;\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 0.5rem;\n}\n.search-bar svg[data-v-1a2c11e6] {\n  color: var(--color-text-secondary);\n  margin-right: 0.5rem;\n}\n.search-input[data-v-1a2c11e6] {\n  flex: 1;\n  border: none;\n  outline: none;\n  background: transparent;\n  color: var(--color-text);\n  font-size: 0.875rem;\n}\n.list-content[data-v-1a2c11e6] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n.loading-state[data-v-1a2c11e6], .empty-state[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-icon[data-v-1a2c11e6] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n.empty-text[data-v-1a2c11e6] {\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.empty-hint[data-v-1a2c11e6] {\n  font-size: 0.8rem;\n  opacity: 0.8;\n}\n.person-list[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.person-card[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  padding: 0.75rem; /* 更紧凑 */\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.person-card[data-v-1a2c11e6]:hover {\n  border-color: var(--color-primary);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);\n  transform: translateY(-1px);\n}\n.person-card.selected[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(147, 51, 234, 0.1));\n  border-color: var(--color-primary);\n  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n}\n.person-avatar[data-v-1a2c11e6] {\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  color: white;\n  margin-right: 0.75rem;\n  flex-shrink: 0;\n  background: linear-gradient(135deg, #3b82f6, #8b5cf6);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n}\n.avatar-text[data-v-1a2c11e6] {\n  font-size: 1.2rem;\n}\n.person-info[data-v-1a2c11e6] {\n  flex: 1;\n  min-width: 0;\n}\n.person-name[data-v-1a2c11e6] {\n  font-weight: 600;\n  color: var(--color-text);\n  margin-bottom: 0.5rem;\n  font-size: 1rem;\n}\n.person-meta[data-v-1a2c11e6] {\n  margin-bottom: 0.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n.relationship-type[data-v-1a2c11e6] {\n  background: rgba(59, 130, 246, 0.1);\n  color: var(--color-primary);\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.attention-toggle[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  background: rgba(156, 163, 175, 0.1);\n  border: 1px solid rgba(156, 163, 175, 0.2);\n  padding: 0;\n  outline: none;\n}\n.attention-toggle[data-v-1a2c11e6]:hover {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: rgba(59, 130, 246, 0.3);\n  transform: scale(1.1);\n}\n.attention-icon[data-v-1a2c11e6] {\n  transition: all 0.2s ease;\n}\n.attention-icon.active[data-v-1a2c11e6] {\n  color: #22c55e;\n}\n.attention-icon.inactive[data-v-1a2c11e6] {\n  color: #9ca3af;\n}\n.attention-toggle:hover .attention-icon.inactive[data-v-1a2c11e6] {\n  color: #3b82f6;\n}\n.attention-toggle:hover .attention-icon.active[data-v-1a2c11e6] {\n  color: #16a34a;\n}\n.person-realm[data-v-1a2c11e6] {\n  margin-bottom: 0.5rem;\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n}\n.person-realm .realm-label[data-v-1a2c11e6] {\n  margin-right: 0.25rem;\n}\n.person-realm .realm-value[data-v-1a2c11e6] {\n  color: var(--color-primary);\n  font-weight: 600;\n}\n.intimacy-info[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.intimacy-bar[data-v-1a2c11e6] {\n  flex: 1;\n  height: 4px;\n  background: rgba(59, 130, 246, 0.1);\n  border-radius: 2px;\n  overflow: hidden;\n}\n.intimacy-fill[data-v-1a2c11e6] {\n  height: 100%;\n  border-radius: 2px;\n  transition: width 0.3s ease;\n}\n.intimacy-high[data-v-1a2c11e6] { background: linear-gradient(90deg, #22c55e, #16a34a);\n}\n.intimacy-good[data-v-1a2c11e6] { background: linear-gradient(90deg, #3b82f6, #1d4ed8);\n}\n.intimacy-medium[data-v-1a2c11e6] { background: linear-gradient(90deg, #8b5cf6, #7c3aed);\n}\n.intimacy-low[data-v-1a2c11e6] { background: linear-gradient(90deg, #f59e0b, #d97706);\n}\n.intimacy-neutral[data-v-1a2c11e6] { background: linear-gradient(90deg, #6b7280, #4b5563);\n}\n.intimacy-dislike[data-v-1a2c11e6] { background: linear-gradient(90deg, #f97316, #ea580c);\n}\n.intimacy-hostile[data-v-1a2c11e6] { background: linear-gradient(90deg, #dc2626, #b91c1c);\n}\n.intimacy-enemy[data-v-1a2c11e6] { background: linear-gradient(90deg, #ef4444, #dc2626);\n}\n.intimacy-value[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  font-weight: 600;\n  color: var(--color-text-secondary);\n  min-width: 30px;\n  text-align: right;\n}\n.arrow-icon[data-v-1a2c11e6] {\n  color: var(--color-border-hover);\n  transition: transform 0.2s;\n}\n.person-card.selected .arrow-icon[data-v-1a2c11e6] {\n  transform: rotate(90deg);\n  color: var(--color-primary);\n}\n.relationship-detail[data-v-1a2c11e6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0; /* 关键修复：允许flex项收缩，防止内容溢出 */\n  overflow: hidden; /* 隐藏所有溢出，滚动由子元素处理 */\n}\n.detail-header[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.detail-avatar[data-v-1a2c11e6] {\n  width: 64px;\n  height: 64px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 600;\n  color: white;\n  font-size: 1.5rem;\n  background: linear-gradient(135deg, #3b82f6, #8b5cf6);\n  flex-shrink: 0;\n  box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);\n}\n.detail-info[data-v-1a2c11e6] {\n  flex: 1;\n  min-width: 0; /* 允许flex项收缩，防止长名称撑开容器 */\n}\n.detail-name[data-v-1a2c11e6] {\n  margin: 0 0 0.5rem 0;\n  font-size: 1.25rem;\n  font-weight: 700;\n  color: var(--color-text);\n  word-break: break-all; /* 强制长名称换行 */\n}\n.detail-badges[data-v-1a2c11e6] {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n.relationship-badge[data-v-1a2c11e6], .intimacy-badge[data-v-1a2c11e6], .race-badge[data-v-1a2c11e6], .faction-badge[data-v-1a2c11e6] {\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n}\n.relationship-badge[data-v-1a2c11e6] {\n  background: rgba(59, 130, 246, 0.1);\n  color: var(--color-primary);\n}\n.race-badge[data-v-1a2c11e6] {\n  background: rgba(34, 197, 94, 0.1);\n  color: #22c55e;\n  border: 1px solid rgba(34, 197, 94, 0.3);\n}\n.faction-badge[data-v-1a2c11e6] {\n  background: rgba(168, 85, 247, 0.1);\n  color: #a855f7;\n  border: 1px solid rgba(168, 85, 247, 0.3);\n}\n.detail-body[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n  flex: 1; /* 占据剩余空间 */\n  min-height: 0; /* 允许收缩 */\n  overflow-y: auto; /* 内容溢出时滚动 */\n  padding: 1rem;\n}\n.tab-content[data-v-1a2c11e6] {\n  animation: fadeIn-1a2c11e6 0.3s ease;\n}\n@keyframes fadeIn-1a2c11e6 {\nfrom { opacity: 0; transform: translateY(10px);\n}\nto { opacity: 1; transform: translateY(0);\n}\n}\n.empty-state-small[data-v-1a2c11e6] {\n  padding: 2rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-style: italic;\n}\n.detail-section[data-v-1a2c11e6] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 1rem;\n}\n.section-title[data-v-1a2c11e6] {\n  margin: 0 0 1rem 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-text);\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--color-border);\n}\n.info-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n  gap: 1rem;\n}\n.info-grid-2col[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 1rem;\n}\n.info-item[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.info-label[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.info-value[data-v-1a2c11e6] {\n  font-size: 0.875rem;\n  color: var(--color-text);\n  font-weight: 600;\n}\n.memory-list[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  margin-top: 1rem;\n}\n.memory-header[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n}\n.memory-actions-header[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n.memory-count[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  background: rgba(59, 130, 246, 0.1);\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-weight: 500;\n}\n.summarize-controls[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.summarize-input[data-v-1a2c11e6] {\n  width: 60px;\n  padding: 0.375rem 0.5rem;\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  background: var(--color-background);\n  color: var(--color-text);\n  font-size: 0.75rem;\n  text-align: center;\n  transition: all 0.2s ease;\n}\n.summarize-input[data-v-1a2c11e6]:focus {\n  outline: none;\n  border-color: #8b5cf6;\n  box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.1);\n}\n.summarize-btn[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  background: linear-gradient(135deg, #8b5cf6, #7c3aed);\n  color: white;\n  border: none;\n  padding: 0.375rem 0.75rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n}\n.summarize-btn[data-v-1a2c11e6]:hover:not(:disabled) {\n  background: linear-gradient(135deg, #7c3aed, #6d28d9);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);\n}\n.summarize-btn[data-v-1a2c11e6]:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  transform: none;\n}\n.memory-summary-list[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  margin-bottom: 1rem;\n}\n.memory-summary-item[data-v-1a2c11e6] {\n  display: flex;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(124, 58, 237, 0.05));\n  border-radius: 8px;\n  border-left: 3px solid #8b5cf6;\n}\n.summary-icon[data-v-1a2c11e6] {\n  font-size: 1.25rem;\n  flex-shrink: 0;\n}\n.summary-text[data-v-1a2c11e6] {\n  flex: 1;\n  font-size: 0.85rem;\n  line-height: 1.6;\n  color: var(--color-text);\n}\n.memory-pagination[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 1rem;\n  padding-top: 0.75rem;\n  border-top: 1px solid var(--color-border);\n  margin-top: 1rem;\n}\n.pagination-btn[data-v-1a2c11e6] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 6px;\n  padding: 0.5rem 1rem;\n  color: var(--color-text);\n  cursor: pointer;\n  font-size: 0.8rem;\n  font-weight: 500;\n  transition: all 0.2s ease;\n}\n.pagination-btn[data-v-1a2c11e6]:hover:not(:disabled) {\n  background: var(--color-surface);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n.pagination-btn[data-v-1a2c11e6]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.pagination-info[data-v-1a2c11e6] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 60px;\n  text-align: center;\n}\n.memory-item[data-v-1a2c11e6] {\n  display: flex;\n  align-items: flex-start;\n  gap: 8px;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border-left: 3px solid var(--color-primary);\n  font-size: 0.85rem;\n  line-height: 1.4;\n  color: var(--color-text-secondary);\n}\n.memory-content[data-v-1a2c11e6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.memory-time[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  color: var(--color-primary);\n  font-weight: 600;\n  opacity: 0.8;\n}\n.memory-event[data-v-1a2c11e6] {\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n  line-height: 1.5;\n}\n.memory-actions[data-v-1a2c11e6] { display: flex; gap: 6px;\n}\n.memory-btn[data-v-1a2c11e6] {\n  padding: 4px 8px;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  background: var(--color-background);\n}\n.memory-btn.edit[data-v-1a2c11e6] { color: #2563eb; border-color: #bfdbfe;\n}\n.memory-btn.delete[data-v-1a2c11e6] { color: #dc2626; border-color: #fecaca;\n}\n\n/* 简化：外貌描述样式 */\n.appearance-description[data-v-1a2c11e6] {\n  padding: 1rem;\n  background: rgba(147, 51, 234, 0.05);\n  border-radius: 8px;\n  border-left: 3px solid #9333ea;\n}\n.description-text[data-v-1a2c11e6] {\n  font-size: 0.875rem;\n  line-height: 1.6;\n  color: var(--color-text);\n  margin: 0;\n  font-style: italic;\n}\n.subsection-title[data-v-1a2c11e6] {\n  margin: 0 0 0.75rem 0;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.talents-grid[data-v-1a2c11e6] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.talent-tag[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));\n  color: #3b82f6;\n  padding: 0.25rem 0.5rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid rgba(59, 130, 246, 0.2);\n}\n.attributes-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));\n  gap: 0.75rem;\n}\n.attribute-item[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 0.5rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.attr-label[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  margin-bottom: 0.25rem;\n  font-weight: 500;\n}\n.attr-value[data-v-1a2c11e6] {\n  font-size: 1rem;\n  font-weight: 700;\n  color: var(--color-primary);\n}\n\n/* NPC物品样式 */\n.npc-inventory[data-v-1a2c11e6] {\n  margin-top: 0.75rem;\n}\n.npc-items-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 0.75rem;\n}\n.npc-item-card[data-v-1a2c11e6] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  padding: 0.75rem;\n  transition: all 0.2s ease;\n}\n.npc-item-card[data-v-1a2c11e6]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n.npc-item-card.quality-凡[data-v-1a2c11e6] {\n  border-left: 3px solid #6b7280;\n}\n.npc-item-card.quality-黄[data-v-1a2c11e6] {\n  border-left: 3px solid #f59e0b;\n}\n.npc-item-card.quality-玄[data-v-1a2c11e6] {\n  border-left: 3px solid #8b5cf6;\n}\n.npc-item-card.quality-地[data-v-1a2c11e6] {\n  border-left: 3px solid #06b6d4;\n}\n.npc-item-card.quality-天[data-v-1a2c11e6] {\n  border-left: 3px solid #ec4899;\n}\n.npc-item-card.quality-仙[data-v-1a2c11e6] {\n  border-left: 3px solid #f59e0b;\n  box-shadow: 0 0 10px rgba(245, 158, 11, 0.3);\n}\n.npc-item-card.quality-神[data-v-1a2c11e6] {\n  border-left: 3px solid #9333ea;\n  box-shadow: 0 0 15px rgba(147, 51, 234, 0.4);\n}\n.item-header[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.5rem;\n}\n.item-name[data-v-1a2c11e6] {\n  font-weight: 600;\n  color: var(--color-text);\n  font-size: 0.9rem;\n}\n.item-type[data-v-1a2c11e6] {\n  background: var(--color-surface);\n  color: var(--color-text-secondary);\n  padding: 0.125rem 0.375rem;\n  border-radius: 4px;\n  font-size: 0.7rem;\n  font-weight: 500;\n}\n.item-quality[data-v-1a2c11e6] {\n  margin-bottom: 0.5rem;\n}\n.quality-text[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  font-weight: 500;\n  color: var(--color-text-secondary);\n}\n.item-quantity[data-v-1a2c11e6] {\n  text-align: right;\n  margin-bottom: 0.5rem;\n  font-size: 0.8rem;\n  /* 使用主题主色，增强与卡片背景的对比度 */\n  color: var(--color-primary);\n  font-weight: 700;\n}\n.item-description[data-v-1a2c11e6] {\n  margin-bottom: 0.75rem;\n}\n.item-description p[data-v-1a2c11e6] {\n  margin: 0;\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  line-height: 1.4;\n}\n.item-actions[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n.trade-btn[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  background: linear-gradient(135deg, #059669, #047857);\n  color: white;\n  border: none;\n  padding: 0.375rem 0.75rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.trade-btn[data-v-1a2c11e6]:hover {\n  background: linear-gradient(135deg, #047857, #065f46);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(5, 150, 105, 0.3);\n}\n.trade-btn[data-v-1a2c11e6]:active {\n  transform: translateY(0);\n}\n.request-btn[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  background: linear-gradient(135deg, #3b82f6, #2563eb);\n  color: white;\n  border: none;\n  padding: 0.375rem 0.75rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.request-btn[data-v-1a2c11e6]:hover {\n  background: linear-gradient(135deg, #2563eb, #1d4ed8);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n}\n.request-btn[data-v-1a2c11e6]:active {\n  transform: translateY(0);\n}\n.steal-btn[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  background: linear-gradient(135deg, #dc2626, #b91c1c);\n  color: white;\n  border: none;\n  padding: 0.375rem 0.75rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n.steal-btn[data-v-1a2c11e6]:hover {\n  background: linear-gradient(135deg, #b91c1c, #991b1b);\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);\n}\n.steal-btn[data-v-1a2c11e6]:active {\n  transform: translateY(0);\n}\n.empty-inventory[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 2rem;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.empty-inventory .empty-icon[data-v-1a2c11e6] {\n  margin-bottom: 0.75rem;\n  opacity: 0.5;\n}\n.no-selection[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  text-align: center;\n  color: var(--color-text-secondary);\n}\n.placeholder-icon[data-v-1a2c11e6] {\n  opacity: 0.5;\n  margin-bottom: 1rem;\n}\n.placeholder-text[data-v-1a2c11e6] {\n  font-size: 1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n.placeholder-hint[data-v-1a2c11e6] {\n  font-size: 0.85rem;\n  opacity: 0.8;\n}\n.animate-spin[data-v-1a2c11e6] {\n  animation: spin-1a2c11e6 1s linear infinite;\n}\n@keyframes spin-1a2c11e6 {\nfrom { transform: rotate(0deg);\n}\nto { transform: rotate(360deg);\n}\n}\n\n/* === NSFW 私密信息样式 === */\n.nsfw-section[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.05), rgba(219, 39, 119, 0.05));\n  border: 2px solid rgba(236, 72, 153, 0.3);\n}\n.nsfw-subsection[data-v-1a2c11e6] {\n  margin-bottom: 1rem;\n}\n.nsfw-subsection[data-v-1a2c11e6]:last-child {\n  margin-bottom: 0;\n}\n.development-bars[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.dev-bar-item[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.dev-bar-header[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 0.8rem;\n}\n.dev-label[data-v-1a2c11e6] {\n  color: var(--color-text);\n  font-weight: 500;\n}\n.dev-value[data-v-1a2c11e6] {\n  color: #ec4899;\n  font-weight: 700;\n  font-size: 0.75rem;\n}\n.dev-bar-track[data-v-1a2c11e6] {\n  height: 8px;\n  background: rgba(236, 72, 153, 0.1);\n  border-radius: 4px;\n  overflow: hidden;\n}\n.dev-bar-fill[data-v-1a2c11e6] {\n  height: 100%;\n  background: linear-gradient(90deg, #ec4899, #db2777);\n  border-radius: 4px;\n  transition: width 0.3s ease;\n}\n.status-badge[data-v-1a2c11e6] {\n  display: inline-block;\n  padding: 0.25rem 0.5rem;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 600;\n}\n.status-正常[data-v-1a2c11e6] {\n  background: rgba(107, 114, 128, 0.2);\n  color: #6b7280;\n}\n.status-微湿[data-v-1a2c11e6] {\n  background: rgba(59, 130, 246, 0.2);\n  color: #3b82f6;\n}\n.status-发情[data-v-1a2c11e6] {\n  background: rgba(236, 72, 153, 0.2);\n  color: #ec4899;\n}\n.status-高潮[data-v-1a2c11e6] {\n  background: rgba(220, 38, 38, 0.2);\n  color: #dc2626;\n}\n.status-贤者时间[data-v-1a2c11e6] {\n  background: rgba(139, 92, 246, 0.2);\n  color: #8b5cf6;\n}\n.fetish-tag[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(219, 39, 119, 0.15));\n  color: #ec4899;\n  padding: 0.25rem 0.5rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid rgba(236, 72, 153, 0.3);\n}\n.partner-tag[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.12), rgba(219, 39, 119, 0.12));\n  color: #db2777;\n  padding: 0.3rem 0.6rem;\n  border-radius: 6px;\n  font-size: 0.8rem;\n  font-weight: 500;\n  border: 1px solid rgba(236, 72, 153, 0.25);\n}\n.partner-list[data-v-1a2c11e6] {\n  margin-top: 0.75rem;\n}\n.pregnancy-info[data-v-1a2c11e6] {\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.pregnancy-active[data-v-1a2c11e6] {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n}\n.pregnancy-icon[data-v-1a2c11e6] {\n  font-size: 1.5rem;\n  flex-shrink: 0;\n}\n.pregnancy-details[data-v-1a2c11e6] {\n  flex: 1;\n  font-size: 0.85rem;\n  color: var(--color-text);\n  line-height: 1.6;\n}\n.pregnancy-inactive[data-v-1a2c11e6] {\n  text-align: center;\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n}\n.first-time-info[data-v-1a2c11e6] {\n  padding: 0.75rem;\n  background: rgba(236, 72, 153, 0.05);\n  border-radius: 6px;\n  border-left: 3px solid #ec4899;\n  font-size: 0.85rem;\n  color: var(--color-text);\n}\n\n/* 实时状态高亮区域（通用）*/\n.highlight-section[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(147, 51, 234, 0.05));\n  border-radius: 8px;\n  padding: 1rem;\n  border: 1px solid rgba(59, 130, 246, 0.15);\n}\n.realtime-status[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.status-item[data-v-1a2c11e6] {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  background: var(--color-background);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.status-icon[data-v-1a2c11e6] {\n  font-size: 1.5rem;\n  flex-shrink: 0;\n  line-height: 1;\n}\n.status-content[data-v-1a2c11e6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.status-label[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.status-text[data-v-1a2c11e6] {\n  font-size: 0.85rem;\n  color: var(--color-text);\n  line-height: 1.5;\n  font-style: italic;\n}\n.desire-fill[data-v-1a2c11e6] {\n  background: linear-gradient(90deg, #f59e0b, #dc2626);\n}\n.mini-label[data-v-1a2c11e6] {\n  font-size: 0.75rem;\n  color: var(--color-text-secondary);\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n/* 性经验统计 */\n.experience-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 0.75rem;\n  margin-bottom: 0.75rem;\n}\n.exp-item[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.exp-icon[data-v-1a2c11e6] {\n  font-size: 1.5rem;\n  flex-shrink: 0;\n}\n.exp-content[data-v-1a2c11e6] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.exp-label[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n}\n.exp-value[data-v-1a2c11e6] {\n  font-size: 0.95rem;\n  color: #ec4899;\n  font-weight: 700;\n}\n.last-time-info[data-v-1a2c11e6] {\n  padding: 0.5rem 0.75rem;\n  background: rgba(236, 72, 153, 0.05);\n  border-radius: 4px;\n  font-size: 0.8rem;\n  text-align: center;\n}\n.last-time-label[data-v-1a2c11e6] {\n  color: var(--color-text-secondary);\n  margin-right: 0.5rem;\n}\n.last-time-value[data-v-1a2c11e6] {\n  color: var(--color-text);\n  font-weight: 600;\n}\n\n/* 身体部位列表 */\n.body-parts-list[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.body-part-item[data-v-1a2c11e6] {\n  padding: 0.75rem;\n  background: var(--color-surface);\n  border-radius: 6px;\n  border: 1px solid var(--color-border);\n}\n.part-header[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n.part-name[data-v-1a2c11e6] {\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: var(--color-text);\n}\n.part-mark[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  padding: 0.125rem 0.375rem;\n  background: linear-gradient(135deg, rgba(236, 72, 153, 0.2), rgba(219, 39, 119, 0.2));\n  color: #ec4899;\n  border-radius: 4px;\n  font-weight: 500;\n}\n.part-description[data-v-1a2c11e6] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-style: italic;\n  margin-bottom: 0.5rem;\n  padding: 0.5rem;\n  background: rgba(236, 72, 153, 0.05);\n  border-radius: 4px;\n  line-height: 1.4;\n}\n.part-stats[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n.part-stat[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.stat-label[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: var(--color-text-secondary);\n  min-width: 50px;\n}\n.stat-bar-mini[data-v-1a2c11e6] {\n  flex: 1;\n  height: 6px;\n  background: rgba(236, 72, 153, 0.1);\n  border-radius: 3px;\n  overflow: hidden;\n}\n.stat-bar-fill[data-v-1a2c11e6] {\n  height: 100%;\n  border-radius: 3px;\n  transition: width 0.3s ease;\n}\n.stat-bar-fill.sensitivity[data-v-1a2c11e6] {\n  background: linear-gradient(90deg, #f59e0b, #ec4899);\n}\n.stat-bar-fill.development[data-v-1a2c11e6] {\n  background: linear-gradient(90deg, #8b5cf6, #ec4899);\n}\n.stat-value[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: #ec4899;\n  font-weight: 700;\n  min-width: 35px;\n  text-align: right;\n}\n\n/* 体液状态 */\n.fluid-status[data-v-1a2c11e6] {\n  padding: 0.75rem;\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(236, 72, 153, 0.08));\n  border-radius: 6px;\n  border-left: 3px solid #3b82f6;\n  font-size: 0.85rem;\n  color: var(--color-text);\n  font-style: italic;\n}\n\n/* 特殊体质标签 */\n.special-trait-tag[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(168, 85, 247, 0.15), rgba(236, 72, 153, 0.15));\n  color: #a855f7;\n  padding: 0.25rem 0.5rem;\n  border-radius: 6px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  border: 1px solid rgba(168, 85, 247, 0.3);\n}\n\n/* ========== 人格底线样式 ========== */\n.personality-section[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(249, 115, 22, 0.08));\n  border-left: 4px solid #ef4444;\n}\n.personality-bottomlines[data-v-1a2c11e6] {\n  margin-bottom: 0.75rem;\n}\n.bottomline-tags[data-v-1a2c11e6] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n.bottomline-tag[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(249, 115, 22, 0.15));\n  color: #ef4444;\n  padding: 0.4rem 0.75rem;\n  border-radius: 8px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  border: 1.5px solid rgba(239, 68, 68, 0.4);\n  display: inline-flex;\n  align-items: center;\n  box-shadow: 0 2px 4px rgba(239, 68, 68, 0.1);\n  transition: all 0.2s ease;\n}\n.bottomline-tag[data-v-1a2c11e6]:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 8px rgba(239, 68, 68, 0.2);\n  border-color: rgba(239, 68, 68, 0.6);\n}\n.bottomline-empty[data-v-1a2c11e6] {\n  color: var(--text-secondary);\n  font-style: italic;\n  font-size: 0.875rem;\n  padding: 0.5rem 0;\n}\n.bottomline-warning[data-v-1a2c11e6] {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.5rem;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 0.75rem;\n  border-radius: 8px;\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n.warning-icon[data-v-1a2c11e6] {\n  font-size: 1.1rem;\n  color: #f59e0b;\n  flex-shrink: 0;\n  animation: pulse-1a2c11e6 2s infinite;\n}\n@keyframes pulse-1a2c11e6 {\n0%, 100% {\n    opacity: 1;\n    transform: scale(1);\n}\n50% {\n    opacity: 0.6;\n    transform: scale(1.1);\n}\n}\n.warning-text[data-v-1a2c11e6] {\n  color: #dc2626;\n  font-size: 0.8rem;\n  line-height: 1.4;\n  font-weight: 500;\n}\n\n/* ========== Tab导航样式 ========== */\n.detail-tabs[data-v-1a2c11e6] {\n  display: flex;\n  gap: 0.5rem;\n  padding: 0 0 1rem 0;\n  border-bottom: 2px solid var(--color-border);\n  margin-bottom: 1rem;\n  flex-wrap: wrap;\n}\n.tab-btn[data-v-1a2c11e6] {\n  background: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px 8px 0 0;\n  padding: 0.5rem 1rem;\n  color: var(--color-text-secondary);\n  font-size: 0.85rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  position: relative;\n  outline: none;\n}\n.tab-btn[data-v-1a2c11e6]:hover {\n  background: var(--color-surface);\n  border-color: var(--color-primary);\n  color: var(--color-text);\n  transform: translateY(-2px);\n}\n.tab-btn.active[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(147, 51, 234, 0.1));\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n  font-weight: 600;\n  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);\n}\n.tab-btn.active[data-v-1a2c11e6]::after {\n  content: '';\n  position: absolute;\n  bottom: -2px;\n  left: 0;\n  right: 0;\n  height: 2px;\n  background: var(--color-primary);\n}\n.tab-panel[data-v-1a2c11e6] {\n  animation: fadeIn-1a2c11e6 0.3s ease;\n}\n\n/* ========== 响应式2列布局样式 ========== */\n.info-grid-responsive[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n}\n\n/* 小屏幕时切换为单列 */\n@media (max-width: 500px) {\n.info-grid-responsive[data-v-1a2c11e6] {\n    grid-template-columns: 1fr;\n}\n}\n.info-item-row[data-v-1a2c11e6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 6px 10px;\n  background: transparent;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n  transition: background 0.2s ease;\n}\n.info-item-row[data-v-1a2c11e6]:hover {\n  background: rgba(59, 130, 246, 0.03);\n}\n.info-item-row .info-label[data-v-1a2c11e6] {\n  font-size: 0.8rem;\n  color: var(--color-text-secondary);\n  font-weight: 500;\n  min-width: 50px;\n}\n.info-item-row .info-value[data-v-1a2c11e6] {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--color-text);\n  text-align: right;\n  flex: 1;\n  word-break: break-word;\n}\n\n/* ========== NPC记忆列表样式 ========== */\n.npc-memories-list[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.npc-memory-item[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(234, 179, 8, 0.05), rgba(249, 115, 22, 0.05));\n  border-left: 3px solid #eab308;\n  border-radius: 4px;\n  padding: 10px 12px;\n  transition: all 0.2s ease;\n}\n.npc-memory-item[data-v-1a2c11e6]:hover {\n  background: linear-gradient(135deg, rgba(234, 179, 8, 0.1), rgba(249, 115, 22, 0.1));\n  transform: translateX(4px);\n  box-shadow: 0 2px 6px rgba(234, 179, 8, 0.15);\n}\n.npc-memory-content[data-v-1a2c11e6] {\n  font-size: 0.85rem;\n  color: var(--color-text);\n  line-height: 1.5;\n}\n\n/* ========== NPC六司属性样式 ========== */\n.npc-attributes-container[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.npc-attr-group[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(147, 51, 234, 0.05));\n  border: 1px solid rgba(59, 130, 246, 0.15);\n  border-radius: 8px;\n  padding: 10px;\n}\n.npc-attr-group-title[data-v-1a2c11e6] {\n  font-size: 0.8rem;\n  font-weight: 600;\n  color: var(--color-primary);\n  margin-bottom: 8px;\n  padding-left: 4px;\n}\n.npc-attr-grid[data-v-1a2c11e6] {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 6px;\n}\n.npc-attr-item[data-v-1a2c11e6] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 6px 4px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  border: 1px solid transparent;\n  transition: all 0.2s ease;\n}\n.npc-attr-item[data-v-1a2c11e6]:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(59, 130, 246, 0.3);\n  transform: translateY(-2px);\n}\n.npc-attr-item.final[data-v-1a2c11e6] {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.12), rgba(147, 51, 234, 0.12));\n}\n.npc-attr-item.final[data-v-1a2c11e6]:hover {\n  background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2));\n}\n.npc-attr-label[data-v-1a2c11e6] {\n  font-size: 0.7rem;\n  color: var(--text-secondary);\n  margin-bottom: 2px;\n  font-weight: 500;\n}\n.npc-attr-value[data-v-1a2c11e6] {\n  font-size: 0.95rem;\n  font-weight: 700;\n  color: var(--color-primary);\n}\n.name-and-actions[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n}\n.delete-npc-btn[data-v-1a2c11e6] {\n  background: transparent;\n  border: 1px solid var(--color-border);\n  color: var(--color-text-secondary);\n  border-radius: 50%;\n  width: 28px;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n}\n.delete-npc-btn[data-v-1a2c11e6]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: #ef4444;\n  color: #ef4444;\n  transform: scale(1.1);\n}\n.card-actions[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n.delete-btn-card[data-v-1a2c11e6] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  background: rgba(156, 163, 175, 0.1);\n  border: 1px solid rgba(156, 163, 175, 0.2);\n  color: #9ca3af;\n  padding: 0;\n  outline: none;\n}\n.delete-btn-card[data-v-1a2c11e6]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: #ef4444;\n  color: #ef4444;\n  transform: scale(1.1);\n}\n.back-to-list-btn[data-v-1a2c11e6] {\n  display: none; /* 默认隐藏 */\n  background: transparent;\n  border: 1px solid var(--color-border);\n  color: var(--color-text-secondary);\n  border-radius: 50%;\n  width: 32px;\n  height: 32px;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  margin-right: 0.5rem;\n}\n.back-to-list-btn[data-v-1a2c11e6]:hover {\n  background: var(--color-surface);\n  border-color: var(--color-primary);\n  color: var(--color-primary);\n}\n@media (max-width: 768px) {\n.relationships-container[data-v-1a2c11e6] {\n    position: relative;\n    overflow: hidden;\n}\n.relationship-list[data-v-1a2c11e6],\n  .relationship-detail[data-v-1a2c11e6] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    transition: transform 0.3s ease-in-out;\n    backface-visibility: hidden;\n}\n.relationship-list[data-v-1a2c11e6] {\n    transform: translateX(0);\n    z-index: 10;\n}\n.relationship-detail[data-v-1a2c11e6] {\n    transform: translateX(100%);\n    z-index: 20;\n    border-left: none; /* 移除左边框 */\n}\n.relationships-container.details-active .relationship-list[data-v-1a2c11e6] {\n    transform: translateX(-100%);\n}\n.relationships-container.details-active .relationship-detail[data-v-1a2c11e6] {\n    transform: translateX(0);\n}\n.back-to-list-btn[data-v-1a2c11e6] {\n    display: flex; /* 在移动端显示 */\n}\n.detail-header[data-v-1a2c11e6] {\n    padding: 0.75rem 1rem;\n}\n}\n",""]);const i=l},9596:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(4061);const o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>{const n=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,t)=>t?t.toUpperCase():n.toLowerCase()))(e);return n.charAt(0).toUpperCase()+n.slice(1)},l=(...e)=>e.filter((e,n,t)=>Boolean(e)&&""!==e.trim()&&t.indexOf(e)===n).join(" ").trim(),i=e=>""===e;var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const s=({name:e,iconNode:n,absoluteStrokeWidth:t,"absolute-stroke-width":s,strokeWidth:d,"stroke-width":m,size:p=c.width,color:v=c.stroke,...u},{slots:g})=>(0,a.h)("svg",{...c,...u,width:p,height:p,stroke:v,"stroke-width":i(t)||i(s)||!0===t||!0===s?24*Number(d||m||c["stroke-width"])/Number(p):d||m||c["stroke-width"],class:l("lucide",u.class,...e?[`lucide-${o(r(e))}-icon`,`lucide-${o(e)}`]:["lucide-icon"])},[...n.map(e=>(0,a.h)(...e)),...g.default?[g.default()]:[]]),d=(e,n)=>(t,{slots:o,attrs:r})=>(0,a.h)(s,{...r,...t,iconNode:n,name:e},o)},9808:(e,n,t)=>{t.d(n,{C4:()=>l,Oq:()=>m,assembleSaveData:()=>r,clearAllShards:()=>d,saveAllShards:()=>i,shardSaveData:()=>o,xG:()=>s,xc:()=>c});var a=t(3302);function o(e){let n=!0,t="all";try{const e=localStorage.getItem("dad_game_settings");if(e){const a=JSON.parse(e);n=void 0===a.enableNsfwMode||!!a.enableNsfwMode,t=a.nsfwGenderFilter||"all"}}catch(e){a.Yz.warn("分片存储","读取NSFW设置失败",e)}const o=e.角色基础信息||{名字:"未知修士",性别:"其他",世界:"未知世界",天资:"普通",出生:"散修",灵根:"无",天赋:[],先天六司:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0}},r=e.世界信息||{世界名称:"修仙界",世界背景:"一个广阔的修仙世界",大陆信息:[],势力信息:[],地点信息:[],生成时间:(new Date).toISOString(),世界纪元:"开元",特殊设定:[],版本:"1.0"};return console.log("[分片存储-保存] 接收到的 saveData.角色基础信息.先天六司:",e.角色基础信息?.先天六司),console.log("[分片存储-保存] 最终使用的 baseInfo.先天六司:",o.先天六司),{基础信息:{名字:o.名字,性别:o.性别||"其他",出生日期:o.出生日期,世界:o.世界,天资:o.天资,出生:o.出生,灵根:o.灵根,天赋:o.天赋,先天六司:o.先天六司},境界:e.玩家角色状态.境界,属性:{气血:e.玩家角色状态.气血,灵气:e.玩家角色状态.灵气,神识:e.玩家角色状态.神识,寿命:e.玩家角色状态.寿命,声望:e.玩家角色状态.声望},位置:e.玩家角色状态.位置,修炼功法:e.修炼功法,掌握技能:e.掌握技能||[],装备栏:e.装备栏,背包_灵石:e.背包.灵石,背包_物品:e.背包.物品,人物关系:e.人物关系,三千大道:e.三千大道||{已解锁大道:[],大道进度:{},大道路径定义:{}},世界信息:r,记忆_短期:e.记忆.短期记忆,记忆_中期:e.记忆.中期记忆,记忆_长期:e.记忆.长期记忆,记忆_隐式中期:e.记忆.隐式中期记忆||[],游戏时间:e.游戏时间,状态效果:e.玩家角色状态.状态效果||[],系统:{nsfwMode:n,nsfwGenderFilter:t}}}function r(e){if(!e["基础信息"])throw new Error("[分片存储] 缺少必需的基础信息分片");const n=e["基础信息"];console.log("[分片存储-读取] 从酒馆读取的 基础信息.先天六司:",n.先天六司);const t=e["境界"]||{名称:"凡人",阶段:"",当前进度:0,下一级所需:100,突破描述:"引气入体，感悟天地灵气，踏上修仙第一步"},a=e["属性"]||{气血:{当前:100,上限:100},灵气:{当前:100,上限:100},神识:{当前:50,上限:50},寿命:{当前:0,上限:80},声望:0};return{角色基础信息:{名字:n.名字,性别:n.性别||"其他",出生日期:n.出生日期,世界:n.世界,天资:n.天资,出生:n.出生,灵根:n.灵根,天赋:n.天赋,先天六司:n.先天六司,后天六司:n.后天六司||{根骨:0,悟性:0,定力:0,气运:0,魅力:0,心性:0}},玩家角色状态:{境界:t,声望:a.声望,气血:a.气血,灵气:a.灵气,神识:a.神识,寿命:a.寿命,位置:e["位置"]||{描述:"未知",x:0,y:0},状态效果:e["状态效果"]||[]},修炼功法:e["修炼功法"]||null,掌握技能:e["掌握技能"]||[],装备栏:e["装备栏"]||{装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null},背包:{灵石:e["背包_灵石"]||{下品:0,中品:0,上品:0,极品:0},物品:e["背包_物品"]||{}},人物关系:e["人物关系"]||{},宗门系统:{availableSects:[],sectRelationships:{},sectHistory:[]},三千大道:e["三千大道"]||{大道列表:{}},世界信息:e["世界信息"]||{世界名称:"修仙界",世界背景:"一个广阔的修仙世界",大陆信息:[],势力信息:[],地点信息:[],生成时间:(new Date).toISOString(),世界纪元:"开元",特殊设定:[],版本:"1.0"},记忆:{短期记忆:e["记忆_短期"]||[],中期记忆:e["记忆_中期"]||[],长期记忆:e["记忆_长期"]||[],隐式中期记忆:e["记忆_隐式中期"]||[]},游戏时间:e["游戏时间"]||{年:1,月:1,日:1,小时:0,分钟:0}}}function l(e,n){switch(n){case"基础信息":return e.角色基础信息?{...e.角色基础信息}:null;case"境界":return e.玩家角色状态.境界;case"属性":return{气血:e.玩家角色状态.气血,灵气:e.玩家角色状态.灵气,神识:e.玩家角色状态.神识,寿命:e.玩家角色状态.寿命,声望:e.玩家角色状态.声望};case"位置":return e.玩家角色状态.位置;case"修炼功法":return e.修炼功法;case"掌握技能":return e.掌握技能;case"装备栏":return e.装备栏;case"背包_灵石":return e.背包.灵石;case"背包_物品":return e.背包.物品;case"人物关系":return e.人物关系;case"三千大道":return e.三千大道;case"世界信息":return e.世界信息??null;case"记忆_短期":return e.记忆.短期记忆;case"记忆_中期":return e.记忆.中期记忆;case"记忆_长期":return e.记忆.长期记忆;case"记忆_隐式中期":return e.记忆.隐式中期记忆||[];case"游戏时间":return e.游戏时间;case"状态效果":return e.玩家角色状态.状态效果;default:return null}}async function i(e,n){const o={};for(const[n,t]of Object.entries(e))o[n]=t;console.log(`[分片存储] 准备保存 ${Object.keys(e).length} 个分片到酒馆...`);const{deepCleanForClone:r}=await Promise.resolve().then(t.bind(t,3098)),l=r(o);console.log("[分片存储] 已清理数据，准备写入酒馆");const i=new Promise((e,n)=>{setTimeout(()=>{n(new Error("保存分片数据超时(30秒)"))},3e4)}),c=n.insertOrAssignVariables(l,{type:"chat"});await Promise.race([c,i]),console.log(`[分片存储] ✅ 已保存所有 ${Object.keys(e).length} 个分片`),a.Yz.log("分片存储",`已保存所有 ${Object.keys(e).length} 个分片`)}async function c(e){const n=await e.getVariables({type:"chat"}),t={},o=["基础信息","境界","属性","位置","修炼功法","掌握技能","装备栏","背包_灵石","背包_物品","人物关系","三千大道","世界信息","记忆_短期","记忆_中期","记忆_长期","记忆_隐式中期","游戏时间","状态效果","系统"];for(const e of o)e in n&&(t[e]=n[e]);return a.Yz.log("分片存储",`已加载 ${Object.keys(t).length} 个分片`),t}async function s(e,n){const o={};for(const[n,t]of Object.entries(e))o[n]=t;const{deepCleanForClone:r}=await Promise.resolve().then(t.bind(t,3098)),l=r(o);await n.insertOrAssignVariables(l,{type:"chat"}),a.Yz.log("分片存储",`已批量更新 ${Object.keys(e).length} 个分片`)}async function d(e){const n=["基础信息","境界","属性","位置","修炼功法","掌握技能","装备栏","背包_灵石","背包_物品","人物关系","三千大道","世界信息","记忆_短期","记忆_中期","记忆_长期","记忆_隐式中期","游戏时间","状态效果","系统"];for(const t of n)try{await e.deleteVariable(t,{type:"chat"})}catch(e){a.Yz.warn("分片存储",`清除分片失败: ${t}`,e)}a.Yz.log("分片存储","已清除所有分片")}function m(e){const n=e;if(n.startsWith("角色基础信息."))return{shardKey:"基础信息",subPath:n.substring(7)};if(n.startsWith("玩家角色状态.境界")||n.startsWith("境界")){const e=n.startsWith("玩家角色状态.境界")?"玩家角色状态.境界":"境界",t=n.substring(e.length);return{shardKey:"境界",subPath:t.startsWith(".")?t.substring(1):t}}if(n.startsWith("玩家角色状态.气血")||n.startsWith("玩家角色状态.灵气")||n.startsWith("玩家角色状态.神识")||n.startsWith("玩家角色状态.寿命")||n.startsWith("玩家角色状态.声望")||n.startsWith("属性.")||"声望"===n){const e=n.startsWith("玩家角色状态.")?"玩家角色状态.":n.startsWith("属性.")?"属性.":"";return{shardKey:"属性",subPath:n.substring(e.length)}}if(n.startsWith("玩家角色状态.位置")||n.startsWith("位置")){const e=n.startsWith("玩家角色状态.位置")?"玩家角色状态.位置":"位置",t=n.substring(e.length);return{shardKey:"位置",subPath:t.startsWith(".")?t.substring(1):t}}if(n.startsWith("玩家角色状态.状态效果")||n.startsWith("状态效果")){const e=n.startsWith("玩家角色状态.状态效果")?"玩家角色状态.状态效果":"状态效果",t=n.substring(e.length);return{shardKey:"状态效果",subPath:t.startsWith(".")?t.substring(1):t}}return n.startsWith("修炼功法")?{shardKey:"修炼功法",subPath:n.substring(4).replace(/^\./,"")}:n.startsWith("装备栏")?{shardKey:"装备栏",subPath:n.substring(3).replace(/^\./,"")}:n.startsWith("背包.灵石")?{shardKey:"背包_灵石",subPath:n.substring(5).replace(/^\./,"")}:n.startsWith("背包.物品")?{shardKey:"背包_物品",subPath:n.substring(5).replace(/^\./,"")}:n.startsWith("人物关系")?{shardKey:"人物关系",subPath:n.substring(4).replace(/^\./,"")}:n.startsWith("三千大道")?{shardKey:"三千大道",subPath:n.substring(4).replace(/^\./,"")}:n.startsWith("世界信息")?{shardKey:"世界信息",subPath:n.substring(4).replace(/^\./,"")}:n.startsWith("记忆.短期记忆")?{shardKey:"记忆_短期",subPath:""}:n.startsWith("记忆.中期记忆")?{shardKey:"记忆_中期",subPath:""}:n.startsWith("记忆.长期记忆")?{shardKey:"记忆_长期",subPath:""}:n.startsWith("记忆.隐式中期记忆")?{shardKey:"记忆_隐式中期",subPath:""}:n.startsWith("游戏时间")?{shardKey:"游戏时间",subPath:n.substring(4).replace(/^\./,"")}:null}},9904:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(1601),o=t.n(a),r=t(6314),l=t.n(r)()(o());l.push([e.id,"\n.tree-node[data-v-70308211] {\n  padding-left: 20px;\n  position: relative;\n}\n.node-line[data-v-70308211] {\n  display: flex;\n  align-items: center;\n  padding: 4px 0;\n  cursor: default;\n  position: relative;\n}\n.node-line.is-object[data-v-70308211] {\n  cursor: pointer;\n}\n.arrow[data-v-70308211] {\n  width: 20px;\n  text-align: center;\n  margin-left: -20px;\n  color: #888;\n  font-size: 0.7rem;\n}\n.key[data-v-70308211] {\n  color: #9cdcfe; /* 蓝色，适合键 */\n  margin-right: 8px;\n  font-weight: bold;\n}\n.value[data-v-70308211] {\n  color: #ce9178; /* 橙色，适合字符串值 */\n}\n.node-children[data-v-70308211] {\n  border-left: 1px solid #444;\n}\n.delete-btn[data-v-70308211] {\n  background: none;\n  border: none;\n  color: #ff5555;\n  cursor: pointer;\n  padding: 2px 4px;\n  border-radius: 4px;\n  margin-left: auto;\n  display: none; /* 默认隐藏 */\n  transition: all 0.2s ease;\n}\n.node-line:hover .delete-btn[data-v-70308211] {\n  display: inline-block; /* 悬停时显示 */\n}\n.delete-btn[data-v-70308211]:hover {\n  background: rgba(255, 85, 85, 0.2);\n  color: #ff8080;\n}\n",""]);const i=l}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var r=n[a]={id:a,exports:{}};return e[a](r,r.exports,t),r.exports}t.m=e,t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.b=document.baseURI||self.location.href,t.nc=void 0;var a=t(4061),o=t(1774);const r=VueRouter,l=$;var i=t.n(l),c=t(9596);const s=(0,c.A)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var d=t(4270);const m={class:"toast-container"},p={class:"toast-icon"},v={key:0},u={key:1},g={key:2},f={key:3},b={key:4,class:"spinner"},h=["innerHTML"],y=(0,a.defineComponent)({__name:"ToastContainer",setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",m,[(0,a.createVNode)(a.TransitionGroup,{name:"toast-fade",tag:"div"},{default:(0,a.withCtx)(()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(d.b),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["toast",`toast-${e.type}`])},[(0,a.createElementVNode)("div",p,[(0,a.createCommentVNode)(" You can use SVGs or an icon library here "),"success"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("span",v,"✅")):"error"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("span",u,"❌")):"warning"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("span",g,"⚠️")):"info"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("span",f,"ℹ️")):"loading"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("div",b)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",{class:"toast-message",innerHTML:e.message},null,8,h)],2))),128))]),_:1})]))});var x=t(5072),k=t.n(x),w=t(7825),N=t.n(w),E=t(7659),V=t.n(E),C=t(5056),z=t.n(C),S=t(540),B=t.n(S),D=t(1113),A=t.n(D),I=t(859),T={};T.styleTagTransform=A(),T.setAttributes=z(),T.insert=V().bind(null,"head"),T.domAPI=N(),T.insertStyleElement=B(),k()(I.A,T),I.A&&I.A.locals&&I.A.locals;var j=t(6262);const M=(0,j.A)(y,[["__scopeId","data-v-4e34161e"]]);var q=t(9173);const O={key:0,class:"loading-overlay"},P={class:"loading-content"},F=["innerHTML"],L=(0,a.defineComponent)({__name:"GlobalLoadingOverlay",setup(e){const n=(0,q.useUIStore)();return(e,t)=>((0,a.openBlock)(),(0,a.createBlock)(a.Transition,{name:"fade"},{default:(0,a.withCtx)(()=>[(0,a.unref)(n).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",O,[(0,a.createElementVNode)("div",P,[t[0]||(t[0]=(0,a.createElementVNode)("div",{class:"spinner"},null,-1)),(0,a.createElementVNode)("p",{class:"loading-text",innerHTML:(0,a.unref)(n).loadingText},null,8,F)])])):(0,a.createCommentVNode)("v-if",!0)]),_:1}))}});var Y=t(6533),R={};R.styleTagTransform=A(),R.setAttributes=z(),R.insert=V().bind(null,"head"),R.domAPI=N(),R.insertStyleElement=B(),k()(Y.A,R),Y.A&&Y.A.locals&&Y.A.locals;const U=(0,j.A)(L,[["__scopeId","data-v-c8648b8a"]]),G=(0,c.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),W={class:"dialog-header"},J={class:"dialog-content"},H={class:"error-icon"},Q={class:"message"},K={class:"dialog-actions"},X=(0,a.defineComponent)({__name:"RetryConfirmDialog",setup(e){const n=(0,q.useUIStore)(),t=(0,a.computed)(()=>n.showRetryDialogState),o=(0,a.computed)(()=>n.retryDialogConfig),r=()=>{n.confirmRetry()},l=()=>{n.cancelRetry()};return(e,n)=>t.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"retry-dialog-overlay",onClick:l},[(0,a.createElementVNode)("div",{class:"retry-dialog",onClick:n[0]||(n[0]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",W,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(o.value?.title||"AI生成失败"),1)]),(0,a.createElementVNode)("div",J,[(0,a.createElementVNode)("div",H,[(0,a.createVNode)((0,a.unref)(G),{size:48})]),(0,a.createElementVNode)("p",Q,(0,a.toDisplayString)(o.value?.message||"生成过程遇到问题"),1)]),(0,a.createElementVNode)("div",K,[(0,a.createElementVNode)("button",{class:"btn-secondary",onClick:l},(0,a.toDisplayString)(o.value?.cancelText||"取消创建"),1),(0,a.createElementVNode)("button",{class:"btn-primary",onClick:r},(0,a.toDisplayString)(o.value?.confirmText||"继续重试"),1)])])])):(0,a.createCommentVNode)("v-if",!0)}});var Z=t(5258),ee={};ee.styleTagTransform=A(),ee.setAttributes=z(),ee.insert=V().bind(null,"head"),ee.domAPI=N(),ee.insertStyleElement=B(),k()(Z.A,ee),Z.A&&Z.A.locals&&Z.A.locals;const ne=(0,j.A)(X,[["__scopeId","data-v-9136f00c"]]),te=(0,c.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ae={key:0,class:"dialog-overlay"},oe={class:"dialog-container"},re={class:"dialog-header"},le={class:"dialog-content"},ie={class:"error-list-container"},ce={class:"error-list"},se={class:"content-suggestion"},de={class:"dialog-actions"},me=(0,a.defineComponent)({__name:"DataValidationErrorDialog",setup(e){const n=(0,q.useUIStore)(),t=()=>{n.confirmDataValidationError()},o=(0,a.computed)(()=>"loading"===n.dataValidationContext?{suggestion:"我们建议您立即修复此问题。修复过程将尝试在保留您核心进度的前提下，修正存档的数据结构。",warning:"注意：修复主要针对结构性问题，无法恢复已损坏或丢失的数据。建议您在修复前备份存档。",buttonText:"修复存档并继续"}:{suggestion:"我们建议您立即修复此问题。修复过程将根据您现有的角色基础信息，重新生成一份健康的初始存档数据。",warning:"注意：这将会重置您的游戏进度（如修为、背包物品等），但角色核心设定（如姓名、天赋、灵根）将保留。",buttonText:"重新初始化并修复"});return(e,r)=>(0,a.unref)(n).showDataValidationError?((0,a.openBlock)(),(0,a.createElementBlock)("div",ae,[(0,a.createElementVNode)("div",oe,[(0,a.createElementVNode)("div",re,[(0,a.createVNode)((0,a.unref)(G),{size:28,class:"header-icon"}),r[0]||(r[0]=(0,a.createElementVNode)("h2",{class:"header-title"},"存档数据异常",-1))]),(0,a.createElementVNode)("div",le,[r[2]||(r[2]=(0,a.createElementVNode)("p",{class:"content-lead"},"系统检测到您的存档文件存在严重结构问题，可能导致游戏无法正常运行。这通常是由于版本更新或数据损坏导致的。",-1)),(0,a.createElementVNode)("div",ie,[r[1]||(r[1]=(0,a.createElementVNode)("strong",{class:"error-list-title"},"具体问题如下：",-1)),(0,a.createElementVNode)("ul",ce,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(n).dataValidationErrorMessages,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("li",{key:n,class:"error-item"},(0,a.toDisplayString)(e),1))),128))])]),(0,a.createElementVNode)("p",se,[(0,a.createTextVNode)((0,a.toDisplayString)(o.value.suggestion)+" ",1),(0,a.createElementVNode)("strong",null,(0,a.toDisplayString)(o.value.warning),1)])]),(0,a.createElementVNode)("div",de,[(0,a.createElementVNode)("button",{class:"action-button confirm-button",onClick:t},[(0,a.createVNode)((0,a.unref)(te),{size:16}),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(o.value.buttonText),1)])])])])):(0,a.createCommentVNode)("v-if",!0)}});var pe=t(8932),ve={};ve.styleTagTransform=A(),ve.setAttributes=z(),ve.insert=V().bind(null,"head"),ve.domAPI=N(),ve.insertStyleElement=B(),k()(pe.A,ve),pe.A&&pe.A.locals&&pe.A.locals;const ue=(0,j.A)(me,[["__scopeId","data-v-7a662fc0"]]);var ge=t(2224);function fe(e){return(0,ge.isObject)(e)?e.名称||e.name||"无名物品":"未知物品"}function be(e){return(0,ge.isObject)(e)&&e.数量||1}function he(e){const{key:n,action:t,oldValue:a,newValue:o}=e;if(n.includes("背包.物品")||n.includes("背包_物品")){if("set"===t&&o&&!a){const e=o;return{icon:"add",color:"green",title:"获得物品",description:`【${fe(e)}】x ${be(e)}`}}if("push"===t){const e=o;return{icon:"add",color:"green",title:"获得物品",description:`【${fe(e)}】x ${be(e)}`}}if("delete"===t||"pull"===t||"set"===t&&!o&&a){const e=a;return{icon:"remove",color:"red",title:"失去物品",description:`【${fe(e)}】x ${be(e)}`}}if("set"===t&&a&&o){const e=be(a),n=be(o);if(e!==n){const t=n-e;return{icon:t>0?"add":"remove",color:t>0?"green":"red",title:t>0?"获得物品":"消耗物品",description:`【${fe(o)}】${t>0?"+":""}${t}`}}}}if(n.startsWith("背包.灵石")||n.startsWith("背包_灵石")||n.includes(".灵石.")){const e=n.split(".").pop()||"灵石",t=("number"==typeof o?o:0)-("number"==typeof a?a:0);if(t>0)return{icon:"add",color:"green",title:`获得${e}`,description:`+ ${t}`};if(t<0)return{icon:"remove",color:"red",title:`消耗${e}`,description:`${t}`}}return null}function ye(e){const{key:n,action:t,oldValue:a,newValue:o}=e;if(!(n.startsWith("玩家角色状态")||n.startsWith("境界.")||n.startsWith("属性.")||n.startsWith("位置.")||n.includes(".境界.")||n.includes(".位置.")||n.includes(".气血")||n.includes(".灵气")||n.includes(".神识")||n.includes(".寿命")))return null;const r=n.split(".").pop()||"属性";if("境界.名称"===n||n.endsWith(".境界.名称")||"玩家角色状态.境界.名称"===n)return{icon:"add",color:"green",title:"境界突破",description:`${a||"凡人"} → ${o}`};if("境界.阶段"===n||n.endsWith(".境界.阶段")||"玩家角色状态.境界.阶段"===n)return{icon:"update",color:"blue",title:"境界阶段提升",description:`${a||"无"} → ${o}`};if("位置.描述"===n||n.endsWith(".位置.描述")||"玩家角色状态.位置.描述"===n){const e=e=>{if(!e)return"未知";if("string"==typeof e)return e;if("object"==typeof e&&null!==e){const n=e;if("string"==typeof n.描述)return n.描述;if("string"==typeof n.description)return n.description}return String(e)};return{icon:"update",color:"blue",title:"位置变更",description:`${e(a)} → ${e(o)}`}}const l=n.split("."),i=l[l.length-1],c=l[l.length-2]||r;if(("上限"===i||"最大"===i)&&"number"==typeof o){const e="number"==typeof a?o-a:o;let n="";return"number"==typeof a?(n=`${a} -> ${o}`,e>0&&(n+=` (+${e})`)):n=`设为 ${o}`,{icon:"update",color:"blue",title:`${c}上限变化`,description:n}}if("当前"===i&&"number"==typeof o){const e="number"==typeof a?o-a:o;let n="";return"number"==typeof a?(n=`${a} -> ${o}`,e>0&&(n+=` (+${e})`),e<0&&(n+=` (${e})`)):n=`设为 ${o}`,{icon:"update",color:"blue",title:`${c}当前值变化`,description:n}}if((0,ge.isObject)(o)&&"当前"in o&&(0,ge.isObject)(a)&&"当前"in a){const e=o.当前-a.当前,n=o.最大!==a.最大;let t=`${a.当前} -> ${o.当前}`;return e>0&&(t+=` (+${e})`),e<0&&(t+=` (${e})`),n&&(t+=` (上限变为 ${o.最大})`),{icon:"update",color:"blue",title:`${r}变化`,description:t}}if("number"==typeof o&&"number"==typeof a){const e=o-a;let n=`${a} -> ${o}`;return e>0&&(n+=` (+${e})`),e<0&&(n+=` (${e})`),{icon:"update",color:"blue",title:`${r}变化`,description:n}}return null}function xe(e){const{key:n,action:t,oldValue:a,newValue:o}=e;if(n.startsWith("人物关系.")||n.includes(".人物关系.")){const e=n.split("."),r=e[1]||"某人",l=e[e.length-1];if("好感度"===l&&"number"==typeof a&&"number"==typeof o){const e=o-a;return{icon:e>0?"add":"remove",color:e>0?"green":"red",title:`【${r}】好感度变化`,description:`${a} → ${o} (${e>0?"+":""}${e})`}}if("人物记忆"===l&&"push"===t)return{icon:"add",color:"blue",title:`【${r}】记忆更新`,description:"新增了关于你的记忆"};if("关系状态"===l)return{icon:"update",color:"blue",title:`【${r}】关系变化`,description:`${a||"初识"} → ${o}`};const i=e.slice(2);if(i.length>0){const e=i.join(".").replace(/\.([0-9]+)(?=\.|$)/g,"[$1]");let n=`'${e}' 已更新`;return"object"==typeof o&&null!==o||"object"==typeof a&&null!==a||(n=`'${e}' 从 ${JSON.stringify(a)} 变为 ${JSON.stringify(o)}`),{icon:"update",color:"blue",title:`【${r}】信息更新`,description:n,details:"object"==typeof o&&null!==o||"object"==typeof a&&null!==a?[`旧值: ${JSON.stringify(a)}`,`新值: ${JSON.stringify(o)}`]:void 0}}}return null}function ke(e){const{key:n,action:t,oldValue:a,newValue:o}=e;let r="";return r="set"===t||"update"===t?`值从 ${JSON.stringify(a)} 变为 ${JSON.stringify(o)}`:"add"===t?`数值增加了 ${o}`:"delete"===t?"移除了该字段":`执行了 ${t} 操作`,{icon:"info",color:"gray",title:`数据变更: ${n}`,description:r}}const we=(0,c.A)("scroll-text",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]),Ne=(0,c.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ee=(0,c.A)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Ve=(0,c.A)("circle-minus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]),Ce=(0,c.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ze=(0,c.A)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Se=(0,c.A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Be={class:"state-change-viewer"},De={class:"viewer-header"},Ae={class:"viewer-summary"},_e={class:"summary-item added"},$e={class:"summary-item removed"},Ie={class:"summary-item updated"},Te={class:"viewer-content"},je={key:0,class:"no-changes"},Me={key:1,class:"changes-list"},qe={class:"item-icon"},Oe={class:"item-content"},Pe={class:"item-title"},Fe={class:"item-description"},Le=(0,a.defineComponent)({__name:"StateChangeViewer",props:{log:{}},emits:["close"],setup(e){const n=e,t=(0,a.computed)(()=>function(e){const n={summary:{added:0,removed:0,updated:0},changes:[]};if(!e||!(0,ge.isArray)(e.changes))return n;for(const t of e.changes){let e=null;e=he(t),e||(e=ye(t)),e||(e=xe(t)),e||(e=ke(t)),n.changes.push(e),"add"===e.icon?n.summary.added++:"remove"===e.icon?n.summary.removed++:"update"===e.icon&&n.summary.updated++}return n}(n.log));return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"state-change-overlay",onClick:n[1]||(n[1]=(0,a.withModifiers)(n=>e.$emit("close"),["self"]))},[(0,a.createElementVNode)("div",Be,[(0,a.createElementVNode)("div",De,[(0,a.createElementVNode)("h3",null,[(0,a.createVNode)((0,a.unref)(we),{size:18}),n[2]||(n[2]=(0,a.createTextVNode)(" 变更日志",-1))]),(0,a.createElementVNode)("button",{onClick:n[0]||(n[0]=n=>e.$emit("close")),class:"close-btn"},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",Ae,[(0,a.createElementVNode)("div",_e,[(0,a.createVNode)((0,a.unref)(Ee),{size:16}),(0,a.createElementVNode)("span",null,"新增 "+(0,a.toDisplayString)(t.value.summary.added),1)]),(0,a.createElementVNode)("div",$e,[(0,a.createVNode)((0,a.unref)(Ve),{size:16}),(0,a.createElementVNode)("span",null,"移除 "+(0,a.toDisplayString)(t.value.summary.removed),1)]),(0,a.createElementVNode)("div",Ie,[(0,a.createVNode)((0,a.unref)(te),{size:16}),(0,a.createElementVNode)("span",null,"更新 "+(0,a.toDisplayString)(t.value.summary.updated),1)])]),(0,a.createElementVNode)("div",Te,[0===t.value.changes.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",je,n[3]||(n[3]=[(0,a.createElementVNode)("p",null,"本次操作没有产生可见的状态变更。",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",Me,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(t.value.changes,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:(0,a.normalizeClass)(["change-item",`item-${e.color}`])},[(0,a.createElementVNode)("div",qe,["add"===e.icon?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Ce),{key:0,size:18})):"remove"===e.icon?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(ze),{key:1,size:18})):"update"===e.icon?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(te),{key:2,size:18})):((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Se),{key:3,size:18}))]),(0,a.createElementVNode)("div",Oe,[(0,a.createElementVNode)("p",Pe,(0,a.toDisplayString)(e.title),1),(0,a.createElementVNode)("p",Fe,(0,a.toDisplayString)(e.description),1)])],2))),128))]))])])]))}});var Ye=t(9336),Re={};Re.styleTagTransform=A(),Re.setAttributes=z(),Re.insert=V().bind(null,"head"),Re.domAPI=N(),Re.insertStyleElement=B(),k()(Ye.A,Re),Ye.A&&Ye.A.locals&&Ye.A.locals;const Ue=(0,j.A)(Le,[["__scopeId","data-v-43a3a720"]]),Ge={class:"modal-header"},We={class:"modal-title"},Je={class:"modal-content"},He=(0,a.defineComponent)({__name:"DetailModal",setup(e){const n=(0,q.useUIStore)(),t=()=>{n.hideDetailModal()};return(e,o)=>((0,a.openBlock)(),(0,a.createBlock)(a.Transition,{name:"modal-fade"},{default:(0,a.withCtx)(()=>[(0,a.unref)(n).showDetailModalState?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:t},[(0,a.createElementVNode)("div",{class:"modal-container",onClick:o[0]||(o[0]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",Ge,[(0,a.createElementVNode)("h3",We,(0,a.toDisplayString)((0,a.unref)(n).detailModalTitle),1),(0,a.createElementVNode)("button",{class:"modal-close-button",onClick:t},[(0,a.createVNode)((0,a.unref)(Ne),{size:24})])]),(0,a.createElementVNode)("div",Je,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)((0,a.unref)(n).detailModalContent),1)])])])):(0,a.createCommentVNode)("v-if",!0)]),_:1}))}});var Qe=t(3332),Ke={};Ke.styleTagTransform=A(),Ke.setAttributes=z(),Ke.insert=V().bind(null,"head"),Ke.domAPI=N(),Ke.insertStyleElement=B(),k()(Qe.A,Ke),Qe.A&&Qe.A.locals&&Qe.A.locals;const Xe=(0,j.A)(He,[["__scopeId","data-v-3b19ffcd"]]);var Ze=t(1208),en={};en.styleTagTransform=A(),en.setAttributes=z(),en.insert=V().bind(null,"head"),en.domAPI=N(),en.insertStyleElement=B(),k()(Ze.A,en),Ze.A&&Ze.A.locals&&Ze.A.locals;var nn=t(1211),tn=t(948),an=t(8651);const on={id:"app-container"},rn={key:1,class:"global-actions"},ln=["checked"],cn={href:"https://ddct.top",target:"_blank",rel:"noopener noreferrer",class:"theme-toggle",title:"教程"},sn={class:"author-modal"},dn={class:"author-modal-header"},mn=(0,a.defineComponent)({__name:"App",setup(e){const n=(0,a.ref)(!1),t=(0,a.ref)("light"!==localStorage.getItem("theme")),o=(0,a.ref)(),l=(0,a.ref)(),c=(0,a.ref)("true"===localStorage.getItem("fullscreen")),m=(0,a.ref)(!1),p=(0,r.useRouter)(),v=(0,r.useRoute)(),u=(0,a.computed)(()=>v.path.startsWith("/game")),g=e=>{const n={ModeSelection:"/",CharacterCreation:"/creation",Login:"/login",CharacterManagement:"/management",GameView:"/game"}[e];n?p.push(n):(console.warn(`未知的视图名称: ${e}，将导航至首页。`),p.push("/"))},f=(0,nn.N)(),b=(0,tn.useCharacterStore)(),h=(0,q.useUIStore)(),y=async e=>{try{if("single"!==e)return d.o.info("联机共修开发中，当前版本暂未开放"),void g("ModeSelection");f.setMode("single"),g("CharacterCreation")}catch(e){console.error("Failed to initialize creation data:",e),d.o.error("初始化创角数据失败，请稍后重试。"),g("ModeSelection")}},x=()=>{p.push("/management")},k=()=>{f.resetCharacter(),g("ModeSelection")},w=()=>{n.value=!0,g("ModeSelection")},N=()=>{g("Login")},E=async e=>{if(console.log("接收到创角指令...",e),h.isLoading)return void console.warn("[App.vue] 角色创建已在进行中，忽略重复请求");h.startLoading("开始铸造法身...");const n=`char_${Date.now()}`,t=async()=>{try{b.rootState.角色列表[n]&&(console.log("[角色创建] 检测到残留数据，清理中..."),delete b.rootState.角色列表[n],b.commitToStorage());let t="无名道友";try{const n=(0,an.getTavernHelper)();if(n){const a=await n.getVariables({type:"global"}),o=a["persona.name"]||a.name||e.characterName;t=("string"==typeof o?o:e.characterName)||"无名道友",console.log("[创角完成] 从酒馆Personas获取名字:",t)}}catch(n){console.warn("[创角完成] 无法从酒馆获取Persona名字，使用用户输入:",n),t=e.characterName||"无名道友"}const a=e.baseAttributes?{根骨:e.baseAttributes.root_bone??0,灵性:e.baseAttributes.spirituality??0,悟性:e.baseAttributes.comprehension??0,气运:e.baseAttributes.fortune??0,魅力:e.baseAttributes.charm??0,心性:e.baseAttributes.temperament??0}:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0},o={名字:t,性别:"女"===e.gender||"其他"===e.gender?e.gender:"男",种族:e.race||"人族",世界:e.world?.name||"未知世界",天资:e.talentTier?.name||"凡品",出生:e.origin?.name||"随机出身",灵根:e.spiritRoot?.name||"随机灵根",天赋:e.talents?.map(e=>({名称:e.name,描述:e.description||""}))||[],先天六司:a,后天六司:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0}};o.天资详情=e.talentTier,o.出身详情=e.origin,o.灵根详情=e.spiritRoot||void 0,o.天赋详情=e.talents;const r={charId:n,baseInfo:o,world:e.world,mode:e.mode,age:e.age},l=await b.createNewCharacter(r);if(!l)throw new Error("角色创建失败，请检查 characterStore 的日志。");const i=b.rootState.角色列表[n];if(!i)throw new Error("严重错误：角色创建后无法在角色列表中找到！");const c="单机"===i.模式?"存档1":"存档";return b.rootState.当前激活存档={角色ID:n,存档槽位:c},b.commitToStorage(),await new Promise(e=>setTimeout(e,500)),d.o.success(`【${l.名字}】已成功踏入修行之路！`),await p.push("/game"),await new Promise(e=>setTimeout(e,100)),z(),!0}catch(e){console.error("角色创建过程出错：",e);const a=e instanceof Error?e.message:"法身铸造过程中出现意外";return b.rootState.角色列表[n]&&(console.log("[角色创建] 创建失败，清理残留数据..."),delete b.rootState.角色列表[n],b.commitToStorage()),a.includes("用户选择终止角色创建")||a.includes("用户选择不继续重试")?(console.log("[角色创建] 用户主动取消创建流程"),d.o.info("角色创建已取消"),!1):new Promise(e=>{h.showRetryDialog({title:"角色创建失败",message:`角色创建过程中遇到问题：\n\n${a}\n\n是否重新尝试创建角色？`,confirmText:"重新创建",cancelText:"返回创建页面",onConfirm:async()=>{console.log("[角色创建] 用户选择重新创建"),e(await t())},onCancel:()=>{console.log("[角色创建] 用户选择返回创建页面"),d.o.info("已返回角色创建页面，您可以调整设置后重新开始"),e(!1)}})})}};try{console.log("[App.vue] 开始执行attemptCreation...");const e=await t();console.log("[App.vue] attemptCreation执行完成,结果:",e),e||console.log("[角色创建] 保持在角色创建页面")}catch(e){console.error("[App.vue] 角色创建流程出现严重错误：",e);const n=e instanceof Error?e.message:String(e);d.o.error(`角色创建失败: ${n}`),n.includes("超时")&&d.o.error("创建过程超时,请检查网络连接和SillyTavern状态")}finally{console.log("[App.vue] finally: 停止loading"),h.stopLoading()}};(0,a.watchEffect)(()=>{const e=t.value?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),o.value&&(o.value.checked=!t.value)});const V=()=>{t.value=!t.value},C=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen().then(()=>{c.value=!1,localStorage.setItem("fullscreen","false"),console.log("[全屏] 已退出全屏模式并保存状态")}).catch(e=>{console.error("无法退出全屏模式:",e),d.o.error("无法退出全屏模式")}):document.documentElement.requestFullscreen().then(()=>{c.value=!0,localStorage.setItem("fullscreen","true"),console.log("[全屏] 已进入全屏模式并保存状态")}).catch(e=>{console.error("无法进入全屏模式:",e),d.o.error("无法进入全屏模式")})},z=()=>{c.value&&!document.fullscreenElement&&(console.log("[全屏] 检测到需要恢复全屏状态"),document.documentElement.requestFullscreen().then(()=>{console.log("[全屏] 全屏状态已恢复")}).catch(e=>{console.warn("[全屏] 无法恢复全屏状态:",e),c.value=!1,localStorage.setItem("fullscreen","false")}))};return(0,a.onMounted)(async()=>{console.log("[App] 等待 characterStore 初始化..."),await b.initializeStore(),console.log("[App] ✅ characterStore 初始化完成");const e=()=>{try{if(window.parent===window)return;const e=i()("#chat",parent.document);if(e.length>0){const n=e.height();if(n){const e=.9*n+"px";document.documentElement.style.minHeight=e,console.log(`[App.vue] 主动查询父窗口#chat高度成功，应用min-height: ${e}`)}}else console.warn("[App.vue] 在父窗口中未找到 #chat 元素，无法自动调整高度。")}catch(n){console.error("[App.vue] 访问父窗口DOM失败，可能是跨域限制。请确保iframe与父页面同源。",n),i()(parent.window).off("resize",e)}};e(),i()(parent.window).on("resize",e);const n=()=>{const e=!!document.fullscreenElement;c.value=e,localStorage.setItem("fullscreen",e.toString()),l.value&&(l.value.checked=e)};document.addEventListener("fullscreenchange",n),document.addEventListener("webkitfullscreenchange",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("MSFullscreenChange",n),n(),setTimeout(()=>{z()},500);const t=setInterval(async()=>{try{const e=b.activeSaveSlot;e?.存档数据&&(console.log("[定时保存] 保存当前存档..."),await b.syncToTavernAndSave(),console.log("[定时保存] 保存成功"))}catch(e){console.error("[定时保存] 保存失败:",e)}},3e5);(0,a.onUnmounted)(()=>{if(clearInterval(t),window.parent!==window)try{i()(parent.window).off("resize",e)}catch{}document.removeEventListener("fullscreenchange",n),document.removeEventListener("webkitfullscreenchange",n),document.removeEventListener("mozfullscreenchange",n),document.removeEventListener("MSFullscreenChange",n)})}),(0,a.watch)(v,(e,n)=>{e.path!==n?.path&&(console.log(`[全屏] 路由从 ${n?.path} 切换到 ${e.path}`),setTimeout(()=>{z()},200))},{immediate:!1}),(e,n)=>{const r=(0,a.resolveComponent)("router-view");return(0,a.openBlock)(),(0,a.createElementBlock)("div",on,[(0,a.createVNode)(M),(0,a.createVNode)(U),(0,a.createVNode)(ne),(0,a.createVNode)(ue),(0,a.unref)(h).showStateChangeViewer?((0,a.openBlock)(),(0,a.createBlock)(Ue,{key:0,log:(0,a.unref)(h).stateChangeLogToShow,onClose:(0,a.unref)(h).closeStateChangeViewer},null,8,["log","onClose"])):(0,a.createCommentVNode)("v-if",!0),(0,a.createVNode)(Xe),(0,a.createCommentVNode)(" 全局操作按钮 - 只在非游戏界面显示 "),u.value?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",rn,[(0,a.createElementVNode)("label",{class:"theme-toggle",onClick:(0,a.withModifiers)(V,["prevent"])},[(0,a.createElementVNode)("input",{type:"checkbox",ref_key:"globalThemeCheckbox",ref:o,checked:!t.value},null,8,ln),n[2]||(n[2]=(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",class:"moon"},[(0,a.createElementVNode)("path",{d:"M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"})],-1)),n[3]||(n[3]=(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",class:"sun"},[(0,a.createElementVNode)("path",{d:"M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"})],-1))]),(0,a.createElementVNode)("label",{class:"fullscreen-toggle",onClick:(0,a.withModifiers)(C,["prevent"])},[(0,a.createElementVNode)("input",{type:"checkbox",ref_key:"globalFullscreenCheckbox",ref:l},null,512),n[4]||(n[4]=(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"expand"},[(0,a.createElementVNode)("path",{d:"M32 32C14.3 32 0 46.3 0 64v96c0 17.7 14.3 32 32 32s32-14.3 32-32V96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H64V352zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h64v64c0 17.7 14.3 32 32 32s32-14.3 32-32V64c0-17.7-14.3-32-32-32H320zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V352z"})],-1)),n[5]||(n[5]=(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"compress"},[(0,a.createElementVNode)("path",{d:"M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V64zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32H96v64c0 17.7 14.3 32 32 32s32-14.3 32-32V352c0-17.7-14.3-32-32-32H32zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V64zM320 320c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32s32-14.3 32-32V384h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H320z"})],-1))]),(0,a.createElementVNode)("a",cn,[(0,a.createVNode)((0,a.unref)(s),{size:24})])])),(0,a.createCommentVNode)(" 路由视图将在这里渲染所有页面 "),(0,a.createVNode)(r,null,{default:(0,a.withCtx)(({Component:e})=>[(0,a.createVNode)(a.Transition,{name:"fade",mode:"out-in"},{default:(0,a.withCtx)(()=>[((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(e),{onStartCreation:y,onShowCharacterList:x,onBack:k,onCreationComplete:E,onLoggedIn:w,onLogin:N},null,32))]),_:2},1024)]),_:1}),(0,a.createCommentVNode)(" Author Info Modal "),m.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:2,class:"author-modal-overlay",onClick:n[1]||(n[1]=(0,a.withModifiers)(e=>m.value=!1,["self"]))},[(0,a.createElementVNode)("div",sn,[(0,a.createElementVNode)("div",dn,[n[6]||(n[6]=(0,a.createElementVNode)("h3",null,"🎮 大道朝天 - 游戏信息",-1)),(0,a.createElementVNode)("button",{class:"close-btn",onClick:n[0]||(n[0]=e=>m.value=!1)},"×")]),n[7]||(n[7]=(0,a.createStaticVNode)('<div class="author-modal-body" data-v-6ff8c096><div class="version-badge" data-v-6ff8c096>V1.0 Beta</div><div class="info-section" data-v-6ff8c096><h4 data-v-6ff8c096>📝 关于游戏</h4><p data-v-6ff8c096>《大道朝天》是一款基于AI驱动的沉浸式修仙文字冒险游戏，结合SillyTavern与Gemini AI，为玩家打造无限可能的修仙世界。</p><p data-v-6ff8c096><span style="color:yellow;" data-v-6ff8c096>游玩尽量使用推荐预设，在了解原理后可自行更换调整，<span style="color:red;" data-v-6ff8c096>禁止打开COT</span></span></p></div><div class="info-section" data-v-6ff8c096><h4 data-v-6ff8c096>✨ 核心功能</h4><ul class="feature-list" data-v-6ff8c096><li data-v-6ff8c096>🎲 <strong data-v-6ff8c096>智能判定系统</strong> - 根据境界、属性、装备、大道等全方位计算判定</li><li data-v-6ff8c096>🌟 <strong data-v-6ff8c096>三千大道系统</strong> - 探索修炼独特的修仙之道，提升实力</li><li data-v-6ff8c096>📖 <strong data-v-6ff8c096>动态剧情生成</strong> - AI实时生成个性化的修仙故事</li><li data-v-6ff8c096>💾 <strong data-v-6ff8c096>多存档管理</strong> - 支持多角色、多周目游玩</li><li data-v-6ff8c096>⚔️ <strong data-v-6ff8c096>深度RPG系统</strong> - 境界突破、功法学习、装备炼制、NPC互动</li><li data-v-6ff8c096>🗺️ <strong data-v-6ff8c096>世界探索</strong> - 自由探索朝天大陆，触发奇遇事件</li><li data-v-6ff8c096>🎨 <strong data-v-6ff8c096>精美UI</strong> - 修仙风格界面，支持亮暗双主题</li><li data-v-6ff8c096>💬 <strong data-v-6ff8c096>格式化文本</strong> - 环境描写、心理活动、对话、判定结果分别渲染</li></ul></div><div class="info-section" data-v-6ff8c096><h4 data-v-6ff8c096>👨‍💻 作者信息</h4><p data-v-6ff8c096><strong data-v-6ff8c096>作者:</strong> 千夜</p><p data-v-6ff8c096><strong data-v-6ff8c096>GitHub:</strong><a href="https://github.com/qianye60" target="_blank" rel="noopener noreferrer" data-v-6ff8c096> https://github.com/qianye60 </a></p><p class="tech-stack" data-v-6ff8c096><strong data-v-6ff8c096>技术栈:</strong> Vue 3 + TypeScript + SillyTavern</p></div><div class="info-section" data-v-6ff8c096><h4 data-v-6ff8c096>📢 版本说明</h4><p class="version-note" data-v-6ff8c096>当前为<strong data-v-6ff8c096>V1.0 Beta</strong>测试版本，部分功能仍在开发完善中。欢迎反馈建议！</p></div><div class="info-section" data-v-6ff8c096><h4 data-v-6ff8c096>⚖️ 版权声明</h4><div class="copyright-notice" data-v-6ff8c096><p data-v-6ff8c096>© 2025 千夜 版权所有</p><p data-v-6ff8c096>本作品采用 <strong data-v-6ff8c096>CC BY-NC-ND 4.0</strong> 协议授权</p><ul class="copyright-list" data-v-6ff8c096><li data-v-6ff8c096>✅ <strong data-v-6ff8c096>允许</strong> - 个人免费使用、学习交流</li><li data-v-6ff8c096>✅ <strong data-v-6ff8c096>允许</strong> - 分享转发时须注明原作者</li><li data-v-6ff8c096>❌ <strong data-v-6ff8c096>禁止</strong> - 商业用途（包括但不限于售卖、收费推广等）</li><li data-v-6ff8c096>❌ <strong data-v-6ff8c096>禁止</strong> - 修改后重新发布</li><li data-v-6ff8c096>❌ <strong data-v-6ff8c096>禁止</strong> - 移除或修改版权信息</li></ul></div></div></div>',1))])])):(0,a.createCommentVNode)("v-if",!0)])}}});var pn=t(4388),vn={};vn.styleTagTransform=A(),vn.setAttributes=z(),vn.insert=V().bind(null,"head"),vn.domAPI=N(),vn.insertStyleElement=B(),k()(pn.A,vn),pn.A&&pn.A.locals&&pn.A.locals;const un=(0,j.A)(mn,[["__scopeId","data-v-6ff8c096"]]),gn={class:"video-background-container"},fn=(0,a.defineComponent)({__name:"VideoBackground",props:{src:{default:"http://ddct.top/backgroundvedio.mp4"}},setup(e){const n=e,t=(0,a.ref)(),o=async e=>{if(!t.value)return void console.warn("[VideoBackground] video元素未准备好");console.log(`[VideoBackground] 直接加载视频: ${e}`),t.value.src=e,t.value.load();const n=async()=>{try{await t.value.play(),console.log("[VideoBackground] 视频播放成功")}catch(e){console.log("[VideoBackground] 自动播放失败，等待用户交互");const n=async()=>{try{await t.value.play(),console.log("[VideoBackground] 用户交互后视频播放成功"),document.removeEventListener("click",n),document.removeEventListener("keydown",n),document.removeEventListener("touchstart",n)}catch(e){console.warn("[VideoBackground] 即使用户交互后仍无法播放:",e)}};document.addEventListener("click",n,{once:!0}),document.addEventListener("keydown",n,{once:!0}),document.addEventListener("touchstart",n,{once:!0})}};t.value.readyState>=3?await n():t.value.addEventListener("canplay",n,{once:!0})};(0,a.onMounted)(async()=>{await o(n.src)}),(0,a.watch)(()=>n.src,async e=>{e&&await o(e)}),(0,a.onUnmounted)(()=>{t.value&&t.value.pause()});const r=()=>{console.log("[VideoBackground] 开始加载视频")},l=()=>{console.log("[VideoBackground] 视频可以流畅播放")},i=e=>{console.error("[VideoBackground] 视频播放错误:",e)};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",gn,[(0,a.createElementVNode)("video",{ref_key:"videoRef",ref:t,autoplay:"",muted:"",loop:"",playsinline:"",class:"video-background",onLoadstart:r,onCanplaythrough:l,onError:i},null,544),n[0]||(n[0]=(0,a.createElementVNode)("div",{class:"video-overlay"},null,-1))]))}});var bn=t(4081),hn={};hn.styleTagTransform=A(),hn.setAttributes=z(),hn.insert=V().bind(null,"head"),hn.domAPI=N(),hn.insertStyleElement=B(),k()(bn.A,hn),bn.A&&bn.A.locals&&bn.A.locals;const yn=(0,j.A)(fn,[["__scopeId","data-v-faad78a8"]]),xn={class:"mode-selection-container"},kn={class:"selection-content"},wn={class:"gate-container"},Nn=(0,a.defineComponent)({__name:"ModeSelection",emits:["start-creation","show-character-list"],setup(e,{emit:n}){(0,a.ref)("..."),(0,a.onMounted)(async()=>{});const t=n,o=(0,q.useUIStore)(),r=e=>{"cloud"!==e?t("start-creation",e):o.showRetryDialog({title:"功能未开放",message:"联机共修开发中，当前版本已封锁入口。请先选择“单机闭关”。",confirmText:"知道了",cancelText:"取消",onConfirm:()=>{},onCancel:()=>{}})},l=()=>{t("show-character-list")};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",xn,[(0,a.createVNode)(yn),(0,a.createElementVNode)("div",kn,[n[5]||(n[5]=(0,a.createStaticVNode)('<div class="header-container" data-v-6b737fda><div class="title-version-row" data-v-6b737fda><h1 class="main-title" data-v-6b737fda>大 道 朝 天</h1><span class="version-tag" data-v-6b737fda>V2.0 Beta</span>\x3c!--{{ appVersion }}--\x3e</div><p class="sub-title" data-v-6b737fda>仙路求索 · 万道归天</p></div>',1)),(0,a.createElementVNode)("div",wn,[(0,a.createCommentVNode)(" Left Gate: Single Player "),(0,a.createElementVNode)("div",{class:"gate-card left-gate",onClick:n[0]||(n[0]=e=>r("single"))},n[2]||(n[2]=[(0,a.createStaticVNode)('<div class="gate-icon" data-v-6b737fda>\x3c!-- Icon: 独修闭关 --\x3e<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6b737fda><path d="M8 2v4" data-v-6b737fda></path><path d="M16 2v4" data-v-6b737fda></path><rect width="18" height="18" x="3" y="4" rx="2" data-v-6b737fda></rect><path d="M3 10h18" data-v-6b737fda></path><path d="M8 14h.01" data-v-6b737fda></path><path d="M12 14h.01" data-v-6b737fda></path><path d="M16 14h.01" data-v-6b737fda></path><path d="M8 18h.01" data-v-6b737fda></path><path d="M12 18h.01" data-v-6b737fda></path><path d="M16 18h.01" data-v-6b737fda></path></svg></div><div class="gate-text" data-v-6b737fda><h2 class="gate-title" data-v-6b737fda>单机闭关</h2><p class="gate-description" data-v-6b737fda>避世清修·心无旁骛</p><p class="gate-detail" data-v-6b737fda>独居洞府，专心致志炼就大道根基<br data-v-6b737fda>所有进度本地存储，断网亦可修行</p></div>',2)])),(0,a.createCommentVNode)(" Right Gate: Multiplayer (temporarily disabled) "),(0,a.createElementVNode)("div",{class:"gate-card right-gate disabled",onClick:n[1]||(n[1]=e=>r("cloud"))},n[3]||(n[3]=[(0,a.createStaticVNode)('<div class="gate-icon" data-v-6b737fda>\x3c!-- Icon: 联机共修 --\x3e<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6b737fda><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" data-v-6b737fda></path><circle cx="9" cy="7" r="4" data-v-6b737fda></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87" data-v-6b737fda></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-6b737fda></path></svg></div><div class="gate-text" data-v-6b737fda><h2 class="gate-title" data-v-6b737fda>联机共修（未开放）</h2><p class="gate-description" data-v-6b737fda>功能研发中，敬请期待</p><p class="gate-detail" data-v-6b737fda>当前版本已封锁联机入口，不影响单机闭关体验</p></div>',2)]))]),(0,a.createCommentVNode)(" 隐私说明 "),n[6]||(n[6]=(0,a.createElementVNode)("div",{class:"privacy-notice"},[(0,a.createElementVNode)("p",null,[(0,a.createTextVNode)("本联机谨遵天道法则："),(0,a.createElementVNode)("strong",null,"不存储任何对话记录")]),(0,a.createElementVNode)("p",null,"仅保留法身属性、境界进度等修行要素，确保道友隐私清净无染")],-1)),(0,a.createElementVNode)("div",{class:"footer-actions"},[(0,a.createElementVNode)("button",{class:"scroll-btn",onClick:l},n[4]||(n[4]=[(0,a.createElementVNode)("span",null,"续 前 世 因 缘",-1)]))])])]))}});var En=t(1325),Vn={};Vn.styleTagTransform=A(),Vn.setAttributes=z(),Vn.insert=V().bind(null,"head"),Vn.domAPI=N(),Vn.insertStyleElement=B(),k()(En.A,Vn),En.A&&En.A.locals&&En.A.locals;const Cn=(0,j.A)(Nn,[["__scopeId","data-v-6b737fda"]]),zn=["disabled","title"],Sn={key:0,class:"sync-icon"},Bn={key:1,class:"sync-icon"},Dn={key:2,class:"sync-icon"},An={class:"sync-text"},_n=(0,a.defineComponent)({__name:"CloudDataSync",props:{size:{},variant:{}},emits:["syncCompleted","syncStarted"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(!1),l=(0,a.ref)(!1);async function i(){if(r.value||l.value)return void(l.value&&d.o.info("云端数据已获取，无需重复操作"));r.value=!0,t("syncStarted");const e="cloud-sync-toast";d.o.loading("正在获取云端数据...",{id:e});try{const n=await o.fetchAllCloudData();n>0?(d.o.success(`同步成功！新增 ${n} 项云端数据`,{id:e}),l.value=!0):(d.o.info("所有云端数据已是最新",{id:e}),l.value=!0),t("syncCompleted",{success:!0,newItemsCount:n,message:"同步成功"})}catch(n){console.error("[云端同步组件] 同步云端数据失败:",n);const a=n instanceof Error?n.message:"同步失败";d.o.error(`同步失败: ${a}`,{id:e}),t("syncCompleted",{success:!1,newItemsCount:0,message:a})}finally{r.value=!1}}return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{onClick:i,class:(0,a.normalizeClass)(["cloud-sync-button",{synced:l.value}]),disabled:r.value,title:r.value?"正在同步云端数据...":l.value?"云端数据已获取":"获取云端数据"},[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",Sn,"⏳")):l.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",Bn,"✅")):((0,a.openBlock)(),(0,a.createElementBlock)("span",Dn,"☁️")),(0,a.createElementVNode)("span",An,(0,a.toDisplayString)(r.value?"同步中":l.value?"已获取":"获取云端"),1)],10,zn))}});var $n=t(6932),In={};In.styleTagTransform=A(),In.setAttributes=z(),In.insert=V().bind(null,"head"),In.domAPI=N(),In.insertStyleElement=B(),k()($n.A,In),$n.A&&$n.A.locals&&$n.A.locals;const Tn=(0,j.A)(_n,[["__scopeId","data-v-5e3340f2"]]);var jn=t(7527);const Mn={class:"data-clear-container"},qn={class:"clear-buttons"},On=["disabled"],Pn=["disabled"],Fn=(0,a.defineComponent)({__name:"DataClearButtons",props:{variant:{},size:{}},emits:["dataCleared"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,q.useUIStore)(),l=(0,a.computed)(()=>{const e=Math.max(...jn.eQ.map(e=>e.id)),n=Math.max(...jn.VQ.map(e=>e.id)),t=Math.max(...jn.yM.map(e=>e.id)),a=Math.max(...jn.Gr.map(e=>e.id)),r=Math.max(...jn.qS.map(e=>e.id));return o.creationData.worlds.some(n=>"cloud"===n.source||n.id>e)||o.creationData.talentTiers.some(e=>"cloud"===e.source||e.id>n)||o.creationData.origins.some(e=>"cloud"===e.source||e.id>t)||o.creationData.spiritRoots.some(e=>"cloud"===e.source||e.id>a)||o.creationData.talents.some(e=>"cloud"===e.source||e.id>r)}),i=(0,a.computed)(()=>o.creationData.worlds.some(e=>"cloud"===e.source)||o.creationData.talentTiers.some(e=>"cloud"===e.source)||o.creationData.origins.some(e=>"cloud"===e.source)||o.creationData.spiritRoots.some(e=>"cloud"===e.source)||o.creationData.talents.some(e=>"cloud"===e.source));async function c(){l.value&&r.showRetryDialog({title:"清除自定义数据",message:"确定要清除自定义数据吗？这将清除所有自定义和AI生成的数据，保留本地基础数据和云端数据。此操作不可撤销！",confirmText:"确认清除",cancelText:"取消",onConfirm:async()=>{const e=o.creationData.worlds.length,n=o.creationData.talentTiers.length,a=o.creationData.origins.length,r=o.creationData.spiritRoots.length,l=o.creationData.talents.length,i=Math.max(...jn.eQ.map(e=>e.id)),c=Math.max(...jn.VQ.map(e=>e.id)),s=Math.max(...jn.yM.map(e=>e.id)),m=Math.max(...jn.Gr.map(e=>e.id)),p=Math.max(...jn.qS.map(e=>e.id));o.creationData.worlds=o.creationData.worlds.filter(e=>"local"===e.source||e.id<=i),o.creationData.talentTiers=o.creationData.talentTiers.filter(e=>"local"===e.source||e.id<=c),o.creationData.origins=o.creationData.origins.filter(e=>"local"===e.source||e.id<=s),o.creationData.spiritRoots=o.creationData.spiritRoots.filter(e=>"local"===e.source||e.id<=m),o.creationData.talents=o.creationData.talents.filter(e=>"local"===e.source||e.id<=p);const v=e-o.creationData.worlds.length+(n-o.creationData.talentTiers.length)+(a-o.creationData.origins.length)+(r-o.creationData.spiritRoots.length)+(l-o.creationData.talents.length);o.resetCharacter(),await async function(){try{const e=(0,an.getTavernHelper)();if(!e)return void console.warn("酒馆助手不可用，跳过清理酒馆自定义数据");await e.deleteVariable("DAD_creationData",{type:"global"}),console.log("已清理酒馆全局变量 DAD_creationData");const n=await e.getVariables({type:"global"}),t=Object.keys(n).filter(e=>e.includes("DAD_")||e.includes("custom")||e.includes("自定义"));t.length>0&&(await Promise.all(t.map(n=>e.deleteVariable(n,{type:"global"}))),console.log(`已清理 ${t.length} 个自定义数据相关的酒馆变量:`,t))}catch(e){console.error("清理酒馆自定义数据时出错:",e)}}(),await o.persistCustomData(),d.o.success(`已清除${v} 项自定义数据，保留本地基础数据和云端数据`),t("dataCleared","custom",v)},onCancel:()=>{}})}async function s(){i.value&&r.showRetryDialog({title:"清除云端数据",message:"确定要清除云端数据吗？这将清除从云端获取的数据，保留本地基础数据和自定义数据。此操作不可撤销！",confirmText:"确认清除",cancelText:"取消",onConfirm:async()=>{const e=o.creationData.worlds.length,n=o.creationData.talentTiers.length,a=o.creationData.origins.length,r=o.creationData.spiritRoots.length,l=o.creationData.talents.length;o.creationData.worlds=o.creationData.worlds.filter(e=>"cloud"!==e.source),o.creationData.talentTiers=o.creationData.talentTiers.filter(e=>"cloud"!==e.source),o.creationData.origins=o.creationData.origins.filter(e=>"cloud"!==e.source),o.creationData.spiritRoots=o.creationData.spiritRoots.filter(e=>"cloud"!==e.source),o.creationData.talents=o.creationData.talents.filter(e=>"cloud"!==e.source);const i=e-o.creationData.worlds.length+(n-o.creationData.talentTiers.length)+(a-o.creationData.origins.length)+(r-o.creationData.spiritRoots.length)+(l-o.creationData.talents.length);o.resetCharacter(),await o.persistCustomData(),d.o.success(`已清除${i} 项云端数据，保留本地数据和自定义数据`),t("dataCleared","cloud",i)},onCancel:()=>{}})}return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Mn,[(0,a.createElementVNode)("div",qn,[(0,a.createCommentVNode)(" 清除自定义数据（自定义+AI生成），保留本地基础+云端数据 "),(0,a.createElementVNode)("button",{onClick:c,class:"clear-button custom",disabled:!l.value,title:"清除自定义和AI生成的数据"},n[0]||(n[0]=[(0,a.createElementVNode)("span",{class:"clear-icon"},"🗑️",-1),(0,a.createElementVNode)("span",{class:"clear-text"},"清除自定义",-1)]),8,On),(0,a.createCommentVNode)(" 清除云端数据，保留本地基础+自定义数据 "),(0,a.createElementVNode)("button",{onClick:s,class:"clear-button cloud",disabled:!i.value,title:"清除从云端获取的数据"},n[1]||(n[1]=[(0,a.createElementVNode)("span",{class:"clear-icon"},"☁️",-1),(0,a.createElementVNode)("span",{class:"clear-text"},"清除云端",-1)]),8,Pn)])]))}});var Ln=t(4920),Yn={};Yn.styleTagTransform=A(),Yn.setAttributes=z(),Yn.insert=V().bind(null,"head"),Yn.domAPI=N(),Yn.insertStyleElement=B(),k()(Ln.A,Yn),Ln.A&&Ln.A.locals&&Ln.A.locals;const Rn=(0,j.A)(Fn,[["__scopeId","data-v-36f2cce4"]]),Un=(0,c.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var Gn=t(1783);const Wn=(0,c.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Jn={class:"modal-dialog"},Hn={class:"modal-title"},Qn={class:"form-fields"},Kn=["for"],Xn=["id","onUpdate:modelValue","placeholder","type"],Zn=["id","onUpdate:modelValue","placeholder"],et=["id","onUpdate:modelValue"],nt=["value"],tt={class:"dynamic-list-container"},at={class:"list-header"},ot=["onClick"],rt={key:0,class:"list-items"},lt={class:"item-inputs"},it=["onUpdate:modelValue"],ct=["value"],st=["onUpdate:modelValue","placeholder"],dt=["onUpdate:modelValue","placeholder"],mt=["onUpdate:modelValue","placeholder"],pt=["onClick"],vt={key:1,class:"empty-list"},ut={key:0,class:"error-messages"},gt=(0,a.defineComponent)({__name:"CustomCreationModal",props:{visible:{type:Boolean},title:{},fields:{},validationFn:{type:Function},initialData:{}},emits:["close","submit"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)({}),l=(0,a.ref)([]),i=(0,a.computed)(()=>t.fields.filter(e=>!e.condition||e.condition(r.value)));function c(){o("close")}function s(){l.value=[];const e=t.validationFn(r.value);e.valid?(o("submit",{...r.value}),c()):l.value=e.errors}return(0,a.watch)(()=>[t.fields,t.initialData],([e,n])=>{const t={};e.forEach(e=>{const a=n?.[e.key];"select"===e.type?t[e.key]=a??e.options?.[0]?.value??"":"dynamic-list"===e.type?t[e.key]=Array.isArray(a)?JSON.parse(JSON.stringify(a)):[]:t[e.key]=a??""}),r.value=t},{immediate:!0,deep:!0}),(e,n)=>((0,a.openBlock)(),(0,a.createBlock)(a.Transition,{name:"modal-fade"},{default:(0,a.withCtx)(()=>[e.visible?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:(0,a.withModifiers)(c,["self"])},[(0,a.createElementVNode)("div",Jn,[(0,a.createElementVNode)("h2",Hn,(0,a.toDisplayString)(e.title),1),(0,a.createElementVNode)("div",Qn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(i.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.key,class:"form-group"},[(0,a.createElementVNode)("label",{for:e.key},(0,a.toDisplayString)(e.label),9,Kn),"text"===e.type||"color"===e.type||"number"===e.type?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:0,id:e.key,"onUpdate:modelValue":n=>r.value[e.key]=n,placeholder:e.placeholder,type:e.type},null,8,Xn)),[[a.vModelDynamic,r.value[e.key]]]):"textarea"===e.type?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("textarea",{key:1,id:e.key,"onUpdate:modelValue":n=>r.value[e.key]=n,placeholder:e.placeholder,rows:"5"},null,8,Zn)),[[a.vModelText,r.value[e.key]]]):"select"===e.type?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("select",{key:2,id:e.key,"onUpdate:modelValue":n=>r.value[e.key]=n},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.options,e=>((0,a.openBlock)(),(0,a.createElementBlock)("option",{key:e.value,value:e.value},(0,a.toDisplayString)(e.label),9,nt))),128))],8,et)),[[a.vModelSelect,r.value[e.key]]]):"dynamic-list"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:3},[(0,a.createCommentVNode)(" 动态列表字段 "),(0,a.createElementVNode)("div",tt,[(0,a.createElementVNode)("div",at,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.label),1),(0,a.createElementVNode)("button",{onClick:n=>function(e){const n=r.value[e.key];Array.isArray(n)||(r.value[e.key]=[]);const t={};e.columns.forEach(e=>{"select"===e.type&&e.options?t[e.key]=e.options[0]?.value||"":t[e.key]=""}),r.value[e.key].push(t)}(e),class:"add-btn",type:"button"},"+ 添加",8,ot)]),Array.isArray(r.value[e.key])&&r.value[e.key].length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",rt,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(r.value[e.key],(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"list-item"},[(0,a.createElementVNode)("div",lt,["select"===e.columns[0].type?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("select",{key:0,"onUpdate:modelValue":t=>n[e.columns[0].key]=t,class:"item-input"},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.columns[0].options,e=>((0,a.openBlock)(),(0,a.createElementBlock)("option",{key:e.value,value:e.value},(0,a.toDisplayString)(e.label),9,ct))),128))],8,it)),[[a.vModelSelect,n[e.columns[0].key]]]):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:1,"onUpdate:modelValue":t=>n[e.columns[0].key]=t,placeholder:e.columns[0].placeholder,class:"item-input"},null,8,st)),[[a.vModelText,n[e.columns[0].key]]]),e.columns[1]?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:2,"onUpdate:modelValue":t=>n[e.columns[1].key]=t,placeholder:e.columns[1].placeholder,class:"item-input"},null,8,dt)),[[a.vModelText,n[e.columns[1].key]]]):(0,a.createCommentVNode)("v-if",!0),e.columns[2]?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:3,"onUpdate:modelValue":t=>n[e.columns[2].key]=t,placeholder:e.columns[2].placeholder,class:"item-input",type:"number",step:"0.1"},null,8,mt)),[[a.vModelText,n[e.columns[2].key]]]):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("button",{onClick:n=>function(e,n){const t=r.value[e.key];Array.isArray(t)&&t.splice(n,1)}(e,t),class:"remove-btn",type:"button"},"×",8,pt)]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",vt,n[0]||(n[0]=[(0,a.createElementVNode)("span",null,'暂无条目，点击"添加"按钮开始',-1)])))])],2112)):(0,a.createCommentVNode)("v-if",!0)]))),128))]),l.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",ut,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("p",{key:n},"* "+(0,a.toDisplayString)(e),1))),128))])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",{class:"modal-actions"},[(0,a.createElementVNode)("button",{onClick:c,class:"btn btn-secondary"},"关闭"),(0,a.createElementVNode)("button",{onClick:s,class:"btn"},"确认")])])])):(0,a.createCommentVNode)("v-if",!0)]),_:1}))}});var ft=t(5805),bt={};bt.styleTagTransform=A(),bt.setAttributes=z(),bt.insert=V().bind(null,"head"),bt.domAPI=N(),bt.insertStyleElement=B(),k()(ft.A,bt),ft.A&&ft.A.locals&&ft.A.locals;const ht=(0,j.A)(gt,[["__scopeId","data-v-0cb8c11b"]]),yt={class:"modal-content"},xt={class:"modal-body"},kt=["onKeydown"],wt={class:"modal-footer"},Nt=["disabled"],Et=(0,a.defineComponent)({__name:"AIPromptModal",props:{visible:{type:Boolean}},emits:["close","submit"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)("");function l(){o("close")}function i(){const e=r.value.trim();e&&(o("submit",e),l())}return(0,a.watch)(()=>t.visible,e=>{e&&(r.value="")}),(e,n)=>e.visible?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:(0,a.withModifiers)(l,["self"])},[(0,a.createElementVNode)("div",yt,[(0,a.createElementVNode)("div",{class:"modal-header"},[n[1]||(n[1]=(0,a.createElementVNode)("h3",null,"AI推演",-1)),(0,a.createElementVNode)("button",{class:"close-btn",onClick:l},"×")]),(0,a.createElementVNode)("div",xt,[n[2]||(n[2]=(0,a.createElementVNode)("p",{class:"hint"},"请描述你想生成什么内容：",-1)),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),class:"prompt-input",placeholder:"例如：生成一个火属性的天赋，适合剑修...",rows:"6",onKeydown:(0,a.withKeys)((0,a.withModifiers)(i,["ctrl"]),["enter"])},null,40,kt),[[a.vModelText,r.value]])]),(0,a.createElementVNode)("div",wt,[(0,a.createElementVNode)("button",{class:"cancel-btn",onClick:l},"取消"),(0,a.createElementVNode)("button",{class:"submit-btn",onClick:i,disabled:!r.value.trim()}," 开始推演 ",8,Nt)])])])):(0,a.createCommentVNode)("v-if",!0)}});var Vt=t(5828),Ct={};Ct.styleTagTransform=A(),Ct.setAttributes=z(),Ct.insert=V().bind(null,"head"),Ct.domAPI=N(),Ct.insertStyleElement=B(),k()(Vt.A,Ct),Vt.A&&Vt.A.locals&&Vt.A.locals;const zt=(0,j.A)(Et,[["__scopeId","data-v-de60386a"]]);var St=t(6972),Bt=t(5408);const Dt={class:"world-selection-container"},At={key:0,class:"loading-state"},_t={key:1,class:"error-state"},$t={key:2,class:"world-layout"},It={class:"left-panel"},Tt={class:"top-actions-container"},jt={class:"list-container"},Mt={key:0,class:"no-worlds-message"},qt={class:"no-worlds-text"},Ot={key:0,class:"no-worlds-hint"},Pt=["onClick","onMouseover"],Ft={class:"item-content"},Lt={class:"item-name"},Yt={key:0,class:"action-buttons"},Rt=["onClick"],Ut=["onClick"],Gt={class:"details-container"},Wt={key:0,class:"world-details"},Jt={class:"details-header"},Ht={class:"details-title"},Qt={class:"era"},Kt={class:"map-options"},Xt={key:0,class:"config-warning"},Zt={class:"map-options-grid"},ea={class:"option-item"},na={class:"option-item"},ta={class:"option-item"},aa={class:"option-item"},oa={class:"option-item"},ra={class:"option-item"},la={class:"map-options-grid geo-grid"},ia={class:"option-item"},ca={class:"range-inputs"},sa={class:"option-item"},da={class:"range-inputs"},ma={class:"description-scroll"},pa={key:1,class:"placeholder"},va=(0,a.defineComponent)({__name:"Step1_WorldSelection",emits:["ai-generate"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(null),l=(0,a.ref)(!1),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(!1),m=(0,a.ref)(null),p=(0,a.ref)({majorFactionsCount:Math.floor(3*Math.random())+4,totalLocations:Math.floor(4*Math.random())+10,secretRealmsCount:Math.floor(3*Math.random())+4,continentCount:Math.floor(3*Math.random())+3,mapConfig:{width:3600,height:2400,minLng:100,maxLng:130,minLat:25,maxLat:45}});(0,a.watch)(p,e=>{o.setWorldGenerationConfig(e),console.log("[世界配置] 配置已更新:",e)},{deep:!0});const v=(0,a.computed)(()=>{const e=o.creationData.worlds;if(console.log("【世界选择】所有世界数据:",e),console.log("【世界选择】当前模式:",o.isLocalCreation?"本地":"联机"),o.isLocalCreation){const n=e.filter(e=>"local"===e.source||"cloud"===e.source);return console.log("【世界选择】单机模式可用世界列表:",n),n}{const n=e.filter(e=>"cloud"===e.source);return console.log("【世界选择】联机模式世界列表:",n),console.log("【世界选择】云端世界数量:",n.length),0===n.length&&(console.warn("【世界选择】警告：联机模式下没有找到云端世界数据！"),console.log("【世界选择】尝试查看所有世界的source字段:",e.map(e=>({name:e.name,source:e.source,id:e.id})))),n}}),u=[{key:"name",label:"世界名称",type:"text",placeholder:"例如：九霄界"},{key:"era",label:"时代背景",type:"text",placeholder:"例如：仙道昌隆"},{key:"description",label:"世界描述",type:"textarea",placeholder:"描述这个世界的背景故事、修炼体系特点等..."}];function g(e){const n={};return e.name?.trim()||(n.name="世界名称不可为空"),{valid:0===Object.keys(n).length,errors:Object.values(n)}}async function f(e){const n={id:Date.now(),name:e.name,era:e.era,description:e.description,source:"local"};try{o.addWorld(n),y(n),l.value=!1,d.o.success(`自定义世界 "${n.name}" 已成功保存！`)}catch(e){console.error("保存自定义世界失败:",e),d.o.error("保存自定义世界失败！")}}function b(){o.isLocalCreation?s.value=!0:t("ai-generate")}async function h(e){const n="ai-generate-world";d.o.loading("天机推演中，请稍候...",{id:n});try{const t=await(0,St.eb)(e,Bt.tQ,!1);if(!t)return void d.o.error("AI推演失败",{id:n});let a;console.log("【AI推演-世界】完整响应:",t);try{const e=t.match(/```json\s*([\s\S]*?)\s*```/)||t.match(/\{[\s\S]*\}/),n=e?e[1]||e[0]:t;a=JSON.parse(n.trim())}catch(e){return console.error("【AI推演-世界】JSON解析失败:",e),void d.o.error("AI推演结果格式错误，无法解析",{id:n})}if(!a.name)return void d.o.error("AI推演结果缺少世界名称",{id:n});const r={id:Date.now(),name:a.name||a.名称||"未命名世界",era:a.era||a.时代背景||"",description:a.description||a.描述||a.世界描述||"",source:"local"};o.addWorld(r),y(r),s.value=!1,d.o.success(`AI推演完成！世界 "${r.name}" 已生成`,{id:n})}catch(e){console.error("【AI推演-世界】失败:",e),d.o.error(`AI推演失败: ${e.message}`,{id:n})}}function y(e){o.selectWorld(e.id),o.setWorldGenerationConfig(p.value)}function x(){const e=[3,4,5,6,7],n=[8,10,12,15,18],t=[3,4,5,6,8],a=[3,4,5,6],r=90+30*Math.random(),l=20+20*Math.random(),i=20+20*Math.random(),c=15+15*Math.random();p.value={majorFactionsCount:e[Math.floor(Math.random()*e.length)],totalLocations:n[Math.floor(Math.random()*n.length)],secretRealmsCount:t[Math.floor(Math.random()*t.length)],continentCount:a[Math.floor(Math.random()*a.length)],mapConfig:{width:3600,height:2400,minLng:parseFloat(r.toFixed(1)),maxLng:parseFloat((r+l).toFixed(1)),minLat:parseFloat(i.toFixed(1)),maxLat:parseFloat((i+c).toFixed(1))}},o.setWorldGenerationConfig(p.value),d.o.info("已随机生成世界配置")}function k(){p.value={majorFactionsCount:5,totalLocations:12,secretRealmsCount:5,continentCount:4,mapConfig:{width:3600,height:2400,minLng:100,maxLng:130,minLat:25,maxLat:45}},o.setWorldGenerationConfig(p.value),d.o.info("已重置为默认配置")}const w=(0,a.computed)(()=>{const e=p.value.mapConfig;return p.value.majorFactionsCount>8||p.value.totalLocations>15||p.value.secretRealmsCount>10||e.width>6e3||e.height>6e3||e.minLng>=e.maxLng||e.minLat>=e.maxLat});async function N(e){if(!m.value)return;const n={name:e.name,era:e.era,description:e.description};try{o.updateWorld(m.value.id,n)?(c.value=!1,m.value=null,d.o.success(`世界 "${n.name}" 已更新！`)):d.o.error("更新世界失败！")}catch(e){console.error("更新世界失败:",e),d.o.error("更新世界失败！")}}const E=(0,a.computed)(()=>m.value?{name:m.value.name,era:m.value.era,description:m.value.description}:{});return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Dt,[(0,a.unref)(o).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",At,"正在推演诸天万界...")):(0,a.unref)(o).error?((0,a.openBlock)(),(0,a.createElementBlock)("div",_t,"天机紊乱："+(0,a.toDisplayString)((0,a.unref)(o).error),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",$t,[(0,a.createCommentVNode)(" 左侧面板：世界列表 "),(0,a.createElementVNode)("div",It,[(0,a.createCommentVNode)(" 顶部功能按钮 "),(0,a.createElementVNode)("div",Tt,[(0,a.unref)(o).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:n[0]||(n[0]=e=>l.value=!0),class:"action-item shimmer-on-hover"},n[15]||(n[15]=[(0,a.createElementVNode)("span",{class:"action-name"},"自定义世界",-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:b,class:"action-item shimmer-on-hover"},n[16]||(n[16]=[(0,a.createElementVNode)("span",{class:"action-name"},"AI推演",-1)]))]),(0,a.createElementVNode)("div",jt,[0===v.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Mt,[n[17]||(n[17]=(0,a.createElementVNode)("div",{class:"no-worlds-icon"},"🌌",-1)),(0,a.createElementVNode)("div",qt,(0,a.toDisplayString)((0,a.unref)(o).isLocalCreation?"暂无本地世界数据":"暂无云端世界数据"),1),(0,a.unref)(o).isLocalCreation?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ot," 请检查网络连接或联系管理员 "))])):((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:1},(0,a.renderList)(v.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["list-item",{selected:(0,a.unref)(o).characterPayload.world_id===e.id}]),onClick:n=>y(e),onMouseover:n=>r.value=e},[(0,a.createElementVNode)("div",Ft,[(0,a.createElementVNode)("span",Lt,(0,a.toDisplayString)(e.name),1)]),"cloud"===e.source?((0,a.openBlock)(),(0,a.createElementBlock)("div",Yt,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>function(e){m.value=e,c.value=!0}(e),["stop"]),class:"edit-btn",title:"编辑此项"},[(0,a.createVNode)((0,a.unref)(Un),{size:14})],8,Rt),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>async function(e){try{await o.removeWorld(e),console.log(`【世界选择】成功删除世界 ID: ${e}`)}catch(n){console.error(`【世界选择】删除世界失败 ID: ${e}`,n)}}(e.id),["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,Ut)])):(0,a.createCommentVNode)("v-if",!0)],42,Pt))),128))])]),(0,a.createCommentVNode)(" 右侧面板：世界详情 + 地图生成选项 "),(0,a.createElementVNode)("div",Gt,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Wt,[(0,a.createElementVNode)("div",Jt,[(0,a.createElementVNode)("h2",Ht,(0,a.toDisplayString)(r.value.name),1),(0,a.createElementVNode)("button",{class:"map-settings-btn",onClick:n[1]||(n[1]=e=>i.value=!i.value),title:"地图生成选项"},[(0,a.createVNode)((0,a.unref)(Wn),{size:16}),n[18]||(n[18]=(0,a.createElementVNode)("span",{class:"btn-text"},"设置",-1))])]),(0,a.createElementVNode)("p",Qt,"【"+(0,a.toDisplayString)(r.value.era||"时代未知")+"】",1),(0,a.createCommentVNode)(" 地图生成选项（移入右侧详情内，避免整体高度溢出） "),(0,a.withDirectives)((0,a.createElementVNode)("div",Kt,[n[36]||(n[36]=(0,a.createElementVNode)("div",{class:"map-options-header"},"地图生成选项",-1)),(0,a.createCommentVNode)(" 配置警告提示 "),w.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Xt,n[19]||(n[19]=[(0,a.createElementVNode)("div",{class:"warning-icon"},"⚠️",-1),(0,a.createElementVNode)("div",{class:"warning-text"},[(0,a.createElementVNode)("div",{class:"warning-title"},"配置过高警告"),(0,a.createElementVNode)("div",{class:"warning-desc"},"当前配置可能导致生成失败，建议调整至合理范围")],-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Zt,[(0,a.createElementVNode)("label",ea,[n[20]||(n[20]=(0,a.createElementVNode)("span",{class:"option-label"},"主要势力",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"1",max:"20",step:"1","onUpdate:modelValue":n[2]||(n[2]=e=>p.value.majorFactionsCount=e),class:(0,a.normalizeClass)({"config-risky":p.value.majorFactionsCount>8})},null,2),[[a.vModelText,p.value.majorFactionsCount,void 0,{number:!0}]]),n[21]||(n[21]=(0,a.createElementVNode)("span",{class:"config-hint"},"推荐: 3-8",-1))]),(0,a.createElementVNode)("label",na,[n[22]||(n[22]=(0,a.createElementVNode)("span",{class:"option-label"},"地点总数",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"5",max:"100",step:"1","onUpdate:modelValue":n[3]||(n[3]=e=>p.value.totalLocations=e),class:(0,a.normalizeClass)({"config-risky":p.value.totalLocations>15})},null,2),[[a.vModelText,p.value.totalLocations,void 0,{number:!0}]]),n[23]||(n[23]=(0,a.createElementVNode)("span",{class:"config-hint"},"推荐: 8-15",-1))]),(0,a.createElementVNode)("label",ta,[n[24]||(n[24]=(0,a.createElementVNode)("span",{class:"option-label"},"秘境数量",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"0",max:"30",step:"1","onUpdate:modelValue":n[4]||(n[4]=e=>p.value.secretRealmsCount=e),class:(0,a.normalizeClass)({"config-risky":p.value.secretRealmsCount>10})},null,2),[[a.vModelText,p.value.secretRealmsCount,void 0,{number:!0}]]),n[25]||(n[25]=(0,a.createElementVNode)("span",{class:"config-hint"},"推荐: 3-10",-1))]),(0,a.createElementVNode)("label",aa,[n[26]||(n[26]=(0,a.createElementVNode)("span",{class:"option-label"},"大陆数量",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"3",max:"7",step:"1","onUpdate:modelValue":n[5]||(n[5]=e=>p.value.continentCount=e),title:"大陆数量决定世界的宏观格局，3-7片大陆形成不同的地缘政治结构"},null,512),[[a.vModelText,p.value.continentCount,void 0,{number:!0}]]),n[27]||(n[27]=(0,a.createElementVNode)("span",{class:"config-hint"},"范围: 3-7",-1))]),(0,a.createElementVNode)("label",oa,[n[28]||(n[28]=(0,a.createElementVNode)("span",{class:"option-label"},"地图宽度",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"1000",max:"8000",step:"100","onUpdate:modelValue":n[6]||(n[6]=e=>p.value.mapConfig.width=e)},null,512),[[a.vModelText,p.value.mapConfig.width,void 0,{number:!0}]]),n[29]||(n[29]=(0,a.createElementVNode)("span",{class:"config-hint"},"推荐: 3600",-1))]),(0,a.createElementVNode)("label",ra,[n[30]||(n[30]=(0,a.createElementVNode)("span",{class:"option-label"},"地图高度",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",min:"1000",max:"8000",step:"100","onUpdate:modelValue":n[7]||(n[7]=e=>p.value.mapConfig.height=e)},null,512),[[a.vModelText,p.value.mapConfig.height,void 0,{number:!0}]]),n[31]||(n[31]=(0,a.createElementVNode)("span",{class:"config-hint"},"推荐: 2400",-1))])]),(0,a.createElementVNode)("div",la,[(0,a.createElementVNode)("label",ia,[n[33]||(n[33]=(0,a.createElementVNode)("span",{class:"option-label"},"经度范围",-1)),(0,a.createElementVNode)("div",ca,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",step:"0.1","onUpdate:modelValue":n[8]||(n[8]=e=>p.value.mapConfig.minLng=e),placeholder:"最小经度"},null,512),[[a.vModelText,p.value.mapConfig.minLng,void 0,{number:!0}]]),n[32]||(n[32]=(0,a.createElementVNode)("span",null,"-",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",step:"0.1","onUpdate:modelValue":n[9]||(n[9]=e=>p.value.mapConfig.maxLng=e),placeholder:"最大经度"},null,512),[[a.vModelText,p.value.mapConfig.maxLng,void 0,{number:!0}]])])]),(0,a.createElementVNode)("label",sa,[n[35]||(n[35]=(0,a.createElementVNode)("span",{class:"option-label"},"纬度范围",-1)),(0,a.createElementVNode)("div",da,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",step:"0.1","onUpdate:modelValue":n[10]||(n[10]=e=>p.value.mapConfig.minLat=e),placeholder:"最小纬度"},null,512),[[a.vModelText,p.value.mapConfig.minLat,void 0,{number:!0}]]),n[34]||(n[34]=(0,a.createElementVNode)("span",null,"-",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number",step:"0.1","onUpdate:modelValue":n[11]||(n[11]=e=>p.value.mapConfig.maxLat=e),placeholder:"最大纬度"},null,512),[[a.vModelText,p.value.mapConfig.maxLat,void 0,{number:!0}]])])])]),(0,a.createElementVNode)("div",{class:"map-options-actions"},[(0,a.createElementVNode)("button",{class:"opt-btn",onClick:x},"随机"),(0,a.createElementVNode)("button",{class:"opt-btn",onClick:k},"重置")])],512),[[a.vShow,i.value]]),(0,a.withDirectives)((0,a.createElementVNode)("div",ma,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(r.value.description||"此界一片混沌，尚无描述。"),1)],512),[[a.vShow,!i.value]])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",pa," 请择一方大千世界，以定道基。 "))])])),(0,a.createVNode)(ht,{visible:l.value,title:"自定义世界",fields:u,validationFn:g,onClose:n[12]||(n[12]=e=>l.value=!1),onSubmit:f},null,8,["visible"]),(0,a.createCommentVNode)(" 编辑模态框 "),(0,a.createVNode)(ht,{visible:c.value,title:"编辑世界",fields:u,validationFn:g,initialData:E.value,onClose:n[13]||(n[13]=e=>{c.value=!1,m.value=null}),onSubmit:N},null,8,["visible","initialData"]),(0,a.createCommentVNode)(" AI推演输入弹窗 "),(0,a.createVNode)(zt,{visible:s.value,onClose:n[14]||(n[14]=e=>s.value=!1),onSubmit:h},null,8,["visible"])]))}});var ua=t(6560),ga={};ga.styleTagTransform=A(),ga.setAttributes=z(),ga.insert=V().bind(null,"head"),ga.domAPI=N(),ga.insertStyleElement=B(),k()(ua.A,ga),ua.A&&ua.A.locals&&ua.A.locals;const fa=(0,j.A)(va,[["__scopeId","data-v-c7bc47b8"]]),ba={class:"talent-tier-selection"},ha={key:0,class:"loading-state"},ya={key:1,class:"error-state"},xa={key:2,class:"tier-layout"},ka={class:"tier-left-panel"},wa={class:"top-actions-container"},Na={class:"tiers-list-container"},Ea=["onClick","onMouseover"],Va={class:"item-content"},Ca={class:"tier-name"},za={class:"tier-points"},Sa={key:0,class:"action-buttons"},Ba=["onClick"],Da=["onClick"],Aa={class:"tier-details-container"},_a={key:0,class:"tier-details"},$a={class:"description-scroll"},Ia={class:"points-display"},Ta={key:1,class:"placeholder"},ja=(0,a.defineComponent)({__name:"Step2_TalentTierSelection",emits:["ai-generate"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(null),l=(0,a.ref)(!1),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(null),m=(0,a.computed)(()=>{const e=o.creationData.talentTiers;if(console.log("【天资选择】所有天资数据:",e),console.log("【天资选择】当前模式:",o.isLocalCreation?"本地":"联机"),console.log("【天资选择】数据明细:",e.map(e=>({name:e.name,source:e.source,id:e.id}))),o.isLocalCreation){const n=e.filter(e=>"local"===e.source||"cloud"===e.source);return console.log("【天资选择】单机模式可用天资列表:",n),n}{const n=e.length>0?e:[];return console.log("【天资选择】联机模式天资列表:",n),console.log("【天资选择】联机模式天资数量:",n.length),0===n.length&&console.warn("【天资选择】警告：联机模式下没有找到任何天资数据！"),n}}),p=[{key:"name",label:"天资名称",type:"text",placeholder:"例如：凡人"},{key:"description",label:"天资描述",type:"textarea",placeholder:"描述此天资的特点..."},{key:"total_points",label:"天道点",type:"text",placeholder:"例如：10"},{key:"color",label:"辉光颜色",type:"color",placeholder:"例如：#808080"}];function v(e){const n={};e.name?.trim()||(n.name="天资名称不可为空");const t=Number(e.total_points);return(isNaN(t)||t<0)&&(n.total_points="天道点必须是非负数"),{valid:0===Object.keys(n).length,errors:Object.values(n)}}async function u(e){const n={id:Date.now(),name:e.name,description:e.description,total_points:parseInt(e.total_points,10)||10,color:e.color||"#808080",rarity:1};try{o.addTalentTier(n),b(n),l.value=!1,d.o.success(`自定义天资 "${n.name}" 已保存！`)}catch(e){console.error("保存自定义天资失败:",e),d.o.error("保存自定义天资失败！")}}function g(){o.isLocalCreation?c.value=!0:t("ai-generate")}async function f(e){const n="ai-generate-talent-tier";d.o.loading("天机推演中，请稍候...",{id:n});try{const t=await(0,St.eb)(e,Bt.__,!1);if(!t)return void d.o.error("AI推演失败",{id:n});let a;console.log("【AI推演-天资】完整响应:",t);try{const e=t.match(/```json\s*([\s\S]*?)\s*```/)||t.match(/\{[\s\S]*\}/),n=e?e[1]||e[0]:t;a=JSON.parse(n.trim())}catch(e){return console.error("【AI推演-天资】JSON解析失败:",e),void d.o.error("AI推演结果格式错误，无法解析",{id:n})}if(!a.name&&!a.名称)return void d.o.error("AI推演结果缺少天资名称",{id:n});const r={id:Date.now(),name:a.name||a.名称||"未命名天资",description:a.description||a.描述||a.说明||"",total_points:a.total_points||a.总点数||a.点数||10,color:a.color||a.颜色||"#808080",rarity:a.rarity||a.稀有度||1,source:"local"};o.addTalentTier(r),b(r),c.value=!1,d.o.success(`AI推演完成！天资 "${r.name}" 已生成`,{id:n})}catch(e){console.error("【AI推演-天资】失败:",e),d.o.error(`AI推演失败: ${e.message}`,{id:n})}}function b(e){o.selectTalentTier(e.id)}function h(e){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?`${parseInt(n[1],16)}, ${parseInt(n[2],16)}, ${parseInt(n[3],16)}`:"229, 192, 123"}async function y(e){if(!s.value)return;const n={name:e.name,description:e.description,total_points:parseInt(e.total_points,10)||10,color:e.color||"#808080"};try{o.updateTalentTier(s.value.id,n)?(i.value=!1,s.value=null,d.o.success(`天资 "${n.name}" 已更新！`)):d.o.error("更新天资失败！")}catch(e){console.error("更新天资失败:",e),d.o.error("更新天资失败！")}}const x=(0,a.computed)(()=>s.value?{name:s.value.name,description:s.value.description,total_points:s.value.total_points.toString(),color:s.value.color}:{});return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",ba,[(0,a.unref)(o).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",ha,"感应天道，测算天资...")):(0,a.unref)(o).error?((0,a.openBlock)(),(0,a.createElementBlock)("div",ya,"天机混沌："+(0,a.toDisplayString)((0,a.unref)(o).error),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",xa,[(0,a.createCommentVNode)(" 左侧面板：列表和操作按钮 "),(0,a.createElementVNode)("div",ka,[(0,a.createCommentVNode)(" 顶部功能按钮 "),(0,a.createElementVNode)("div",wa,[(0,a.unref)(o).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:n[0]||(n[0]=e=>l.value=!0),class:"action-item shimmer-on-hover"},n[4]||(n[4]=[(0,a.createElementVNode)("span",{class:"action-name"},"自定义天资",-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:g,class:"action-item shimmer-on-hover"},n[5]||(n[5]=[(0,a.createElementVNode)("span",{class:"action-name"},"AI推演",-1)]))]),(0,a.createElementVNode)("div",Na,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["tier-item",{selected:(0,a.unref)(o).characterPayload.talent_tier_id===e.id}]),style:(0,a.normalizeStyle)({"--tier-glow-color":e.color,"--tier-glow-color-rgb":h(e.color)}),onClick:n=>b(e),onMouseover:n=>r.value=e},[(0,a.createElementVNode)("div",Va,[(0,a.createElementVNode)("span",Ca,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",za,(0,a.toDisplayString)(e.total_points)+" 点",1)]),"cloud"===e.source?((0,a.openBlock)(),(0,a.createElementBlock)("div",Sa,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>function(e){s.value=e,i.value=!0}(e),["stop"]),class:"edit-btn",title:"编辑此项"},[(0,a.createVNode)((0,a.unref)(Un),{size:14})],8,Ba),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>async function(e){console.log(`🔥 点击删除按钮，准备删除天资 ID: ${e}`);try{await o.removeTalentTier(e),console.log(`【天资选择】成功删除天资 ID: ${e}`)}catch(n){console.error(`【天资选择】删除天资失败 ID: ${e}`,n)}}(e.id),["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,Da)])):(0,a.createCommentVNode)("v-if",!0)],46,Ea))),128))])]),(0,a.createCommentVNode)(" 右侧详情 "),(0,a.createElementVNode)("div",Aa,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",_a,[(0,a.createElementVNode)("h2",{style:(0,a.normalizeStyle)({color:r.value.color})},(0,a.toDisplayString)(r.value.name),5),(0,a.createElementVNode)("div",$a,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(r.value.description),1)]),(0,a.createElementVNode)("div",Ia,"天道点: "+(0,a.toDisplayString)(r.value.total_points),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ta,"请选择你的天资等级，这将决定你的起点。"))])])),(0,a.createVNode)(ht,{visible:l.value,title:"自定义天资",fields:p,validationFn:v,onClose:n[1]||(n[1]=e=>l.value=!1),onSubmit:u},null,8,["visible"]),(0,a.createCommentVNode)(" 编辑模态框 "),(0,a.createVNode)(ht,{visible:i.value,title:"编辑天资",fields:p,validationFn:v,initialData:x.value,onClose:n[2]||(n[2]=e=>{i.value=!1,s.value=null}),onSubmit:y},null,8,["visible","initialData"]),(0,a.createCommentVNode)(" AI推演输入弹窗 "),(0,a.createVNode)(zt,{visible:c.value,onClose:n[3]||(n[3]=e=>c.value=!1),onSubmit:f},null,8,["visible"])]))}});var Ma=t(2067),qa={};qa.styleTagTransform=A(),qa.setAttributes=z(),qa.insert=V().bind(null,"head"),qa.domAPI=N(),qa.insertStyleElement=B(),k()(Ma.A,qa),Ma.A&&Ma.A.locals&&Ma.A.locals;const Oa=(0,j.A)(ja,[["__scopeId","data-v-d9928082"]]),Pa={class:"origin-selection-container"},Fa={key:0,class:"loading-state"},La={key:1,class:"error-state"},Ya={key:2,class:"origin-layout"},Ra={class:"origin-left-panel"},Ua={class:"top-actions-container"},Ga={class:"origin-list-container"},Wa=["onClick","onMouseover"],Ja={class:"item-content"},Ha={class:"origin-name"},Qa={class:"origin-cost"},Ka={key:0,class:"action-buttons"},Xa=["onClick"],Za=["onClick"],eo={class:"origin-details-container"},no={key:0,class:"origin-details"},to={class:"description-scroll"},ao={class:"cost-display"},oo={key:1,class:"placeholder"},ro=(0,a.defineComponent)({__name:"Step3_OriginSelection",emits:["ai-generate"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(null),l=(0,a.ref)(!1),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(null),m=(0,a.computed)(()=>{const e=o.creationData.origins;if(console.log("【出身选择】所有出身数据:",e),console.log("【出身选择】当前模式:",o.isLocalCreation?"本地":"联机"),o.isLocalCreation){const n=e.filter(e=>"local"===e.source||"cloud"===e.source);return console.log("【出身选择】单机模式可用出身列表:",n),n}{const n=e.filter(e=>"cloud"===e.source);return console.log("【出身选择】联机模式出身列表:",n),console.log("【出身选择】云端出身数量:",n.length),0===n.length&&(console.warn("【出身选择】警告：联机模式下没有找到云端出身数据！"),console.log("【出身选择】所有出身的source分布:",e.reduce((e,n)=>(e[n.source]=(e[n.source]||0)+1,e),{}))),n}}),p=[{key:"name",label:"出身名称",type:"text",placeholder:"例如：山野遗孤"},{key:"description",label:"出身描述",type:"textarea",placeholder:"描述此出身的背景故事和成长经历..."},{key:"talent_cost",label:"消耗天道点",type:"text",placeholder:"例如：0（可为负数）"},{key:"rarity",label:"稀有度等级",type:"select",options:[{value:"1",label:"1 - 常见"},{value:"2",label:"2 - 少见"},{value:"3",label:"3 - 罕见"},{value:"4",label:"4 - 极罕见"},{value:"5",label:"5 - 传说"}]},{key:"background_effects",label:"出身效果",type:"dynamic-list",columns:[{key:"type",placeholder:"效果类型",type:"select",options:[{value:"初始资源",label:"初始资源"},{value:"社会关系",label:"社会关系"},{value:"特殊身份",label:"特殊身份"},{value:"传承知识",label:"传承知识"},{value:"起始装备",label:"起始装备"}]},{key:"description",placeholder:"具体描述，如：拥有一把传家宝剑"}]}];function v(e){const n={};e.name?.trim()||(n.name="出身名称不可为空"),e.description?.trim()||(n.description="出身描述不可为空");const t=Number(e.talent_cost);return isNaN(t)&&(n.talent_cost="消耗点数必须为数字"),e.rarity&&(isNaN(parseInt(e.rarity,10))||parseInt(e.rarity,10)<1||parseInt(e.rarity,10)>5)&&(n.rarity="稀有度等级必须为1-5的数字"),{valid:0===Object.keys(n).length,errors:Object.values(n)}}async function u(e){const n=e.background_effects?.length?e.background_effects.filter(e=>e.type&&e.description?.trim()).map(e=>({type:e.type,description:e.description.trim()})):[],t={id:Date.now(),name:e.name,description:e.description,talent_cost:parseInt(e.talent_cost,10)||0,attribute_modifiers:{},background_effects:n,rarity:parseInt(e.rarity,10)||1,source:"local"};try{o.addOrigin(t),x(t),l.value=!1,d.o.success(`自定义出身 "${t.name}" 已保存！`)}catch(e){console.error("保存自定义出身失败:",e),d.o.error("保存自定义出身失败！")}}function g(){if(o.isLocalCreation){if(!o.selectedWorld)return void d.o.error("请先选择一方大千世界，方可推演出身。");c.value=!0}else t("ai-generate")}async function f(e){const n="ai-generate-origin";d.o.loading("天机推演中，请稍候...",{id:n});try{const t=await(0,St.eb)(e,Bt.XN,!1);if(!t)return void d.o.error("AI推演失败",{id:n});let a;console.log("【AI推演-出身】完整响应:",t);try{const e=t.match(/```json\s*([\s\S]*?)\s*```/)||t.match(/\{[\s\S]*\}/),n=e?e[1]||e[0]:t;a=JSON.parse(n.trim())}catch(e){return console.error("【AI推演-出身】JSON解析失败:",e),void d.o.error("AI推演结果格式错误，无法解析",{id:n})}if(!a.name&&!a.名称)return void d.o.error("AI推演结果缺少出身名称",{id:n});let r=a.talent_cost||a.天道点消耗||a.消耗天道点;null==r?(console.warn("【AI推演-出身】AI未返回天道点消耗字段，使用默认值3"),d.o.warning("AI未设置天道点消耗，已自动设为3点",{id:n,duration:2e3}),r=3):(r=Number(r),isNaN(r)&&(console.warn("【AI推演-出身】天道点消耗不是有效数字，使用默认值3"),r=3));const l={id:Date.now(),name:a.name||a.名称||"未命名出身",description:a.description||a.描述||a.说明||"",talent_cost:r,attribute_modifiers:a.attribute_modifiers||a.属性修正||{},background_effects:a.background_effects||a.背景效果||[],rarity:a.rarity||a.稀有度||1,source:"local"};o.addOrigin(l),x(l),c.value=!1,d.o.success(`AI推演完成！出身 "${l.name}" 已生成`,{id:n})}catch(e){console.error("【AI推演-出身】失败:",e),d.o.error(`AI推演失败: ${e.message}`,{id:n})}}const b=e=>{if(o.characterPayload.origin_id===e.id)return!0;const n=o.selectedOrigin?.talent_cost??0;return o.remainingTalentPoints+n>=e.talent_cost};async function h(e){if(!s.value)return;const n=e.background_effects?.length?e.background_effects.filter(e=>e.type&&e.description?.trim()).map(e=>({type:e.type,description:e.description.trim()})):[],t={name:e.name,description:e.description,talent_cost:parseInt(e.talent_cost,10)||0,rarity:parseInt(e.rarity,10)||1,background_effects:n};try{o.updateOrigin(s.value.id,t)?(i.value=!1,s.value=null,d.o.success(`出身 "${t.name}" 已更新！`)):d.o.error("更新出身失败！")}catch(e){console.error("更新出身失败:",e),d.o.error("更新出身失败！")}}const y=(0,a.computed)(()=>s.value?{name:s.value.name,description:s.value.description,talent_cost:s.value.talent_cost.toString(),rarity:s.value.rarity.toString(),background_effects:s.value.background_effects||[]}:{});function x(e){if(!b(e))return void d.o.warning("天道点不足，无法选择此出身。");const n=o.characterPayload.origin_id===e.id?null:e.id;o.selectOrigin(n)}function k(){o.selectOrigin(null)}const w=(0,a.computed)(()=>null===o.characterPayload.origin_id),N=((0,a.computed)(()=>w.value?"随机出身":o.selectedOrigin?.name||""),(0,a.computed)(()=>w.value?"天道无常，造化弄人。选择此项，你的出身将完全随机生成。是生于帝王之家，或为山野遗孤，皆在天道一念之间。":o.selectedOrigin?.description||"身世如谜，过往一片空白。"),(0,a.computed)(()=>w.value?0:o.selectedOrigin?.talent_cost||0),(0,a.computed)(()=>"random"===r.value?"随机出身":r.value&&"object"==typeof r.value?r.value.name:"")),E=(0,a.computed)(()=>"random"===r.value?"天道无常，造化弄人。选择此项，你的出身将完全随机生成。是生于帝王之家，或为山野遗孤，皆在天道一念之间。":r.value&&"object"==typeof r.value&&r.value.description||"身世如谜，过往一片空白。"),V=(0,a.computed)(()=>"random"===r.value?0:r.value&&"object"==typeof r.value&&r.value.talent_cost||0);return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Pa,[(0,a.unref)(o).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",Fa,"追溯过往，探寻出身...")):(0,a.unref)(o).error?((0,a.openBlock)(),(0,a.createElementBlock)("div",La,"因果不明："+(0,a.toDisplayString)((0,a.unref)(o).error),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ya,[(0,a.createCommentVNode)(" 左侧栏：列表和操作按钮 "),(0,a.createElementVNode)("div",Ra,[(0,a.createCommentVNode)(" 顶部功能按钮 "),(0,a.createElementVNode)("div",Ua,[(0,a.unref)(o).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:n[0]||(n[0]=e=>l.value=!0),class:"action-item shimmer-on-hover"},n[5]||(n[5]=[(0,a.createElementVNode)("span",{class:"action-name"},"自定义出身",-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:g,class:"action-item shimmer-on-hover"},n[6]||(n[6]=[(0,a.createElementVNode)("span",{class:"action-name"},"AI推演",-1)]))]),(0,a.createElementVNode)("div",Ga,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["origin-item",{selected:w.value}]),onClick:k,onMouseover:n[1]||(n[1]=e=>r.value="random")},n[7]||(n[7]=[(0,a.createElementVNode)("span",{class:"origin-name"},"随机出身",-1),(0,a.createElementVNode)("span",{class:"origin-cost"},"0 点",-1)]),34),n[8]||(n[8]=(0,a.createElementVNode)("div",{class:"divider"},null,-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["origin-item",{selected:(0,a.unref)(o).characterPayload.origin_id===e.id,disabled:!b(e)}]),onClick:n=>x(e),onMouseover:n=>r.value=e},[(0,a.createElementVNode)("div",Ja,[(0,a.createElementVNode)("span",Ha,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",Qa,(0,a.toDisplayString)(e.talent_cost)+" 点",1)]),"cloud"===e.source?((0,a.openBlock)(),(0,a.createElementBlock)("div",Ka,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>function(e){s.value=e,i.value=!0}(e),["stop"]),class:"edit-btn",title:"编辑此项"},[(0,a.createVNode)((0,a.unref)(Un),{size:14})],8,Xa),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>async function(e){try{await o.removeOrigin(e),console.log(`【出身选择】成功删除出身 ID: ${e}`)}catch(n){console.error(`【出身选择】删除出身失败 ID: ${e}`,n)}}(e.id),["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,Za)])):(0,a.createCommentVNode)("v-if",!0)],42,Wa))),128))])]),(0,a.createCommentVNode)(" 右侧详情 "),(0,a.createElementVNode)("div",eo,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",no,[(0,a.createElementVNode)("h2",null,(0,a.toDisplayString)(N.value),1),(0,a.createElementVNode)("div",to,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(E.value),1)]),(0,a.createElementVNode)("div",ao,"消耗天道点: "+(0,a.toDisplayString)(V.value),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",oo,"请选择一处出身，或听天由命。"))])])),(0,a.createVNode)(ht,{visible:l.value,title:"自定义出身",fields:p,validationFn:v,onClose:n[2]||(n[2]=e=>l.value=!1),onSubmit:u},null,8,["visible"]),(0,a.createCommentVNode)(" 编辑模态框 "),(0,a.createVNode)(ht,{visible:i.value,title:"编辑出身",fields:p,validationFn:v,initialData:y.value,onClose:n[3]||(n[3]=e=>{i.value=!1,s.value=null}),onSubmit:h},null,8,["visible","initialData"]),(0,a.createCommentVNode)(" AI推演输入弹窗 "),(0,a.createVNode)(zt,{visible:c.value,onClose:n[4]||(n[4]=e=>c.value=!1),onSubmit:f},null,8,["visible"])]))}});var lo=t(5272),io={};io.styleTagTransform=A(),io.setAttributes=z(),io.insert=V().bind(null,"head"),io.domAPI=N(),io.insertStyleElement=B(),k()(lo.A,io),lo.A&&lo.A.locals&&lo.A.locals;const co=(0,j.A)(ro,[["__scopeId","data-v-907f35d4"]]),so={class:"spirit-root-selection-container"},mo={key:0,class:"loading-state"},po={key:1,class:"error-state"},vo={key:2,class:"spirit-root-layout"},uo={class:"spirit-root-left-panel"},go={class:"top-actions-container"},fo={class:"selection-mode-tabs"},bo={key:0,class:"preset-mode"},ho={class:"spirit-root-list-container"},yo=["onClick","onMouseover"],xo={class:"item-content"},ko={class:"spirit-root-name-container"},wo={class:"spirit-root-name"},No={class:"spirit-root-cost"},Eo={key:0,class:"action-buttons"},Vo=["onClick"],Co=["onClick"],zo={key:1,class:"custom-mode"},So={class:"custom-selection-container"},Bo={class:"selection-group"},Do={class:"spirit-type-grid"},Ao=["onClick"],_o={class:"type-icon"},$o={class:"type-name"},Io={class:"selection-group"},To={class:"tier-selection"},jo=["onClick"],Mo={class:"tier-name"},qo={class:"tier-multiplier"},Oo={class:"tier-cost"},Po={class:"custom-preview"},Fo={class:"preview-content"},Lo={class:"preview-name"},Yo={class:"preview-stats"},Ro={class:"stat"},Uo={class:"stat"},Go=["disabled"],Wo={class:"spirit-root-details-container"},Jo={key:0,class:"spirit-root-details"},Ho={class:"description-scroll"},Qo={class:"stats-display"},Ko={class:"stat-item"},Xo={class:"stat-value"},Zo={class:"stat-item"},er={class:"stat-value"},nr={key:1,class:"placeholder"},tr=(0,a.defineComponent)({__name:"Step4_SpiritRootSelection",emits:["ai-generate"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(null),l=(0,a.ref)("preset"),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(!1),m=(0,a.ref)(null),p=(0,a.reactive)({type:"none",tier:"none"}),v=[{key:"fire",name:"火",icon:"🔥",color:"#ef4444",desc:"烈火焚天，爆发力强"},{key:"water",name:"水",icon:"💧",color:"#3b82f6",desc:"水流不息，绵延悠长"},{key:"wood",name:"木",icon:"🌿",color:"#10b981",desc:"生机盎然，治愈修复"},{key:"metal",name:"金",icon:"⚔️",color:"#f59e0b",desc:"锋锐无匹，切金断玉"},{key:"earth",name:"土",icon:"🗿",color:"#8b5cf6",desc:"厚德载物，防御超群"},{key:"wind",name:"风",icon:"💨",color:"#06b6d4",desc:"风驰电掣，身法如神"},{key:"thunder",name:"雷",icon:"⚡",color:"#eab308",desc:"雷霆万钧，毁天灭地"},{key:"ice",name:"冰",icon:"❄️",color:"#0ea5e9",desc:"冰霜刺骨，万物凋零"},{key:"light",name:"光",icon:"☀️",color:"#f97316",desc:"光明普照，净化邪恶"},{key:"dark",name:"暗",icon:"🌑",color:"#6b7280",desc:"幽暗深邃，诡异莫测"},{key:"space",name:"空间",icon:"🌀",color:"#7c3aed",desc:"虚空挪移，空间掌控"},{key:"time",name:"时间",icon:"⏰",color:"#ec4899",desc:"时光流转，逆转乾坤"}],u=[{key:"common",name:"凡品",multiplier:1,cost:0,desc:"平平无奇的普通灵根"},{key:"low",name:"下品",multiplier:1.1,cost:3,desc:"略有天赋，勉强可用"},{key:"middle",name:"中品",multiplier:1.3,cost:6,desc:"资质尚可，小有成就"},{key:"high",name:"上品",multiplier:1.6,cost:10,desc:"天赋卓越，前途无量"},{key:"supreme",name:"极品",multiplier:2,cost:15,desc:"万中无一，天之骄子"},{key:"heaven",name:"仙品",multiplier:2.4,cost:20,desc:"天降异象，举世罕见"},{key:"divine",name:"神品",multiplier:2.8,cost:25,desc:"神鬼莫测，逆天改命"},{key:"special",name:"特殊",multiplier:0,cost:0,desc:"特殊体质，另有奥妙"}],g=(0,a.computed)(()=>o.isLocalCreation?o.creationData.spiritRoots.filter(e=>"local"===e.source||"cloud"===e.source):o.creationData.spiritRoots.filter(e=>"cloud"===e.source)),f=[{key:"name",label:"灵根名称",type:"text",placeholder:"例如：混沌灵根"},{key:"tier",label:"品级",type:"select",options:u.map(e=>({value:e.key,label:e.name}))},{key:"description",label:"灵根描述",type:"textarea",placeholder:"描述这个灵根的特性和背景故事..."},{key:"base_multiplier",label:"修炼倍率",type:"text",placeholder:"例如：1.5"},{key:"talent_cost",label:"消耗天道点",type:"text",placeholder:"例如：10"},{key:"rarity",label:"稀有度等级",type:"select",options:[{value:"1",label:"1 - 常见"},{value:"2",label:"2 - 少见"},{value:"3",label:"3 - 罕见"},{value:"4",label:"4 - 极罕见"},{value:"5",label:"5 - 传说"}]},{key:"special_effects",label:"特殊效果",type:"dynamic-list",columns:[{key:"effect",placeholder:"效果描述，如：雷系法术威力+80%"}]}],b=(0,a.computed)(()=>null===o.characterPayload.spirit_root_id),h=(0,a.computed)(()=>"random"===r.value?"随机灵根":r.value&&"object"==typeof r.value?r.value.name:""),y=(0,a.computed)(()=>"random"===r.value?"大道五十，天衍四九，人遁其一。选择此项，你的灵根将完全随机生成，可能一步登天，亦可能平庸无奇。":r.value&&"object"==typeof r.value&&r.value.description||"灵根信息不明。"),x=(0,a.computed)(()=>"random"===r.value?0:r.value&&"object"==typeof r.value&&r.value.talent_cost||0),k=e=>{if(o.characterPayload.spirit_root_id===e.id)return!0;const n=o.selectedSpiritRoot?.talent_cost??0;return o.remainingTalentPoints+n>=e.talent_cost};function w(e){if(!k(e))return void d.o.warning("天道点不足，无法选择此灵根。");const n=o.characterPayload.spirit_root_id===e.id?null:e.id;o.selectSpiritRoot(n)}function N(){o.selectSpiritRoot(null)}function E(){o.isLocalCreation?s.value=!0:t("ai-generate")}async function V(e){const n="ai-generate-spirit-root";d.o.loading("天机推演中，请稍候...",{id:n});try{const t=await(0,St.eb)(e,Bt.x$,!1);if(!t)return void d.o.error("AI推演失败",{id:n});let a;console.log("【AI推演-灵根】完整响应:",t);try{const e=t.match(/```json\s*([\s\S]*?)\s*```/)||t.match(/\{[\s\S]*\}/),n=e?e[1]||e[0]:t;a=JSON.parse(n.trim())}catch(e){return console.error("【AI推演-灵根】JSON解析失败:",e),void d.o.error("AI推演结果格式错误，无法解析",{id:n})}if(!a.name&&!a.名称)return void d.o.error("AI推演结果缺少灵根名称",{id:n});const r={id:Date.now(),name:a.name||a.名称||"未命名灵根",tier:a.tier||a.品级||a.等级||"",description:a.description||a.描述||a.说明||"",base_multiplier:a.base_multiplier||a.修炼倍率||1,talent_cost:a.talent_cost||a.天道点消耗||a.点数消耗||5,rarity:a.rarity||a.稀有度||3,source:"local"};o.addSpiritRoot(r),w(r),s.value=!1,d.o.success(`AI推演完成！灵根 "${r.name}" 已生成`,{id:n})}catch(e){console.error("【AI推演-灵根】失败:",e),d.o.error(`AI推演失败: ${e.message}`,{id:n})}}function C(e){return e.tier||""}function z(){if("none"===p.type)return"请选择灵根类型";const e=v.find(e=>e.key===p.type);return e?`${e.name}灵根`:"未知灵根"}function S(){if("none"===p.tier)return 1;const e=u.find(e=>e.key===p.tier);return e?e.multiplier:1}function B(){if("none"===p.tier)return 0;const e=u.find(e=>e.key===p.tier);return e?e.cost:0}function D(e){const n=u.find(n=>n.key===e);return n?n.name:""}function A(){return"none"!==p.type&&"none"!==p.tier}function _(){if(!A())return void d.o.warning("请完整选择灵根类型和品级");const e=v.find(e=>e.key===p.type),n=u.find(e=>e.key===p.tier);if(!e||!n)return void d.o.error("选择的灵根配置无效");const t={id:Date.now(),name:`${e.name}灵根`,description:`${n.desc}的${e.desc}`,base_multiplier:n.multiplier,talent_cost:n.cost,tier:n.name,source:"cloud"};o.addSpiritRoot(t),w(t),d.o.success(`自定义灵根 "${t.name}" 已创建！`),p.type="none",p.tier="none"}function $(){if("custom"===l.value&&"none"!==p.type){const e=v.find(e=>e.key===p.type),n=u.find(e=>e.key===p.tier);return e&&n&&"none"!==p.tier?`${n.desc}的${e.desc}`:e?e.desc:"请选择灵根品级"}return y.value}function I(e){return function(e){const n={};return e.name?.trim()||(n.name="灵根名称不可为空"),e.tier||(n.tier="请选择品级"),e.description?.trim()||(n.description="灵根描述不可为空"),(void 0===e.base_multiplier||isNaN(parseFloat(e.base_multiplier)))&&(n.base_multiplier="修炼倍率必须为数字"),(void 0===e.talent_cost||isNaN(parseInt(e.talent_cost,10)))&&(n.talent_cost="消耗点数必须为数字"),e.rarity&&(isNaN(parseInt(e.rarity,10))||parseInt(e.rarity,10)<1||parseInt(e.rarity,10)>5)&&(n.rarity="稀有度等级必须为1-5的数字"),{valid:0===Object.keys(n).length,errors:Object.values(n)}}(e)}function T(e){!async function(e){const n=e.special_effects?.length?e.special_effects.filter(e=>e.effect?.trim()).map(e=>e.effect.trim()):[],t={id:Date.now(),name:e.name,tier:u.find(n=>n.key===e.tier)?.name||e.tier,description:e.description,cultivation_speed:`${e.base_multiplier}x`,special_effects:n,base_multiplier:parseFloat(e.base_multiplier)||1,talent_cost:parseInt(e.talent_cost,10)||0,rarity:parseInt(e.rarity,10)||1,source:"cloud"};try{o.addSpiritRoot(t),w(t),i.value=!1,d.o.success(`自定义灵根 "${t.name}" 已保存！`)}catch(e){console.error("保存自定义灵根失败:",e),d.o.error("保存自定义灵根失败！")}}(e)}async function j(e){if(!m.value)return;const n=e.special_effects?.length?e.special_effects.filter(e=>e.effect?.trim()).map(e=>e.effect.trim()):[],t={name:e.name,tier:u.find(n=>n.key===e.tier)?.name||e.tier,description:e.description,cultivation_speed:`${e.base_multiplier}x`,special_effects:n,base_multiplier:parseFloat(e.base_multiplier)||1,talent_cost:parseInt(e.talent_cost,10)||0,rarity:parseInt(e.rarity,10)||1};try{o.updateSpiritRoot(m.value.id,t)?(c.value=!1,m.value=null,d.o.success(`灵根 "${t.name}" 已更新！`)):d.o.error("更新灵根失败！")}catch(e){console.error("更新灵根失败:",e),d.o.error("更新灵根失败！")}}const M=(0,a.computed)(()=>m.value?{name:m.value.name,tier:u.find(e=>e.name===m.value.tier)?.key||"common",description:m.value.description,base_multiplier:m.value.base_multiplier?.toString()||"1.0",talent_cost:m.value.talent_cost.toString(),rarity:m.value.rarity?.toString()||"1",special_effects:m.value.special_effects?.map(e=>({effect:e}))||[]}:{});return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",so,[(0,a.unref)(o).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",mo,"天地玄黄，探查灵根...")):(0,a.unref)(o).error?((0,a.openBlock)(),(0,a.createElementBlock)("div",po,"天机混沌："+(0,a.toDisplayString)((0,a.unref)(o).error),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",vo,[(0,a.createCommentVNode)(" 左侧面板：选择和操作 "),(0,a.createElementVNode)("div",uo,[(0,a.createCommentVNode)(" 顶部功能按钮 "),(0,a.createElementVNode)("div",go,[(0,a.unref)(o).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:n[0]||(n[0]=e=>i.value=!0),class:"action-item shimmer-on-hover"},n[7]||(n[7]=[(0,a.createElementVNode)("span",{class:"action-name"},"高级自定义",-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:E,class:"action-item shimmer-on-hover"},n[8]||(n[8]=[(0,a.createElementVNode)("span",{class:"action-name"},"AI推演",-1)]))]),(0,a.createCommentVNode)(" 选择模式切换 "),(0,a.createElementVNode)("div",fo,[(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)([{active:"preset"===l.value},"mode-tab"]),onClick:n[1]||(n[1]=e=>l.value="preset")}," 预设灵根 ",2),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)([{active:"custom"===l.value},"mode-tab"]),onClick:n[2]||(n[2]=e=>l.value="custom")}," 组合选择 ",2)]),(0,a.createCommentVNode)(" 预设灵根模式 "),"preset"===l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",bo,[(0,a.createElementVNode)("div",ho,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["spirit-root-item",{selected:b.value}]),onClick:N,onMouseover:n[3]||(n[3]=e=>r.value="random")},n[9]||(n[9]=[(0,a.createElementVNode)("span",{class:"spirit-root-name"},"随机灵根",-1),(0,a.createElementVNode)("span",{class:"spirit-root-cost"},"0 点",-1)]),34),n[10]||(n[10]=(0,a.createElementVNode)("div",{class:"divider"},null,-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(g.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["spirit-root-item",{selected:(0,a.unref)(o).characterPayload.spirit_root_id===e.id,disabled:!k(e)}]),onClick:n=>w(e),onMouseover:n=>r.value=e},[(0,a.createElementVNode)("div",xo,[(0,a.createElementVNode)("div",ko,[(0,a.createElementVNode)("span",wo,(0,a.toDisplayString)(e.name),1),C(e)?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["spirit-root-tier",`tier-${C(e)}`])},(0,a.toDisplayString)(C(e)),3)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("span",No,(0,a.toDisplayString)(e.talent_cost)+" 点",1)]),"cloud"===e.source?((0,a.openBlock)(),(0,a.createElementBlock)("div",Eo,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>function(e){m.value=e,c.value=!0}(e),["stop"]),class:"edit-btn",title:"编辑此项"},[(0,a.createVNode)((0,a.unref)(Un),{size:14})],8,Vo),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>async function(e){try{await o.removeSpiritRoot(e),console.log(`【灵根选择】成功删除灵根 ID: ${e}`)}catch(n){console.error(`【灵根选择】删除灵根失败 ID: ${e}`,n)}}(e.id),["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,Co)])):(0,a.createCommentVNode)("v-if",!0)],42,yo))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 组合选择模式 "),"custom"===l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",zo,[(0,a.createElementVNode)("div",So,[(0,a.createCommentVNode)(" 灵根类型选择 "),(0,a.createElementVNode)("div",Bo,[n[11]||(n[11]=(0,a.createElementVNode)("label",{class:"selection-label"},"灵根类型",-1)),(0,a.createElementVNode)("div",Do,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(v,e=>(0,a.createElementVNode)("button",{key:e.key,class:(0,a.normalizeClass)([{selected:p.type===e.key},"type-button"]),onClick:n=>p.type=e.key,style:(0,a.normalizeStyle)({"--element-color":e.color})},[(0,a.createElementVNode)("span",_o,(0,a.toDisplayString)(e.icon),1),(0,a.createElementVNode)("span",$o,(0,a.toDisplayString)(e.name),1)],14,Ao)),64))])]),(0,a.createCommentVNode)(" 品级选择 "),(0,a.createElementVNode)("div",Io,[n[12]||(n[12]=(0,a.createElementVNode)("label",{class:"selection-label"},"灵根品级",-1)),(0,a.createElementVNode)("div",To,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(u,e=>(0,a.createElementVNode)("button",{key:e.key,class:(0,a.normalizeClass)(["tier-button",`tier-${e.key}`,{selected:p.tier===e.key}]),onClick:n=>p.tier=e.key},[(0,a.createElementVNode)("span",Mo,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",qo,(0,a.toDisplayString)(e.multiplier)+"x",1),(0,a.createElementVNode)("span",Oo,(0,a.toDisplayString)(e.cost)+"点",1)],10,jo)),64))])]),(0,a.createCommentVNode)(" 预览和确认 "),(0,a.createElementVNode)("div",Po,[n[13]||(n[13]=(0,a.createElementVNode)("div",{class:"preview-title"},"预览",-1)),(0,a.createElementVNode)("div",Fo,[(0,a.createElementVNode)("div",Lo,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(z()),1),"none"!==p.tier?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["preview-tier",`tier-${p.tier}`])},(0,a.toDisplayString)(D(p.tier)),3)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",Yo,[(0,a.createElementVNode)("div",Ro,"修炼倍率: "+(0,a.toDisplayString)(S())+"x",1),(0,a.createElementVNode)("div",Uo,"消耗点数: "+(0,a.toDisplayString)(B())+"点",1)])]),(0,a.createElementVNode)("button",{onClick:_,disabled:!A(),class:"confirm-custom-button"}," 确认选择 ",8,Go)])])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 右侧详情 "),(0,a.createElementVNode)("div",Wo,[r.value||"custom"===l.value&&"none"!==p.type?((0,a.openBlock)(),(0,a.createElementBlock)("div",Jo,[(0,a.createElementVNode)("h2",null,(0,a.toDisplayString)("custom"===l.value&&"none"!==p.type?z():h.value),1),(0,a.createElementVNode)("div",Ho,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)($()),1)]),(0,a.createElementVNode)("div",Qo,[(0,a.createElementVNode)("div",Ko,[n[14]||(n[14]=(0,a.createElementVNode)("span",{class:"stat-label"},"修炼倍率:",-1)),(0,a.createElementVNode)("span",Xo,(0,a.toDisplayString)("custom"===l.value&&"none"!==p.type?S().toString():"random"===r.value?"随机":r.value&&"object"==typeof r.value?(r.value.base_multiplier||1).toString():"1.0")+"x",1)]),(0,a.createElementVNode)("div",Zo,[n[15]||(n[15]=(0,a.createElementVNode)("span",{class:"stat-label"},"消耗天道点:",-1)),(0,a.createElementVNode)("span",er,(0,a.toDisplayString)("custom"===l.value&&"none"!==p.type?B().toString():x.value.toString())+"点",1)])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",nr,"请选择一种灵根，或听天由命。"))])])),(0,a.createCommentVNode)(" 高级自定义模态框 "),(0,a.createVNode)(ht,{visible:i.value,title:"高级自定义灵根",fields:f,validationFn:I,onClose:n[4]||(n[4]=e=>i.value=!1),onSubmit:T},null,8,["visible"]),(0,a.createCommentVNode)(" 编辑模态框 "),(0,a.createVNode)(ht,{visible:c.value,title:"编辑灵根",fields:f,validationFn:I,initialData:M.value,onClose:n[5]||(n[5]=e=>{c.value=!1,m.value=null}),onSubmit:j},null,8,["visible","initialData"]),(0,a.createCommentVNode)(" AI推演输入弹窗 "),(0,a.createVNode)(zt,{visible:s.value,onClose:n[6]||(n[6]=e=>s.value=!1),onSubmit:V},null,8,["visible"])]))}});var ar=t(7456),or={};or.styleTagTransform=A(),or.setAttributes=z(),or.insert=V().bind(null,"head"),or.domAPI=N(),or.insertStyleElement=B(),k()(ar.A,or),ar.A&&ar.A.locals&&ar.A.locals;const rr=(0,j.A)(tr,[["__scopeId","data-v-11916b84"]]),lr={class:"talent-selection-container"},ir={key:0,class:"loading-state"},cr={key:1,class:"error-state"},sr={key:2,class:"talent-layout"},dr={class:"talent-left-panel"},mr={class:"top-actions-container"},pr={class:"talent-list-container"},vr=["onClick","onMouseover"],ur={class:"item-content"},gr={class:"talent-name"},fr={class:"talent-cost"},br={key:0,class:"action-buttons"},hr=["onClick"],yr=["onClick"],xr={class:"talent-details-container"},kr={key:0,class:"talent-details"},wr={class:"description-scroll"},Nr={key:1,class:"placeholder"},Er=(0,a.defineComponent)({__name:"Step5_TalentSelection",emits:["ai-generate"],setup(e,{emit:n}){const t=n,o=(0,nn.N)(),r=(0,a.ref)(null),l=(0,a.ref)(!1),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(null),m=(0,a.computed)(()=>{const e=o.creationData.talents;if(console.log("【天赋选择】所有天赋数据:",e.length,"个"),console.log("【天赋选择】当前模式:",o.isLocalCreation?"本地":"联机"),o.isLocalCreation){const n=e.filter(e=>"local"===e.source||"cloud"===e.source);return console.log("【天赋选择】单机模式可用天赋数量:",n.length),n}{const n=e.length>0?e:[];return console.log("【天赋选择】联机模式天赋数量:",n.length),0===n.length&&console.warn("【天赋选择】警告：联机模式下没有找到任何天赋数据！"),n}}),p=[{key:"name",label:"天赋名称",type:"text",placeholder:"例如：道心天成"},{key:"description",label:"天赋描述",type:"textarea",placeholder:"描述此天赋的本质..."},{key:"talent_cost",label:"天道点消耗",type:"number",placeholder:"例如：3"}];function v(e){const n={};return e.name?.trim()||(n.name="天赋名称不可为空"),e.description?.trim()||(n.description="天赋描述不可为空"),void 0===e.talent_cost||null===e.talent_cost||isNaN(e.talent_cost)?n.talent_cost="天道点消耗必须填写":e.talent_cost<0&&(n.talent_cost="天道点消耗不能为负数"),{valid:0===Object.keys(n).length,errors:Object.values(n)}}async function u(e){const n={id:Date.now(),name:e.name,description:e.description,talent_cost:Number(e.talent_cost)||0,rarity:1,source:"local"};try{o.addTalent(n),l.value=!1,d.o.success(`自定义天赋 "${n.name}" 已保存！`)}catch(e){console.error("保存自定义天赋失败:",e),d.o.error("保存自定义天赋失败！")}}const g=e=>o.characterPayload.selected_talent_ids.includes(e.id);function f(e){r.value=e,o.toggleTalent(e.id)}function b(){o.isLocalCreation?c.value=!0:t("ai-generate")}async function h(e){const n="ai-generate-talent";d.o.loading("天机推演中，请稍候...",{id:n});try{const t=await(0,St.eb)(e,Bt.BA,!1);if(!t)return void d.o.error("AI推演失败",{id:n});let a;console.log("【AI推演-天赋】完整响应:",t);try{const e=t.match(/```json\s*([\s\S]*?)\s*```/)||t.match(/\{[\s\S]*\}/),n=e?e[1]||e[0]:t;a=JSON.parse(n.trim())}catch(e){return console.error("【AI推演-天赋】JSON解析失败:",e),void d.o.error("AI推演结果格式错误，无法解析",{id:n})}if(!a.name&&!a.名称)return void d.o.error("AI推演结果缺少天赋名称",{id:n});const r={id:Date.now(),name:a.name||a.名称||"未命名天赋",description:a.description||a.描述||a.说明||"",talent_cost:a.talent_cost||a.点数消耗||1,rarity:a.rarity||a.稀有度||1,source:"local"};o.addTalent(r),f(r),c.value=!1,d.o.success(`AI推演完成！天赋 "${r.name}" 已生成`,{id:n})}catch(e){console.error("【AI推演-天赋】失败:",e),d.o.error(`AI推演失败: ${e.message}`,{id:n})}}async function y(e){if(!s.value)return;const n={name:e.name,description:e.description,talent_cost:Number(e.talent_cost)||0};try{o.updateTalent(s.value.id,n)?(i.value=!1,s.value=null,d.o.success(`天赋 "${n.name}" 已更新！`)):d.o.error("更新天赋失败！")}catch(e){console.error("更新天赋失败:",e),d.o.error("更新天赋失败！")}}const x=(0,a.computed)(()=>s.value?{name:s.value.name,description:s.value.description,talent_cost:s.value.talent_cost||0}:{});return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",lr,[(0,a.unref)(o).isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",ir,"于时光长河中搜寻天赋...")):(0,a.unref)(o).error?((0,a.openBlock)(),(0,a.createElementBlock)("div",cr,"天机紊乱："+(0,a.toDisplayString)((0,a.unref)(o).error),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",sr,[(0,a.createCommentVNode)(" 左侧面板：列表和操作按钮 "),(0,a.createElementVNode)("div",dr,[(0,a.createCommentVNode)(" 顶部功能按钮 "),(0,a.createElementVNode)("div",mr,[(0,a.unref)(o).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:n[0]||(n[0]=e=>l.value=!0),class:"action-item shimmer-on-hover"},n[4]||(n[4]=[(0,a.createElementVNode)("span",{class:"action-name"},"自定义天赋",-1)]))):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:b,class:"action-item shimmer-on-hover"},n[5]||(n[5]=[(0,a.createElementVNode)("span",{class:"action-name"},"AI推演",-1)]))]),(0,a.createElementVNode)("div",pr,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["talent-item",{selected:g(e)}]),onClick:n=>f(e),onMouseover:n=>r.value=e},[(0,a.createElementVNode)("div",ur,[(0,a.createElementVNode)("span",gr,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",fr,(0,a.toDisplayString)(e.talent_cost||0)+"点",1)]),"cloud"===e.source||"local"===e.source?((0,a.openBlock)(),(0,a.createElementBlock)("div",br,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>function(e){s.value=e,i.value=!0}(e),["stop"]),class:"edit-btn",title:"编辑此项"},[(0,a.createVNode)((0,a.unref)(Un),{size:14})],8,hr),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>async function(e){try{await o.removeTalent(e),console.log(`【天赋选择】成功删除天赋 ID: ${e}`)}catch(n){console.error(`【天赋选择】删除天赋失败 ID: ${e}`,n)}}(e.id),["stop"]),class:"delete-btn",title:"删除此项"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,yr)])):(0,a.createCommentVNode)("v-if",!0)],42,vr))),128))])]),(0,a.createElementVNode)("div",xr,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",kr,[(0,a.createElementVNode)("h2",null,(0,a.toDisplayString)(r.value.name),1),(0,a.createElementVNode)("div",wr,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(r.value.description||"此天赋之玄妙，需自行领悟。"),1)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Nr,"请选择天赋。"))])])),(0,a.createVNode)(ht,{visible:l.value,title:"自定义天赋",fields:p,validationFn:v,onClose:n[1]||(n[1]=e=>l.value=!1),onSubmit:u},null,8,["visible"]),(0,a.createCommentVNode)(" 编辑模态框 "),(0,a.createVNode)(ht,{visible:i.value,title:"编辑天赋",fields:p,validationFn:v,initialData:x.value,onClose:n[2]||(n[2]=e=>{i.value=!1,s.value=null}),onSubmit:y},null,8,["visible","initialData"]),(0,a.createCommentVNode)(" AI推演输入弹窗 "),(0,a.createVNode)(zt,{visible:c.value,onClose:n[3]||(n[3]=e=>c.value=!1),onSubmit:h},null,8,["visible"])]))}});var Vr=t(2753),Cr={};Cr.styleTagTransform=A(),Cr.setAttributes=z(),Cr.insert=V().bind(null,"head"),Cr.domAPI=N(),Cr.insertStyleElement=B(),k()(Vr.A,Cr),Vr.A&&Vr.A.locals&&Vr.A.locals;const zr=(0,j.A)(Er,[["__scopeId","data-v-5a49dc56"]]),Sr={class:"attribute-allocation-container"},Br={class:"header"},Dr={class:"points-display"},Ar={class:"attributes-list"},_r={class:"attribute-info"},$r={class:"attribute-name"},Ir={class:"attribute-desc"},Tr={class:"attribute-controls"},jr=["onClick","disabled"],Mr={class:"attribute-value"},qr=["onClick","disabled"],Or=10,Pr=(0,a.defineComponent)({__name:"Step6_AttributeAllocation",setup(e){const n=(0,nn.N)(),t={root_bone:"根骨",spirituality:"灵性",comprehension:"悟性",fortune:"气运",charm:"魅力",temperament:"心性"},o={root_bone:"决定气血上限、恢复速度、寿命上限。影响炼体修行、抗打击能力。",spirituality:"决定灵气上限、吸收效率。影响修炼速度、法术威力。",comprehension:"决定神识上限、学习效率。影响功法领悟、技能掌握速度。",fortune:"决定各种概率、物品掉落品质。影响天材地宝获取、贵人相助。",charm:"决定初始好感度、社交加成。影响NPC互动、门派声望获取。",temperament:"决定心魔抗性、意志力。影响走火入魔抵抗、关键抉择。"};function r(){Object.keys(n.attributes).forEach(e=>{n.setAttribute(e,0)})}function l(){r();let e=n.remainingTalentPoints;const t=Object.keys(n.attributes);for(;e>0;){const a=t[Math.floor(Math.random()*t.length)],o=n.attributes[a];if(o<Or&&(n.setAttribute(a,o+1),e--),t.every(e=>n.attributes[e]>=Or))break}}function i(){r();const e=Math.max(0,n.remainingTalentPoints);if(e<=0)return;const t=Object.keys(n.attributes).length,a=Math.floor(e/t);let o=e%t;Object.keys(n.attributes).forEach(e=>{let t=a;o>0&&(t++,o--);const r=Math.min(0+t,Or);n.setAttribute(e,r)})}return(0,a.onMounted)(()=>{}),(e,c)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Sr,[(0,a.createElementVNode)("div",Br,[c[1]||(c[1]=(0,a.createElementVNode)("h2",null,"先天六命分配",-1)),(0,a.createElementVNode)("div",Dr,[c[0]||(c[0]=(0,a.createTextVNode)(" 剩余天道点: ",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)({negative:(0,a.unref)(n).remainingTalentPoints<0})},(0,a.toDisplayString)((0,a.unref)(n).remainingTalentPoints),3)])]),(0,a.createElementVNode)("div",Ar,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(n).attributes,(e,r)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:r,class:"attribute-item"},[(0,a.createElementVNode)("div",_r,[(0,a.createElementVNode)("span",$r,(0,a.toDisplayString)(t[r]),1),(0,a.createElementVNode)("p",Ir,(0,a.toDisplayString)(o[r]),1)]),(0,a.createElementVNode)("div",Tr,[(0,a.createElementVNode)("button",{onClick:e=>function(e){n.attributes[e]>0&&n.setAttribute(e,n.attributes[e]-1)}(r),disabled:e<=0},"-",8,jr),(0,a.createElementVNode)("span",Mr,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)("button",{onClick:e=>function(e){n.remainingTalentPoints>0&&n.attributes[e]<Or&&n.setAttribute(e,n.attributes[e]+1)}(r),disabled:(0,a.unref)(n).remainingTalentPoints<=0||e>=Or,class:(0,a.normalizeClass)({disabled:(0,a.unref)(n).remainingTalentPoints<=0||e>=Or})}," + ",10,qr)])]))),128))]),(0,a.createElementVNode)("div",{class:"actions"},[(0,a.createElementVNode)("button",{onClick:r,class:"btn btn-secondary"},"重置"),(0,a.createElementVNode)("button",{onClick:l,class:"btn btn-warning"},"🎲 随机"),(0,a.createElementVNode)("button",{onClick:i,class:"btn btn-success"},"⚖️ 均衡")])]))}});var Fr=t(2881),Lr={};Lr.styleTagTransform=A(),Lr.setAttributes=z(),Lr.insert=V().bind(null,"head"),Lr.domAPI=N(),Lr.insertStyleElement=B(),k()(Fr.A,Lr),Fr.A&&Fr.A.locals&&Fr.A.locals;const Yr=(0,j.A)(Pr,[["__scopeId","data-v-0d0d1bb1"]]),Rr={class:"preview-container"},Ur={class:"preview-grid"},Gr={class:"preview-item name-item"},Wr={class:"preview-item race-item input-field"},Jr={class:"preview-item gender-item"},Hr={class:"gender-control"},Qr={class:"gender-label"},Kr={class:"gender-label"},Xr={class:"gender-label"},Zr={class:"preview-item age-item"},el={class:"age-control"},nl=["disabled"],tl={class:"age-display"},al=["disabled"],ol={class:"preview-item"},rl={class:"item-description"},ll={class:"preview-item"},il={class:"item-description"},cl={class:"preview-item"},sl={class:"item-description"},dl={class:"preview-item"},ml={class:"item-description"},pl={class:"preview-item talents-item"},vl={key:0},ul={class:"item-description"},gl={key:1},fl={key:0,class:"preview-item attributes-item"},bl=(0,a.defineComponent)({__name:"Step7_Preview",props:{isLocalCreation:{type:Boolean}},setup(e){const n=(0,nn.N)(),t=e,o=()=>{n.characterPayload.current_age<18&&n.characterPayload.current_age++},r=()=>{n.characterPayload.current_age>0&&n.characterPayload.current_age--};return(e,l)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Rr,[l[25]||(l[25]=(0,a.createElementVNode)("h2",{class:"title"},"最终预览",-1)),l[26]||(l[26]=(0,a.createElementVNode)("p",{class:"subtitle"},"请确认你的选择，此为踏入仙途的最后一步。",-1)),(0,a.createElementVNode)("div",Ur,[(0,a.createCommentVNode)(" Character Name "),(0,a.createElementVNode)("div",Gr,[l[11]||(l[11]=(0,a.createElementVNode)("label",{for:"characterName"},"道号:",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text",id:"characterName",class:"named","onUpdate:modelValue":l[0]||(l[0]=e=>(0,a.unref)(n).characterPayload.character_name=e),placeholder:"{{user}}",onMousedown:l[1]||(l[1]=(0,a.withModifiers)(()=>{},["stop"])),onClick:l[2]||(l[2]=(0,a.withModifiers)(()=>{},["stop"])),onSelect:l[3]||(l[3]=(0,a.withModifiers)(()=>{},["stop"]))},null,544),[[a.vModelText,(0,a.unref)(n).characterPayload.character_name]])]),(0,a.createCommentVNode)(" Character Race "),(0,a.createElementVNode)("div",Wr,[l[12]||(l[12]=(0,a.createElementVNode)("label",{for:"characterRace"},"种族:",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text",id:"characterRace",class:"named","onUpdate:modelValue":l[4]||(l[4]=e=>(0,a.unref)(n).characterPayload.race=e),placeholder:"人族",onMousedown:l[5]||(l[5]=(0,a.withModifiers)(()=>{},["stop"])),onClick:l[6]||(l[6]=(0,a.withModifiers)(()=>{},["stop"])),onSelect:l[7]||(l[7]=(0,a.withModifiers)(()=>{},["stop"]))},null,544),[[a.vModelText,(0,a.unref)(n).characterPayload.race]])]),(0,a.createCommentVNode)(" Gender Selection "),(0,a.createElementVNode)("div",Jr,[l[16]||(l[16]=(0,a.createElementVNode)("h3",null,"性别",-1)),(0,a.createElementVNode)("div",Hr,[(0,a.createElementVNode)("label",Qr,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"radio",name:"gender",value:"男","onUpdate:modelValue":l[8]||(l[8]=e=>(0,a.unref)(n).characterPayload.gender=e)},null,512),[[a.vModelRadio,(0,a.unref)(n).characterPayload.gender]]),l[13]||(l[13]=(0,a.createElementVNode)("span",null,"男",-1))]),(0,a.createElementVNode)("label",Kr,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"radio",name:"gender",value:"女","onUpdate:modelValue":l[9]||(l[9]=e=>(0,a.unref)(n).characterPayload.gender=e)},null,512),[[a.vModelRadio,(0,a.unref)(n).characterPayload.gender]]),l[14]||(l[14]=(0,a.createElementVNode)("span",null,"女",-1))]),(0,a.createElementVNode)("label",Xr,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"radio",name:"gender",value:"双性","onUpdate:modelValue":l[10]||(l[10]=e=>(0,a.unref)(n).characterPayload.gender=e)},null,512),[[a.vModelRadio,(0,a.unref)(n).characterPayload.gender]]),l[15]||(l[15]=(0,a.createElementVNode)("span",null,"双性",-1))])])]),(0,a.createCommentVNode)(" Birth Age "),(0,a.createElementVNode)("div",Zr,[l[17]||(l[17]=(0,a.createElementVNode)("h3",null,"初始年龄",-1)),(0,a.createElementVNode)("div",el,[(0,a.createElementVNode)("button",{type:"button",onClick:r,disabled:(0,a.unref)(n).characterPayload.current_age<=0,class:"age-btn"},"-",8,nl),(0,a.createElementVNode)("span",tl,(0,a.toDisplayString)((0,a.unref)(n).characterPayload.current_age)+" 岁",1),(0,a.createElementVNode)("button",{type:"button",onClick:o,disabled:(0,a.unref)(n).characterPayload.current_age>=18,class:"age-btn"},"+",8,al)])]),(0,a.createCommentVNode)(" World "),(0,a.createElementVNode)("div",ol,[l[18]||(l[18]=(0,a.createElementVNode)("h3",null,"所选世界",-1)),(0,a.createElementVNode)("h4",null,(0,a.toDisplayString)((0,a.unref)(n).selectedWorld?.name||"未选择"),1),(0,a.createElementVNode)("p",rl,(0,a.toDisplayString)((0,a.unref)(n).selectedWorld?.description||"暂无描述"),1)]),(0,a.createCommentVNode)(" Talent Tier "),(0,a.createElementVNode)("div",ll,[l[19]||(l[19]=(0,a.createElementVNode)("h3",null,"天资",-1)),(0,a.createElementVNode)("h4",{style:(0,a.normalizeStyle)({color:(0,a.unref)(n).selectedTalentTier?.color||"inherit"})},(0,a.toDisplayString)((0,a.unref)(n).selectedTalentTier?.name||"未选择"),5),(0,a.createElementVNode)("p",il,(0,a.toDisplayString)((0,a.unref)(n).selectedTalentTier?.description||"暂无描述"),1)]),(0,a.createCommentVNode)(" Origin "),(0,a.createElementVNode)("div",cl,[l[20]||(l[20]=(0,a.createElementVNode)("h3",null,"出身",-1)),(0,a.createElementVNode)("h4",null,(0,a.toDisplayString)((0,a.unref)(n).selectedOrigin?.name||"随机出身"),1),(0,a.createElementVNode)("p",sl,(0,a.toDisplayString)((0,a.unref)(n).selectedOrigin?.description||"暂无描述"),1)]),(0,a.createCommentVNode)(" Spirit Root "),(0,a.createElementVNode)("div",dl,[l[21]||(l[21]=(0,a.createElementVNode)("h3",null,"灵根",-1)),(0,a.createElementVNode)("h4",null,(0,a.toDisplayString)((0,a.unref)(n).selectedSpiritRoot?.name||"随机灵根"),1),(0,a.createElementVNode)("p",ml,(0,a.toDisplayString)((0,a.unref)(n).selectedSpiritRoot?.description||"暂无描述"),1)]),(0,a.createCommentVNode)(" Talents "),(0,a.createElementVNode)("div",pl,[l[22]||(l[22]=(0,a.createElementVNode)("h3",null,"天赋",-1)),(0,a.unref)(n).selectedTalents.length?((0,a.openBlock)(),(0,a.createElementBlock)("ul",vl,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(n).selectedTalents,e=>((0,a.openBlock)(),(0,a.createElementBlock)("li",{key:e.id},[(0,a.createElementVNode)("strong",null,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("p",ul,(0,a.toDisplayString)(e.description),1)]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("p",gl,"未选择任何天赋"))]),(0,a.createCommentVNode)(" Attributes "),t.isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("div",fl,[l[23]||(l[23]=(0,a.createElementVNode)("h3",null,"先天六司",-1)),(0,a.createElementVNode)("ul",null,[(0,a.createElementVNode)("li",null,"根骨: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.root_bone),1),(0,a.createElementVNode)("li",null,"灵性: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.spirituality),1),(0,a.createElementVNode)("li",null,"悟性: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.comprehension),1),(0,a.createElementVNode)("li",null,"气运: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.fortune),1),(0,a.createElementVNode)("li",null,"魅力: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.charm),1),(0,a.createElementVNode)("li",null,"心性: "+(0,a.toDisplayString)((0,a.unref)(n).attributes.temperament),1)])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" Cloud Mode Placeholder "),l[24]||(l[24]=(0,a.createElementVNode)("div",{class:"preview-item cloud-info-item"},[(0,a.createElementVNode)("h3",null,"命格天定"),(0,a.createElementVNode)("p",{class:"cloud-info-text"}," 联机模式下，角色的初始命格将由所选世界的天道法则在云端生成，以确保公平与平衡。 ")],-1))],2112))])]))}});var hl=t(4042),yl={};yl.styleTagTransform=A(),yl.setAttributes=z(),yl.insert=V().bind(null,"head"),yl.domAPI=N(),yl.insertStyleElement=B(),k()(hl.A,yl),hl.A&&hl.A.locals&&hl.A.locals;const xl=(0,j.A)(bl,[["__scopeId","data-v-bcd8af9a"]]),kl={class:"modal-dialog"},wl={key:0,class:"step-content"},Nl={class:"modal-title"},El={class:"form-group"},Vl={key:0,class:"error-message"},Cl={class:"form-actions"},zl=["disabled"],Sl={class:"step-content"},Bl={class:"modal-subtitle"},Dl={class:"prompt-section"},Al=["placeholder","onKeyup"],_l={class:"char-count"},$l={key:0,class:"suggested-prompts"},Il={class:"suggestions-grid"},Tl=["onClick"],jl=(0,a.defineComponent)({__name:"RedemptionCodeModal",props:{visible:{type:Boolean},title:{},type:{}},emits:["close","submit"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)(""),l=(0,a.ref)(""),i=(0,a.ref)(""),c=(0,a.ref)(null),s=(0,a.ref)("code"),d=(0,a.ref)(!1),m=()=>({world:["现代都市修仙，灵气复苏","古代仙侠世界，门派林立","末法时代，修真没落","星际修仙，宇宙征途"],talent_tier:["天生剑心，剑道天才","丹道奇才，炼丹天赋","阵法大师，天机推算","体修霸体，肉身无双"],origin:["修仙世家的没落子弟","凡人出身的天选之子","魔门弟子改邪归正","上古传承的最后血脉"],spirit_root:["雷属性变异灵根","罕见的时间属性","混沌属性至尊灵根","五行俱全的废柴灵根"],talent:["透视本质的天眼神通","预知未来的天机术","不死不灭的重生能力","操控时空的神级天赋"]}[t.type||"world"]||[]);(0,a.watch)(()=>t.visible,e=>{e&&(p(),(0,a.nextTick)(()=>{c.value?.focus()}))});const p=()=>{i.value="",r.value="",l.value="",s.value="code",d.value=!1},v=()=>{p(),o("close")},u=()=>{s.value="code",i.value=""},g=async()=>{if(r.value.trim()){d.value=!0,i.value="";try{await new Promise(e=>setTimeout(e,500)),s.value="prompt"}catch(e){i.value="兑换码验证失败，请检查后重试。"}finally{d.value=!1}}else i.value="兑换码不可为空。"},f=()=>{o("submit",{code:r.value.trim(),prompt:l.value.trim()||void 0}),p()};return(e,n)=>e.visible?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:(0,a.withModifiers)(v,["self"])},[(0,a.createElementVNode)("div",kl,[(0,a.createCommentVNode)(" 第一步：输入兑换码 "),"code"===s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",wl,[(0,a.createElementVNode)("h2",Nl,(0,a.toDisplayString)(e.title),1),n[2]||(n[2]=(0,a.createElementVNode)("p",{class:"modal-subtitle"},"请输入兑换码以接引天机进行AI推演。",-1)),(0,a.createElementVNode)("form",{onSubmit:(0,a.withModifiers)(g,["prevent"])},[(0,a.createElementVNode)("div",El,[(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),type:"text",placeholder:"请输入兑换码",class:"code-input",ref_key:"inputRef",ref:c},null,512),[[a.vModelText,r.value]])]),i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vl,(0,a.toDisplayString)(i.value),1)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Cl,[(0,a.createElementVNode)("button",{type:"button",class:"btn btn-secondary",onClick:v}," 取消 "),(0,a.createElementVNode)("button",{type:"submit",class:"btn",disabled:!r.value.trim()||d.value},(0,a.toDisplayString)(d.value?"验证中...":"下一步"),9,zl)])],32)])):"prompt"===s.value?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 第二步：输入提示词 "),(0,a.createElementVNode)("div",Sl,[n[5]||(n[5]=(0,a.createElementVNode)("h2",{class:"modal-title"},"自定义AI推演",-1)),(0,a.createElementVNode)("p",Bl,(0,a.toDisplayString)({world:"描述你希望的世界风格、时代背景或特色设定（可含对话，使用中文引号“”，每句仅一对）",talent_tier:"描述你希望的天资类型、特点或能力倾向（可含对话，使用中文引号“”，每句仅一对）",origin:"描述你希望的出身背景、家族或成长环境（可含对话，使用中文引号“”，每句仅一对）",spirit_root:"描述你希望的灵根属性、特色或修炼倾向（可含对话，使用中文引号“”，每句仅一对）",talent:"描述你希望的天赋能力、特殊技能或神通（可含对话，使用中文引号“”，每句仅一对）"}[t.type||"world"]||"请输入自定义提示词"),1),(0,a.createElementVNode)("div",Dl,[n[3]||(n[3]=(0,a.createElementVNode)("label",{class:"prompt-label"},"提示词 (可选)",-1)),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),class:"prompt-input",placeholder:{world:"例如：现代都市修仙世界，灵气复苏，科技与修真并存...",talent_tier:"例如：擅长炼丹制器的天才，拥有超强的感知能力...",origin:"例如：修仙世家的没落子弟，身负血海深仇...",spirit_root:"例如：罕见的雷属性变异灵根，天生引雷...",talent:"例如：能够看透事物本质的天眼神通..."}[t.type||"world"]||"请输入提示词...",rows:"4",maxlength:"500",onKeyup:(0,a.withKeys)((0,a.withModifiers)(f,["ctrl"]),["enter"])},null,40,Al),[[a.vModelText,l.value]]),(0,a.createElementVNode)("div",_l,(0,a.toDisplayString)(l.value.length)+"/500",1)]),m().length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",$l,[n[4]||(n[4]=(0,a.createElementVNode)("h4",{class:"suggestions-title"},"建议提示词",-1)),(0,a.createElementVNode)("div",Il,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m(),e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e,class:"suggestion-button",onClick:n=>l.value=e},(0,a.toDisplayString)(e),9,Tl))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",{class:"form-actions"},[(0,a.createElementVNode)("button",{type:"button",class:"btn btn-secondary",onClick:u}," 返回 "),(0,a.createElementVNode)("button",{type:"button",class:"btn",onClick:f}," 开始推演 ")])])],2112)):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0)}});var Ml=t(5890),ql={};ql.styleTagTransform=A(),ql.setAttributes=z(),ql.insert=V().bind(null,"head"),ql.domAPI=N(),ql.insertStyleElement=B(),k()(Ml.A,ql),Ml.A&&Ml.A.locals&&Ml.A.locals;const Ol=(0,j.A)(jl,[["__scopeId","data-v-0d860b7f"]]);var Pl=t(9333);const Fl={class:"creation-container"},Ll={class:"creation-scroll"},Yl={class:"header-container"},Rl={class:"header-top"},Ul={class:"mode-indicator"},Gl={key:0,class:"cloud-sync-container"},Wl={class:"progress-steps"},Jl={class:"step-circle"},Hl={class:"step-label"},Ql={class:"step-content"},Kl={class:"navigation-buttons"},Xl={class:"points-display"},Zl={key:0,class:"destiny-points"},ei=["disabled"],ni=(0,a.defineComponent)({__name:"CharacterCreation",props:{onBack:{type:Function}},emits:["creation-complete"],setup(e,{expose:n,emit:o}){const r=e,l=o,i=(0,nn.N)(),c=(0,a.ref)(!1),s=(0,a.ref)(!1),m=(0,a.ref)("world");function p(){m.value={1:"world",2:"talent_tier",3:"origin",4:"spirit_root",5:"talent"}[i.currentStep]||"world",i.isLocalCreation||(c.value=!0)}(0,a.onMounted)(async()=>{console.log("【角色创建】当前模式:",i.isLocalCreation?"单机":"联机"),await i.initializeStore(i.isLocalCreation?"single":"cloud");const e=i.creationData.worlds.length,n=i.creationData.talents.length;console.log("【角色创建】当前数据量:"),console.log("- 总世界数量:",e),console.log("- 总天赋数量:",n),!i.isLocalCreation&&(e<=3||n<=5)&&(console.log("【角色创建】联机模式下数据量不足，尝试获取云端数据..."),await i.fetchAllCloudData(),console.log("【角色创建】云端数据获取完成，最终数据量:"),console.log("- 总世界数量:",i.creationData.worlds.length),console.log("- 总天赋数量:",i.creationData.talents.length));try{const e=await(0,an.wz)();e?(console.log("【角色创建】成功获取酒馆角色卡名字:",e),i.characterPayload.character_name=e):(console.log("【角色创建】无法获取酒馆角色卡名字，使用默认值"),i.characterPayload.character_name=i.isLocalCreation?"无名者":"修士")}catch(e){console.error("【角色创建】获取角色名字时出错:",e),i.characterPayload.character_name=i.isLocalCreation?"无名者":"修士"}}),(0,a.onUnmounted)(()=>{i.resetOnExit()}),n({handleAIGenerateClick:p});const v=["诸天问道","仙缘初定","转世因果","测灵问道","神通择定","命格天成","窥天算命"],u=()=>{i.currentStep>1?i.prevStep():r.onBack()},g=(0,a.computed)(()=>{const e=i.currentStep,n=i.totalSteps,t=i.selectedWorld,a=i.selectedTalentTier,o=i.remainingTalentPoints,r=s.value;return console.log("[DEBUG] 按钮状态检查 - 当前步骤:",e,"/",n),console.log("[DEBUG] 按钮状态检查 - isGenerating:",r),console.log("[DEBUG] 按钮状态检查 - 选中的世界:",t?.name),console.log("[DEBUG] 按钮状态检查 - 选中的天资:",a?.name),console.log("[DEBUG] 按钮状态检查 - 剩余天赋点:",o),1!==e||t?2!==e||a?(console.log("[DEBUG] 按钮状态：启用"),!1):(console.log("[DEBUG] 按钮被禁用：第2步未选择天资"),!0):(console.log("[DEBUG] 按钮被禁用：第1步未选择世界"),!0)});const f=(0,a.ref)(null),b=(0,a.ref)(null),h=(0,a.ref)(null),y=(0,a.ref)(null),x=(0,a.ref)(null);async function k(e){if(!localStorage.getItem("access_token"))return d.o.error("身份凭证缺失，请先登录再使用信物。"),void(c.value=!1);!e.code||e.code.trim().length<6?d.o.error("请输入有效的仙缘信物！"):(c.value=!1,await async function(e,n){let a="";switch(i.currentStep){case 1:a="world";break;case 2:a="talent_tier";break;case 3:a="origin";break;case 4:a="spirit_root";break;case 5:a="talent";break;default:return void d.o.error("当前步骤不支持AI生成！")}s.value=!0;const o=`cloud-ai-generate-${a}`,r=n?"基于你的心愿推演玄妙...":"天机推演中...";d.o.loading(r,{id:o});try{d.o.loading("正在验证仙缘信物...",{id:o});try{const n=await(0,Pl.Em)(`/api/v1/redemption/validate/${e}`,{method:"POST"});if(n?.is_used)return d.o.error("仙缘信物已被使用或无效！",{id:o}),void(s.value=!1)}catch(e){console.warn("兑换码预验证失败，继续执行:",e)}d.o.loading("已连接天机阁，正在推演...",{id:o});const r=await Promise.resolve().then(t.bind(t,414));let l=null;switch(a){case"world":l=await r.generateWorld();break;case"talent_tier":l=await r.generateTalentTier();break;case"origin":if(!i.selectedWorld)return void d.o.error("请先选择世界！");l=await r.generateOrigin();break;case"spirit_root":l=await r.generateSpiritRoot();break;case"talent":l=await r.generateTalent()}if(!l)return void d.o.error("天机推演失败，请重试。");d.o.loading("正在将结果铭刻于云端...",{id:o});const c=await(0,Pl.Em)("/api/v1/ai/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.trim().toUpperCase(),type:a,content:l,user_prompt:n||null})});if(c?.message){i.addGeneratedData(a,l);const e=c.code_used?`天机已成功记录！信物使用次数：${c.code_used}`:"天机已成功记录于云端！";d.o.success(e,{id:o})}}catch(e){const n=e instanceof Error?e.message:"未知错误";n.includes("兑换码")||n.includes("信物")?d.o.error(n,{id:o}):n.includes("登录")?d.o.error("身份验证失败，请重新登录！",{id:o}):d.o.error("天机紊乱："+n,{id:o})}finally{s.value=!1,setTimeout(()=>d.o.hide(o),3e3)}}(e.code,e.prompt))}function w(e){console.log("[角色创建] 云端同步完成:",e),e.success&&e.newItemsCount>0&&d.o.success(`已更新 ${e.newItemsCount} 项云端数据`)}function N(e,n){console.log("[角色创建] 数据清除完成:",{type:e,count:n}),n>0&&i.resetCharacter()}return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Fl,[(0,a.createVNode)(yn),(0,a.createElementVNode)("div",Ll,[(0,a.createCommentVNode)(" 进度条 "),(0,a.createElementVNode)("div",Yl,[(0,a.createElementVNode)("div",Rl,[(0,a.createCommentVNode)(" 左侧：模式指示 "),(0,a.createElementVNode)("div",Ul,(0,a.toDisplayString)((0,a.unref)(i).isLocalCreation?"单机模式":"联机模式"),1),(0,a.createCommentVNode)(" 右侧：云端同步按钮（仅单机模式显示） "),(0,a.unref)(i).isLocalCreation?((0,a.openBlock)(),(0,a.createElementBlock)("div",Gl,[(0,a.createVNode)(Tn,{onSyncCompleted:w,variant:"compact",size:"small"}),(0,a.createVNode)(Rn,{variant:"horizontal",size:"small",onDataCleared:N})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",Wl,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(i).totalSteps,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:(0,a.normalizeClass)(["step",{active:(0,a.unref)(i).currentStep>=e}])},[(0,a.createElementVNode)("div",Jl,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)("div",Hl,(0,a.toDisplayString)(v[e-1]),1)],2))),128))])]),(0,a.createCommentVNode)(" 内容区域 "),(0,a.createElementVNode)("div",Ql,[(0,a.createVNode)(a.Transition,{name:"fade-step",mode:"out-in"},{default:(0,a.withCtx)(()=>[((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:(0,a.unref)(i).currentStep,class:"step-wrapper"},[1===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(fa,{key:0,ref_key:"step1Ref",ref:f,onAiGenerate:p},null,512)):2===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(Oa,{key:1,ref_key:"step2Ref",ref:b,onAiGenerate:p},null,512)):3===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(co,{key:2,ref_key:"step3Ref",ref:h,onAiGenerate:p},null,512)):4===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(rr,{key:3,ref_key:"step4Ref",ref:y,onAiGenerate:p},null,512)):5===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(zr,{key:4,ref_key:"step5Ref",ref:x,onAiGenerate:p},null,512)):6===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(Yr,{key:5})):7===(0,a.unref)(i).currentStep?((0,a.openBlock)(),(0,a.createBlock)(xl,{key:6,"is-local-creation":(0,a.unref)(i).isLocalCreation},null,8,["is-local-creation"])):(0,a.createCommentVNode)("v-if",!0)]))]),_:1})]),(0,a.createCommentVNode)(" 导航 "),(0,a.createElementVNode)("div",Kl,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(u,["prevent"]),type:"button",class:"btn btn-secondary"},(0,a.toDisplayString)(1===(0,a.unref)(i).currentStep?"返回道途":"上一步"),1),(0,a.createCommentVNode)(" 剩余点数显示 "),(0,a.createElementVNode)("div",Xl,[(0,a.unref)(i).currentStep>=3&&(0,a.unref)(i).currentStep<=7?((0,a.openBlock)(),(0,a.createElementBlock)("div",Zl,[n[2]||(n[2]=(0,a.createElementVNode)("span",{class:"points-label"},"剩余天道点:",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["points-value",{low:(0,a.unref)(i).remainingTalentPoints<0}])},(0,a.toDisplayString)((0,a.unref)(i).remainingTalentPoints),3)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("button",{type:"button",onClick:n[0]||(n[0]=(0,a.withModifiers)(e=>{console.log("[DEBUG] 开启仙途按钮被点击!"),async function(e){console.log("[DEBUG] handleNext 被调用，当前步骤:",i.currentStep,"总步骤:",i.totalSteps),e&&(e.preventDefault(),e.stopPropagation(),console.log("[DEBUG] 事件已阻止默认行为")),i.currentStep<i.totalSteps?(console.log("[DEBUG] 执行下一步"),i.nextStep()):(console.log("[DEBUG] 最后一步，准备创建角色"),await async function(){if(console.log("[DEBUG] createCharacter 开始执行"),console.log("[DEBUG] isGenerating.value:",s.value),s.value)console.warn("[CharacterCreation.vue] 角色创建已在进行中，忽略重复请求");else{if(console.log("[CharacterCreation.vue] createCharacter() called."),s.value=!0,console.log("[DEBUG] 开始数据校验"),console.log("[DEBUG] 角色名:",i.characterPayload.character_name),console.log("[DEBUG] 选中的世界:",i.selectedWorld),console.log("[DEBUG] 选中的天资:",i.selectedTalentTier),console.log("[DEBUG] 选中的出身:",i.selectedOrigin),console.log("[DEBUG] 选中的灵根:",i.selectedSpiritRoot),i.characterPayload.character_name||(console.log("[DEBUG] 角色名为空，使用默认值"),i.characterPayload.character_name="修士"),!i.selectedWorld||!i.selectedTalentTier)return console.log("[DEBUG] 验证失败：缺少必需选择项"),console.log("[DEBUG] selectedWorld:",i.selectedWorld),console.log("[DEBUG] selectedTalentTier:",i.selectedTalentTier),void d.o.error("创建数据不完整，请检查世界和天资选择！");if(console.log("[DEBUG] selectedOrigin:",i.selectedOrigin,"(可为空，表示随机出生)"),console.log("[DEBUG] selectedSpiritRoot:",i.selectedSpiritRoot,"(可为空，表示随机灵根)"),!i.isLocalCreation&&!window.parent?.TavernHelper)return console.log("[DEBUG] 验证失败：联机模式但非SillyTavern环境"),void d.o.error("联机模式需要在SillyTavern扩展中运行。");console.log("[DEBUG] 数据校验通过，开始创建角色"),s.value=!0;try{const e={名字:i.characterPayload.character_name,性别:i.characterPayload.gender,世界:i.selectedWorld.name,天资:i.selectedTalentTier.name,出生:i.selectedOrigin?.name||"随机出身",灵根:i.selectedSpiritRoot?{名称:i.selectedSpiritRoot.name,品级:i.selectedSpiritRoot.tier||"",描述:i.selectedSpiritRoot.description||""}:"随机灵根",天赋:i.selectedTalents.map(e=>e.name),先天六司:{根骨:i.attributes.root_bone,灵性:i.attributes.spirituality,悟性:i.attributes.comprehension,气运:i.attributes.fortune,魅力:i.attributes.charm,心性:i.attributes.temperament},后天六司:{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0},世界详情:i.selectedWorld,天资详情:i.selectedTalentTier,出身详情:i.selectedOrigin,灵根详情:i.selectedSpiritRoot,天赋详情:i.selectedTalents},n={charId:`char_${Date.now()}`,characterName:i.characterPayload.character_name,world:i.selectedWorld,talentTier:i.selectedTalentTier,origin:i.selectedOrigin,spiritRoot:i.selectedSpiritRoot,talents:i.selectedTalents,角色基础信息:e,baseAttributes:{root_bone:i.attributes.root_bone,spirituality:i.attributes.spirituality,comprehension:i.attributes.comprehension,fortune:i.attributes.fortune,charm:i.attributes.charm,temperament:i.attributes.temperament},mode:i.isLocalCreation?"单机":"联机",age:i.characterPayload.current_age,gender:i.characterPayload.gender};console.log("发射creation-complete事件，载荷:",n),l("creation-complete",n)}catch(e){console.error("创建角色时发生严重错误:",e),s.value=!1,l("creation-complete",{error:e})}}}())}(e)},["prevent"])),disabled:s.value||g.value||(0,a.unref)(i).currentStep===(0,a.unref)(i).totalSteps&&(0,a.unref)(i).remainingTalentPoints<0,class:(0,a.normalizeClass)(["btn",{"btn-complete":(0,a.unref)(i).currentStep===(0,a.unref)(i).totalSteps,disabled:s.value||g.value||(0,a.unref)(i).currentStep===(0,a.unref)(i).totalSteps&&(0,a.unref)(i).remainingTalentPoints<0}])},(0,a.toDisplayString)((0,a.unref)(i).currentStep===(0,a.unref)(i).totalSteps?"开启仙途":"下一步"),11,ei)])]),(0,a.createCommentVNode)(" 仙缘信物按钮 - 只在联机模式下点击AI推演时显示 "),(0,a.createVNode)(Ol,{visible:c.value,type:m.value,title:"使用仙缘信物",onClose:n[1]||(n[1]=e=>c.value=!1),onSubmit:k},null,8,["visible","type"]),(0,a.createCommentVNode)(" AI生成等待由全局toast处理 ")]))}});var ti=t(6893),ai={};ai.styleTagTransform=A(),ai.setAttributes=z(),ai.insert=V().bind(null,"head"),ai.domAPI=N(),ai.insertStyleElement=B(),k()(ti.A,ai),ti.A&&ti.A.locals&&ti.A.locals;var oi=t(383),ri={};ri.styleTagTransform=A(),ri.setAttributes=z(),ri.insert=V().bind(null,"head"),ri.domAPI=N(),ri.insertStyleElement=B(),k()(oi.A,ri),oi.A&&oi.A.locals&&oi.A.locals;const li=(0,j.A)(ni,[["__scopeId","data-v-23a2a838"]]),ii={class:"login-container"},ci={class:"login-panel"},si={class:"title"},di={class:"subtitle"},mi={class:"form-group"},pi={class:"form-group"},vi={key:0,class:"form-group"},ui={key:1,class:"error-message"},gi={key:2,class:"success-message"},fi={class:"form-actions"},bi=["disabled"],hi={class:"btn-text"},yi={class:"form-footer"},xi=(0,a.defineComponent)({__name:"LoginView",props:{onBack:{type:Function}},emits:["loggedIn"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)(""),l=(0,a.ref)(""),i=(0,a.ref)(""),c=(0,a.ref)(!1),s=(0,a.ref)(null),m=(0,a.ref)(null),p=(0,a.ref)(!1),v=(0,a.ref)(null),u=(0,a.ref)(null),g=(0,a.ref)(null),f=()=>{if(u.value&&window.turnstile)if(g.value)window.turnstile.reset(g.value);else{const e=window.turnstile.render(u.value,{sitekey:"0x4AAAAAABsSt_IBcfz18lmt",callback:e=>{v.value=e},"expired-callback":()=>{v.value=null}});g.value=e||null}};(0,a.onMounted)(()=>{window.onTurnstileLoad=()=>{f()},window.turnstile&&f()}),(0,a.onUnmounted)(()=>{window.onTurnstileLoad=void 0});const b=()=>{p.value=!p.value,s.value=null,m.value=null,l.value="",i.value="",v.value=null,(0,a.nextTick)(()=>{g.value&&window.turnstile&&window.turnstile.reset(g.value)})},h=async()=>{if(!c.value){if(!v.value)return s.value="请先完成人机验证。",void d.o.error("请先完成人机验证。");c.value=!0,s.value=null,m.value=null;try{const e={username:r.value,password:l.value,turnstile_token:v.value},n=await(0,Pl.Em)("/api/v1/auth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});localStorage.setItem("access_token",n.access_token),localStorage.setItem("username",r.value),d.o.success("登入成功，天机已连通！"),o("loggedIn")}catch(e){let n="一个未知的错误发生了";"object"==typeof e&&null!==e&&("detail"in e&&"string"==typeof e.detail?n=e.detail:"message"in e&&"string"==typeof e.message&&(n=e.message)),s.value=n,d.o.error(n)}finally{c.value=!1}}};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",ii,[(0,a.createElementVNode)("div",ci,[(0,a.createElementVNode)("h2",si,(0,a.toDisplayString)(p.value?"初入道门":"登入洞天"),1),(0,a.createElementVNode)("p",di,(0,a.toDisplayString)(p.value?"注册新道号，踏入修仙之路。":"验证道友身份，以便同步云端天机。"),1),(0,a.createElementVNode)("form",{onSubmit:n[4]||(n[4]=(0,a.withModifiers)(e=>p.value?(async()=>{if(!c.value)if(l.value===i.value){if(!v.value)return s.value="请先完成人机验证。",void d.o.error("请先完成人机验证。");c.value=!0,s.value=null,m.value=null;try{await(0,Pl.Em)("/api/v1/auth/register",{method:"POST",body:JSON.stringify({user_name:r.value,password:l.value,turnstile_token:v.value})}),m.value="注册成功！正在为您登入...",d.o.success("道号注册成功，欢迎踏入修仙之路！"),setTimeout(()=>{h()},1e3)}catch(e){let n="一个未知的错误发生了";"object"==typeof e&&null!==e&&("detail"in e&&"string"==typeof e.detail?n=e.detail:"message"in e&&"string"==typeof e.message&&(n=e.message)),s.value=n,d.o.error(n)}finally{c.value=!1}}else s.value="两次输入的令牌不一致！"})():h(),["prevent"]))},[(0,a.createElementVNode)("div",mi,[n[5]||(n[5]=(0,a.createElementVNode)("label",{for:"username"},"道号",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text",id:"username","onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),placeholder:"请输入您的道号",required:""},null,512),[[a.vModelText,r.value]])]),(0,a.createElementVNode)("div",pi,[n[6]||(n[6]=(0,a.createElementVNode)("label",{for:"password"},"令牌",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"password",id:"password","onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),placeholder:"请输入您的身份令牌",required:""},null,512),[[a.vModelText,l.value]])]),p.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",vi,[n[7]||(n[7]=(0,a.createElementVNode)("label",{for:"confirmPassword"},"确认令牌",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":n[2]||(n[2]=e=>i.value=e),placeholder:"请再次输入令牌",required:""},null,512),[[a.vModelText,i.value]])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" Cloudflare Turnstile Widget "),(0,a.createElementVNode)("div",{ref_key:"turnstileContainer",ref:u,class:"form-group turnstile-container"},null,512),s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",ui,(0,a.toDisplayString)(s.value),1)):(0,a.createCommentVNode)("v-if",!0),m.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",gi,(0,a.toDisplayString)(m.value),1)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",fi,[(0,a.createElementVNode)("button",{type:"button",onClick:n[3]||(n[3]=(...e)=>t.onBack&&t.onBack(...e)),class:"btn btn-secondary"},"返回"),(0,a.createElementVNode)("button",{type:"submit",class:(0,a.normalizeClass)(["btn",{"is-loading":c.value}]),disabled:c.value},[(0,a.createElementVNode)("span",hi,(0,a.toDisplayString)(p.value?"注册":"登入"),1)],10,bi)]),(0,a.createElementVNode)("div",yi,[(0,a.createElementVNode)("a",{href:"#",onClick:(0,a.withModifiers)(b,["prevent"]),class:"link"},(0,a.toDisplayString)(p.value?"已有道号？立即登入":"初来乍到？注册道号"),1)])],32)])]))}});var ki=t(8974),wi={};wi.styleTagTransform=A(),wi.setAttributes=z(),wi.insert=V().bind(null,"head"),wi.domAPI=N(),wi.insertStyleElement=B(),k()(ki.A,wi),ki.A&&ki.A.locals&&ki.A.locals;const Ni=(0,j.A)(xi,[["__scopeId","data-v-950f3f12"]]),Ei=(0,c.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Vi=(0,c.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ci=(0,c.A)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]),zi=(0,c.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Si=(0,c.A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Bi=(0,c.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Di=(0,c.A)("scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]),Ai=(0,c.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),_i=(0,c.A)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),$i=(0,c.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),Ii=(0,c.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Ti=(0,c.A)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),ji=(0,c.A)("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]]),Mi=(0,c.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),qi=(0,c.A)("users-round",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),Oi=new class{listeners=new Map;on(e,n){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(n)}off(e,n){this.listeners.get(e)?.delete(n)}async emit(e,n){const t=Array.from(this.listeners.get(e)||[]);for(const e of t)await e(n)}},Pi=(0,c.A)("maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]),Fi=(0,c.A)("minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);var Li=t(9142);function Yi(e){if(!e)return"凡人";if("string"==typeof e)return e;const n=e.名称||e.name||"凡人",t=e.阶段||e.stage||"";return"凡人"===n||"Mortal"===n?"凡人":t?`${n}·${t}`:n}const Ri={class:"top-bar"},Ui={class:"left-section"},Gi={key:0,class:"character-quick-info"},Wi={class:"character-name"},Ji={class:"character-realm"},Hi={class:"center-section"},Qi={class:"location-time-info"},Ki={class:"location-text"},Xi={class:"time-value"},Zi={class:"right-section"},ec=(0,a.defineComponent)({__name:"TopBar",setup(e){const{characterData:n}=(0,Li.useUnifiedCharacterData)(),t=(0,a.ref)(!1),o=(0,a.computed)(()=>{try{return n.value?.基础信息?.名字||""}catch(e){return console.error("[TopBar] Error getting characterName:",e),""}}),r=(0,a.computed)(()=>{try{return Yi(n.value?.境界)}catch(e){return console.error("[TopBar] Error getting characterRealm:",e),"凡人"}}),l=(0,a.computed)(()=>{try{return n.value?.位置?.描述||"初始地"}catch(e){return console.error("[TopBar] Error getting currentLocation:",e),"初始地"}}),i=(0,a.computed)(()=>{try{const e=n.value?.游戏时间;if(e){const n=function(e){return e.分钟??0}(e),t=n.toString().padStart(2,"0"),a=e.小时.toString().padStart(2,"0");return`仙道${e.年}年${e.月}月${e.日}日 ${a}:${t}`}return"仙道元年1月1日 00:00"}catch(e){return console.error("[TopBar] Error getting gameTime:",e),"仙道元年1月1日 00:00"}}),c=()=>{document.fullscreenElement?document.exitFullscreen().catch(e=>{console.error("无法退出全屏模式:",e)}):document.documentElement.requestFullscreen().catch(e=>{console.error("无法进入全屏模式:",e)})};return(0,a.onMounted)(()=>{console.log("[TopBar] Component mounted");const e=()=>{t.value=!!document.fullscreenElement};document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e)}),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Ri,[(0,a.createElementVNode)("div",Ui,[n[0]||(n[0]=(0,a.createElementVNode)("h1",{class:"game-title"},"大道朝天",-1)),o.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Gi,[(0,a.createElementVNode)("span",Wi,(0,a.toDisplayString)(o.value),1),(0,a.createElementVNode)("span",Ji,(0,a.toDisplayString)(r.value),1)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",Hi,[(0,a.createElementVNode)("div",Qi,[(0,a.createElementVNode)("span",Ki,(0,a.toDisplayString)(l.value),1),n[1]||(n[1]=(0,a.createElementVNode)("span",{class:"separator"},"|",-1)),(0,a.createElementVNode)("span",Xi,(0,a.toDisplayString)(i.value),1)])]),(0,a.createElementVNode)("div",Zi,[(0,a.createElementVNode)("button",{onClick:c,class:"fullscreen-btn"},[t.value?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Fi),{key:1,size:16})):((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Pi),{key:0,size:16}))])])]))}});var nc=t(2589),tc={};tc.styleTagTransform=A(),tc.setAttributes=z(),tc.insert=V().bind(null,"head"),tc.domAPI=N(),tc.insertStyleElement=B(),k()(nc.A,tc),nc.A&&nc.A.locals&&nc.A.locals;const ac=(0,j.A)(ec,[["__scopeId","data-v-18a40716"]]),oc=(0,c.A)("compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),rc=(0,c.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),lc=(0,c.A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),ic=(0,c.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),cc={class:"left-sidebar"},sc={class:"sidebar-header"},dc={class:"sidebar-title"},mc={class:"sidebar-content"},pc={class:"function-section"},vc={class:"function-group"},uc={class:"btn-icon"},gc={class:"btn-icon"},fc={class:"btn-icon"},bc={class:"btn-icon"},hc={class:"function-section"},yc={class:"function-group"},xc={class:"btn-icon"},kc={class:"btn-icon"},wc={class:"btn-icon"},Nc={class:"function-section"},Ec={class:"function-group"},Vc={class:"btn-icon"},Cc={class:"btn-icon"},zc={class:"btn-icon"},Sc={class:"system-section"},Bc={class:"function-group"},Dc=["disabled"],Ac={class:"btn-icon"},_c={class:"btn-icon"},$c={class:"btn-icon"},Ic={class:"btn-icon"},Tc=(0,a.defineComponent)({__name:"LeftSidebar",props:{collapsed:{type:Boolean}},setup(e){const n=(0,r.useRouter)(),o=(0,tn.useCharacterStore)(),l=(0,q.useUIStore)(),i=(0,a.computed)(()=>o.activeCharacterProfile),c=(0,a.computed)(()=>"联机"===i.value?.模式),s=async()=>{n.push("/game/save")},m=()=>{n.push("/game/inventory")},p=()=>{n.push("/game/character-details")},v=()=>{n.push("/game/quests")},u=()=>{n.push("/game/sect")},g=()=>{n.push("/game/relationships")},f=()=>{n.push("/game/techniques")},b=()=>{n.push("/game/thousand-dao")},h=()=>{n.push("/game/memory")},y=()=>{n.push("/game/world-map")},x=()=>{d.o.info("联机功能开发中...")},k=()=>{n.push("/game/settings")},w=()=>{n.push("/game/tavern-data")},N=()=>{l.showRetryDialog({title:"返回道途",message:"您想如何退出当前游戏？",confirmText:"保存并退出",cancelText:"取消",neutralText:"不保存直接退出",onConfirm:async()=>{console.log("[返回道途] 用户选择保存并退出...");try{await o.saveCurrentGame(),d.o.success("游戏已保存")}catch(e){console.error("[返回道途] 保存游戏失败:",e),d.o.error("游戏保存失败，但仍会继续退出。")}await E()},onNeutral:async()=>{console.log("[返回道途] 用户选择不保存直接退出..."),d.o.info("游戏进度未保存"),await E(!1)},onCancel:()=>{console.log("[返回道途] 用户取消操作")}})},E=async(e=!0)=>{try{const e=(0,an.getTavernHelper)();if(e){const{clearAllShards:n}=await Promise.resolve().then(t.bind(t,9808));await n(e),console.log("[返回道途] 已清理酒馆上下文")}}catch(e){console.error("[返回道途] 清理酒馆数据失败:",e),d.o.warning("清理会话上下文失败")}o.rootState.当前激活存档=null,await o.commitToStorage(),console.log("[返回道途] 已重置激活存档状态"),l.stopLoading(),await n.push("/"),console.log("[返回道途] 已跳转至主菜单")};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",cc,[(0,a.createElementVNode)("div",sc,[(0,a.createElementVNode)("h3",dc,[(0,a.createVNode)((0,a.unref)(oc),{size:20,class:"title-icon"}),n[0]||(n[0]=(0,a.createTextVNode)(" 游戏功能 ",-1))])]),(0,a.createElementVNode)("div",mc,[(0,a.createCommentVNode)(" 主要功能区 "),(0,a.createElementVNode)("div",pc,[n[5]||(n[5]=(0,a.createElementVNode)("div",{class:"section-title"},"修行管理",-1)),(0,a.createElementVNode)("div",vc,[(0,a.createElementVNode)("button",{class:"function-btn primary",onClick:m},[(0,a.createElementVNode)("div",uc,[(0,a.createVNode)((0,a.unref)(Ei),{size:18})]),n[1]||(n[1]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"背包物品"),(0,a.createElementVNode)("span",{class:"btn-desc"},"查看道具装备")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn primary",onClick:p},[(0,a.createElementVNode)("div",gc,[(0,a.createVNode)((0,a.unref)(Vi),{size:18})]),n[2]||(n[2]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"人物详情"),(0,a.createElementVNode)("span",{class:"btn-desc"},"查看修为境界")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn primary",onClick:f},[(0,a.createElementVNode)("div",fc,[(0,a.createVNode)((0,a.unref)(Si),{size:18})]),n[3]||(n[3]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"修炼功法"),(0,a.createElementVNode)("span",{class:"btn-desc"},"功法修炼技能")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn primary",onClick:b},[(0,a.createElementVNode)("div",bc,[(0,a.createVNode)((0,a.unref)(Bi),{size:18})]),n[4]||(n[4]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"三千大道"),(0,a.createElementVNode)("span",{class:"btn-desc"},"修炼万法道途")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})])])]),(0,a.createCommentVNode)(" 社交功能区 "),(0,a.createElementVNode)("div",hc,[n[9]||(n[9]=(0,a.createElementVNode)("div",{class:"section-title"},"红尘俗事",-1)),(0,a.createElementVNode)("div",yc,[(0,a.createElementVNode)("button",{class:"function-btn secondary",onClick:g},[(0,a.createElementVNode)("div",xc,[(0,a.createVNode)((0,a.unref)(zi),{size:18})]),n[6]||(n[6]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"人物关系"),(0,a.createElementVNode)("span",{class:"btn-desc"},"人情世故网络")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn secondary",onClick:u},[(0,a.createElementVNode)("div",kc,[(0,a.createVNode)((0,a.unref)($i),{size:18})]),n[7]||(n[7]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"宗门势力"),(0,a.createElementVNode)("span",{class:"btn-desc"},"势力与宗门展示")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn secondary",onClick:v},[(0,a.createElementVNode)("div",wc,[(0,a.createVNode)((0,a.unref)(Di),{size:18})]),n[8]||(n[8]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"任务系统"),(0,a.createElementVNode)("span",{class:"btn-desc"},"进行中任务")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})])])]),(0,a.createCommentVNode)(" 探索功能区 "),(0,a.createElementVNode)("div",Nc,[n[13]||(n[13]=(0,a.createElementVNode)("div",{class:"section-title"},"世界探索",-1)),(0,a.createElementVNode)("div",Ec,[(0,a.createElementVNode)("button",{class:"function-btn accent",onClick:y},[(0,a.createElementVNode)("div",Vc,[(0,a.createVNode)((0,a.unref)(_i),{size:18})]),n[10]||(n[10]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"世界地图"),(0,a.createElementVNode)("span",{class:"btn-desc"},"查看修仙大陆")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn accent",onClick:h},[(0,a.createElementVNode)("div",Cc,[(0,a.createVNode)((0,a.unref)(Ci),{size:18})]),n[11]||(n[11]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"记忆中心"),(0,a.createElementVNode)("span",{class:"btn-desc"},"回顾修行历程")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),c.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,class:"function-btn accent",onClick:x},[(0,a.createElementVNode)("div",zc,[(0,a.createVNode)((0,a.unref)(lc),{size:18})]),n[12]||(n[12]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"论道交友"),(0,a.createElementVNode)("span",{class:"btn-desc"},"与道友论道")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})])):(0,a.createCommentVNode)("v-if",!0)])]),n[18]||(n[18]=(0,a.createElementVNode)("div",{class:"divider"},null,-1)),(0,a.createCommentVNode)(" 系统功能区 "),(0,a.createElementVNode)("div",Sc,[(0,a.createElementVNode)("div",Bc,[(0,a.createElementVNode)("button",{class:"function-btn system",onClick:s,disabled:!i.value},[(0,a.createElementVNode)("div",Ac,[(0,a.createVNode)((0,a.unref)(Ai),{size:18})]),n[14]||(n[14]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"保存游戏"),(0,a.createElementVNode)("span",{class:"btn-desc"},"保存修行进度")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})],8,Dc),(0,a.createElementVNode)("button",{class:"function-btn system",onClick:w},[(0,a.createElementVNode)("div",_c,[(0,a.createVNode)((0,a.unref)(Ii),{size:18})]),n[15]||(n[15]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"酒馆数据"),(0,a.createElementVNode)("span",{class:"btn-desc"},"查看存储数据")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn system",onClick:k},[(0,a.createElementVNode)("div",$c,[(0,a.createVNode)((0,a.unref)(Wn),{size:18})]),n[16]||(n[16]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"系统设置"),(0,a.createElementVNode)("span",{class:"btn-desc"},"调整游戏选项")],-1)),(0,a.createVNode)((0,a.unref)(rc),{size:14,class:"btn-arrow"})]),(0,a.createElementVNode)("button",{class:"function-btn exit-btn no-arrow",onClick:N},[(0,a.createElementVNode)("div",Ic,[(0,a.createVNode)((0,a.unref)(ic),{size:18})]),n[17]||(n[17]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-text"},"返回道途"),(0,a.createElementVNode)("span",{class:"btn-desc"},"退出当前游戏")],-1))])])])])]))}});var jc=t(1667),Mc={};Mc.styleTagTransform=A(),Mc.setAttributes=z(),Mc.insert=V().bind(null,"head"),Mc.domAPI=N(),Mc.insertStyleElement=B(),k()(jc.A,Mc),jc.A&&jc.A.locals&&jc.A.locals;const qc=(0,j.A)(Tc,[["__scopeId","data-v-722579ba"]]),Oc=(0,c.A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),Pc=(0,c.A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),Fc=(0,c.A)("droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]),Lc=(0,c.A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),Yc=(0,c.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Rc=(0,c.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var Uc=t(6939);const Gc={class:"right-sidebar"},Wc={class:"sidebar-header"},Jc={class:"sidebar-title"},Hc={key:0,class:"sidebar-content"},Qc={class:"vitals-section"},Kc={class:"section-title"},Xc={class:"vitals-list"},Zc={class:"vital-item"},es={class:"vital-info"},ns={class:"vital-name"},ts={class:"vital-text"},as={class:"progress-bar"},os={class:"vital-item"},rs={class:"vital-info"},ls={class:"vital-name"},is={class:"vital-text"},cs={class:"progress-bar"},ss={class:"vital-item"},ds={class:"vital-info"},ms={class:"vital-name"},ps={class:"vital-text"},vs={class:"progress-bar"},us={class:"vital-item"},gs={class:"vital-info"},fs={class:"vital-name"},bs={class:"vital-text"},hs={class:"progress-bar"},ys={class:"cultivation-section"},xs={class:"section-title"},ks={class:"realm-display"},ws={class:"realm-info"},Ns={class:"realm-name"},Es={key:0,class:"realm-breakthrough"},Vs={key:0,class:"realm-mortal"},Cs={class:"realm-progress"},zs={class:"progress-bar"},Ss={class:"progress-text"},Bs={class:"reputation-display"},Ds={class:"reputation-item"},As={class:"reputation-info"},_s={class:"reputation-label"},$s={class:"reputation-value"},Is={class:"collapsible-section talents-section"},Ts={class:"section-title"},js={class:"talents-list"},Ms=["onClick"],qs={class:"talent-header"},Os={class:"talent-name"},Ps={key:0,class:"empty-talents"},Fs={class:"collapsible-section status-section"},Ls={class:"section-title"},Ys={class:"status-effects"},Rs={key:0,class:"empty-status"},Us={key:1,class:"status-tags-container"},Gs=["onClick","title"],Ws={class:"tag-icon"},Js={class:"tag-name"},Hs={key:0,class:"tag-intensity"},Qs={key:1,class:"tag-time"},Ks=(0,a.defineComponent)({__name:"RightSidebar",setup(e){const{characterData:n,saveData:t,isDataLoaded:o}=(0,Li.useUnifiedCharacterData)(),r=((0,tn.useCharacterStore)(),(0,q.useUIStore)()),l=(0,a.computed)(()=>n.value?.基础信息),i=(0,a.computed)(()=>n.value?.玩家角色状态),c=(0,a.computed)(()=>n.value?.状态效果||[]),s=((0,a.computed)(()=>n.value?.三千大道),(0,a.computed)(()=>{const e=l.value?.出生日期,n=t.value?.游戏时间;return e&&n?(0,Uc.R)(e,n):l.value?.年龄||i.value?.寿命?.当前||0})),d=(0,a.ref)(!1),m=(0,a.ref)(!1),p=e=>{if(!e||"未指定"===e)return"";if("永久"===e)return"永久";if(/^\d+$/.test(e)){const n=parseInt(e);if(n>=60){const e=Math.floor(n/60),t=n%60;return t>0?`${e}时${t}分`:`${e}时`}return`${n}分钟`}return e},v=(0,a.computed)(()=>{if(!i.value?.境界)return 0;const e=i.value.境界.当前进度,n=i.value.境界.下一级所需;return e&&n?Math.round(e/n*100):0}),u=e=>{if(!i.value)return 0;const n=i.value[e];return n?.当前&&n?.上限?Math.round(n.当前/n.上限*100):0},g=()=>{const e=i.value?.寿命?.上限;return e?Math.round(s.value/e*100):0},f=e=>{const n=i.value?.境界?.当前进度,t=i.value?.境界?.下一级所需,a=i.value?.境界?.阶段;return Yi({name:e,阶段:a,progress:n,maxProgress:t})};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Gc,[(0,a.createElementVNode)("div",Wc,[(0,a.createElementVNode)("h3",Jc,[(0,a.createVNode)((0,a.unref)(Oc),{size:18,class:"title-icon"}),n[2]||(n[2]=(0,a.createElementVNode)("span",null,"角色状态",-1))])]),(0,a.unref)(o)&&l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Hc,[(0,a.createCommentVNode)(" 修行状态 "),(0,a.createElementVNode)("div",Qc,[(0,a.createElementVNode)("h3",Kc,[(0,a.createVNode)((0,a.unref)(Pc),{size:14,class:"section-icon"}),n[3]||(n[3]=(0,a.createElementVNode)("span",null,"修行状态",-1))]),(0,a.createElementVNode)("div",Xc,[(0,a.createElementVNode)("div",Zc,[(0,a.createElementVNode)("div",es,[(0,a.createElementVNode)("span",ns,[(0,a.createVNode)((0,a.unref)(Fc),{size:12,class:"vital-icon blood"}),n[4]||(n[4]=(0,a.createElementVNode)("span",null,"气血",-1))]),(0,a.createElementVNode)("span",ts,(0,a.toDisplayString)(i.value?.气血?.当前)+" / "+(0,a.toDisplayString)(i.value?.气血?.上限),1)]),(0,a.createElementVNode)("div",as,[(0,a.createElementVNode)("div",{class:"progress-fill health",style:(0,a.normalizeStyle)({width:u("气血")+"%"})},null,4)])]),(0,a.createElementVNode)("div",os,[(0,a.createElementVNode)("div",rs,[(0,a.createElementVNode)("span",ls,[(0,a.createVNode)((0,a.unref)(Lc),{size:12,class:"vital-icon mana"}),n[5]||(n[5]=(0,a.createElementVNode)("span",null,"灵气",-1))]),(0,a.createElementVNode)("span",is,(0,a.toDisplayString)(i.value?.灵气?.当前)+" / "+(0,a.toDisplayString)(i.value?.灵气?.上限),1)]),(0,a.createElementVNode)("div",cs,[(0,a.createElementVNode)("div",{class:"progress-fill mana",style:(0,a.normalizeStyle)({width:u("灵气")+"%"})},null,4)])]),(0,a.createElementVNode)("div",ss,[(0,a.createElementVNode)("div",ds,[(0,a.createElementVNode)("span",ms,[(0,a.createVNode)((0,a.unref)(Ci),{size:12,class:"vital-icon spirit"}),n[6]||(n[6]=(0,a.createElementVNode)("span",null,"神识",-1))]),(0,a.createElementVNode)("span",ps,(0,a.toDisplayString)(i.value?.神识?.当前)+" / "+(0,a.toDisplayString)(i.value?.神识?.上限),1)]),(0,a.createElementVNode)("div",vs,[(0,a.createElementVNode)("div",{class:"progress-fill spirit",style:(0,a.normalizeStyle)({width:u("神识")+"%"})},null,4)])]),(0,a.createElementVNode)("div",us,[(0,a.createElementVNode)("div",gs,[(0,a.createElementVNode)("span",fs,[(0,a.createVNode)((0,a.unref)(Yc),{size:12,class:"vital-icon lifespan"}),n[7]||(n[7]=(0,a.createElementVNode)("span",null,"寿元",-1))]),(0,a.createElementVNode)("span",bs,(0,a.toDisplayString)(s.value)+" / "+(0,a.toDisplayString)(i.value?.寿命?.上限),1)]),(0,a.createElementVNode)("div",hs,[(0,a.createElementVNode)("div",{class:"progress-fill lifespan",style:(0,a.normalizeStyle)({width:g()+"%"})},null,4)])])])]),(0,a.createCommentVNode)(" 境界状态 "),(0,a.createElementVNode)("div",ys,[(0,a.createElementVNode)("h3",xs,[(0,a.createVNode)((0,a.unref)(Rc),{size:14,class:"section-icon"}),n[8]||(n[8]=(0,a.createElementVNode)("span",null,"境界状态",-1))]),(0,a.createElementVNode)("div",ks,[(0,a.createElementVNode)("div",ws,[(0,a.createElementVNode)("span",Ns,(0,a.toDisplayString)(f(i.value?.境界?.名称)),1),i.value?.境界?.突破描述?((0,a.openBlock)(),(0,a.createElementBlock)("span",Es,(0,a.toDisplayString)(i.value?.境界?.突破描述),1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 凡人境界显示等待引气入体 "),"凡人"===i.value?.境界?.名称?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vs,n[9]||(n[9]=[(0,a.createElementVNode)("span",{class:"mortal-text"},"等待仙缘，引气入体",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 修炼境界显示进度条 "),(0,a.createElementVNode)("div",Cs,[(0,a.createElementVNode)("div",zs,[(0,a.createElementVNode)("div",{class:"progress-fill cultivation",style:(0,a.normalizeStyle)({width:v.value+"%"})},null,4)]),(0,a.createElementVNode)("span",Ss,(0,a.toDisplayString)(v.value)+"%",1)])],2112))]),(0,a.createCommentVNode)(" 声望显示 "),(0,a.createElementVNode)("div",Bs,[(0,a.createElementVNode)("div",Ds,[(0,a.createElementVNode)("div",As,[(0,a.createElementVNode)("span",_s,[(0,a.createVNode)((0,a.unref)(Rc),{size:12,class:"vital-icon reputation"}),n[10]||(n[10]=(0,a.createElementVNode)("span",null,"声望",-1))]),(0,a.createElementVNode)("span",$s,(0,a.toDisplayString)(i.value?.声望||"籍籍无名"),1)])])])]),(0,a.createCommentVNode)(" 天赋神通 "),(0,a.createElementVNode)("div",Is,[(0,a.createElementVNode)("div",{class:"section-header",onClick:n[0]||(n[0]=e=>d.value=!d.value)},[(0,a.createElementVNode)("h3",Ts,[(0,a.createVNode)((0,a.unref)(Rc),{size:14,class:"section-icon gold"}),n[11]||(n[11]=(0,a.createElementVNode)("span",null,"天赋神通",-1))]),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["collapse-toggle",{collapsed:d.value}])},n[12]||(n[12]=[(0,a.createElementVNode)("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[(0,a.createElementVNode)("path",{d:"M8 10l4-4H4l4 4z"})],-1)]),2)]),(0,a.withDirectives)((0,a.createElementVNode)("div",js,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.天赋,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:"string"==typeof e?e:e.名称,class:"talent-card clickable",onClick:n=>(e=>{const n=t.value?.角色基础信息,a=n?.天赋?.find(n=>n.名称===e),o=jn.qS.find(n=>n.name===e),l=(a?{description:a.描述||"自定义天赋"}:o?{description:o.description}:{description:`天赋《${e}》的详细描述暂未开放，请期待后续更新。`}).description;r.showDetailModal({title:e,content:l})})("string"==typeof e?e:e.名称)},[(0,a.createElementVNode)("div",qs,[(0,a.createElementVNode)("span",Os,(0,a.toDisplayString)("string"==typeof e?e:e.名称),1)])],8,Ms))),128)),(0,a.createCommentVNode)(" 空状态显示 "),l.value.天赋&&0!==l.value.天赋.length?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ps,n[13]||(n[13]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"✨",-1),(0,a.createElementVNode)("div",{class:"empty-text"},"暂无天赋神通",-1)])))],512),[[a.vShow,!d.value]])]),(0,a.createCommentVNode)(" 状态效果 "),(0,a.createElementVNode)("div",Fs,[(0,a.createElementVNode)("div",{class:"section-header",onClick:n[1]||(n[1]=e=>m.value=!m.value)},[(0,a.createElementVNode)("h3",Ls,[(0,a.createVNode)((0,a.unref)(Bi),{size:14,class:"section-icon"}),n[14]||(n[14]=(0,a.createElementVNode)("span",null,"状态效果",-1))]),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["collapse-toggle",{collapsed:m.value}])},n[15]||(n[15]=[(0,a.createElementVNode)("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[(0,a.createElementVNode)("path",{d:"M8 10l4-4H4l4 4z"})],-1)]),2)]),(0,a.withDirectives)((0,a.createElementVNode)("div",Ys,[0===c.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Rs,n[16]||(n[16]=[(0,a.createElementVNode)("span",{class:"empty-text"},"清净无为",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",Us,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.状态名称,class:(0,a.normalizeClass)(["status-tag clickable",["buff"===String(e.类型).toLowerCase()?"buff":"debuff"]]),onClick:n=>(e=>{const n=e.状态描述&&String(e.状态描述).trim()?String(e.状态描述).trim():`${e.状态名称||"未知"}状态生效中`,t=[];if(e.强度){const n=e.强度>=8?`极强(${e.强度}/10)`:e.强度>=5?`中等(${e.强度}/10)`:`轻微(${e.强度}/10)`;t.push({label:"效果强度",value:n})}const a=e.剩余时间,o=e.时间;if(a&&o&&a!==o)t.push({label:"剩余时间",value:a});else if(a)t.push({label:"持续时间",value:a});else if(o){const e=p(o);t.push({label:"持续时间",value:e||o})}e.来源&&t.push({label:"产生原因",value:e.来源});const l=[],i="buff"===String(e.类型).toLowerCase()?"增益状态✅":"负面状态⚠️";l.push({label:"状态类型",value:i}),l.push(...t);let c=n;l.length>0&&(c+="\n\n基本信息:",l.forEach(e=>{c+=`\n- ${e.label}: ${e.value}`})),r.showDetailModal({title:e.状态名称,content:c})})(e),title:`${e.状态名称}${e.强度?` - 强度${e.强度}`:""}${p(e.时间)?` - ${p(e.时间)}`:""}`},[(0,a.createElementVNode)("span",Ws,(0,a.toDisplayString)("buff"===String(e.类型).toLowerCase()?"增":"减"),1),(0,a.createElementVNode)("span",Js,(0,a.toDisplayString)(e.状态名称),1),e.强度?((0,a.openBlock)(),(0,a.createElementBlock)("span",Hs,(0,a.toDisplayString)(e.强度),1)):(0,a.createCommentVNode)("v-if",!0),p(e.时间)?((0,a.openBlock)(),(0,a.createElementBlock)("span",Qs,(0,a.toDisplayString)(p(e.时间)),1)):(0,a.createCommentVNode)("v-if",!0)],10,Gs))),128))]))],512),[[a.vShow,!m.value]])])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 无角色数据 "),n[17]||(n[17]=(0,a.createElementVNode)("div",{class:"no-character"},[(0,a.createElementVNode)("div",{class:"no-char-text"},"请选择角色开启修仙之旅")],-1))],2112)),(0,a.createCommentVNode)(" 详情模态框 "),(0,a.createVNode)(Xe)]))}});var Xs=t(6782),Zs={};Zs.styleTagTransform=A(),Zs.setAttributes=z(),Zs.insert=V().bind(null,"head"),Zs.domAPI=N(),Zs.insertStyleElement=B(),k()(Xs.A,Zs),Xs.A&&Xs.A.locals&&Xs.A.locals;const ed=(0,j.A)(Ks,[["__scopeId","data-v-b79cffd4"]]),nd={class:"hexagon-chart-container"},td=["width","height","viewBox"],ad=["transform"],od=["points"],rd=["x2","y2"],ld=["points"],id=["cx","cy"],cd=["x","y","text-anchor","dominant-baseline"],sd=["x","y","text-anchor","dominant-baseline"],dd=(0,a.defineComponent)({__name:"HexagonChart",props:{stats:{},size:{default:160},maxValue:{default:10}},setup(e){const n=e,t=(0,a.computed)(()=>n.size/2),o=(0,a.computed)(()=>n.size/2*.7),r=["root_bone","spirituality","comprehension","fortune","charm","temperament"],l={root_bone:"根骨",spirituality:"灵性",comprehension:"悟性",fortune:"气运",charm:"魅力",temperament:"心性"},i=(e=1)=>{const n=[];for(let t=0;t<6;t++){const a=Math.PI/2+Math.PI/3*t,r=Math.cos(a)*o.value*e,l=-Math.sin(a)*o.value*e;n.push(`${r.toFixed(2)},${l.toFixed(2)}`)}return n.join(" ")},c=(0,a.computed)(()=>r.map((e,t)=>{const a=n.stats[e]??0,r=Math.max(0,Math.min(1,a/n.maxValue)),l=Math.PI/2+Math.PI/3*t,i=o.value*r+(0===r?4:0);return{value:a,x:Math.cos(l)*i,y:-Math.sin(l)*i}})),s=(0,a.computed)(()=>{const e=[];return r.forEach((t,a)=>{const r=n.stats[t]??0,l=Math.max(0,Math.min(1,r/n.maxValue)),i=Math.PI/2+Math.PI/3*a,c=Math.cos(i)*o.value*l,s=-Math.sin(i)*o.value*l;e.push(`${c.toFixed(2)},${s.toFixed(2)}`)}),e.join(" ")}),d=(0,a.computed)(()=>{const e=[];for(let n=0;n<6;n++){const t=Math.PI/2+Math.PI/3*n;e.push({x:Math.cos(t)*o.value,y:-Math.sin(t)*o.value})}return e}),m=(0,a.computed)(()=>{const e=1.25*o.value;return r.map((n,t)=>{const a=Math.PI/2+Math.PI/3*t;return{key:n,name:l[n],x:Math.cos(a)*e,y:-Math.sin(a)*e}})}),p=(e,n=!1)=>0===e||3===e?"middle":1===e||2===e?n?"end":"start":n?"start":"end",v=(e,n=!1)=>0===e?n?"hanging":"alphabetic":3===e?n?"alphabetic":"hanging":"middle";return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",nd,[((0,a.openBlock)(),(0,a.createElementBlock)("svg",{width:e.size,height:e.size,viewBox:`0 0 ${e.size} ${e.size}`},[(0,a.createCommentVNode)(" 定义渐变 "),n[0]||(n[0]=(0,a.createStaticVNode)('<defs data-v-256c0aae><linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-256c0aae><stop offset="0%" stop-color="rgba(255, 215, 0, 0.3)" data-v-256c0aae></stop><stop offset="50%" stop-color="rgba(218, 165, 32, 0.25)" data-v-256c0aae></stop><stop offset="100%" stop-color="rgba(255, 223, 0, 0.2)" data-v-256c0aae></stop></linearGradient><linearGradient id="darkGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-256c0aae><stop offset="0%" stop-color="rgba(100, 181, 246, 0.3)" data-v-256c0aae></stop><stop offset="100%" stop-color="rgba(100, 181, 246, 0.1)" data-v-256c0aae></stop></linearGradient></defs>',1)),(0,a.createElementVNode)("g",{transform:`translate(${t.value}, ${t.value})`},[(0,a.createCommentVNode)(" Hexagon Grid Lines "),((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(5,e=>(0,a.createElementVNode)("polygon",{key:`grid-${e}`,points:i(e/5),class:"grid-line"},null,8,od)),64)),(0,a.createCommentVNode)(" Radial Lines "),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(d.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("line",{key:`axis-${n}`,x1:"0",y1:"0",x2:e.x,y2:e.y,class:"grid-line"},null,8,rd))),128)),(0,a.createCommentVNode)(" Data Polygon "),(0,a.createElementVNode)("polygon",{points:s.value,class:"data-polygon"},null,8,ld),(0,a.createCommentVNode)(" Data Points & Numeric Values "),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("g",{key:`data-point-${n}`},[(0,a.createElementVNode)("circle",{cx:e.x,cy:e.y,r:"3",class:"data-point"},null,8,id),(0,a.createElementVNode)("text",{x:e.x,y:e.y,class:"data-value-text","text-anchor":p(n,!0),"dominant-baseline":v(n,!0)},(0,a.toDisplayString)(e.value),9,cd)]))),128)),(0,a.createCommentVNode)(" Stat Labels "),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("text",{key:e.key,x:e.x,y:e.y,class:"label-text","text-anchor":p(n),"dominant-baseline":v(n)},(0,a.toDisplayString)(e.name),9,sd))),128))],8,ad)],8,td))]))}});var md=t(3019),pd={};pd.styleTagTransform=A(),pd.setAttributes=z(),pd.insert=V().bind(null,"head"),pd.domAPI=N(),pd.insertStyleElement=B(),k()(md.A,pd),md.A&&md.A.locals&&md.A.locals;const vd=(0,j.A)(dd,[["__scopeId","data-v-256c0aae"]]),ud=(0,c.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),gd=(0,c.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),fd=(0,c.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),bd={class:"dialog-title"},hd={class:"dialog-message"},yd=["placeholder"],xd={class:"dialog-actions"},kd={key:0,class:"fullscreen-header"},wd={class:"mobile-header"},Nd={class:"mobile-title"},Ed={key:0,class:"selected-info"},Vd={key:2,class:"empty-state"},Cd={class:"management-layout"},zd={class:"grid-container"},Sd={class:"grid-header-left"},Bd={class:"character-count"},Dd={class:"grid-header-right"},Ad={class:"header-left-content"},_d={key:0,class:"selected-char-info"},$d={key:0,class:"save-actions-buttons"},Id={class:"characters-grid"},Td=["onClick"],jd={class:"card-header"},Md={class:"avatar-text"},qd={class:"mode-indicator"},Od={class:"char-info"},Pd={class:"char-name"},Fd={class:"char-meta"},Ld={class:"world"},Yd={class:"talent"},Rd={class:"save-count"},Ud={class:"count"},Gd={class:"card-actions"},Wd=["onClick"],Jd=["onClick"],Hd=["onClick"],Qd={class:"grid-content-right saves-panel"},Kd={key:0,class:"no-selection"},Xd={class:"saves-container"},Zd={class:"saves-section"},em={class:"auto-saves-section"},nm={class:"auto-saves-grid"},tm={key:0,class:"save-data"},am={class:"save-header"},om={class:"save-badges"},rm={class:"realm-badge"},lm={class:"age-badge"},im={class:"save-stats"},cm={class:"stat-grid"},sm={class:"stat"},dm={class:"value"},mm={class:"stat"},pm={class:"value"},vm={class:"stat"},um={class:"value"},gm={class:"stat"},fm={class:"value"},bm={class:"save-footer"},hm={class:"location"},ym={class:"save-time"},xm={key:1,class:"save-empty"},km={key:0,class:"manual-saves-section"},wm={class:"manual-saves-grid"},Nm=["onClick"],Em={key:0,class:"save-data"},Vm={class:"save-header"},Cm={class:"save-name"},zm={class:"save-actions"},Sm=["onClick"],Bm=["onClick","disabled","title"],Dm={class:"save-badges"},Am={class:"realm-badge"},_m={class:"age-badge"},$m={class:"save-stats"},Im={class:"stat-grid"},Tm={class:"stat"},jm={class:"value"},Mm={class:"stat"},qm={class:"value"},Om={class:"stat"},Pm={class:"value"},Fm={class:"stat"},Lm={class:"value"},Ym={class:"save-footer"},Rm={class:"location"},Um={class:"save-time"},Gm={key:1,class:"save-empty"},Wm={class:"online-saves-container"},Jm={key:0,class:"login-prompt"},Hm={key:1,class:"online-save-card"},Qm={key:0,class:"save-data"},Km={class:"save-header"},Xm={class:"save-badges"},Zm={class:"realm-badge"},ep={class:"age-badge"},np={class:"save-stats"},tp={class:"stat-grid"},ap={class:"stat"},op={class:"value"},rp={class:"stat"},lp={class:"value"},ip={class:"stat"},cp={class:"value"},sp={class:"stat"},dp={class:"value"},mp={class:"save-footer"},pp={class:"location"},vp={class:"sync-info"},up={class:"online-actions"},gp={key:0,class:"btn-sync"},fp={key:1,class:"save-empty"},bp={class:"modal-header"},hp={key:0,class:"modal-content"},yp={class:"details-grid"},xp={class:"detail-section"},kp={class:"detail-items"},wp={class:"detail-item"},Np={class:"value"},Ep={class:"detail-item"},Vp={class:"value"},Cp={class:"detail-item"},zp={class:"value"},Sp={class:"detail-item"},Bp={class:"value"},Dp={class:"detail-item"},Ap={class:"value"},_p={class:"detail-item"},$p={class:"value"},Ip={class:"detail-section"},Tp={class:"attributes-display"},jp={class:"detail-section"},Mp={class:"talents-list"},qp={key:0,class:"talent-items"},Op=["title"],Pp={key:1,class:"no-talents"},Fp=(0,a.defineComponent)({__name:"CharacterManagement",props:{fullscreen:{type:Boolean,default:!1}},emits:["back","login","close","character-selected"],setup(e,{emit:n}){const t=e,o=n,l=(0,a.computed)(()=>t.fullscreen),i=(0,r.useRouter)(),c=(0,tn.useCharacterStore)(),s=(0,a.ref)(!0),m=(0,a.ref)(null),p=(0,a.ref)(!1),v=(0,a.ref)(null),u=(0,a.ref)(null),g=(0,a.ref)(null),f=(0,a.ref)(!1),b=(0,a.ref)(!1),h=(0,a.ref)(window.innerWidth),y=()=>{h.value=window.innerWidth,h.value>768?f.value=!0:h.value<=480&&(f.value=!1)};(0,a.onMounted)(()=>{window.addEventListener("resize",y),y()}),(0,a.onUnmounted)(()=>{window.removeEventListener("resize",y)});const x=(0,a.ref)({show:!1,type:"alert",title:"",message:"",inputValue:"",placeholder:"",onConfirm:(...e)=>{},onCancel:()=>{}}),k=(0,a.computed)(()=>Object.keys(c.rootState.角色列表).length),w=(0,a.computed)(()=>m.value?c.rootState.角色列表[m.value]:null),N=(0,a.computed)(()=>h.value<=768),E=()=>{f.value=!f.value},V=e=>"单机"===e.模式?Object.values(e.存档列表||{}).filter(e=>e.存档数据).length:e.存档?.存档数据?1:0,C=()=>{p.value=!1,v.value=null},z=async(e,n,a)=>{console.log("选择存档:",e,n,a);const r=c.rootState.角色列表[e];if(a){console.log("设置活跃角色...");try{await c.setActiveCharacterInTavern(e)}catch(e){console.warn("跳过酒馆同步（单机环境）",e)}console.log("加载存档...");const a=await c.loadGame(e,n);console.log("加载结果:",a),a?(console.log("跳转到游戏界面..."),t.fullscreen?o("character-selected",r):i.push("/game")):console.error("存档加载失败")}else{const a="上次对话"===n;O(a?"创建新存档":"开启新征程",a?`是否在【${n}】位置创建新的存档开始游戏？`:`是否在存档位 "${n}" 开始一段新的修行？`,async()=>{console.log("确认创建新存档...");try{await c.setActiveCharacterInTavern(e)}catch(e){console.warn("跳过酒馆同步（单机环境）",e)}const a=await c.loadGame(e,n);console.log("新存档加载结果:",a),a&&(console.log("跳转到游戏界面..."),t.fullscreen?o("character-selected",r):i.push("/game"))})}},S=(e,n)=>{if(!e||"联机"===e.模式)return!1;let t=0;const a=e.存档列表||{};Object.entries(a).forEach(([,e])=>{e.存档数据&&t++});const o=a[n];return!(o?.存档数据&&t<=1)},B=e=>{if(!e?.存档列表)return{};const n={};return Object.entries(e.存档列表).forEach(([e,t])=>{"上次对话"!==e&&(n[e]=t)}),n},D=()=>{o("back")},A=()=>{t.fullscreen?o("close"):D()},_=()=>{o("login")},$=e=>Yi(e),I=e=>e?new Date(e).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"未保存",T=e=>"string"==typeof e?e:e&&"object"==typeof e&&(e.名称||e.name)||"未知天赋",j=e=>{if("string"==typeof e)return`天赋《${e}》`;if(e&&"object"==typeof e){const n=e.描述||e.description||"",t=T(e);return n||`天赋《${t}》`}return"未知天赋"},M=e=>e?"string"==typeof e?e:"object"==typeof e&&null!==e&&(e.名称||e.name||e.名字)||"未知":"未知",q=(e,n,t)=>{x.value={show:!0,type:"alert",title:e,message:n,inputValue:"",placeholder:"",onConfirm:()=>{t&&t(),L()},onCancel:L}},O=(e,n,t,a)=>{x.value={show:!0,type:"confirm",title:e,message:n,inputValue:"",placeholder:"",onConfirm:()=>{t(),L()},onCancel:()=>{a&&a(),L()}}},P=()=>{"prompt"===x.value.type?x.value.onConfirm(x.value.inputValue):x.value.onConfirm()},F=()=>{x.value.onCancel(),L()},L=()=>{x.value.show=!1},Y=()=>{if(w.value)try{const e=w.value,n=Object.values(e.存档列表||{}).filter(e=>e.存档数据);if(0===n.length)return void d.o.info("该角色没有可导出的存档");const t={saves:n,exportTime:(new Date).toISOString(),version:"1.0.0",characterName:e.角色基础信息.名字},a=JSON.stringify(t,null,2),o=new Blob([a],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=`大道朝天-${e.角色基础信息.名字}-存档备份-${(new Date).toISOString().split("T")[0]}.json`,r.click(),d.o.success("存档已导出")}catch(e){console.error("导出失败",e),d.o.error("导出存档失败")}else d.o.error("请先选择一个角色")},R=()=>{w.value?g.value?.click():d.o.error("请先选择一个角色以导入存档")},U=()=>{g.value?.click()},G=async e=>{const n=e.target.files?.[0];if(n)try{const e=await n.text(),t=JSON.parse(e);if(t.saves&&Array.isArray(t.saves)){if(!m.value||!w.value)return d.o.error("请先选择一个角色以导入存档"),void(g.value&&(g.value.value=""));const e=m.value,n=w.value.角色基础信息.名字;O("导入存档",`确定要将 ${t.saves.length} 个存档导入到角色 "${n}" 吗？同名存档将被覆盖。`,async()=>{b.value=!0;try{await c.setActiveCharacterInTavern(e);for(const e of t.saves)await c.importSave(e);d.o.success(`成功为角色 "${n}" 导入 ${t.saves.length} 个存档`)}catch(e){console.error("导入失败",e),d.o.error("导入存档失败: "+e.message)}finally{b.value=!1,g.value&&(g.value.value="")}},()=>{g.value&&(g.value.value="")})}else{if(!t.角色基础信息||!t.模式)throw new Error("无效的文件格式，请导入角色或存档文件");{const e=t.角色基础信息?.名字||"未知角色";O("导入角色",`确定要导入角色 "${e}" 吗？`,async()=>{b.value=!0;try{await c.importCharacter(t),d.o.success(`成功导入角色 "${e}"`)}catch(e){console.error("导入角色失败",e),d.o.error("导入角色失败: "+e.message)}finally{b.value=!1,g.value&&(g.value.value="")}},()=>{g.value&&(g.value.value="")})}}}catch(e){console.error("处理导入文件失败",e),d.o.error("处理导入文件失败: "+e.message),g.value&&(g.value.value="")}};return(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:(0,a.normalizeClass)(["character-management-panel",{fullscreen:l.value}])},[l.value?((0,a.openBlock)(),(0,a.createBlock)(yn,{key:0})):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 自定义对话框 "),x.value.show?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"dialog-overlay",onClick:F},[(0,a.createElementVNode)("div",{class:"dialog-box",onClick:n[1]||(n[1]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("h3",bd,(0,a.toDisplayString)(x.value.title),1),(0,a.createElementVNode)("p",hd,(0,a.toDisplayString)(x.value.message),1),"prompt"===x.value.type?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("input",{key:0,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value.inputValue=e),placeholder:x.value.placeholder,class:"dialog-input",ref_key:"promptInput",ref:u},null,8,yd)),[[a.vModelText,x.value.inputValue]]):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",xd,["alert"!==x.value.type?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:F,class:"btn-dialog-cancel"}," 取消 ")):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{onClick:P,class:"btn-dialog-confirm"}," 确认 ")])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 主体区域 "),(0,a.createElementVNode)("main",{class:(0,a.normalizeClass)(["main-content",{"fullscreen-content":l.value}])},[(0,a.createElementVNode)("input",{ref_key:"fileInput",ref:g,type:"file",accept:".json",onChange:G,style:{display:"none"}},null,544),(0,a.createCommentVNode)(" 返回按钮 - 仅在全屏模式显示 "),l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",kd,[(0,a.createElementVNode)("button",{onClick:A,class:"fullscreen-back-btn"},[(0,a.createVNode)((0,a.unref)(ud),{size:20}),n[6]||(n[6]=(0,a.createElementVNode)("span",null,"返回道途",-1))]),n[7]||(n[7]=(0,a.createElementVNode)("div",{class:"fullscreen-title"},[(0,a.createElementVNode)("h1",null,"续前世因缘"),(0,a.createElementVNode)("p",null,"择一法身，入道重修")],-1))])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 移动端头部导航 "),(0,a.createElementVNode)("div",wd,[(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["mobile-menu-btn",{active:f.value}]),onClick:E},n[8]||(n[8]=[(0,a.createElementVNode)("div",{class:"hamburger"},[(0,a.createElementVNode)("span"),(0,a.createElementVNode)("span"),(0,a.createElementVNode)("span")],-1),(0,a.createElementVNode)("span",{class:"menu-text"},"角色列表",-1)]),2),(0,a.createElementVNode)("div",Nd,[n[9]||(n[9]=(0,a.createElementVNode)("h2",null,"角色管理",-1)),w.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Ed,(0,a.toDisplayString)(w.value.角色基础信息.名字)+" - "+(0,a.toDisplayString)(w.value.模式)+"模式 ",1)):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 遮罩层 "),f.value&&N.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"panel-overlay",onClick:n[2]||(n[2]=e=>f.value=!1)})):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 无角色提示 "),0===Object.keys((0,a.unref)(c).rootState.角色列表).length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vd,[n[10]||(n[10]=(0,a.createElementVNode)("div",{class:"empty-icon"},"🌟",-1)),n[11]||(n[11]=(0,a.createElementVNode)("h2",null,"道途未启",-1)),n[12]||(n[12]=(0,a.createElementVNode)("p",null,"尚未创建任何法身，请返回道途开启修仙之旅",-1)),(0,a.createElementVNode)("div",{class:"empty-actions"},[(0,a.createElementVNode)("button",{onClick:D,class:"btn-create"},"踏入仙途"),(0,a.createElementVNode)("button",{onClick:U,class:"btn-import"},"导入角色")])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:3},[(0,a.createCommentVNode)(" 角色管理界面 "),(0,a.createElementVNode)("div",Cd,[(0,a.createCommentVNode)(" 3行2列网格容器 "),(0,a.createElementVNode)("div",zd,[(0,a.createCommentVNode)(" 第1行：标题栏 "),(0,a.createElementVNode)("div",Sd,[n[13]||(n[13]=(0,a.createElementVNode)("h2",null,"角色列表",-1)),(0,a.createElementVNode)("div",Bd,(0,a.toDisplayString)(k.value)+" 个角色",1)]),(0,a.createElementVNode)("div",Dd,[(0,a.createElementVNode)("div",Ad,[n[14]||(n[14]=(0,a.createElementVNode)("h2",null,"存档管理",-1)),w.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",_d,(0,a.toDisplayString)(w.value.角色基础信息.名字)+" - "+(0,a.toDisplayString)(w.value.模式)+"模式 ",1)):(0,a.createCommentVNode)("v-if",!0)]),w.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",$d,[(0,a.createElementVNode)("button",{onClick:Y,class:"btn-save-action export",title:"导出选中角色的存档"},[(0,a.createVNode)((0,a.unref)(gd),{size:18}),n[15]||(n[15]=(0,a.createElementVNode)("span",null,"导出存档",-1))]),(0,a.createElementVNode)("button",{onClick:R,class:"btn-save-action import",title:"向选中角色导入存档"},[(0,a.createVNode)((0,a.unref)(fd),{size:18}),n[16]||(n[16]=(0,a.createElementVNode)("span",null,"导入存档",-1))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 第2行：主要内容区 "),(0,a.createElementVNode)("section",{class:(0,a.normalizeClass)(["grid-content-left characters-panel",{"is-open":f.value}])},[(0,a.createElementVNode)("div",Id,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(c).rootState.角色列表,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:(0,a.normalizeClass)(["character-card",{active:m.value===t,"single-mode":"单机"===e.模式,"online-mode":"联机"===e.模式}]),onClick:e=>(e=>{m.value=e,N.value&&(f.value=!1)})(t)},[(0,a.createCommentVNode)(" 卡片头部 "),(0,a.createElementVNode)("div",jd,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["char-avatar",e.模式])},[(0,a.createElementVNode)("span",Md,(0,a.toDisplayString)(e.角色基础信息.名字[0]),1),(0,a.createElementVNode)("div",qd,(0,a.toDisplayString)("单机"===e.模式?"单":"联"),1)],2),(0,a.createElementVNode)("div",Od,[(0,a.createElementVNode)("h3",Pd,(0,a.toDisplayString)(e.角色基础信息.名字),1),(0,a.createElementVNode)("div",Fd,[(0,a.createElementVNode)("span",Ld,(0,a.toDisplayString)(e.角色基础信息.世界),1),(0,a.createElementVNode)("span",Yd,(0,a.toDisplayString)(M(e.角色基础信息.天资)),1)])]),(0,a.createElementVNode)("div",Rd,[(0,a.createElementVNode)("span",Ud,(0,a.toDisplayString)(V(e)),1),n[17]||(n[17]=(0,a.createElementVNode)("span",{class:"label"},"存档",-1))])]),(0,a.createCommentVNode)(" 卡片底部操作 "),(0,a.createElementVNode)("div",Gd,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(e=>(e=>{v.value=c.rootState.角色列表[e],p.value=!0})(t),["stop"]),class:"btn-details"},"详情",8,Wd),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(e=>(e=>{try{const n=c.rootState.角色列表[e];if(!n)return void d.o.error("角色不存在");const t={...n,exportTime:(new Date).toISOString(),version:"1.0.0"},a=JSON.stringify(t,null,2),o=new Blob([a],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=`大道朝天-${n.角色基础信息.名字}-角色备份-${(new Date).toISOString().split("T")[0]}.json`,r.click(),d.o.success(`角色 "${n.角色基础信息.名字}" 已导出`)}catch(e){console.error("导出角色失败",e),d.o.error("导出角色失败")}})(t),["stop"]),class:"btn-export"},"导出",8,Jd),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(e=>(e=>{const n=c.rootState.角色列表[e]?.角色基础信息.名字;O("删除角色",`确定要彻底删除角色"${n}"及其所有修行记录吗？此操作不可恢复。`,()=>{c.deleteCharacter(e),m.value===e&&(m.value=null)})})(t),["stop"]),class:"btn-delete"},"删除",8,Hd)])],10,Td))),128))])],2),(0,a.createCommentVNode)(" 右侧：存档详情 "),(0,a.createElementVNode)("section",Qd,[(0,a.createCommentVNode)(" 未选择角色 "),w.value?"单机"===w.value.模式?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 单机模式存档 "),(0,a.createElementVNode)("div",Xd,[(0,a.createElementVNode)("div",Zd,[(0,a.createCommentVNode)(" 上次对话存档区 "),(0,a.createElementVNode)("div",em,[n[26]||(n[26]=(0,a.createElementVNode)("h3",null,"上次对话",-1)),(0,a.createElementVNode)("div",nm,[(0,a.createCommentVNode)(" 上次对话存档 "),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["save-card auto-save",{"has-data":w.value.存档列表?.["上次对话"]?.存档数据}]),style:{cursor:"default"}},[w.value.存档列表?.["上次对话"]?.存档数据?((0,a.openBlock)(),(0,a.createElementBlock)("div",tm,[(0,a.createElementVNode)("div",am,[n[19]||(n[19]=(0,a.createElementVNode)("h4",{class:"save-name"},"上次对话",-1)),(0,a.createElementVNode)("div",om,[(0,a.createElementVNode)("span",rm,(0,a.toDisplayString)($(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.境界)),1),(0,a.createElementVNode)("span",lm,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.寿命?.当前||18)+"岁",1)])]),(0,a.createElementVNode)("div",im,[(0,a.createElementVNode)("div",cm,[(0,a.createElementVNode)("div",sm,[n[20]||(n[20]=(0,a.createElementVNode)("span",{class:"label"},"气血",-1)),(0,a.createElementVNode)("span",dm,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.气血?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.气血?.上限||0),1)]),(0,a.createElementVNode)("div",mm,[n[21]||(n[21]=(0,a.createElementVNode)("span",{class:"label"},"灵气",-1)),(0,a.createElementVNode)("span",pm,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.灵气?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.灵气?.上限||0),1)]),(0,a.createElementVNode)("div",vm,[n[22]||(n[22]=(0,a.createElementVNode)("span",{class:"label"},"神识",-1)),(0,a.createElementVNode)("span",um,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.神识?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.神识?.上限||0),1)]),(0,a.createElementVNode)("div",gm,[n[23]||(n[23]=(0,a.createElementVNode)("span",{class:"label"},"声望",-1)),(0,a.createElementVNode)("span",fm,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.声望||0),1)])])]),(0,a.createElementVNode)("div",bm,[(0,a.createElementVNode)("span",hm,(0,a.toDisplayString)(w.value.存档列表["上次对话"].存档数据.玩家角色状态?.位置?.描述||"初始地"),1),(0,a.createElementVNode)("span",ym,(0,a.toDisplayString)(I(w.value.存档列表["上次对话"].保存时间)),1)]),n[24]||(n[24]=(0,a.createElementVNode)("div",{class:"save-hint",style:{"margin-top":"0.5rem",padding:"0.5rem",background:"rgba(255, 193, 7, 0.1)","border-radius":"4px","font-size":"0.85rem",color:"var(--color-warning)"}},' 💡 此存档用于回滚，请在游戏中的"存档管理"面板使用回滚功能 ',-1))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",xm,n[25]||(n[25]=[(0,a.createElementVNode)("div",{class:"empty-slot-icon"},"🔄",-1),(0,a.createElementVNode)("span",{class:"empty-text"},"暂无对话存档",-1),(0,a.createElementVNode)("span",{class:"auto-save-desc"},"每次对话前自动备份",-1)])))],2)])]),(0,a.createCommentVNode)(" 手动存档区 - 仅单机模式显示 "),"单机"===w.value.模式?((0,a.openBlock)(),(0,a.createElementBlock)("div",km,[n[32]||(n[32]=(0,a.createElementVNode)("div",{class:"manual-saves-header"},[(0,a.createElementVNode)("h3",null,"手动存档"),(0,a.createElementVNode)("div",{class:"save-info-text"},[(0,a.createElementVNode)("span",null,"存档通过游戏内保存功能创建")])],-1)),(0,a.createElementVNode)("div",wm,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B(w.value),(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:(0,a.normalizeClass)(["save-card manual-save",{"has-data":e.存档数据}]),onClick:n=>e.存档数据&&z(m.value,String(t),!0),style:(0,a.normalizeStyle)({cursor:e.存档数据?"pointer":"default"})},[e.存档数据?((0,a.openBlock)(),(0,a.createElementBlock)("div",Em,[(0,a.createElementVNode)("div",Vm,[(0,a.createElementVNode)("h4",Cm,(0,a.toDisplayString)(e.存档名||t),1),(0,a.createElementVNode)("div",zm,[(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(e=>((e,n)=>{const t=c.rootState.角色列表[e]?.存档列表?.[n],o=t?.存档名||n;((e,n,t="",o="",r,l)=>{x.value={show:!0,type:"prompt",title:e,message:n,inputValue:t,placeholder:o,onConfirm:e=>{r(e||""),L()},onCancel:()=>{l&&l(),L()}},(0,a.nextTick)(()=>{u.value?.focus()})})("重命名存档","请输入新的存档名称：",o,"",async t=>{if(t&&t.trim()&&t.trim()!==o){const a=t.trim(),o=c.rootState.角色列表[e]?.存档列表;if(o&&a!==n&&o[a])return void q("重命名失败","存档名称已存在，请使用其他名称。");await c.renameSave(e,n,a)}})})(m.value,String(t)),["stop"]),class:"btn-edit-save",title:"重命名"},"编",8,Sm),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(e=>((e,n)=>{const t=c.rootState.角色列表[e],a=t?.角色基础信息.名字,o="上次对话"===n?"上次对话存档":n;S(t,n)?O("删除存档",`确定要删除角色"${a}"的"${o}"吗？此操作不可恢复。`,()=>{c.deleteSave(e,n)}):q("无法删除存档","无法删除该存档：角色至少需要保留一个存档。如需删除，请先创建其他存档或删除整个角色。")})(m.value,String(t)),["stop"]),class:(0,a.normalizeClass)(["btn-delete-save",{disabled:!S(w.value,String(t))}]),disabled:!S(w.value,String(t)),title:S(w.value,String(t))?"删除存档":"无法删除：至少需要保留一个存档"},"删",10,Bm)])]),(0,a.createElementVNode)("div",Dm,[(0,a.createElementVNode)("span",Am,(0,a.toDisplayString)($(e.存档数据.玩家角色状态?.境界)),1),(0,a.createElementVNode)("span",_m,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.寿命?.当前||18)+"岁",1)]),(0,a.createElementVNode)("div",$m,[(0,a.createElementVNode)("div",Im,[(0,a.createElementVNode)("div",Tm,[n[27]||(n[27]=(0,a.createElementVNode)("span",{class:"label"},"气血",-1)),(0,a.createElementVNode)("span",jm,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.气血?.当前||0)+"/"+(0,a.toDisplayString)(e.存档数据.玩家角色状态?.气血?.上限||0),1)]),(0,a.createElementVNode)("div",Mm,[n[28]||(n[28]=(0,a.createElementVNode)("span",{class:"label"},"灵气",-1)),(0,a.createElementVNode)("span",qm,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.灵气?.当前||0)+"/"+(0,a.toDisplayString)(e.存档数据.玩家角色状态?.灵气?.上限||0),1)]),(0,a.createElementVNode)("div",Om,[n[29]||(n[29]=(0,a.createElementVNode)("span",{class:"label"},"神识",-1)),(0,a.createElementVNode)("span",Pm,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.神识?.当前||0)+"/"+(0,a.toDisplayString)(e.存档数据.玩家角色状态?.神识?.上限||0),1)]),(0,a.createElementVNode)("div",Fm,[n[30]||(n[30]=(0,a.createElementVNode)("span",{class:"label"},"声望",-1)),(0,a.createElementVNode)("span",Lm,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.声望||0),1)])])]),(0,a.createElementVNode)("div",Ym,[(0,a.createElementVNode)("span",Rm,(0,a.toDisplayString)(e.存档数据.玩家角色状态?.位置?.描述||"初始地"),1),(0,a.createElementVNode)("span",Um,(0,a.toDisplayString)(I(e.保存时间)),1)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Gm,n[31]||(n[31]=[(0,a.createElementVNode)("div",{class:"empty-slot-icon"},"📁",-1),(0,a.createElementVNode)("span",{class:"empty-text"},"空存档槽",-1),(0,a.createElementVNode)("span",{class:"empty-desc"},"通过游戏内保存创建",-1)])))],14,Nm))),128))])])):(0,a.createCommentVNode)("v-if",!0)])])],2112)):"联机"===w.value.模式?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(" 联机模式存档 "),(0,a.createElementVNode)("div",Wm,[s.value?w.value.存档?((0,a.openBlock)(),(0,a.createElementBlock)("div",Hm,[w.value.存档.存档数据?((0,a.openBlock)(),(0,a.createElementBlock)("div",Qm,[(0,a.createElementVNode)("div",Km,[n[36]||(n[36]=(0,a.createElementVNode)("h4",{class:"save-name"},"云端存档",-1)),(0,a.createElementVNode)("div",Xm,[(0,a.createElementVNode)("span",Zm,(0,a.toDisplayString)($(w.value.存档.存档数据.玩家角色状态?.境界)),1),(0,a.createElementVNode)("span",ep,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.寿命?.当前||18)+"岁",1)])]),(0,a.createElementVNode)("div",np,[(0,a.createElementVNode)("div",tp,[(0,a.createElementVNode)("div",ap,[n[37]||(n[37]=(0,a.createElementVNode)("span",{class:"label"},"气血",-1)),(0,a.createElementVNode)("span",op,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.气血?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.气血?.上限||0),1)]),(0,a.createElementVNode)("div",rp,[n[38]||(n[38]=(0,a.createElementVNode)("span",{class:"label"},"灵气",-1)),(0,a.createElementVNode)("span",lp,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.灵气?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.灵气?.上限||0),1)]),(0,a.createElementVNode)("div",ip,[n[39]||(n[39]=(0,a.createElementVNode)("span",{class:"label"},"神识",-1)),(0,a.createElementVNode)("span",cp,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.神识?.当前||0)+"/"+(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.神识?.上限||0),1)]),(0,a.createElementVNode)("div",sp,[n[40]||(n[40]=(0,a.createElementVNode)("span",{class:"label"},"声望",-1)),(0,a.createElementVNode)("span",dp,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.声望||0),1)])])]),(0,a.createElementVNode)("div",mp,[(0,a.createElementVNode)("span",pp,(0,a.toDisplayString)(w.value.存档.存档数据.玩家角色状态?.位置?.描述||"初始地"),1),(0,a.createElementVNode)("div",vp,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["sync-status",{synced:!w.value.存档.云端同步信息?.需要同步}])},(0,a.toDisplayString)(w.value.存档.云端同步信息?.需要同步?"待同步":"已同步"),3)])]),(0,a.createElementVNode)("div",up,[(0,a.createElementVNode)("button",{onClick:n[3]||(n[3]=e=>z(m.value,"存档",!0)),class:"btn-play"},"进入游戏"),w.value.存档.云端同步信息?.需要同步?((0,a.openBlock)(),(0,a.createElementBlock)("button",gp,"同步云端")):(0,a.createCommentVNode)("v-if",!0)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",fp,[n[41]||(n[41]=(0,a.createElementVNode)("div",{class:"empty-slot-icon"},"☁️",-1)),n[42]||(n[42]=(0,a.createElementVNode)("span",{class:"empty-text"},"尚未开始修行",-1)),(0,a.createElementVNode)("button",{onClick:n[4]||(n[4]=e=>z(m.value,"存档",!1)),class:"btn-start"},"开始游戏")]))])):(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Jm,[n[33]||(n[33]=(0,a.createElementVNode)("div",{class:"login-icon"},"🔐",-1)),n[34]||(n[34]=(0,a.createElementVNode)("h3",null,"需要登录",-1)),n[35]||(n[35]=(0,a.createElementVNode)("p",null,"请先登录以管理联机角色存档",-1)),(0,a.createElementVNode)("button",{onClick:_,class:"btn-login"},"登入道籍")]))])],2112)):(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Kd,n[18]||(n[18]=[(0,a.createElementVNode)("div",{class:"no-selection-icon"},"📋",-1),(0,a.createElementVNode)("p",null,"请选择左侧角色查看存档详情",-1)])))]),(0,a.createCommentVNode)(" 第3行：底部信息栏（可选） "),n[43]||(n[43]=(0,a.createElementVNode)("div",{class:"grid-footer-left"},[(0,a.createCommentVNode)(" 预留底部区域 ")],-1)),n[44]||(n[44]=(0,a.createElementVNode)("div",{class:"grid-footer-right"},[(0,a.createCommentVNode)(" 预留底部区域 ")],-1))])])],2112))],2),(0,a.createCommentVNode)(" 角色详情弹窗 "),p.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:2,class:"modal-overlay",onClick:C},[(0,a.createElementVNode)("div",{class:"details-modal",onClick:n[5]||(n[5]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",bp,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(v.value?.角色基础信息.名字)+" - 详细信息",1),(0,a.createElementVNode)("button",{onClick:C,class:"btn-close"},"×")]),v.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",hp,[(0,a.createElementVNode)("div",yp,[(0,a.createElementVNode)("div",xp,[n[51]||(n[51]=(0,a.createElementVNode)("h4",null,"基础信息",-1)),(0,a.createElementVNode)("div",kp,[(0,a.createElementVNode)("div",wp,[n[45]||(n[45]=(0,a.createElementVNode)("span",{class:"label"},"道号",-1)),(0,a.createElementVNode)("span",Np,(0,a.toDisplayString)(v.value.角色基础信息.名字),1)]),(0,a.createElementVNode)("div",Ep,[n[46]||(n[46]=(0,a.createElementVNode)("span",{class:"label"},"世界",-1)),(0,a.createElementVNode)("span",Vp,(0,a.toDisplayString)(M(v.value.角色基础信息.世界)),1)]),(0,a.createElementVNode)("div",Cp,[n[47]||(n[47]=(0,a.createElementVNode)("span",{class:"label"},"天资",-1)),(0,a.createElementVNode)("span",zp,(0,a.toDisplayString)(M(v.value.角色基础信息.天资)),1)]),(0,a.createElementVNode)("div",Sp,[n[48]||(n[48]=(0,a.createElementVNode)("span",{class:"label"},"出身",-1)),(0,a.createElementVNode)("span",Bp,(0,a.toDisplayString)(M(v.value.角色基础信息.出生)),1)]),(0,a.createElementVNode)("div",Dp,[n[49]||(n[49]=(0,a.createElementVNode)("span",{class:"label"},"灵根",-1)),(0,a.createElementVNode)("span",Ap,(0,a.toDisplayString)(M(v.value.角色基础信息.灵根)),1)]),(0,a.createElementVNode)("div",_p,[n[50]||(n[50]=(0,a.createElementVNode)("span",{class:"label"},"模式",-1)),(0,a.createElementVNode)("span",$p,(0,a.toDisplayString)(v.value.模式),1)])])]),(0,a.createElementVNode)("div",Ip,[n[52]||(n[52]=(0,a.createElementVNode)("h4",null,"先天六司",-1)),(0,a.createElementVNode)("div",Tp,[v.value.角色基础信息.先天六司?((0,a.openBlock)(),(0,a.createBlock)(vd,{key:0,stats:(t=v.value.角色基础信息.先天六司,{root_bone:t["根骨"]||0,spirituality:t["灵性"]||0,comprehension:t["悟性"]||0,fortune:t["气运"]||0,charm:t["魅力"]||0,temperament:t["心性"]||0}),size:150,maxValue:10},null,8,["stats"])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createElementVNode)("div",jp,[n[53]||(n[53]=(0,a.createElementVNode)("h4",null,"天赋神通",-1)),(0,a.createElementVNode)("div",Mp,[v.value.角色基础信息.天赋?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",qp,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(v.value.角色基础信息.天赋,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"talent-tag",title:j(e)},(0,a.toDisplayString)(T(e)),9,Op))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("span",Pp,"暂无天赋"))])])])])):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0)],2);var t}}});var Lp=t(2614),Yp={};Yp.styleTagTransform=A(),Yp.setAttributes=z(),Yp.insert=V().bind(null,"head"),Yp.domAPI=N(),Yp.insertStyleElement=B(),k()(Lp.A,Yp),Lp.A&&Lp.A.locals&&Lp.A.locals;const Rp=(0,j.A)(Fp,[["__scopeId","data-v-fd2fc302"]]),Up={key:0,class:"error-boundary"},Gp={class:"error-container"},Wp={class:"error-message"},Jp={key:0,class:"error-details"},Hp={class:"error-actions"},Qp=(0,a.defineComponent)({__name:"ErrorBoundary",setup(e){const n=(0,r.useRouter)(),t=(0,a.ref)(!1),o=(0,a.ref)(""),l=(0,a.ref)(""),i=(0,a.ref)(!1);(0,a.onErrorCaptured)((e,n,a)=>(console.error("[错误边界] 捕获到错误:",e),console.error("[错误边界] 组件信息:",a),t.value=!0,o.value=e.message||"未知错误",l.value=`\n错误: ${e.name}: ${e.message}\n堆栈: ${e.stack||"无堆栈信息"}\n组件: ${a}\n  `.trim(),!1));const c=()=>{t.value=!1,o.value="",l.value="",i.value=!1,n.go(0)},s=()=>{t.value=!1,n.back()},d=()=>{i.value=!i.value};return(e,n)=>t.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Up,[(0,a.createElementVNode)("div",Gp,[n[0]||(n[0]=(0,a.createElementVNode)("div",{class:"error-icon"},"⚠️",-1)),n[1]||(n[1]=(0,a.createElementVNode)("h2",null,"道法受阻",-1)),(0,a.createElementVNode)("p",Wp,(0,a.toDisplayString)(o.value),1),i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Jp,[(0,a.createElementVNode)("pre",null,(0,a.toDisplayString)(l.value),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Hp,[(0,a.createElementVNode)("button",{onClick:c,class:"btn-retry"},"重试"),(0,a.createElementVNode)("button",{onClick:s,class:"btn-back"},"返回"),(0,a.createElementVNode)("button",{onClick:d,class:"btn-details"},(0,a.toDisplayString)(i.value?"隐藏详情":"查看详情"),1)])])])):(0,a.renderSlot)(e.$slots,"default",{key:1})}});var Kp=t(9376),Xp={};Xp.styleTagTransform=A(),Xp.setAttributes=z(),Xp.insert=V().bind(null,"head"),Xp.domAPI=N(),Xp.insertStyleElement=B(),k()(Kp.A,Xp),Kp.A&&Kp.A.locals&&Kp.A.locals;const Zp=(0,j.A)(Qp,[["__scopeId","data-v-31d28cfa"]]);var ev=t(4986);const nv={class:"game-view"},tv={class:"sidebar-wrapper"},av={width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ov=["points"],rv={class:"main-content"},lv={key:0,class:"panel-overlay"},iv={class:"panel-header compact","aria-label":"功能面板导航"},cv={class:"panel-title-compact"},sv={class:"title-text"},dv={class:"panel-actions"},mv=["title","onClick","aria-label"],pv={class:"panel-content compact"},vv={key:2,class:"panel-overlay"},uv={class:"panel-header"},gv={class:"panel-title"},fv={class:"panel-content"},bv={width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},hv=["points"],yv={class:"sidebar-wrapper"},xv=(0,a.defineComponent)({__name:"GameView",setup(e){const n=(0,tn.useCharacterStore)(),o=(0,q.useUIStore)(),l=(0,r.useRouter)(),i=(0,r.useRoute)(),c=(0,a.ref)(!1),s=(0,a.ref)(!1),d=(0,a.ref)(!1),m=()=>{d.value=window.innerWidth<=768,d.value&&(c.value=!0,s.value=!0)},p=new Set(["Inventory","CharacterDetails","Memory","Relationships","Cultivation","Techniques","ThousandDao","Settings","Save","WorldMap","Quests","Sect","TavernData"]),v=new Set(["Memory","Relationships","Cultivation","Techniques","ThousandDao","Settings","Save","Sect"]),u={Inventory:{title:"背包物品",icon:Ei},CharacterDetails:{title:"人物详情",icon:Vi},Memory:{title:"记忆中心",icon:Ci},Relationships:{title:"人物关系",icon:zi},Cultivation:{title:"修炼系统",icon:Si},Techniques:{title:"修炼功法",icon:Bi},ThousandDao:{title:"三千大道",icon:Di},Settings:{title:"系统设置",icon:Wn},Save:{title:"保存游戏",icon:Ai},WorldMap:{title:"世界地图",icon:_i},Quests:{title:"任务系统",icon:Di},Sect:{title:"宗门势力",icon:$i},TavernData:{title:"酒馆数据",icon:Ii}},g=(0,a.computed)(()=>p.has(String(i.name))),f=(0,a.computed)(()=>{const e=String(i.name),n=u[e];return n?.title||"功能面板"}),b=(0,a.computed)(()=>{const e=String(i.name),n=u[e];return n?.icon||Ti}),h=()=>{"GameMain"!==i.name&&l.push("/game")},y={Memory:[{key:"refresh",title:"刷新",icon:te,action:"refresh"},{key:"test",title:"测试转化",icon:ji,action:"test"},{key:"clear",title:"清理",icon:Gn.A,action:"clear"}],Quests:[{key:"refresh",title:"刷新",icon:te,action:"refresh"}],Save:[{key:"refresh",title:"刷新",icon:te,action:"refresh"},{key:"save",title:"快速存档",icon:Ai,action:"save"}],ThousandDao:[{key:"refresh",title:"刷新",icon:te,action:"refresh"}],TavernData:[{key:"refresh",title:"刷新数据",icon:te,action:"refresh"},{key:"export",title:"导出JSON",icon:Ai,action:"export"},{key:"stats",title:"数据统计",icon:Mi,action:"stats"}]},x=(0,a.computed)(()=>{const e=String(i.name);return(y[e]||[]).map(e=>({key:e.key,title:e.title,icon:e.icon,onClick:()=>Oi.emit(e.action)}))}),k=(0,a.computed)(()=>!!n.activeCharacterProfile);return(0,a.onMounted)(async()=>{(()=>{try{const e=localStorage.getItem("dad_game_settings");if(e){const n=JSON.parse(e);if(n.uiScale){const e=n.uiScale/100;document.documentElement.style.setProperty("--ui-scale",e.toString())}if(n.fontSize){const e={small:"0.875rem",medium:"1rem",large:"1.125rem"}[n.fontSize]||"1rem";document.documentElement.style.setProperty("--base-font-size",e)}if(n.theme){let e=n.theme;"auto"===n.theme&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme",e)}}}catch(e){console.error("[GameView] 应用设置失败:",e)}})(),m(),window.addEventListener("resize",m);try{const e=(0,an.getTavernHelper)();if(e){const n=await e.getVariables({type:"chat"}),{assembleSaveData:a}=await Promise.resolve().then(t.bind(t,9808)),o=a(n),r=n["基础信息"];o&&r&&(await(0,ev.syncHeavenlyPrecalcToTavern)(o,r),console.log("[GameView] 已刷新天道演算预计算"))}}catch(e){console.warn("[GameView] 刷新天道演算失败（忽略）：",e)}}),(0,a.onBeforeUnmount)(()=>{window.removeEventListener("resize",m)}),(0,a.watch)(g,e=>{if(e){const e=String(i.name);d.value&&(c.value=!0),v.has(e)&&(s.value=!0)}}),(e,n)=>{const t=(0,a.resolveComponent)("router-view");return(0,a.openBlock)(),(0,a.createElementBlock)("div",nv,[(0,a.createCommentVNode)(" 顶部栏 "),(0,a.createVNode)(ac),(0,a.createCommentVNode)(" 主要内容区域 "),k.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:(0,a.normalizeClass)(["game-content",{"panel-mode":g.value}])},[(0,a.createCommentVNode)(" 左侧功能栏 "),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["left-sidebar",{collapsed:c.value}])},[(0,a.createElementVNode)("div",tv,[(0,a.createVNode)(qc,{collapsed:c.value},null,8,["collapsed"])])],2),(0,a.createCommentVNode)(" 左侧收缩按钮 "),(0,a.withDirectives)((0,a.createElementVNode)("button",{class:"collapse-btn left",onClick:n[0]||(n[0]=e=>c.value=!c.value)},[((0,a.openBlock)(),(0,a.createElementBlock)("svg",av,[(0,a.createElementVNode)("polyline",{points:c.value?"9,18 15,12 9,6":"15,18 9,12 15,6"},null,8,ov)]))],512),[[a.vShow,!g.value]]),(0,a.createCommentVNode)(" 主游戏区域 "),(0,a.createElementVNode)("div",rv,[(0,a.createCommentVNode)(" 功能面板覆盖层 "),g.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",lv,[(0,a.createElementVNode)("div",iv,[(0,a.createElementVNode)("button",{class:"back-btn",onClick:h,title:"返回对话","aria-label":"返回对话"},n[3]||(n[3]=[(0,a.createElementVNode)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,a.createElementVNode)("polyline",{points:"15 18 9 12 15 6"})],-1)])),(0,a.createElementVNode)("div",cv,[((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(b.value),{size:16,class:"panel-title-icon"})),(0,a.createElementVNode)("span",sv,(0,a.toDisplayString)(f.value),1)]),(0,a.createElementVNode)("div",dv,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e.key,class:"action-btn-compact",title:e.title,onClick:e.onClick,"aria-label":e.title},[((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(e.icon),{size:14}))],8,mv))),128))])]),(0,a.createElementVNode)("div",pv,[((0,a.openBlock)(),(0,a.createBlock)(a.KeepAlive,null,[(0,a.createVNode)(t)],1024))])])):(0,a.unref)(o).showCharacterManagement?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 正常路由视图 "),((0,a.openBlock)(),(0,a.createBlock)(a.KeepAlive,null,[(0,a.createVNode)(t)],1024))],2112)),(0,a.createCommentVNode)(" 角色管理面板 "),(0,a.unref)(o).showCharacterManagement?((0,a.openBlock)(),(0,a.createElementBlock)("div",vv,[(0,a.createElementVNode)("div",uv,[(0,a.createElementVNode)("h2",gv,[(0,a.createVNode)((0,a.unref)(qi),{size:20,class:"panel-title-icon"}),n[4]||(n[4]=(0,a.createTextVNode)(" 角色管理 ",-1))]),(0,a.createElementVNode)("button",{class:"panel-close-btn",onClick:n[1]||(n[1]=e=>(0,a.unref)(o).closeCharacterManagement()),title:"关闭面板"},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",fv,[(0,a.createVNode)(Rp,{onBack:(0,a.unref)(o).closeCharacterManagement},null,8,["onBack"])])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 右侧收缩按钮 "),(0,a.withDirectives)((0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["collapse-btn right",{collapsed:s.value}]),onClick:n[2]||(n[2]=e=>s.value=!s.value)},[((0,a.openBlock)(),(0,a.createElementBlock)("svg",bv,[(0,a.createElementVNode)("polyline",{points:s.value?"15,18 9,12 15,6":"9,18 15,12 9,6"},null,8,hv)]))],2),[[a.vShow,!g.value]]),(0,a.createCommentVNode)(" 右侧区域: 角色信息栏 "),(0,a.withDirectives)((0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["right-panel-area",{collapsed:s.value}])},[(0,a.createElementVNode)("div",yv,[(0,a.createVNode)(Zp,null,{default:(0,a.withCtx)(()=>[(0,a.createVNode)(ed)]),_:1})])],2),[[a.vShow,!g.value]])],2)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 数据未就绪时的提示 "),n[5]||(n[5]=(0,a.createStaticVNode)('<div class="data-loading" data-v-61af6578><div class="loading-content" data-v-61af6578><div class="loading-spinner-wrapper" data-v-61af6578><div class="loading-spinner" data-v-61af6578></div><div class="spinner-glow" data-v-61af6578></div></div><h2 class="loading-title" data-v-61af6578>道法自然，天地初开</h2><p class="loading-message" data-v-61af6578>正在加载修仙世界...</p><div class="loading-steps" data-v-61af6578><div class="loading-step" data-v-61af6578><span class="step-icon" data-v-61af6578>✓</span><span class="step-text" data-v-61af6578>连接天道</span></div><div class="loading-step" data-v-61af6578><span class="step-icon" data-v-61af6578>✓</span><span class="step-text" data-v-61af6578>加载角色数据</span></div><div class="loading-step active" data-v-61af6578><span class="step-icon" data-v-61af6578>○</span><span class="step-text" data-v-61af6578>读取存档信息</span></div></div><p class="loading-hint" data-v-61af6578>提示：请在左侧菜单选择角色并加载存档</p></div></div>',1))],2112))])}}});var kv=t(1591),wv={};wv.styleTagTransform=A(),wv.setAttributes=z(),wv.insert=V().bind(null,"head"),wv.domAPI=N(),wv.insertStyleElement=B(),k()(kv.A,wv),kv.A&&kv.A.locals&&kv.A.locals;const Nv=(0,j.A)(xv,[["__scopeId","data-v-61af6578"]]),Ev=(0,c.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Vv=(0,c.A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Cv=(0,c.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),zv=(0,c.A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var Sv=t(3310);class Bv{static instance=null;undoActions=[];storageKey="dao_undo_actions";constructor(){this.loadUndoHistoryFromStorage()}static getInstance(){return this.instance||(this.instance=new Bv),this.instance}async equipItem(e){const n=(0,tn.useCharacterStore)(),t=(0,Sv.useActionQueueStore)();try{const a=n.activeSaveSlot?.存档数据;if(!a)return d.o.error("存档数据不存在，无法装备"),!1;a.装备栏||(a.装备栏={装备1:null,装备2:null,装备3:null,装备4:null,装备5:null,装备6:null});const o=a.背包?.物品;if(!o||"object"!=typeof o)return d.o.error("背包数据异常"),!1;const r=o[e.物品ID];if(r&&!0===r.已装备)return d.o.info(`《${e.名称}》已经装备在身上了`),!1;this.removeConflictingActions(e.物品ID,"unequip");let l=null,i=null;for(let e=1;e<=6;e++){const n=`装备${e}`,t=a.装备栏[n];if(!t||null===t){l=n;break}}if(!l){l="装备1";const e=l,n=a.装备栏[e];n&&"object"==typeof n&&"物品ID"in n&&(i=o[n.物品ID]||null,i&&(i.已装备=!1))}a.装备栏[l]={物品ID:e.物品ID,名称:e.名称},r&&(o[e.物品ID]={...r,已装备:!0}),console.log("装备操作完成:",{槽位:l,物品:e,装备栏状态:a.装备栏}),await n.commitToStorage(),await this.syncEquipmentToTavern(a);const c={type:"equip",itemId:e.物品ID,itemName:e.名称,restoreData:{originalSlot:null,replacedItem:i}};return this.undoActions.push(c),this.saveUndoHistoryToStorage(),t.addAction({type:"equip",itemName:e.名称,itemType:e.类型,description:i?`装备了《${e.名称}》，替换了《${i.名称}》`:`装备了《${e.名称}》`}),!0}catch(e){return console.error("装备物品失败:",e),d.o.error("装备失败"),!1}}async unequipItem(e){const n=(0,tn.useCharacterStore)(),t=(0,Sv.useActionQueueStore)();try{const a=n.activeSaveSlot?.存档数据;if(!a||!a.装备栏)return d.o.error("装备栏数据不存在"),!1;const o=a.背包?.物品;if(!o||"object"!=typeof o)return d.o.error("背包数据异常"),!1;const r=o[e.物品ID];if(!r||!0!==r.已装备){d.o.info(`《${e.名称}》未装备，无法卸下`);let t=!1;for(let n=1;n<=6;n++){const o=`装备${n}`,r=a.装备栏[o];r&&"object"==typeof r&&r.物品ID===e.物品ID&&(a.装备栏[o]=null,t=!0)}return t&&await n.commitToStorage(),!1}this.removeConflictingActions(e.物品ID,"equip");let l=null;for(let n=1;n<=6;n++){const t=`装备${n}`,o=a.装备栏[t];if(o&&"object"==typeof o&&"物品ID"in o&&o.物品ID===e.物品ID){l=t;break}}if(!l)return d.o.error("装备栏中未找到该装备，数据可能不一致"),a.背包?.物品?.[e.物品ID]&&(a.背包.物品[e.物品ID].已装备=!1),await n.commitToStorage(),!0;a.装备栏[l]=null,r?(o[e.物品ID]={...r,已装备:!1},console.log("卸下装备完成:",{物品:e.名称,物品ID:e.物品ID,清空槽位:l,已装备状态:!1})):console.warn("背包中未找到物品:",e.物品ID),await n.commitToStorage(),await this.syncEquipmentToTavern(a);const i={type:"unequip",itemId:e.物品ID,itemName:e.名称,restoreData:{originalSlot:l}};return this.undoActions.push(i),this.saveUndoHistoryToStorage(),t.addAction({type:"unequip",itemName:e.名称,itemType:e.类型,description:`卸下了《${e.名称}》`}),!0}catch(e){return console.error("卸下装备失败:",e),d.o.error("卸下失败"),!1}}async useItem(e,n=1){const t=(0,tn.useCharacterStore)(),a=(0,Sv.useActionQueueStore)();try{const o=t.activeSaveSlot?.存档数据;if(!o)return d.o.error("存档数据不存在"),!1;const r=o.背包?.物品?.[e.物品ID];if(!r||r.数量<n)return d.o.error("物品数量不足"),!1;const l=r.数量,i=JSON.parse(JSON.stringify(r));r.数量===n?delete o.背包.物品[e.物品ID]:r.数量-=n,await t.commitToStorage(),await this.syncInventoryToTavern(o);const c={type:"use",itemId:e.物品ID,itemName:e.名称,quantity:n,restoreData:{originalQuantity:l},itemData:i};this.undoActions.push(c),this.saveUndoHistoryToStorage();const s="其他"===e.类型&&"使用效果"in e?e.使用效果:e.描述||"无特殊效果";return a.addAction({type:"use",itemName:e.名称,itemType:e.类型,description:`使用了 ${n} 个《${e.名称}》（效果：${s}）`}),!0}catch(e){return console.error("使用物品失败:",e),d.o.error("使用失败"),!1}}async cultivateItem(e){const n=(0,tn.useCharacterStore)(),t=(0,Sv.useActionQueueStore)();try{const a=n.activeSaveSlot?.存档数据;if(!a)return d.o.error("存档数据不存在，无法修炼功法"),!1;if("功法"!==e.类型)return d.o.error("只能修炼功法类物品"),!1;const o=a.背包?.物品;if(!o||"object"!=typeof o)return d.o.error("背包数据异常"),!1;let r=null;const l=a.修炼功法;if(l&&l.物品ID!==e.物品ID){r={...l};const e=l.物品ID,n=o[e];n&&"功法"===n.类型&&(o[e]={...n,已装备:!1,修炼中:!1})}const i=o[e.物品ID];if(!i||"功法"!==i.类型)return d.o.error("物品不是功法类型"),!1;a.修炼功法={...i,熟练度:l?.熟练度||0,已解锁技能:l?.已解锁技能||[],修炼时间:l?.修炼时间||0,突破次数:l?.突破次数||0,正在修炼:!0,修炼进度:l?.修炼进度||0},o[e.物品ID]={...i,已装备:!0,修炼中:!0},await n.commitToStorage(),await this.syncCultivationToTavern(a);const c={type:"cultivate",itemId:e.物品ID,itemName:e.名称,restoreData:{originalCultivationState:{previousTechnique:r,wasInInventory:!0}}};return this.undoActions.push(c),this.saveUndoHistoryToStorage(),t.addAction({type:"cultivate",itemName:e.名称,itemType:e.类型,description:r?`开始修炼《${e.名称}》功法，停止修炼《${r.名称}》`:`开始修炼《${e.名称}》功法`}),!0}catch(e){return console.error("修炼功法失败:",e),d.o.error("修炼功法失败"),!1}}async stopCultivation(e){const n=(0,tn.useCharacterStore)(),t=(0,Sv.useActionQueueStore)();try{const a=n.activeSaveSlot?.存档数据;if(!a?.修炼功法||!a.修炼功法.正在修炼)return d.o.error("当前没有正在修炼的功法"),!1;const o=a.修炼功法,r=o.物品ID;if(o.名称!==e.名称)return d.o.error("操作的功法与当前修炼的功法不符"),!1;const l=a.背包?.物品;if(!l||"object"!=typeof l)return d.o.error("背包数据异常"),!1;const i=l[r];a.修炼功法=null,i&&"功法"===i.类型&&(l[r]={...i,已装备:!1,修炼中:!1}),await n.commitToStorage(),await this.syncCultivationToTavern(a);const c={type:"cultivate",itemId:e.物品ID,itemName:e.名称,restoreData:{originalCultivationState:{previousTechnique:o?{...o}:null,wasInInventory:!1}}};return this.undoActions.push(c),this.saveUndoHistoryToStorage(),t.addAction({type:"stop_cultivation",itemName:e.名称,itemType:e.类型,description:`停止修炼《${e.名称}》功法`}),!0}catch(e){return console.error("停止修炼失败:",e),d.o.error("停止修炼失败"),!1}}async undoLastAction(){if(0===this.undoActions.length)return d.o.info("未找到可撤回的动作记录，可能已清空或刷新后丢失"),!1;const e=this.undoActions.pop();this.saveUndoHistoryToStorage();const n=(0,tn.useCharacterStore)(),t=(0,Sv.useActionQueueStore)();try{const a=n.activeSaveSlot?.存档数据;if(!a)return d.o.error("存档数据不存在"),!1;switch(e.type){case"equip":await this.undoEquip(e,a);break;case"unequip":await this.undoUnequip(e);break;case"use":await this.undoUse(e,a);break;case"cultivate":await this.undoCultivate(e,a)}const o=t.pendingActions;for(let n=o.length-1;n>=0;n--)if(o[n].itemName===e.itemName&&o[n].type===e.type){t.removeAction(o[n].id);break}return!0}catch(e){return console.error("撤回动作失败:",e),d.o.error("撤回失败"),!1}}async undoByItemName(e,n){if(0===this.undoActions.length)return d.o.info("未找到可撤回的动作记录，可能已清空或刷新后丢失"),!1;let t=-1;for(let a=this.undoActions.length-1;a>=0;a--){const o=this.undoActions[a];if(o.type===e&&o.itemName===n){t=a;break}}if(-1===t)return d.o.info("未找到该动作的撤回记录"),!1;const a=this.undoActions.splice(t,1)[0];this.saveUndoHistoryToStorage();try{const t=(0,tn.useCharacterStore)(),o=t.activeSaveSlot?.存档数据;if(!o)return d.o.error("当前存档不存在，无法撤回"),!1;switch(a.type){case"equip":await this.undoEquip(a,o);break;case"unequip":await this.undoUnequip(a);break;case"use":await this.undoUse(a,o);break;case"cultivate":await this.undoCultivate(a,o)}const r=(0,Sv.useActionQueueStore)(),l=r.pendingActions;for(let t=l.length-1;t>=0;t--)if(l[t].itemName===n&&l[t].type===e){r.removeAction(l[t].id);break}return await(0,tn.useCharacterStore)().commitToStorage(),!0}catch(e){return console.error("按名称撤回失败:",e),d.o.error("撤回失败"),!1}}async undoEquip(e,n){for(let t=1;t<=6;t++){const a=`装备${t}`,o=n.装备栏[a];if(o&&"object"==typeof o&&"物品ID"in o&&o.物品ID===e.itemId){if(n.装备栏[a]=null,n.背包?.物品?.[e.itemId]){const t=n.背包.物品[e.itemId];n.背包.物品[e.itemId]={...t,已装备:!1}}if(e.restoreData?.replacedItem&&(n.装备栏[a]={物品ID:e.restoreData.replacedItem.物品ID,名称:e.restoreData.replacedItem.名称},n.背包?.物品?.[e.restoreData.replacedItem.物品ID])){const t=n.背包.物品[e.restoreData.replacedItem.物品ID];n.背包.物品[e.restoreData.replacedItem.物品ID]={...t,已装备:!0}}await this.syncEquipmentToTavern(n);break}}}removeUndoAction(e,n){const t=this.undoActions.findIndex(t=>t.type===e&&t.itemName===n);-1!==t&&(this.undoActions.splice(t,1),this.saveUndoHistoryToStorage(),console.log("[撤销历史] 移除了一个已抵消的动作:",{type:e,itemName:n}))}async undoUnequip(e){e.restoreData?.originalSlot&&d.o.warning("装备撤回功能受限，卸下的装备无法完全恢复")}async undoUse(e,n){e.itemData?(n.背包||(n.背包={物品:{},灵石:{下品:0,中品:0,上品:0,极品:0}}),n.背包.物品||(n.背包.物品={}),n.背包.物品[e.itemId]=JSON.parse(JSON.stringify(e.itemData))):d.o.warning("物品已完全消失，且无备份数据，无法恢复")}async undoCultivate(e,n){const t=e.restoreData?.originalCultivationState;if(!t)return;const a=n.背包?.物品;if(a&&"object"==typeof a){if(t.previousTechnique){const e=t.previousTechnique.物品ID;n.修炼功法={...t.previousTechnique};const o=a[e];o&&"功法"===o.类型&&(a[e]={...o,已装备:!0,修炼中:!0})}else n.修炼功法=null;await this.syncCultivationToTavern(n)}else console.error("背包数据异常，无法撤回修炼")}clearUndoHistory(){this.undoActions=[],this.saveUndoHistoryToStorage()}getUndoActionsCount(){return this.undoActions.length}removeConflictingActions(e,n){const t=(0,Sv.useActionQueueStore)(),a=t.pendingActions.filter(t=>t.itemName&&t.type===n&&this.findItemByName(t.itemName)?.物品ID===e);a.forEach(e=>{t.removeAction(e.id)}),this.undoActions=this.undoActions.filter(t=>!(t.itemId===e&&t.type===n)),this.saveUndoHistoryToStorage(),a.length>0&&d.o.info("已移除冲突的操作")}findItemByName(e){const n=(0,tn.useCharacterStore)(),t=n.activeSaveSlot?.存档数据;if(!t)return null;if(t.背包?.物品)for(const n of Object.values(t.背包.物品))if(n&&"object"==typeof n&&n.名称===e)return n;if(t.装备栏)for(let n=1;n<=6;n++){const a=`装备${n}`,o=t.装备栏[a];if(o&&"object"==typeof o&&"名称"in o&&o.名称===e&&t.背包?.物品){const n=Object.values(t.背包.物品).find(n=>n.名称===e);if(n)return n}}return null}async syncEquipmentToTavern(e){try{const n=(0,an.getTavernHelper)();if(!n)return void console.warn("[装备同步] 酒馆助手不可用，跳过同步");const{calculateEquipmentBonuses:a}=await Promise.resolve().then(t.bind(t,6728)),o=e.装备栏&&e.背包?a(e.装备栏,e.背包):{根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0};e.角色基础信息&&(e.角色基础信息.后天六司=o,console.log("[装备同步] 更新后天六司:",o));const{deepCleanForClone:r}=await Promise.resolve().then(t.bind(t,3098)),l=r({装备栏:e.装备栏,角色基础信息:e.角色基础信息});await n.insertOrAssignVariables(l,{type:"chat"}),console.log("[装备同步] 装备栏和后天六司已同步到酒馆变量")}catch(e){console.warn("[装备同步] 同步装备栏到酒馆变量失败:",e)}}async syncCultivationToTavern(e){try{const n=(0,an.getTavernHelper)();if(!n)return void console.warn("[修炼同步] 酒馆助手不可用，跳过同步");const a=e.修炼功法?{...e.修炼功法,熟练度:e.修炼功法.熟练度||0,已解锁技能:e.修炼功法.已解锁技能||[],修炼时间:e.修炼功法.修炼时间||0,突破次数:e.修炼功法.突破次数||0,正在修炼:e.修炼功法.正在修炼||!1,修炼进度:e.修炼功法.修炼进度||0}:null,{deepCleanForClone:o}=await Promise.resolve().then(t.bind(t,3098)),r=o({修炼功法:a});await n.insertOrAssignVariables(r,{type:"chat"}),console.log("[修炼同步] 修炼功法已同步到酒馆变量")}catch(e){console.warn("[修炼同步] 同步修炼功法到酒馆变量失败:",e)}}async syncInventoryToTavern(e){try{const n=(0,an.getTavernHelper)();if(!n)return void console.warn("[背包同步] 酒馆助手不可用，跳过同步");const{deepCleanForClone:a}=await Promise.resolve().then(t.bind(t,3098)),o=a({背包:e.背包});await n.insertOrAssignVariables(o,{type:"chat"}),console.log("[背包同步] 背包已同步到酒馆变量")}catch(e){console.warn("[背包同步] 同步背包到酒馆变量失败:",e)}}saveUndoHistoryToStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.undoActions))}catch(e){console.warn("[撤回历史] 保存失败:",e)}}loadUndoHistoryFromStorage(){try{const e=localStorage.getItem(this.storageKey);if(e){const n=JSON.parse(e);Array.isArray(n)&&(this.undoActions=n)}}catch(e){console.warn("[撤回历史] 加载失败:",e)}}}var Dv=t(7181),Av=t(8587);class _v{static instance=null;stateHistory=[];constructor(){}static getInstance(){return this.instance||(this.instance=new _v),this.instance}async processPlayerAction(e,n,a,o){let r=null;try{r=(0,an.getTavernHelper)()}catch{const e="当下灵机未至（未连接酒馆环境），请稍后再试。";return o?.onStreamChunk?.(e),{finalContent:e}}o?.onProgressUpdate?.("获取当前状态快照…");const l=await this.captureCurrentState(r);let i;o?.onProgressUpdate?.("构建提示词并请求AI生成…");try{const t=e&&e.toString().trim()||"继续当前活动",r=this.buildGameStateData(n,a,t);if(i=await(0,Dv.Ez)(r,t,o?.useStreaming),!i||!i.text)throw new Error("AI生成器返回了无效的响应")}catch(e){throw console.error("[AI双向系统] AI生成失败:",e),d.o.error("天机推演失败，请稍后重试。"),e instanceof Error?e:new Error(String(e))}let c=null;if(i.tavern_commands&&i.tavern_commands.length>0){o?.onProgressUpdate?.("执行AI指令并更新游戏状态…");try{const e=await(0,Av.hy)("chat");if(e){const n=await(0,Av.Dj)(i,e),a=n.saveData;c=n.stateChanges;const{shardSaveData:o,saveAllShards:l}=await Promise.resolve().then(t.bind(t,9808)),s=o(a);await l(s,r),console.log("[AI双向系统] ✅ 已将命令执行后的SaveData同步到酒馆分片");const{useCharacterStore:d}=await Promise.resolve().then(t.bind(t,948)),m=d();await m.updateSaveDataDirectly(a),console.log("[AI双向系统] ✅ 已将命令执行后的SaveData更新到Store，UI将实时响应")}else console.warn("[AI双向系统] 无法获取SaveData，跳过指令执行");const n=await this.captureCurrentState(r);c=this.generateStateChangeLogFromCommands(i.tavern_commands,l,n),console.log("[AI双向系统] ===== 状态变更详情 ====="),console.log("[AI双向系统] 命令数量:",i.tavern_commands.length),console.log("[AI双向系统] 检测到的变更数量:",c.changes.length),console.log("[AI双向系统] 变更详情:",JSON.stringify(c.changes,null,2)),console.log("[AI双向系统] beforeState 分片数:",Object.keys(l).length),console.log("[AI双向系统] afterState 分片数:",Object.keys(n).length),console.log("[AI双向系统] ========================"),o?.onStateChange&&c.changes.length>0&&o.onStateChange(n)}catch(e){console.error("[AI双向系统] 执行AI指令失败:",e),d.o.warning(`部分指令执行失败: ${e instanceof Error?e.message:String(e)}`)}}const s=i.text;return o?.onStreamChunk?.(s),c&&(this.stateHistory.push(c),this.stateHistory.length>50&&(this.stateHistory=this.stateHistory.slice(-30))),{finalContent:s,gmResponse:i,stateChanges:c}}async captureCurrentState(e){try{return await e.getVariables({type:"chat"})||{}}catch(e){return console.warn("[AI双向系统] 获取状态快照失败:",e),{}}}buildGameStateData(e,n,t){const a=(0,tn.useCharacterStore)(),o=a.activeSaveSlot?.存档数据;return{character:e,saveData:o,gameState:n,playerAction:t,timestamp:(new Date).toISOString()}}generateStateChangeLogFromCommands(e,n,t){const a=[];console.log("[状态变更] ===== 开始生成变更日志 ====="),console.log("[状态变更] 总命令数:",e.length);for(const o of e){if(!o||!o.action||!o.key){console.log("[状态变更] ⚠️ 跳过无效命令:",o);continue}const e=o.key,r=o.action,l=this.getNestedValue(n,e),i=this.getNestedValue(t,e);console.log(`[状态变更] 检查命令: ${r} "${e}"`),console.log("[状态变更]   oldValue:",l),console.log("[状态变更]   newValue:",i),JSON.stringify(l)!==JSON.stringify(i)?(a.push({key:e,action:r,oldValue:l,newValue:i}),console.log("[状态变更]   ✅ 检测到变更")):console.log("[状态变更]   ⏭️ 值未变化，跳过")}return console.log("[状态变更] ===== 变更日志生成完成 ====="),console.log("[状态变更] 最终变更数量:",a.length),{before:n,after:t,changes:a,timestamp:(new Date).toISOString()}}getNestedValue(e,n){if(!e||"object"!=typeof e)return;const t=n.split(".");let a=e;for(const e of t){if(!a||"object"!=typeof a||!(e in a))return;a=a[e]}return a}}const $v=_v,Iv={class:"formatted-text"},Tv={class:"card-icon"},jv={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Mv={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},qv={key:2,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ov={class:"card-content"},Pv={class:"card-header"},Fv={class:"judgement-title"},Lv={class:"header-right"},Yv={class:"judgement-badge"},Rv={class:"card-body"},Uv={class:"stat-item"},Gv={class:"stat-info"},Wv={class:"stat-value"},Jv={key:0,class:"stat-item"},Hv={class:"stat-info"},Qv={class:"stat-value"},Kv={key:1,class:"stat-item"},Xv={class:"stat-info"},Zv={class:"stat-value"},eu={key:2,class:"stat-item"},nu={class:"stat-info"},tu={class:"stat-value"},au={key:3,class:"stat-item"},ou={class:"stat-info"},ru={class:"stat-value"},lu={key:4,class:"details-list"},iu=(0,a.defineComponent)({__name:"FormattedText",props:{text:{}},setup(e){const n=(0,a.ref)(!1),t=()=>{n.value=!0},o=()=>{n.value=!1},r=e,l=(0,a.computed)(()=>{const e=[],n=r.text||"";if(!n.trim())return[{type:"normal",content:n}];let t=0;const a=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n");for(;t<a.length;){const n=[],o=a.indexOf("【",t);if(-1!==o){const e=a.indexOf("】",o+1);-1!==e&&n.push({start:o,end:e+1,type:"environment",contentStart:o+1,contentEnd:e})}const r=a.indexOf("`",t);if(-1!==r){const e=a.indexOf("`",r+1);-1!==e&&n.push({start:r,end:e+1,type:"psychology",contentStart:r+1,contentEnd:e})}const l=a.indexOf('"',t);if(-1!==l){const e=a.indexOf('"',l+1);-1!==e&&n.push({start:l,end:e+1,type:"dialogue",contentStart:l+1,contentEnd:e})}const i=a.indexOf("“",t);if(-1!==i){const e=a.indexOf("”",i+1);-1!==e&&n.push({start:i,end:e+1,type:"quote",contentStart:i,contentEnd:e+1})}const c=a.indexOf("「",t);if(-1!==c){const e=a.indexOf("」",c+1);-1!==e&&n.push({start:c,end:e+1,type:"dialogue",contentStart:c,contentEnd:e+1})}const s=a.indexOf("〖",t);if(-1!==s){const e=a.indexOf("〗",s+1);-1!==e&&n.push({start:s,end:e+1,type:"judgement",contentStart:s+1,contentEnd:e})}const d=n.filter(e=>e.start>=t&&e.contentStart<e.contentEnd).sort((e,n)=>e.start-n.start);if(0===d.length){t<a.length&&e.push({type:"normal",content:a.slice(t)});break}const m=d[0];if(m.start>t){const n=a.slice(t,m.start);n&&e.push({type:"normal",content:n})}const p=a.slice(m.contentStart,m.contentEnd);if(p.trim())if("judgement"===m.type){const n=p.split(",").map(e=>e.trim());if(n.length>=1){const t=n[0].split(":");if(2===t.length){const a={title:t[0].trim(),result:t[1].trim(),dice:"未知",attribute:"",details:[]};for(let e=1;e<n.length;e++){const t=n[e],[o,r]=t.split(":").map(e=>e.trim());o&&r&&(o.includes("骰点")||o.includes("骰子")?a.dice=r:o.includes("难度")?a.difficulty=r:o.includes("加成")?a.bonus=r:o.includes("最终值")||o.includes("总值")?a.finalValue=r:o.match(/^[^\d\s]+$/)?a.attribute?a.details.push(`${o}:${r}`):a.attribute=`${o}:${r}`:a.details.push(t))}e.push({type:"judgement-card",content:a})}else e.push({type:"normal",content:`〖${p}〗`})}else e.push({type:"normal",content:`〖${p}〗`})}else e.push({type:m.type,content:a.slice(m.start,m.end)});t=m.end}return e.length>0?e:[{type:"normal",content:n}]}),i=e=>["成功","大成功","完美","通过"].includes(e),c=e=>["失败","大失败","失败惨重","未通过"].includes(e);return(e,r)=>((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",Iv,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value,(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:n},["judgement-card"!==e.type?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)((l=e.type,{"text-environment":"environment"===l,"text-psychology":"psychology"===l,"text-dialogue":"dialogue"===l,"text-quote":"quote"===l,"text-normal":"normal"===l}))},(0,a.toDisplayString)(e.content),3)):(o=e.content,"object"==typeof o&&null!==o&&"title"in o?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:(0,a.normalizeClass)(["judgement-card",{"is-success":i(e.content.result),"is-failure":c(e.content.result),"is-great-success":e.content.result?.includes("大成功"),"is-great-failure":e.content.result?.includes("大失败")}])},[(0,a.createElementVNode)("div",Tv,[i(e.content.result)?((0,a.openBlock)(),(0,a.createElementBlock)("svg",jv,r[1]||(r[1]=[(0,a.createElementVNode)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,-1),(0,a.createElementVNode)("polyline",{points:"22 4 12 14.01 9 11.01"},null,-1)]))):c(e.content.result)?((0,a.openBlock)(),(0,a.createElementBlock)("svg",Mv,r[2]||(r[2]=[(0,a.createElementVNode)("circle",{cx:"12",cy:"12",r:"10"},null,-1),(0,a.createElementVNode)("line",{x1:"15",y1:"9",x2:"9",y2:"15"},null,-1),(0,a.createElementVNode)("line",{x1:"9",y1:"9",x2:"15",y2:"15"},null,-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("svg",qv,r[3]||(r[3]=[(0,a.createElementVNode)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},null,-1),(0,a.createElementVNode)("line",{x1:"12",y1:"9",x2:"12",y2:"13"},null,-1),(0,a.createElementVNode)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"},null,-1)])))]),(0,a.createElementVNode)("div",Ov,[(0,a.createElementVNode)("div",Pv,[(0,a.createElementVNode)("span",Fv,(0,a.toDisplayString)(e.content.title),1),(0,a.createElementVNode)("div",Lv,[(0,a.createElementVNode)("span",Yv,(0,a.toDisplayString)(e.content.result),1),(0,a.createElementVNode)("button",{class:"help-btn",onClick:(0,a.withModifiers)(t,["stop"]),title:"查看判定规则"},r[4]||(r[4]=[(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.createElementVNode)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.createElementVNode)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),(0,a.createElementVNode)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)]))])]),(0,a.createElementVNode)("div",Rv,[(0,a.createElementVNode)("div",Uv,[r[6]||(r[6]=(0,a.createElementVNode)("span",{class:"stat-icon"},"🎲",-1)),(0,a.createElementVNode)("div",Gv,[r[5]||(r[5]=(0,a.createElementVNode)("span",{class:"stat-label"},"骰点",-1)),(0,a.createElementVNode)("span",Wv,(0,a.toDisplayString)(e.content.dice),1)])]),e.content.attribute&&"未知属性"!==e.content.attribute?((0,a.openBlock)(),(0,a.createElementBlock)("div",Jv,[r[8]||(r[8]=(0,a.createElementVNode)("span",{class:"stat-icon"},"⚡",-1)),(0,a.createElementVNode)("div",Hv,[r[7]||(r[7]=(0,a.createElementVNode)("span",{class:"stat-label"},"属性",-1)),(0,a.createElementVNode)("span",Qv,(0,a.toDisplayString)(e.content.attribute),1)])])):(0,a.createCommentVNode)("v-if",!0),e.content.bonus?((0,a.openBlock)(),(0,a.createElementBlock)("div",Kv,[r[10]||(r[10]=(0,a.createElementVNode)("span",{class:"stat-icon"},"➕",-1)),(0,a.createElementVNode)("div",Xv,[r[9]||(r[9]=(0,a.createElementVNode)("span",{class:"stat-label"},"加成",-1)),(0,a.createElementVNode)("span",Zv,(0,a.toDisplayString)(e.content.bonus),1)])])):(0,a.createCommentVNode)("v-if",!0),e.content.finalValue?((0,a.openBlock)(),(0,a.createElementBlock)("div",eu,[r[12]||(r[12]=(0,a.createElementVNode)("span",{class:"stat-icon"},"✨",-1)),(0,a.createElementVNode)("div",nu,[r[11]||(r[11]=(0,a.createElementVNode)("span",{class:"stat-label"},"最终值",-1)),(0,a.createElementVNode)("span",tu,(0,a.toDisplayString)(e.content.finalValue),1)])])):(0,a.createCommentVNode)("v-if",!0),e.content.difficulty?((0,a.openBlock)(),(0,a.createElementBlock)("div",au,[r[14]||(r[14]=(0,a.createElementVNode)("span",{class:"stat-icon"},"🎯",-1)),(0,a.createElementVNode)("div",ou,[r[13]||(r[13]=(0,a.createElementVNode)("span",{class:"stat-label"},"难度",-1)),(0,a.createElementVNode)("span",ru,(0,a.toDisplayString)(e.content.difficulty),1)])])):(0,a.createCommentVNode)("v-if",!0),e.content.details&&e.content.details.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",lu,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.content.details,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"detail-item",key:n},(0,a.toDisplayString)(e),1))),128))])):(0,a.createCommentVNode)("v-if",!0)])])],2)):(0,a.createCommentVNode)("v-if",!0))],64);var o,l}),128))]),(0,a.createCommentVNode)(" 判定规则帮助弹窗 "),((0,a.openBlock)(),(0,a.createBlock)(a.Teleport,{to:"body"},[n.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"help-modal-overlay",onClick:o},[(0,a.createElementVNode)("div",{class:"help-modal",onClick:r[0]||(r[0]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",{class:"help-modal-header"},[r[16]||(r[16]=(0,a.createElementVNode)("h3",null,"🎲 判定规则说明",-1)),(0,a.createElementVNode)("button",{class:"close-btn",onClick:o},r[15]||(r[15]=[(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.createElementVNode)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,a.createElementVNode)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)]))]),r[17]||(r[17]=(0,a.createElementVNode)("div",{class:"help-modal-content"},[(0,a.createElementVNode)("div",{class:"help-section"},[(0,a.createElementVNode)("h4",null,"📊 判定计算公式"),(0,a.createElementVNode)("div",{class:"formula-box"},[(0,a.createElementVNode)("strong",null,"判定值"),(0,a.createTextVNode)(" = (先天六司×100% + 后天六司×20%) + 修行状态 + 境界加成 + 装备 + 功法 + 状态效果 ")]),(0,a.createElementVNode)("ol",null,[(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"先天六司"),(0,a.createTextVNode)("：天生资质，权重100%（固定无法改变）")]),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"后天六司"),(0,a.createTextVNode)("：修炼提升，权重仅20%（避免过度强化）")]),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"修行状态"),(0,a.createTextVNode)("：气血/灵气/神识当前值影响判定")]),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"境界加成"),(0,a.createTextVNode)("：练气+10%，筑基+20%，金丹+30%...")]),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"装备/功法"),(0,a.createTextVNode)("：法器和功法熟练度提供额外加成")]),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("strong",null,"状态效果"),(0,a.createTextVNode)("：buff增强判定，debuff削弱判定")])])]),(0,a.createElementVNode)("div",{class:"help-section"},[(0,a.createElementVNode)("h4",null,"🎯 判定结果"),(0,a.createElementVNode)("div",{class:"formula-note"},[(0,a.createElementVNode)("strong",null,"计算公式"),(0,a.createTextVNode)(": 最终值 = 骰点(1d20) + 属性值 + 加成 ")]),(0,a.createElementVNode)("div",{class:"result-list"},[(0,a.createElementVNode)("div",{class:"result-item perfect"},[(0,a.createElementVNode)("span",{class:"result-label"},"完美"),(0,a.createElementVNode)("span",{class:"result-desc"},"骰点19-20，必定成功且额外奖励")]),(0,a.createElementVNode)("div",{class:"result-item great-success"},[(0,a.createElementVNode)("span",{class:"result-label"},"大成功"),(0,a.createElementVNode)("span",{class:"result-desc"},"最终值 ≥ 难度+20，显著成果")]),(0,a.createElementVNode)("div",{class:"result-item success"},[(0,a.createElementVNode)("span",{class:"result-label"},"成功"),(0,a.createElementVNode)("span",{class:"result-desc"},"最终值 ≥ 难度，达成目标")]),(0,a.createElementVNode)("div",{class:"result-item failure"},[(0,a.createElementVNode)("span",{class:"result-label"},"失败"),(0,a.createElementVNode)("span",{class:"result-desc"},"最终值 < 难度，未达成")]),(0,a.createElementVNode)("div",{class:"result-item critical-failure"},[(0,a.createElementVNode)("span",{class:"result-label"},"大失败"),(0,a.createElementVNode)("span",{class:"result-desc"},"骰点1-2，必定失败且负面后果")])])]),(0,a.createElementVNode)("div",{class:"help-section"},[(0,a.createElementVNode)("h4",null,"⚔️ 判定类型与属性"),(0,a.createElementVNode)("div",{class:"judgement-types"},[(0,a.createElementVNode)("div",{class:"type-item"},[(0,a.createElementVNode)("span",{class:"type-name"},"战斗判定"),(0,a.createElementVNode)("span",{class:"type-attrs"},"根骨30% + 灵性40% + 悟性10% + 心性10% + 气运10%")]),(0,a.createElementVNode)("div",{class:"type-item"},[(0,a.createElementVNode)("span",{class:"type-name"},"修炼判定"),(0,a.createElementVNode)("span",{class:"type-attrs"},"灵性20% + 悟性50% + 根骨10% + 心性10% + 气运10%")]),(0,a.createElementVNode)("div",{class:"type-item"},[(0,a.createElementVNode)("span",{class:"type-name"},"交际判定"),(0,a.createElementVNode)("span",{class:"type-attrs"},"魅力20% + 悟性30% + 灵性20% + 心性20% + 气运10%")]),(0,a.createElementVNode)("div",{class:"type-item"},[(0,a.createElementVNode)("span",{class:"type-name"},"探索判定"),(0,a.createElementVNode)("span",{class:"type-attrs"},"气运30% + 灵性30% + 悟性20% + 根骨10% + 心性10%")])])]),(0,a.createElementVNode)("div",{class:"help-section"},[(0,a.createElementVNode)("h4",null,"📖 六司属性说明"),(0,a.createElementVNode)("div",{class:"attributes-desc"},[(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"💪"),(0,a.createElementVNode)("span",{class:"attr-name"},"根骨")]),(0,a.createElementVNode)("p",null,"决定气血上限、恢复速度、寿命上限。影响炼体修行、抗打击能力。")]),(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"✨"),(0,a.createElementVNode)("span",{class:"attr-name"},"灵性")]),(0,a.createElementVNode)("p",null,"决定灵气上限、吸收效率。影响修炼速度、法术威力。")]),(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"🧠"),(0,a.createElementVNode)("span",{class:"attr-name"},"悟性")]),(0,a.createElementVNode)("p",null,"决定神识上限、学习效率。影响功法领悟、技能掌握速度。")]),(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"🍀"),(0,a.createElementVNode)("span",{class:"attr-name"},"气运")]),(0,a.createElementVNode)("p",null,"决定各种概率、物品掉落品质。影响天材地宝获取、贵人相助。")]),(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"🌺"),(0,a.createElementVNode)("span",{class:"attr-name"},"魅力")]),(0,a.createElementVNode)("p",null,"决定初始好感度、社交加成。影响NPC互动、门派声望获取。")]),(0,a.createElementVNode)("div",{class:"attr-card"},[(0,a.createElementVNode)("div",{class:"attr-header"},[(0,a.createElementVNode)("span",{class:"attr-icon"},"💎"),(0,a.createElementVNode)("span",{class:"attr-name"},"心性")]),(0,a.createElementVNode)("p",null,"决定心魔抗性、意志力。影响走火入魔抵抗、关键抉择。")])])]),(0,a.createElementVNode)("div",{class:"help-section"},[(0,a.createElementVNode)("h4",null,"💡 提升判定成功率"),(0,a.createElementVNode)("ul",{class:"tips-list"},[(0,a.createElementVNode)("li",null,"提升对应属性：不同判定侧重不同的六司属性"),(0,a.createElementVNode)("li",null,"提升境界：境界越高，判定基础加成越大"),(0,a.createElementVNode)("li",null,"学习功法：相关功法可提供专项判定加成"),(0,a.createElementVNode)("li",null,"装备法器：合适的装备能大幅提升判定值"),(0,a.createElementVNode)("li",null,"天赋效果：某些天赋在特定判定中发挥奇效")])])],-1))])])):(0,a.createCommentVNode)("v-if",!0)]))],64))}});var cu=t(8431),su={};su.styleTagTransform=A(),su.setAttributes=z(),su.insert=V().bind(null,"head"),su.domAPI=N(),su.insertStyleElement=B(),k()(cu.A,su),cu.A&&cu.A.locals&&cu.A.locals;const du=(0,j.A)(iu,[["__scopeId","data-v-176b782c"]]),mu={class:"main-game-panel"},pu={key:0,class:"memory-section"},vu={key:0,class:"memory-dropdown"},uu={class:"memory-content"},gu={key:0,class:"no-memory"},fu={class:"current-narrative"},bu={key:0,class:"ai-processing-display"},hu={key:0,class:"streaming-content"},yu={class:"narrative-meta streaming-meta"},xu={class:"narrative-time"},ku={class:"streaming-indicator"},wu={key:0,class:"streaming-text"},Nu={class:"narrative-text"},Eu={class:"waiting-for-stream"},Vu={class:"narrative-meta streaming-meta"},Cu={class:"narrative-time"},zu={key:0,class:"narrative-content"},Su={class:"narrative-meta"},Bu={class:"narrative-time"},Du={class:"meta-buttons"},Au=["disabled","title"],_u={class:"update-count"},$u={class:"narrative-text"},Iu={key:1,class:"empty-narrative"},Tu={class:"input-section"},ju={key:0,class:"action-queue-display"},Mu={class:"queue-actions"},qu={class:"action-text"},Ou={class:"action-controls"},Pu=["onClick","title"],Fu={class:"input-wrapper"},Lu=["disabled"],Yu=["disabled"],Ru={class:"input-container"},Uu={key:0,class:"image-preview-container"},Gu=["src","alt"],Wu=["onClick"],Ju=["placeholder","disabled"],Hu={class:"stream-toggle-inside"},Qu=["disabled"],Ku={class:"action-modal"},Xu={class:"action-grid"},Zu=["onClick"],eg={class:"action-icon"},ng={class:"action-text"},tg={class:"action-config-modal"},ag={class:"config-header"},og={class:"config-content"},rg={class:"action-description"},lg={key:0,class:"config-section"},ig={class:"time-selector"},cg=["onClick"],sg={class:"time-custom"},dg={key:1,class:"config-section"},mg={class:"action-options"},pg=["name","value"],vg=(0,a.defineComponent)({__name:"MainGamePanel",setup(e,{expose:n}){function o(e){if(!e)return"【未知时间】";const n=e.分钟??0;return`【仙道${e.年}年${e.月}月${e.日}日 ${String(e.小时).padStart(2,"0")}:${String(n).padStart(2,"0")}】`}const r=(0,a.computed)(()=>j.value?.stateChanges?.changes||[]),l=(0,a.computed)({get:()=>V.userInputText,set:e=>{V.userInputText=e}}),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(),m=(0,a.ref)(),p=(0,a.ref)(!1),v=(0,a.ref)(!0),u=()=>{p.value=!p.value},g=()=>{c.value?(sessionStorage.setItem("ai-processing-state","true"),sessionStorage.setItem("ai-processing-timestamp",Date.now().toString())):(sessionStorage.removeItem("ai-processing-state"),sessionStorage.removeItem("ai-processing-timestamp"))},f=()=>{const e=sessionStorage.getItem("ai-processing-state"),n=sessionStorage.getItem("ai-processing-timestamp");"true"===e&&n&&(Date.now()-parseInt(n)<3e4?(c.value=!0,console.log("[状态恢复] 恢复AI处理状态"),setTimeout(()=>{c.value&&(console.log("[状态恢复] AI处理超时，自动清除状态"),b())},3e4)):(console.log("[状态恢复] AI处理状态已超时，清除状态"),sessionStorage.removeItem("ai-processing-state"),sessionStorage.removeItem("ai-processing-timestamp"),c.value=!1))};(0,a.watch)(c,g);const b=()=>{console.log("[强制重置] 清除AI处理状态和会话存储"),c.value=!1,sessionStorage.removeItem("ai-processing-state"),sessionStorage.removeItem("ai-processing-timestamp"),S.value=null,B.value="",d.o.info("AI处理状态已重置")};"undefined"!=typeof window&&(window.forceResetAIState=b,window.debugMemory=async()=>{const e=N.activeSaveSlot,n=e?.存档数据;console.log("[调试] 当前存档数据:",e),console.log("[调试] 存档中短期记忆:",n?.记忆?.短期记忆),console.log("[调试] 存档中中期记忆:",n?.记忆?.中期记忆),console.log("[调试] 存档中长期记忆:",n?.记忆?.长期记忆);const t=localStorage.getItem("characterStoreV3");console.log("[调试] LocalStorage原始数据长度:",t?.length);try{const e=(0,an.getTavernHelper)();if(e){const n=await e.getVariables({type:"chat"});console.log("[调试] 酒馆Chat变量:",n),console.log("[调试] 酒馆中的character.saveData:",n["character.saveData"]),console.log("[调试] 酒馆中的短期记忆:",n["character.saveData"]?.记忆?.短期记忆)}else console.warn("[调试] 无法获取酒馆Helper")}catch(e){console.error("[调试] 检查酒馆变量失败:",e)}return{存档:e,存档中短期记忆:n?.记忆?.短期记忆,存档中中期记忆:n?.记忆?.中期记忆,存档中长期记忆:n?.记忆?.长期记忆,本地存储可用:!!t}},window.testAddMemory=async e=>{console.log("[测试] 手动添加记忆:",e),await re(e,"assistant"),console.log("[测试] 记忆添加完成，检查持久化..."),await N.syncToTavernAndSave(),console.log("[测试] 持久化完成")},window.debugAIResponse=async()=>{console.log("[调试AI响应] 开始检查AI响应存储流程...");const e=N.activeSaveSlot,n=e?.存档数据;console.log("[调试AI响应] 当前存档:",e),console.log("[调试AI响应] 短期记忆:",n?.记忆?.短期记忆);try{const e=(0,an.getTavernHelper)();if(e){const t=(await e.getVariables({type:"chat"}))["character.saveData"];console.log("[调试AI响应] 酒馆saveData:",t),console.log("[调试AI响应] 酒馆短期记忆:",t?.记忆?.短期记忆);const a=n?.记忆?.短期记忆?.length||0,o=t?.记忆?.短期记忆?.length||0;console.log("[调试AI响应] 本地短期记忆数量:",a),console.log("[调试AI响应] 酒馆短期记忆数量:",o),a!==o&&console.error("[调试AI响应] 🚨 数据同步问题：本地和酒馆记忆数量不一致！")}}catch(e){console.error("[调试AI响应] 检查酒馆变量失败:",e)}console.log("[调试AI响应] 本地短期记忆:",n?.记忆?.短期记忆),console.log("[调试AI响应] 存档状态:",!!e),console.log("[调试AI响应] 数据完整性:",!!n)});const h=(0,a.ref)(!1),y=(0,a.ref)(null),x=(0,a.ref)(1),k=(0,a.ref)(1),w=(0,a.ref)(""),N=(0,tn.useCharacterStore)(),E=(0,Sv.useActionQueueStore)(),V=(0,q.useUIStore)(),C=Bv.getInstance(),z=$v.getInstance(),S=(0,a.ref)(null),B=(0,a.ref)(""),D=(0,a.ref)(!0),A=(0,a.computed)(()=>B.value.length),_=(0,a.ref)([]),$=(0,a.ref)(),I=()=>{$.value?.click()},T=e=>{const n=e.target;if(n.files&&n.files.length>0){const e=Array.from(n.files);_.value.push(...e),console.log("[图片上传] 已选择图片:",e.length,"张"),d.o.success(`已选择 ${e.length} 张图片`)}},j=(0,a.ref)(null),M=(0,a.ref)(null),O=(0,a.ref)(3),P=(0,a.ref)(25),F=(0,a.ref)(8);n({updateMemorySettings:(e,n)=>{void 0!==e&&e>0&&(O.value=e),void 0!==n&&n>0&&(P.value=n),(()=>{try{const e={maxShortTerm:O.value,maxMidTerm:P.value};localStorage.setItem("memory-settings",JSON.stringify(e)),console.log("[记忆设置] 已保存配置:",e)}catch(e){console.warn("[记忆设置] 保存配置失败:",e)}})(),console.log("[记忆设置] 配置已更新:",{短期记忆上限:O.value,中期记忆上限:P.value})},getMemorySettings:()=>({maxShortTerm:O.value,maxMidTerm:P.value})});const L=(0,a.computed)(()=>{const e=N.activeCharacterProfile;return console.log("[主面板] 激活角色检查:",{hasProfile:!!e,profileName:e?.角色基础信息?.名字,activeSlot:N.rootState.当前激活存档}),!!e}),Y=(0,a.computed)(()=>N.activeCharacterProfile?.角色基础信息?.名字||"无名道友"),R=(0,a.computed)(()=>{const e=N.activeCharacterProfile;if(!e||"单机"!==e.模式)return!1;const n=e.存档列表?.["上次对话"];return null!=n?.存档数据}),U=async()=>{R.value?V.showRetryDialog({title:"回滚确认",message:"确定要回滚到上次对话前的状态吗？当前进度将被替换。",confirmText:"确认回滚",cancelText:"取消",onConfirm:async()=>{try{await N.rollbackToLastConversation(),d.o.success("已回滚到上次对话前的状态")}catch(e){console.error("回滚失败:",e),d.o.error(`回滚失败: ${e instanceof Error?e.message:"未知错误"}`)}},onCancel:()=>{}}):d.o.warning("没有可回滚的存档")},G=(0,a.computed)(()=>{const e=[];return J.value.forEach(n=>{e.push(...n.actions)}),e}),W=(0,a.ref)([{label:"1天",value:1},{label:"3天",value:3},{label:"7天",value:7},{label:"30天",value:30}]),J=(0,a.ref)([{name:"修炼",icon:"🧘",actions:[{name:"基础修炼",icon:"⚡",type:"cultivation",description:"进行基础的修为修炼，提升境界",timeRequired:!0},{name:"炼体",icon:"💪",type:"cultivation",description:"锻炼肉身，增强体质",timeRequired:!0},{name:"冥想",icon:"🌟",type:"cultivation",description:"静心冥想，稳固心境",timeRequired:!0}]},{name:"探索",icon:"🗺️",actions:[{name:"野外探索",icon:"🌲",type:"exploration",description:"前往野外探索，寻找机缘",options:[{key:"nearby",label:"附近区域"},{key:"far",label:"远方区域"},{key:"dangerous",label:"危险区域"}]},{name:"城镇逛街",icon:"🏛️",type:"exploration",description:"在城镇中闲逛，了解信息",options:[{key:"market",label:"集市"},{key:"tavern",label:"酒楼"},{key:"shop",label:"商铺"}]}]},{name:"交流",icon:"💬",actions:[{name:"拜访朋友",icon:"👥",type:"social",description:"拜访认识的朋友",options:[{key:"random",label:"随机拜访"},{key:"close",label:"亲密朋友"}]},{name:"结交新友",icon:"🤝",type:"social",description:"主动结交新的朋友"}]},{name:"其他",icon:"⚙️",actions:[{name:"休息",icon:"😴",type:"other",description:"好好休息，恢复精神",timeRequired:!0},{name:"查看状态",icon:"📊",type:"other",description:"查看当前的详细状态"}]}]),H=()=>{h.value=!0},Q=()=>{h.value=!1},K=()=>{y.value=null,x.value=1,k.value=1,w.value=""},X=()=>{if(!y.value)return;let e=y.value.name;if(y.value.timeRequired&&(e+=`（${k.value>0?k.value:x.value}天）`),w.value&&y.value.options){const n=y.value.options.find(e=>e.key===w.value);n&&(e+=`（${n.label}）`)}l.value=e,K(),(0,a.nextTick)(()=>{s.value?.focus()})},Z=(0,a.computed)(()=>{try{console.log("[短期记忆] 开始获取短期记忆数据...");const e=N.activeSaveSlot,n=e?.存档数据;if(n?.记忆?.短期记忆){const e=n.记忆.短期记忆.slice(0,O.value);return console.log("[短期记忆] 从存档数据获取:",e.length,"条记忆"),e}return console.log("[短期记忆] 存档中未找到短期记忆数据"),[]}catch(e){return console.warn("[短期记忆] 获取短期记忆失败:",e),[]}}),ee=e=>{const n=[];if(!e)return n.push("AI响应为空"),{isValid:!1,errors:n};const t=e;return t.text&&"string"==typeof t.text||n.push("缺少有效的text字段"),t.mid_term_memory&&"string"==typeof t.mid_term_memory?0===t.mid_term_memory.trim().length&&n.push("mid_term_memory字段不能为空"):n.push("缺少必要的mid_term_memory字段（中期记忆总结）"),t.tavern_commands&&(Array.isArray(t.tavern_commands)?t.tavern_commands.forEach((e,t)=>{const a=e;e&&"object"==typeof e?a.action&&a.key||n.push(`tavern_commands[${t}]缺少必要字段(action/key)`):n.push(`tavern_commands[${t}]不是有效对象`)}):n.push("tavern_commands字段必须是数组")),{isValid:0===n.length,errors:n}},ne=e=>{null!==S.value&&(B.value+=e,(0,a.nextTick)(()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)}))},te=e=>!!e.type&&(!["npc_trade","npc_request","npc_steal"].includes(e.type)&&["equip","unequip","use","cultivate"].includes(e.type)),ae=async()=>{E.clearActions(),d.o.success("操作记录已清空")},oe=async()=>{if(!l.value.trim())return;if(c.value)return void d.o.warning("AI正在处理中，请稍等...");if(!L.value)return void d.o.error("请先选择或创建角色");const e=N.activeSaveSlot?.存档数据;if(e){const n=(0,ev.Q3)(e);if(n.isDead)return d.o.error(`角色已死亡：${n.deathReason}。无法继续游戏，请重新开始或复活角色。`),void(j.value={type:"system",content:`【死亡提示】${Y.value}已经死亡（${n.deathReason}），修仙之路戛然而止。若要继续游戏，请选择其他角色或重新开始。`,time:ce(),stateChanges:{changes:[]}})}const n=l.value.trim();try{const e=N.activeCharacterProfile;if("单机"===e?.模式&&e.存档列表){const n=N.activeSaveSlot;if(n?.存档数据){const t=(new Date).toISOString();e.存档列表["上次对话"]={存档名:"上次对话",保存时间:e.存档列表["上次对话"]?.保存时间||t,最后保存时间:t,游戏内时间:n.游戏内时间,角色名字:n.角色名字,境界:n.境界,位置:n.位置,修为进度:n.修为进度,世界地图:n.世界地图,存档数据:JSON.parse(JSON.stringify(n.存档数据))},await N.commitToStorage(),console.log("[上次对话] 已备份当前状态，时间:",t)}}}catch(e){console.warn("[上次对话] 备份失败（非致命）:",e)}const r=E.getActionPrompt(),i=n?`<用户行动趋向>${n}</用户行动趋向>`:"",s=r?`${i}${r}`:i;r&&E.clearActions(),(0,a.nextTick)(()=>{de()}),c.value=!0,j.value=null,B.value="",S.value=1;try{const e=N.activeCharacterProfile;if(!e)throw new Error("角色数据缺失");j.value={type:"ai",content:"",time:ce(),stateChanges:{changes:[]}};let n=null;try{const a={onProgressUpdate:e=>{console.log("[AI进度]",e)}};D.value&&(a.onStreamChunk=ne,a.useStreaming=!0),_.value.length>0&&(a.image=_.value,console.log("[图片上传] 将发送",_.value.length,"张图片"));const r=e.角色基础信息,l=N.activeSaveSlot?.存档数据;if(l&&r){const{syncHeavenlyPrecalcToTavern:e}=await Promise.resolve().then(t.bind(t,4986));await e(l,r),console.log("[天道系统] 已同步预计算数据到酒馆")}if(n=await z.processPlayerAction(s,e,{},a),n.gmResponse){const t=ee(n.gmResponse);if(!t.isValid){console.warn("[AI响应验证] 结构验证失败:",t.errors),d.o.warning("AI响应格式不正确，正在重试...");const a=await(async(e,n,t,a,o=2)=>{console.log("[AI响应重试] 开始重试，之前的错误:",a);for(let r=1;r<=o;r++)try{console.log(`[AI响应重试] 第${r}次尝试`);const o=`${e}\n\n## 输出格式（必须严格遵守）\n\n**⚠️ 重要：以下3个字段都是必需的，缺一不可！**\n\n{\n  "text": "Narrative text(中文简体，字数越多越好1000-3000，往用户趋向去尝试行动)",\n  "mid_term_memory": "Brief summary",\n  "tavern_commands": [{"action": "Action", "key": "key.path", "value": Value/List}]\n}\n\n下面为tavern_commands的行动命令类型\n\n# 🎯 Action Types\n\n| Action | Purpose | Example |\n|--------|---------|---------|\n| set | Replace/Set | Update state |\n| add | Increase/Decrease | Change numerical values |\n| push | Add to array | Record history |\n| delete | Remove field | Clear data |\n| pull | Remove from array | Remove array element |\n\n---\n\n\n上次响应的问题：${a.join(", ")}\n请修正这些问题并确保结构正确。`,l=await z.processPlayerAction(o,n,t,{onProgressUpdate:e=>{console.log("[AI重试进度]",e)}});if(l.gmResponse){const e=ee(l.gmResponse);if(e.isValid)return console.log(`[AI响应重试] 第${r}次尝试成功`),l;console.warn(`[AI响应重试] 第${r}次尝试验证失败:`,e.errors),a=e.errors}}catch(e){console.error(`[AI响应重试] 第${r}次尝试出错:`,e)}return console.error("[AI响应重试] 所有重试尝试都失败了"),null})(s,e,{},t.errors);if(!a)throw new Error("AI响应格式错误，且多次重试失败");n=a,console.log("[AI响应验证] 重试成功")}}console.log("[流式输出] 完成，清除流式状态"),S.value=null,B.value="";let i="";const c=n.gmResponse;if(console.log("[AI响应处理] 开始处理AI响应文本"),console.log("[AI响应处理] aiResponse:",n),console.log("[AI响应处理] gmResp:",c),console.log("[AI响应处理] streamingContent:",B.value),c?.text&&"string"==typeof c.text?(i=c.text,console.log("[AI响应处理] 使用 gmResponse.text 作为最终文本，长度:",i.length)):n.finalContent&&"string"==typeof n.finalContent?(i=n.finalContent,console.log("[AI响应处理] 使用 aiResponse.finalContent 作为最终文本，长度:",i.length)):B.value?(i=B.value,console.log("[AI响应处理] 使用 streamingContent 作为最终文本，长度:",i.length)):console.warn("[AI响应处理] 未找到任何有效的文本内容"),console.log("[AI响应处理] 最终文本内容预览:",i.substring(0,100)+"..."),i){console.log("[AI响应处理] 开始处理最终文本..."),M.value=c?.text||null;const e=N.activeSaveSlot?.存档数据,n=e?.游戏时间,t=o(n),a=i.startsWith("【仙道")||i.startsWith("【未知时间】")?i:`${t}${i}`;j.value&&(j.value.content=a,console.log("[AI响应处理] 已更新UI显示（使用带前缀内容）")),console.log("[AI响应处理] 准备将文本添加到短期记忆...");const r=c?.mid_term_memory&&"string"==typeof c.mid_term_memory?c.mid_term_memory:void 0;await re(a,"assistant",r),console.log("[AI响应处理] 最终文本已添加到短期记忆，文本长度:",a.length)}else M.value=null,console.error("[AI响应处理] 没有找到有效的文本内容，跳过记忆保存");console.log("[数据同步] ⚠️ 跳过 syncFromTavern（命令已在processGmResponse中同步）");const m=N.activeSaveSlot?.存档数据;if(m?.记忆){const e=(0,an.getTavernHelper)();if(e){const{deepCleanForClone:n}=await Promise.resolve().then(t.bind(t,3098));await e.setVariable("记忆_短期",n(m.记忆.短期记忆),{type:"chat"}),await e.setVariable("记忆_中期",n(m.记忆.中期记忆),{type:"chat"}),await e.setVariable("记忆_长期",n(m.记忆.长期记忆),{type:"chat"}),console.log("[记忆同步] ✅ 记忆已同步到Tavern分片")}}if(n&&n.stateChanges){V.clearCurrentMessageStateChanges(),console.log("[日志清空] 收到新响应，已清空上一条消息的状态变更日志");const e=n.stateChanges&&"object"==typeof n.stateChanges&&"changes"in n.stateChanges?n.stateChanges:{changes:[]};if(await N.updateCharacterData(e),j.value){j.value.stateChanges=n.stateChanges;const e=N.activeSaveSlot?.存档数据;if(e){e.叙事历史||(e.叙事历史=[]);const n={type:j.value.type,content:j.value.content,time:j.value.time,stateChanges:j.value.stateChanges};e.叙事历史.unshift(n),console.log("[主面板-调试] 保存叙事历史:",{叙事类型:n.type,内容长度:n.content.length,changes数量:n.stateChanges?.changes?.length||0,历史总数:e.叙事历史.length}),e.叙事历史.length>100&&(e.叙事历史=e.叙事历史.slice(0,100)),N.saveCurrentGame()}}V.setCurrentMessageStateChanges(n.stateChanges),console.log("[日志面板] State changes received and stored in memory:",n.stateChanges);const t=N.activeSaveSlot?.存档数据;if(t){const e=(0,ev.Q3)(t);e.isDead&&(j.value={type:"system",content:`💀【死亡通知】${Y.value}在此次行动中不幸死亡（${e.deathReason}）。修仙路断，生命已逝。`,time:ce(),stateChanges:{changes:[]}},d.o.error(`角色已死亡：${e.deathReason}`))}}else n&&console.log("[日志面板] No state changes received in this response.")}catch(e){console.error("[AI处理失败]",e),S.value=null,B.value="",c.value=!1,g();const t=e instanceof Error?e.message:"未知错误";d.o.error(`AI生成失败：${t}`,{duration:5e3}),j.value={type:"system",content:"【生成失败】天道感应中断，未能生成有效回应。原有游戏状态未发生任何变化，请重新尝试。",time:ce(),stateChanges:{changes:[]}},n=null}if(n&&n.systemMessages&&Array.isArray(n.systemMessages)&&n.systemMessages.length>0&&(j.value={type:"system",content:n.systemMessages.join("\n"),time:ce(),stateChanges:{changes:[]}}),n){d.o.success("天机重现"),_.value=[],$.value&&($.value.value="");try{console.log("[AI响应处理] 保存所有数据到本地和酒馆..."),await N.syncToTavernAndSave(),console.log("[AI响应处理] 数据保存完成")}catch(e){console.error("[AI响应处理] 数据保存失败:",e),d.o.error("数据保存失败，请尝试手动保存游戏")}console.log("[AI响应处理] 成功完成,清除AI处理状态"),c.value=!1,g()}}catch(e){console.error("[AI交互] 处理失败:",e),S.value=null,B.value="",j.value={type:"system",content:`【天道无应】${e instanceof Error?e.message:"修仙路上遇到了未知阻碍"}`,time:ce(),stateChanges:{changes:[]}},d.o.error("天道无应，请稍后再试")}finally{c.value=!1,g()}},re=async(e,n="assistant",t)=>{try{console.log(`[记忆管理] 开始添加 ${n} 消息到短期记忆`),console.log(`[记忆管理] 内容长度: ${e.length}`),console.log("[记忆管理] 中期记忆总结:",t||"无");const a=N.activeSaveSlot,r=a?.存档数据;if(!r)return void console.warn("[记忆管理] 存档数据不可用，无法存储短期记忆");r.记忆||(console.log("[记忆管理] 初始化记忆结构"),r.记忆={短期记忆:[],中期记忆:[],长期记忆:[],隐式中期记忆:[]}),Array.isArray(r.记忆.短期记忆)||(console.log("[记忆管理] 初始化短期记忆数组"),r.记忆.短期记忆=[]),Array.isArray(r.记忆.隐式中期记忆)||(console.log("[记忆管理] 初始化隐式中期记忆数组"),r.记忆.隐式中期记忆=[]),console.log(`[记忆管理] 添加前短期记忆数量: ${r.记忆.短期记忆.length}`),console.log(`[记忆管理] 添加前隐式中期记忆数量: ${r.记忆.隐式中期记忆.length}`);const l=e.startsWith("【仙道")||e.startsWith("【未知时间】")||e.startsWith("【仙历");let i=e;if(l)console.log("[记忆管理] content已包含时间前缀，跳过添加");else{i=`${o(r.游戏时间)}${e}`,console.log("[记忆管理] 为content添加时间前缀")}if(r.记忆.短期记忆.unshift(i),t&&t.trim()){const e=`${o(r.游戏时间)}${t}`;r.记忆.隐式中期记忆.unshift(e),console.log(`[记忆管理] ✅ 已同时添加隐式中期记忆: ${e.substring(0,50)}...`)}else{const n=o(r.游戏时间),t=l?e.substring(e.indexOf("】")+1):e,a=`${n}${t.length>100?t.substring(0,100)+"...":t}`;r.记忆.隐式中期记忆.unshift(a),console.log("[记忆管理] ⚠️ AI未返回mid_term_memory，自动生成隐式中期记忆")}if(console.log(`[记忆管理] 短期记忆已添加，当前数量: ${r.记忆.短期记忆.length}`),console.log(`[记忆管理] 隐式中期记忆已添加，当前数量: ${r.记忆.隐式中期记忆.length}`),r.记忆.短期记忆.length>O.value){console.log(`[记忆管理] 短期记忆超出限制（${O.value}），开始触发溢出处理`),r.记忆.中期记忆||(r.记忆.中期记忆=[]);const e=r.记忆.短期记忆.length-O.value;console.log(`[记忆管理] 需要移除 ${e} 条短期记忆`);for(let n=0;n<e;n++){const e=r.记忆.短期记忆.pop();if(e&&console.log(`[记忆管理] 移除短期记忆 #${n+1}: ${e.substring(0,50)}...`),r.记忆.隐式中期记忆.length>0){const e=r.记忆.隐式中期记忆.pop();e&&(r.记忆.中期记忆.some(n=>n===e)?console.log("[记忆管理] ⚠️ 跳过重复的中期记忆"):(r.记忆.中期记忆.unshift(e),console.log(`[记忆管理] 转移隐式中期记忆到中期记忆 #${n+1}: ${e.substring(0,50)}...`)))}else console.log(`[记忆管理] ⚠️ 隐式中期记忆不足，无法同步转移第 ${n+1} 条`)}console.log("[记忆管理] ✅ 完成记忆转移"),console.log(`[记忆管理] 📝 短期记忆剩余: ${r.记忆.短期记忆.length}`),console.log(`[记忆管理] 🔄 隐式中期记忆剩余: ${r.记忆.隐式中期记忆.length}`),console.log(`[记忆管理] 💭 中期记忆当前: ${r.记忆.中期记忆.length}`),r.记忆.中期记忆.length>P.value&&await le()}console.log("[记忆管理] ✅ 记忆保存完成"),console.log(`[记忆管理] 📝 当前短期记忆总数: ${r.记忆.短期记忆.length}`),console.log(`[记忆管理] 🔄 当前隐式中期记忆总数: ${r.记忆.隐式中期记忆.length}`),console.log(`[记忆管理] 💭 当前中期记忆总数: ${r.记忆.中期记忆?.length||0}`),console.log("[记忆管理] 数据已更新到内存，等待主流程统一保存")}catch(e){console.error("[记忆管理] 添加短期记忆或转移中期记忆失败:",e)}},le=async()=>{try{console.log("[记忆管理] 开始转移到长期记忆");const e=N.activeSaveSlot,n=e?.存档数据;if(!n?.记忆?.中期记忆)return void console.warn("[记忆管理] 存档或中期记忆数据不可用，无法处理长期记忆转移");const t=n.记忆.中期记忆.length-F.value;if(t>0){const e=n.记忆.中期记忆.splice(0,t);console.log(`[记忆管理] 提取了 ${e.length} 条中期记忆进行总结。剩余中期记忆: ${n.记忆.中期记忆.length} 条`);const a=await ie(e);if(a){n.记忆.长期记忆||(n.记忆.长期记忆=[]),n.记忆.长期记忆.unshift(a),console.log(`[记忆管理] ✅ 成功总结并添加到长期记忆。长期记忆总数: ${n.记忆.长期记忆.length} 条`),console.log("[记忆管理] 长期记忆内容预览:",a.substring(0,100)),console.log("[记忆管理] 完整长期记忆数组:",n.记忆.长期记忆),await N.syncToTavernAndSave({fullSync:!0}),console.log("[记忆管理] ✅ 已保存中期记忆删除和长期记忆新增到酒馆");const e=N.activeSaveSlot;e?.存档数据?.记忆?.长期记忆&&console.log(`[记忆管理] 验证：存档中的长期记忆数量 = ${e.存档数据.记忆.长期记忆.length}`)}else console.warn("[记忆管理] ⚠️ 生成长期记忆总结失败，被移除的中期记忆已丢失:",e)}}catch(e){console.warn("[记忆管理] 转移长期记忆失败:",e)}},ie=async e=>{try{const n=(0,an.getTavernHelper)();if(!n)return null;const t=e.join("\n\n"),a=await n.generateRaw({ordered_prompts:[{role:"system",content:"你是记忆整理助手。将提供的多条记忆整理成一段连贯的总结。只输出总结内容，不要任何前言、后语或额外说明。"},{role:"user",content:`请将以下记忆总结成一段连贯的文本：\n\n${t}`}],use_world_info:!1,should_stream:!1});return("string"==typeof a?a.trim():null)||null}catch(e){return console.warn("[记忆管理] 生成长期记忆总结失败:",e),null}},ce=()=>{const e=new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},se=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),oe())},de=()=>{const e=s.value;if(e){const n=36.16;e.style.height=`${n}px`;const t=e.scrollHeight,a=120;if(t>n){const n=Math.min(t,a);e.style.height=`${n}px`}e.style.overflowY=t>a?"auto":"hidden"}},me=()=>{(0,a.nextTick)(()=>{de()})},pe=async()=>{console.log("[主面板] 为当前存档初始化面板 (新逻辑)...");try{if(L.value){const e=N.activeSaveSlot?.存档数据,n=e?.记忆?.短期记忆;if(console.log("[主面板-调试] 存档数据检查:",{有存档数据:!!e,有叙事历史:!!e?.叙事历史,叙事历史长度:e?.叙事历史?.length||0,有短期记忆:!!n,短期记忆长度:n?.length||0}),e?.叙事历史&&e.叙事历史.length>0){const n=e.叙事历史[0];console.log("[主面板] 从叙事历史恢复最新叙述（含状态变更日志）"),console.log("[主面板-调试] 叙事历史第一条:",{type:n.type,内容长度:n.content?.length||0,有stateChanges:!!n.stateChanges,changes数量:n.stateChanges?.changes?.length||0}),j.value={type:n.type,content:n.content,time:n.time,stateChanges:n.stateChanges||{changes:[]}}}else if(n&&n.length>0){const e=n[0];console.log("[主面板] 从存档加载最新叙述:",e.substring(0,100));const t=N.consumeInitialCreationStateChanges();j.value={type:"gm",content:e,time:ce(),stateChanges:t||{changes:[]}},t&&console.log("[主面板] 已加载并消费角色创建时的初始状态变更。")}else{console.log("[主面板] 未找到叙事记录，显示欢迎信息");const e=N.activeSaveSlot?.存档数据?.角色基础信息?.名字||"修行者";j.value={type:"system",content:`【欢迎】${e}，你的修仙之旅即将开始。请输入你的行动。`,time:ce(),stateChanges:{changes:[]}}}await ue()}else j.value={type:"system",content:"【提示】请先选择或创建角色开始游戏。",time:ce(),stateChanges:{changes:[]}};(0,a.nextTick)(()=>{m.value&&(m.value.scrollTop=m.value.scrollHeight)})}catch(e){console.error("[主面板] 初始化存档数据失败:",e),j.value={type:"system",content:"【系统】加载存档数据时遇到问题。",time:ce(),stateChanges:{changes:[]}}}};(0,a.watch)(()=>N.rootState.当前激活存档,async(e,n)=>{e&&e!==n&&(console.log(`[主面板] 存档已切换: 从 ${n||"无"} 到 ${e}`),console.log("[主面板] 检测到存档切换，正在重置面板状态..."),E.clearActions(),j.value=null,l.value="",M.value=null,c.value=!1,g(),await pe())}),(0,a.watch)(()=>N.activeSaveSlot?.存档数据?.记忆?.短期记忆,e=>{if(!c.value&&e&&e.length>0){const n=e[0];j.value&&j.value.content===n||(console.log("[主面板] 检测到短期记忆变更，同步更新显示。"),j.value={type:"ai",content:n,time:ce(),stateChanges:{changes:[]}})}},{deep:!0}),(0,a.onMounted)(async()=>{try{(async()=>{try{const e=(0,an.getTavernHelper)();if(e)try{const n=await e.getVariable("character.memorySettings",{type:"chat"});if(n&&"object"==typeof n){const e=n;return"number"==typeof e.shortTermLimit&&(O.value=e.shortTermLimit),"number"==typeof e.midTermTrigger&&(P.value=e.midTermTrigger),"number"==typeof e.midTermKeep&&(F.value=e.midTermKeep),void console.log("[记忆设置] 已从酒馆变量加载配置:",{短期记忆上限:O.value,中期记忆触发阈值:P.value,中期记忆保留数量:F.value})}}catch{console.log("[记忆设置] 未找到酒馆变量配置，尝试从localStorage读取")}const n=localStorage.getItem("memory-settings");if(n){const e=JSON.parse(n);e.maxShortTerm&&(O.value=e.maxShortTerm),e.maxMidTerm&&(P.value=e.maxMidTerm),e.midTermKeep&&(F.value=e.midTermKeep),console.log("[记忆设置] 已从localStorage加载配置:",{短期记忆上限:O.value,中期记忆触发阈值:P.value,中期记忆保留数量:F.value})}}catch(e){console.warn("[记忆设置] 加载配置失败，使用默认值:",e)}})(),f(),await ve(),(0,a.nextTick)(de),await pe(),Oi.on("memory-settings-updated",e=>{if(console.log("[记忆设置] 接收到配置更新事件:",e),e&&"object"==typeof e){const n=e;"number"==typeof n.shortTermLimit&&(O.value=n.shortTermLimit,console.log(`[记忆设置] 短期记忆上限已更新为: ${O.value}`)),"number"==typeof n.midTermTrigger&&(P.value=n.midTermTrigger,console.log(`[记忆设置] 中期记忆触发阈值已更新为: ${P.value}`)),"number"==typeof n.midTermKeep&&(F.value=n.midTermKeep,console.log(`[记忆设置] 中期记忆保留数量已更新为: ${F.value}`))}});const e=(0,an.getTavernHelper)();e&&e.registerSlashCommand&&(console.log("[主面板] 注册 AI 生成完成监听"),e.registerSlashCommand("event-emit",async e=>{const n=e,t=n?.event;"MESSAGE_GENERATED"!==t&&"GENERATION_COMPLETED"!==t||(console.log("[主面板] 检测到 AI 生成完成事件"),c.value&&(console.log("[主面板] 自动清除 AI 处理状态"),c.value=!1,g()))}))}catch(e){console.error("[主面板] 首次挂载失败:",e),j.value={type:"system",content:"【系统】初始化遇到问题，请刷新页面重试。",time:ce(),stateChanges:{changes:[]}}}}),(0,a.onActivated)(()=>{console.log("[主面板] 组件激活，恢复AI处理状态"),f()});const ve=async()=>{try{console.log("[主面板] 初始化系统连接..."),console.log("[主面板] 系统连接初始化完成")}catch(e){console.error("[主面板] 系统连接初始化失败:",e)}},ue=async()=>{try{if(!N.activeCharacterProfile)return;console.log("[主面板] 游戏状态同步完成")}catch(e){console.error("[主面板] 游戏状态同步失败:",e)}};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",mu,[(0,a.createCommentVNode)(" 短期记忆区域 "),v.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",pu,[(0,a.createElementVNode)("div",{class:"memory-header",onClick:u},[n[7]||(n[7]=(0,a.createElementVNode)("span",{class:"memory-title"},"📝 短期记忆",-1)),p.value?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Ev),{key:0,size:16,class:"memory-icon"})):((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(rc),{key:1,size:16,class:"memory-icon"}))]),(0,a.createCommentVNode)(" 下拉悬浮的记忆内容 "),(0,a.createVNode)(a.Transition,{name:"memory-dropdown"},{default:(0,a.withCtx)(()=>[p.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",vu,[(0,a.createElementVNode)("div",uu,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Z.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"memory-item"},(0,a.toDisplayString)(e),1))),128)),0===Z.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",gu," 脑海中一片清净，尚未留下修行痕迹... ")):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0)]),_:1})])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 文本显示区域 - 当前AI回复 "),(0,a.createElementVNode)("div",{class:"content-area",ref_key:"contentAreaRef",ref:m},[(0,a.createCommentVNode)(" 左侧：当前叙述 "),(0,a.createElementVNode)("div",fu,[(0,a.createCommentVNode)(" AI处理时显示 "),c.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",bu,[(0,a.createCommentVNode)(" 如果有流式内容则显示 "),D.value&&B.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",hu,[(0,a.createElementVNode)("div",yu,[(0,a.createElementVNode)("span",xu,(0,a.toDisplayString)(ce()),1),(0,a.createElementVNode)("div",ku,[n[8]||(n[8]=(0,a.createElementVNode)("span",{class:"streaming-dot"},null,-1)),B.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",wu,(0,a.toDisplayString)(A.value)+" 字",1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 重置按钮 - 右侧 "),(0,a.createElementVNode)("button",{onClick:b,class:"reset-state-btn",title:"如果长时间无响应，点击此处重置状态"},[(0,a.createVNode)((0,a.unref)(Vv),{size:16})])]),(0,a.createElementVNode)("div",Nu,[(0,a.createVNode)(du,{text:B.value},null,8,["text"])])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 等待响应的加载动画 "),(0,a.createElementVNode)("div",Eu,[(0,a.createElementVNode)("div",Vu,[(0,a.createElementVNode)("span",Cu,(0,a.toDisplayString)(ce()),1),n[9]||(n[9]=(0,a.createElementVNode)("div",{class:"streaming-indicator"},[(0,a.createElementVNode)("span",{class:"streaming-dot"}),(0,a.createElementVNode)("span",{class:"streaming-text"},"天道感应中...")],-1)),(0,a.createCommentVNode)(" 重置按钮 - 右侧 "),(0,a.createElementVNode)("button",{onClick:b,class:"reset-state-btn",title:"如果长时间无响应，点击此处重置状态"},[(0,a.createVNode)((0,a.unref)(Vv),{size:16})])]),n[10]||(n[10]=(0,a.createStaticVNode)('<div class="narrative-text" data-v-b63a96a6><div class="waiting-animation" data-v-b63a96a6><div class="thinking-dots" data-v-b63a96a6><div class="dot" data-v-b63a96a6></div><div class="dot" data-v-b63a96a6></div><div class="dot" data-v-b63a96a6></div></div></div></div>',1))])],2112))])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 非AI处理时显示 "),j.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",zu,[(0,a.createElementVNode)("div",Su,[(0,a.createElementVNode)("span",Bu,(0,a.toDisplayString)(j.value.time),1),(0,a.createElementVNode)("div",Du,[(0,a.createCommentVNode)(" 回滚按钮 "),R.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:U,class:"header-action-btn rollback-btn",title:"回滚到上次对话前的状态"},[(0,a.createVNode)((0,a.unref)(Vv),{size:24})])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 命令日志按钮 "),(0,a.createElementVNode)("button",{onClick:n[0]||(n[0]=e=>{var n;(n=j.value.stateChanges)&&n.changes&&0!==n.changes.length?V.openStateChangeViewer(n):d.o.info("本次对话无变更记录")}),class:(0,a.normalizeClass)(["variable-updates-toggle",{disabled:0===r.value.length}]),disabled:0===r.value.length,title:r.value.length>0?"查看本次对话的变更日志":"本次对话无变更记录"},[(0,a.createVNode)((0,a.unref)(we),{size:16}),(0,a.createElementVNode)("span",_u,(0,a.toDisplayString)(r.value.length),1)],10,Au)])]),(0,a.createElementVNode)("div",$u,[(0,a.createVNode)(du,{text:j.value.content},null,8,["text"])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Iu," 静待天机变化... "))],64))])],512),(0,a.createCommentVNode)(" 输入区域 "),(0,a.createElementVNode)("div",Tu,[(0,a.createCommentVNode)(" 动作队列显示区域 "),(0,a.unref)(E).pendingActions.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",ju,[(0,a.createElementVNode)("div",{class:"queue-header"},[n[12]||(n[12]=(0,a.createElementVNode)("span",{class:"queue-title"},"📝 最近操作",-1)),(0,a.createElementVNode)("button",{onClick:ae,class:"clear-queue-btn",title:"清空记录"},n[11]||(n[11]=[(0,a.createElementVNode)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,a.createElementVNode)("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),(0,a.createElementVNode)("div",Mu,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(E).pendingActions,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:"queue-action-item"},[(0,a.createElementVNode)("span",qu,(0,a.toDisplayString)(e.description),1),(0,a.createElementVNode)("div",Ou,[(0,a.createElementVNode)("button",{onClick:e=>(async e=>{if(e>=0&&e<E.pendingActions.length){const n=E.pendingActions[e],t=["npc_trade","npc_request","npc_steal"];if(n.type&&t.includes(n.type))return E.removeAction(n.id),void d.o.success("已移除NPC交互动作");if(n.type&&["equip","unequip","use","cultivate"].includes(n.type)&&n.itemName&&await C.undoByItemName(n.type,n.itemName))return void d.o.success("已撤回并恢复");E.removeAction(n.id),d.o.success("已移除动作")}})(n),class:"remove-action-btn",title:te(e)?"撤回并恢复":"删除此动作"}," × ",8,Pu)])]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Fu,[(0,a.createCommentVNode)(" 隐藏的文件选择器 "),(0,a.createElementVNode)("input",{type:"file",ref_key:"imageInputRef",ref:$,onChange:T,multiple:"",accept:"image/*",style:{display:"none"}},null,544),(0,a.createCommentVNode)(" 图片上传按钮 "),(0,a.createElementVNode)("button",{onClick:I,class:"action-selector-btn image-upload-btn",disabled:!L.value,title:"上传图片"},n[13]||(n[13]=[(0,a.createElementVNode)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,a.createElementVNode)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,a.createElementVNode)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,a.createElementVNode)("polyline",{points:"21 15 16 10 5 21"})],-1)]),8,Lu),(0,a.createElementVNode)("button",{onClick:H,class:"action-selector-btn",disabled:!L.value,title:"快捷行动"},[(0,a.createVNode)((0,a.unref)(Ev),{size:16})],8,Yu),(0,a.createElementVNode)("div",Ru,[(0,a.createCommentVNode)(" 图片预览区域 "),_.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",Uu,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(_.value,(e,t)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"image-preview-item"},[(0,a.createElementVNode)("img",{src:(o=e,URL.createObjectURL(o)),alt:e.name},null,8,Gu),(0,a.createElementVNode)("button",{onClick:e=>(e=>{_.value.splice(e,1),d.o.info("已移除图片")})(t),class:"remove-image-btn",title:"移除图片"},n[14]||(n[14]=[(0,a.createElementVNode)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,a.createElementVNode)("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]),8,Wu)]);var o}),128))])):(0,a.createCommentVNode)("v-if",!0),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),onFocus:n[2]||(n[2]=e=>i.value=!0),onBlur:n[3]||(n[3]=e=>i.value=!1),onKeydown:se,onInput:me,placeholder:L.value?"请输入您的选择或行动...":"请先选择角色...",class:"game-input",ref_key:"inputRef",ref:s,rows:"1",wrap:"soft",disabled:!L.value||c.value},null,40,Ju),[[a.vModelText,l.value]]),(0,a.createCommentVNode)(" 流式传输选项在输入框内部右侧 "),(0,a.createElementVNode)("label",Hu,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":n[4]||(n[4]=e=>D.value=e)},null,512),[[a.vModelCheckbox,D.value]]),n[15]||(n[15]=(0,a.createElementVNode)("span",{class:"label-text"},"流式",-1))])]),(0,a.createElementVNode)("button",{onClick:oe,disabled:!l.value.trim()||c.value||!L.value,class:"send-button"},[c.value?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(Cv),{key:0,size:16,class:"animate-spin"})):((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(zv),{key:1,size:16}))],8,Qu)]),(0,a.createCommentVNode)(" 行动选择弹窗 "),h.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"action-modal-overlay",onClick:(0,a.withModifiers)(Q,["self"])},[(0,a.createElementVNode)("div",Ku,[(0,a.createElementVNode)("div",{class:"modal-header"},[n[17]||(n[17]=(0,a.createElementVNode)("h3",null,"🎯 快捷行动",-1)),(0,a.createElementVNode)("button",{onClick:Q,class:"close-btn"},n[16]||(n[16]=[(0,a.createElementVNode)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[(0,a.createElementVNode)("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),(0,a.createElementVNode)("div",Xu,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(G.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e.name,onClick:n=>(e=>{y.value=e,h.value=!1,x.value=1,k.value=1,w.value="",e.timeRequired||e.options||X()})(e),class:(0,a.normalizeClass)(["quick-action-btn",e.type])},[(0,a.createElementVNode)("div",eg,(0,a.toDisplayString)(e.icon),1),(0,a.createElementVNode)("div",ng,(0,a.toDisplayString)(e.name),1)],10,Zu))),128))])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 行动配置弹窗 "),y.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:2,class:"action-config-overlay",onClick:(0,a.withModifiers)(K,["self"])},[(0,a.createElementVNode)("div",tg,[(0,a.createElementVNode)("div",ag,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(y.value.icon)+" "+(0,a.toDisplayString)(y.value.name),1),(0,a.createElementVNode)("button",{onClick:K,class:"close-btn"},"×")]),(0,a.createElementVNode)("div",og,[(0,a.createElementVNode)("p",rg,(0,a.toDisplayString)(y.value.description),1),(0,a.createCommentVNode)(" 时间配置 "),y.value.timeRequired?((0,a.openBlock)(),(0,a.createElementBlock)("div",lg,[n[20]||(n[20]=(0,a.createElementVNode)("label",{class:"config-label"},"修炼时间",-1)),(0,a.createElementVNode)("div",ig,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(W.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e.value,onClick:n=>x.value=e.value,class:(0,a.normalizeClass)(["time-btn",{active:x.value===e.value}])},(0,a.toDisplayString)(e.label),11,cg))),128))]),(0,a.createElementVNode)("div",sg,[n[18]||(n[18]=(0,a.createElementVNode)("label",null,"自定义：",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":n[5]||(n[5]=e=>k.value=e),type:"number",min:"1",max:"365",class:"time-input"},null,512),[[a.vModelText,k.value,void 0,{number:!0}]]),n[19]||(n[19]=(0,a.createTextVNode)(" 天 ",-1))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 其他配置选项 "),y.value.options?((0,a.openBlock)(),(0,a.createElementBlock)("div",dg,[n[21]||(n[21]=(0,a.createElementVNode)("label",{class:"config-label"},"选项",-1)),(0,a.createElementVNode)("div",mg,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(y.value.options,e=>((0,a.openBlock)(),(0,a.createElementBlock)("label",{key:e.key,class:"option-item"},[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"radio",name:"option-"+y.value.name,value:e.key,"onUpdate:modelValue":n[6]||(n[6]=e=>w.value=e)},null,8,pg),[[a.vModelRadio,w.value]]),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.label),1)]))),128))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",{class:"config-actions"},[(0,a.createElementVNode)("button",{onClick:K,class:"cancel-btn"},"取消"),(0,a.createElementVNode)("button",{onClick:X,class:"confirm-btn"},"确认")])])])):(0,a.createCommentVNode)("v-if",!0)])]))}});var ug=t(1214),gg={};gg.styleTagTransform=A(),gg.setAttributes=z(),gg.insert=V().bind(null,"head"),gg.domAPI=N(),gg.insertStyleElement=B(),k()(ug.A,gg),ug.A&&ug.A.locals&&ug.A.locals;const fg=(0,j.A)(vg,[["__scopeId","data-v-b63a96a6"]]);var bg=t(3302);const hg={class:"memory-center-panel game-panel"},yg={class:"filter-section"},xg={class:"filter-tabs"},kg=["onClick"],wg={class:"tab-icon"},Ng={class:"tab-name"},Eg={class:"tab-count"},Vg={key:0,class:"settings-section"},Cg={class:"settings-header"},zg={class:"header-actions"},Sg={class:"settings-content"},Bg={class:"setting-item"},Dg={class:"setting-item"},Ag={class:"setting-item"},_g={class:"setting-item"},$g={class:"setting-label"},Ig={class:"setting-item"},Tg={class:"setting-item"},jg={class:"manual-summary-section"},Mg={class:"summary-info"},qg={class:"info-text"},Og={class:"info-hint"},Pg=["disabled","title"],Fg={key:1,class:"panel-content"},Lg={key:0,class:"loading-state"},Yg={key:1,class:"empty-state"},Rg={class:"empty-text"},Ug={key:2,class:"memory-list"},Gg={class:"memory-header"},Wg={class:"memory-actions"},Jg=["onClick"],Hg={class:"memory-time"},Qg={class:"memory-content"},Kg={key:0,class:"structured-memory"},Xg={key:0,class:"memory-title"},Zg={key:0,class:"memory-section-group"},ef={class:"memory-section"},nf={class:"memory-icon"},tf={class:"memory-section-title"},af={key:1,class:"memory-item"},of={key:1,class:"memory-section-group"},rf={key:1,class:"memory-item"},lf={key:1,class:"simple-memory"},cf=(0,a.defineComponent)({__name:"MemoryCenterPanel",setup(e){const{characterData:n,saveData:o}=(0,Li.useUnifiedCharacterData)(),r=(0,a.ref)(!1),l=(0,a.ref)("all"),i=(0,a.ref)(!1),c=(0,a.ref)({shortTermLimit:3,midTermTrigger:25,midTermKeep:8,autoSummaryEnabled:!0,midTermFormat:"",longTermFormat:""}),s=(0,a.ref)([]),m=(0,a.ref)([]),p=(0,a.ref)([]),v=(0,a.computed)(()=>[...p.value,...m.value,...s.value].sort((e,n)=>new Date(n.time).getTime()-new Date(e.time).getTime())),u=[{key:"all",name:"全部",icon:"🧠"},{key:"short",name:"短期",icon:"⚡"},{key:"medium",name:"中期",icon:"💭"},{key:"long",name:"长期",icon:"💾"}],g=(0,a.computed)(()=>{if("all"===l.value)return v.value;switch(l.value){case"short":return s.value;case"medium":return m.value;case"long":return p.value;default:return v.value}}),f=(0,a.computed)(()=>s.value.length+m.value.length+p.value.length),b=e=>{if("all"===e)return f.value;switch(e){case"short":return s.value.length;case"medium":return m.value.length;case"long":return p.value.length;default:return 0}},h=()=>{if("all"===l.value)return"心境空明如镜，尚未记录修行感悟";const e=u.find(e=>e.key===l.value);return`暂无${e?.name}记忆`},y=e=>({short:"短期记忆",medium:"中期记忆",long:"长期记忆"}[e]||"未知"),x=e=>{const n=new Date(e);return`${n.getMonth()+1}/${n.getDate()} ${n.getHours()}:${n.getMinutes().toString().padStart(2,"0")}`},k=async()=>{try{const e=(0,an.getTavernHelper)();if(!e)return void bg.Yz.warn("记忆中心","无法连接到酒馆助手，跳过AI总结");const n=m.value.length,t=c.value.midTermKeep||8,a=Math.max(0,n-t);if(a<=0)return void bg.Yz.log("记忆中心","中期记忆数量未超过保留阈值，无需总结");bg.Yz.log("记忆中心",`开始AI总结：将总结 ${a} 条中期记忆，保留最新 ${t} 条`);const o=m.value.slice(0,a).map((e,n)=>`${n+1}. ${e.parsedContent?`${e.parsedContent.事件}（${e.parsedContent.时间}）`:e.content}`).join("\n"),r='你是一个专业的记忆总结助手，擅长将中期记忆整合为详细的长期记忆档案。\n\n总结要求：\n1. 必须包含时间线索、关键事件、人物关系变化、情感波动\n2. 使用第一人称（"我"）的视角描述\n3. 按时间顺序梳理事件脉络，突出因果关系\n4. 保留重要细节，合并琐碎信息\n5. 字数控制在200-350字，确保信息完整详实\n6. 使用修仙小说的语言风格\n7. 只返回总结内容，不要有任何前缀、后缀或标题',l=c.value.longTermFormat||r,i=`请将以下中期记忆总结成详细的长期记忆档案：\n\n${o}`,s=await e.generateRaw({ordered_prompts:[{role:"system",content:l},{role:"user",content:i}],should_stream:!1});if(!s||"string"!=typeof s)throw new Error("AI响应格式错误");const v=s.trim();if(!v)throw new Error("总结内容为空");const u={type:"long",content:v,time:`总结于${x(Date.now())}`,importance:8,parsedContent:{事件:v,时间:`总结于${x(Date.now())}`,地点:"综合",人物:"综合",影响:"记忆总结",sections:{}},isConverted:!0,isSummarized:!0};p.value.push(u),m.value.splice(0,a),bg.Yz.log("记忆中心",`✅ AI总结完成：已将 ${a} 条中期记忆总结为1条长期记忆`),d.o.success(`已将 ${a} 条中期记忆总结为长期记忆`),await w()}catch(e){bg.Yz.error("记忆中心","AI总结失败:",e);const n=e instanceof Error?e.message:"未知错误";throw d.o.error(`记忆总结失败: ${n}`),e}},w=async()=>{try{const{useCharacterStore:e}=await Promise.resolve().then(t.bind(t,948)),n=e(),a=n.activeSaveSlot?.存档数据;if(!a||!a.记忆)return void bg.Yz.warn("记忆中心","存档数据不存在，无法保存记忆");a.记忆.短期记忆=s.value.map(e=>e.content),a.记忆.中期记忆=m.value.map(e=>e.content),a.记忆.长期记忆=p.value.map(e=>e.content),await n.syncToTavernAndSave({fullSync:!0}),bg.Yz.log("记忆中心","记忆数据已保存到存档")}catch(e){throw bg.Yz.error("记忆中心","保存记忆数据到存档失败:",e),e}},N=(0,q.useUIStore)(),E=async()=>{try{bg.Yz.log("记忆中心","开始加载记忆数据");const e=[],t=[],a=[],o=n.value?.记忆;o?(bg.Yz.log("记忆中心","从存档数据加载记忆:",Object.keys(o)),Array.isArray(o.短期记忆)&&o.短期记忆.forEach((n,t)=>{if(n&&"string"==typeof n){const a={type:"short",content:n,time:x(Date.now()-3e5*t),importance:5};e.push(a)}}),Array.isArray(o.中期记忆)&&o.中期记忆.forEach((e,n)=>{if(e&&"string"==typeof e){const a={type:"medium",content:e,time:x(Date.now()-36e5*n),importance:7};t.push(a)}}),Array.isArray(o.长期记忆)?(bg.Yz.log("记忆中心",`发现长期记忆数组，长度: ${o.长期记忆.length}`),bg.Yz.log("记忆中心","长期记忆原始数据:",o.长期记忆),o.长期记忆.forEach((e,n)=>{if(e&&"string"==typeof e){const t={type:"long",content:e,time:x(Date.now()-864e5*n),importance:9};a.push(t),bg.Yz.log("记忆中心",`加载长期记忆 #${n}:`,e.substring(0,50))}})):bg.Yz.warn("记忆中心","长期记忆不是数组或不存在:",o.长期记忆),bg.Yz.log("记忆中心",`记忆加载完成: 短期${e.length}, 中期${t.length}, 长期${a.length}`)):bg.Yz.warn("记忆中心","未找到存档记忆数据"),s.value=e,m.value=t,p.value=a;const r=e.length+t.length+a.length;bg.Yz.log("记忆中心",`记忆加载完成：总计 ${r} 条记忆`)}catch(e){bg.Yz.error("记忆中心","加载记忆数据失败",e),d.o.error("加载记忆数据失败")}},V=async()=>{try{const e=(0,an.getTavernHelper)();if(!e)throw new Error("无法获取Tavern助手");{const{deepCleanForClone:n}=await Promise.resolve().then(t.bind(t,3098)),a=n(c.value);await e.setVariable("character.memorySettings",a,{type:"chat"}),Oi.emit("memory-settings-updated",a),d.o.success("记忆系统配置已保存"),bg.Yz.log("记忆中心","配置已保存并同步:",a)}}catch(e){bg.Yz.error("记忆中心","保存配置失败:",e),d.o.error("保存配置失败")}},C=()=>{c.value={shortTermLimit:3,midTermTrigger:20,midTermKeep:8,autoSummaryEnabled:!0,midTermFormat:"",longTermFormat:""},d.o.success("配置已重置为默认值")},z=async()=>{const e=c.value.midTermKeep+5;if(m.value.length<e)d.o.warning(`中期记忆不足，至少需要 ${e} 条才能总结`);else try{d.o.loading("正在调用AI总结中期记忆...",{id:"manual-summary"}),await k(),d.o.success("手动总结完成！",{id:"manual-summary"})}catch(e){const n=e instanceof Error?e.message:"未知错误";d.o.error(`手动总结失败: ${n}`,{id:"manual-summary"})}};(0,a.onMounted)(async()=>{await E(),await(async()=>{try{const e=(0,an.getTavernHelper)();if(e){const n=await e.getVariable("character.memorySettings",{type:"chat"});if(n&&"object"==typeof n)return c.value={...c.value,...n},void bg.Yz.log("记忆中心","已从酒馆变量加载配置",n)}bg.Yz.log("记忆中心","未找到酒馆配置，使用默认值")}catch(e){bg.Yz.error("记忆中心","加载记忆配置失败:",e)}})(),Oi.on("refresh",async()=>{r.value=!0;try{await E()}finally{r.value=!1}}),Oi.on("test",()=>{((e,n,t=5,a)=>{const o={type:e,content:n,time:x(Date.now()),importance:t,parsedContent:a};switch(e){case"short":s.value.push(o);break;case"medium":m.value.push(o);break;case"long":p.value.push(o)}(()=>{let e=!1;if(s.value.length>=3){bg.Yz.log("记忆中心","短期记忆达到上限，开始转化为中期记忆");const n=s.value.shift();if(n){const t={...n,type:"medium",time:`转化于${x(Date.now())}`,isConverted:!0};m.value.push(t),e=!0}}if(m.value.length>=25)if(bg.Yz.log("记忆中心","中期记忆达到上限，准备转化为长期记忆"),c.value.autoSummaryEnabled)bg.Yz.log("记忆中心","自动总结已启用，将在后台触发AI总结"),k().catch(e=>{bg.Yz.error("记忆中心","自动总结失败:",e)});else{const n=m.value.shift();if(n){const t={...n,type:"long",time:`归档于${x(Date.now())}`,importance:Math.max(n.importance||5,7),isConverted:!0};p.value.push(t),e=!0}}if(p.value.length>50){p.value.sort((e,n)=>(n.importance||5)-(e.importance||5));const e=p.value.splice(50);bg.Yz.log("记忆中心",`长期记忆超限，移除${e.length}条低重要性记忆`)}e&&d.o.success("记忆已重新整理，旧记忆已转化")})()})("short","【测试记忆】用于检验转化与渲染。")}),Oi.on("clear",async()=>{await(async()=>{N.showRetryDialog({title:"清理记忆",message:"确定要清理所有记忆吗？此操作不可撤销，将同步清理酒馆数据。",confirmText:"确认清理",cancelText:"取消",onConfirm:async()=>{try{if(s.value=[],m.value=[],p.value=[],o.value){n.value?.记忆&&(n.value.记忆.短期记忆=[],n.value.记忆.中期记忆=[],n.value.记忆.长期记忆=[]);const e=(0,an.getTavernHelper)();if(e){const{shardSaveData:n,saveAllShards:a}=await Promise.resolve().then(t.bind(t,9808)),r=n(o.value);await a(r,e),console.log("[记忆中心] 已同步清理酒馆记忆数据")}}d.o.success("记忆已清理并同步到酒馆")}catch(e){console.error("[记忆中心] 清理记忆失败:",e),d.o.error("清理记忆失败，请重试")}},onCancel:()=>{}})})()})});const S=async()=>{try{const e={content:`测试长期记忆 ${Date.now()} - 这是一条用于测试的长期记忆记录。`,time:x(Date.now()),type:"long",isConverted:!1,isSummarized:!1,parsedContent:{影响:"测试",sections:{}}};p.value.push(e),await w(),d.o.success(`✅ 测试记忆已添加！当前长期记忆: ${p.value.length} 条`),bg.Yz.log("记忆中心","添加测试长期记忆成功",e)}catch(e){bg.Yz.error("记忆中心","添加测试记忆失败",e),d.o.error("添加测试记忆失败")}};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",hg,[(0,a.createCommentVNode)(" 记忆类型筛选 "),(0,a.createElementVNode)("div",yg,[(0,a.createElementVNode)("div",xg,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(u,e=>(0,a.createElementVNode)("button",{key:e.key,class:(0,a.normalizeClass)(["filter-tab",{active:l.value===e.key}]),onClick:n=>{return t=e.key,void(l.value=t);var t}},[(0,a.createElementVNode)("span",wg,(0,a.toDisplayString)(e.icon),1),(0,a.createElementVNode)("span",Ng,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",Eg,(0,a.toDisplayString)(b(e.key)),1)],10,kg)),64)),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["settings-toggle-btn",{active:i.value}]),onClick:n[0]||(n[0]=e=>i.value=!i.value),title:"记忆系统设置"},[(0,a.createVNode)((0,a.unref)(Wn),{size:16})],2)])]),(0,a.createCommentVNode)(" 记忆系统设置 "),i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vg,[(0,a.createElementVNode)("div",Cg,[n[8]||(n[8]=(0,a.createElementVNode)("span",{class:"settings-title"},"⚙️ 记忆系统配置",-1)),(0,a.createElementVNode)("div",zg,[(0,a.createElementVNode)("button",{class:"test-btn",onClick:S,title:"添加测试长期记忆"}," 🧪 测试 "),(0,a.createElementVNode)("button",{class:"settings-close-btn",onClick:n[1]||(n[1]=e=>i.value=!1)},"✕")])]),(0,a.createElementVNode)("div",Sg,[(0,a.createElementVNode)("div",Bg,[n[9]||(n[9]=(0,a.createElementVNode)("label",{class:"setting-label"},"短期记忆限制 (条):",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>c.value.shortTermLimit=e),min:"3",max:"10",class:"setting-input"},null,512),[[a.vModelText,c.value.shortTermLimit,void 0,{number:!0}]]),n[10]||(n[10]=(0,a.createElementVNode)("span",{class:"setting-hint"},"默认: 3",-1))]),(0,a.createElementVNode)("div",Dg,[n[11]||(n[11]=(0,a.createElementVNode)("label",{class:"setting-label"},"中期记忆转化阈值 (条):",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number","onUpdate:modelValue":n[3]||(n[3]=e=>c.value.midTermTrigger=e),min:"10",max:"50",class:"setting-input"},null,512),[[a.vModelText,c.value.midTermTrigger,void 0,{number:!0}]]),n[12]||(n[12]=(0,a.createElementVNode)("span",{class:"setting-hint"},"中期记忆积累达到此数量时转化为长期记忆，默认: 25",-1))]),(0,a.createElementVNode)("div",Ag,[n[13]||(n[13]=(0,a.createElementVNode)("label",{class:"setting-label"},"中期记忆保留数量 (条):",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=e=>c.value.midTermKeep=e),min:"5",max:"15",class:"setting-input"},null,512),[[a.vModelText,c.value.midTermKeep,void 0,{number:!0}]]),n[14]||(n[14]=(0,a.createElementVNode)("span",{class:"setting-hint"},"转化为长期记忆时保留最新的中期记忆数量，默认: 8",-1))]),(0,a.createElementVNode)("div",_g,[(0,a.createElementVNode)("label",$g,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":n[5]||(n[5]=e=>c.value.autoSummaryEnabled=e),class:"setting-checkbox"},null,512),[[a.vModelCheckbox,c.value.autoSummaryEnabled]]),n[15]||(n[15]=(0,a.createTextVNode)(" 启用自动记忆转化 ",-1))]),n[16]||(n[16]=(0,a.createElementVNode)("span",{class:"setting-hint"},"开启后自动将中期记忆转化为长期记忆，关闭则不进行转化",-1))]),(0,a.createElementVNode)("div",Ig,[n[17]||(n[17]=(0,a.createElementVNode)("label",{class:"setting-label"},"中期记忆自定义格式:",-1)),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[6]||(n[6]=e=>c.value.midTermFormat=e),class:"setting-textarea",placeholder:"留空使用默认格式。可自定义AI提示词来控制中期记忆的生成格式...",rows:"4"},null,512),[[a.vModelText,c.value.midTermFormat]]),n[18]||(n[18]=(0,a.createElementVNode)("span",{class:"setting-hint"},"自定义中期记忆的AI提示词格式，留空使用系统默认",-1))]),(0,a.createElementVNode)("div",Tg,[n[19]||(n[19]=(0,a.createElementVNode)("label",{class:"setting-label"},"长期记忆自定义格式:",-1)),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[7]||(n[7]=e=>c.value.longTermFormat=e),class:"setting-textarea",placeholder:"留空使用默认格式。可自定义AI提示词来控制长期记忆的生成格式...",rows:"4"},null,512),[[a.vModelText,c.value.longTermFormat]]),n[20]||(n[20]=(0,a.createElementVNode)("span",{class:"setting-hint"},"自定义长期记忆的AI提示词格式，留空使用系统默认",-1))]),(0,a.createElementVNode)("div",{class:"settings-actions"},[(0,a.createElementVNode)("button",{class:"action-btn success",onClick:V}," 💾 保存配置 "),(0,a.createElementVNode)("button",{class:"action-btn info",onClick:C}," 重置默认 ")]),(0,a.createCommentVNode)(" 手动总结触发 "),(0,a.createElementVNode)("div",jg,[(0,a.createElementVNode)("div",Mg,[(0,a.createElementVNode)("span",qg,"当前中期记忆: "+(0,a.toDisplayString)(m.value.length)+" 条",1),(0,a.createElementVNode)("span",Og,"（达到 "+(0,a.toDisplayString)(c.value.midTermTrigger)+" 条时自动触发总结）",1)]),(0,a.createElementVNode)("button",{class:"action-btn warning",onClick:z,disabled:m.value.length<c.value.midTermKeep+5,title:m.value.length<c.value.midTermKeep+5?`至少需要 ${c.value.midTermKeep+5} 条中期记忆才能总结`:"手动触发AI总结"}," 📝 手动总结中期记忆 ",8,Pg)])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 记忆列表 "),i.value?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Fg,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Lg,n[21]||(n[21]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},"⏳",-1),(0,a.createElementVNode)("div",{class:"loading-text"},"正在读取记忆...",-1)]))):0===g.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Yg,[n[22]||(n[22]=(0,a.createElementVNode)("div",{class:"empty-icon"},"🧠",-1)),(0,a.createElementVNode)("div",Rg,(0,a.toDisplayString)(h()),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Ug,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(g.value,(e,o)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:o,class:(0,a.normalizeClass)(["memory-card",`memory-${e.type}`])},[(0,a.createElementVNode)("div",Gg,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["memory-type-badge",`badge-${e.type}`])},(0,a.toDisplayString)((r=e.type,{short:"⚡",medium:"💭",long:"💾"}[r]||"🧠"))+" "+(0,a.toDisplayString)(y(e.type)),3),(0,a.createElementVNode)("div",Wg,[(0,a.createElementVNode)("button",{class:"delete-memory-btn",onClick:(0,a.withModifiers)(n=>(async e=>{N.showRetryDialog({title:"删除记忆",message:`确定要删除这条${y(e.type)}吗？此操作不可撤销。\n\n内容：${e.content.substring(0,50)}...`,confirmText:"删除",cancelText:"取消",onConfirm:async()=>{try{let n=-1;switch(e.type){case"short":n=s.value.findIndex(n=>n===e),-1!==n&&s.value.splice(n,1);break;case"medium":n=m.value.findIndex(n=>n===e),-1!==n&&m.value.splice(n,1);break;case"long":n=p.value.findIndex(n=>n===e),-1!==n&&p.value.splice(n,1)}if(-1===n)return void d.o.error("找不到要删除的记忆");const{useCharacterStore:a}=await Promise.resolve().then(t.bind(t,948));a(),await w(),bg.Yz.log("记忆中心",`✅ 已删除${y(e.type)}并同步到存档和酒馆`),d.o.success(`已删除${y(e.type)}并同步到酒馆`)}catch(e){bg.Yz.error("记忆中心","删除记忆失败:",e);const n=e instanceof Error?e.message:"未知错误";d.o.error(`删除失败: ${n}`)}},onCancel:()=>{}})})(e),["stop"]),title:"删除此记忆"}," 🗑️ ",8,Jg),(0,a.createElementVNode)("div",Hg,(0,a.toDisplayString)(e.time),1)])]),(0,a.createElementVNode)("div",Qg,[e.parsedContent&&e.parsedContent.format?((0,a.openBlock)(),(0,a.createElementBlock)("div",Kg,[e.parsedContent.title?((0,a.openBlock)(),(0,a.createElementBlock)("div",Xg," 【"+(0,a.toDisplayString)(e.parsedContent.title)+"】 ",1)):(0,a.createCommentVNode)("v-if",!0),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.parsedContent.format.sections,n=>((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:n.key},[e.parsedContent.sections&&e.parsedContent.sections[n.key]?((0,a.openBlock)(),(0,a.createElementBlock)("div",Zg,[(0,a.createElementVNode)("div",ef,[(0,a.createElementVNode)("span",nf,(0,a.toDisplayString)(n.icon),1),(0,a.createElementVNode)("span",tf,(0,a.toDisplayString)(n.title),1)]),(0,a.createCommentVNode)(" 确保只在数组时才遍历，字符串直接显示 "),Array.isArray(e.parsedContent.sections[n.key])?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(e.parsedContent.sections[n.key],e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"memory-item"},(0,a.toDisplayString)(e),1))),128)):((0,a.openBlock)(),(0,a.createElementBlock)("div",af,(0,a.toDisplayString)(e.parsedContent.sections[n.key]),1))])):(0,a.createCommentVNode)("v-if",!0)],64))),128)),(0,a.createCommentVNode)(" 未识别的通用内容 "),e.parsedContent.sections.general?((0,a.openBlock)(),(0,a.createElementBlock)("div",of,[n[23]||(n[23]=(0,a.createElementVNode)("div",{class:"memory-section"},[(0,a.createElementVNode)("span",{class:"memory-icon"},"📝"),(0,a.createElementVNode)("span",{class:"memory-section-title"},"其他记录")],-1)),(0,a.createCommentVNode)(" 确保只在数组时才遍历，字符串直接显示 "),Array.isArray(e.parsedContent.sections.general)?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(e.parsedContent.sections.general,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"memory-item"},(0,a.toDisplayString)(e),1))),128)):((0,a.openBlock)(),(0,a.createElementBlock)("div",rf,(0,a.toDisplayString)(e.parsedContent.sections.general),1))])):(0,a.createCommentVNode)("v-if",!0)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",lf,(0,a.toDisplayString)(e.content),1))])],2);var r}),128))]))]))]))}});var sf=t(1524),df={};df.styleTagTransform=A(),df.setAttributes=z(),df.insert=V().bind(null,"head"),df.domAPI=N(),df.insertStyleElement=B(),k()(sf.A,df),sf.A&&sf.A.locals&&sf.A.locals;const mf=(0,j.A)(cf,[["__scopeId","data-v-722c190a"]]);var pf=t(6728),vf=t(3943);const uf=(0,c.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),gf=(0,c.A)("mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]),ff=(0,c.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),bf=(0,c.A)("sprout",[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]]),hf=(0,c.A)("bird",[["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M3.4 18H12a8 8 0 0 0 8-8V7a4 4 0 0 0-7.28-2.3L2 20",key:"oj1oa8"}],["path",{d:"m20 7 2 .5-2 .5",key:"12nv4d"}],["path",{d:"M10 18v3",key:"1yea0a"}],["path",{d:"M14 17.75V21",key:"1pymcb"}],["path",{d:"M7 18a6 6 0 0 0 3.84-10.61",key:"1npnn0"}]]),yf=(0,c.A)("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]),xf=(0,c.A)("backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z",key:"1ol0lm"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}],["path",{d:"M8 22v-6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v6",key:"1fr6do"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}]]),kf={class:"character-details-wrapper"},wf={key:0,class:"loading-container"},Nf={key:1,class:"error-container"},Ef={class:"error-icon"},Vf={key:2,class:"character-details-content"},Cf={class:"character-header-card"},zf={class:"header-content"},Sf={class:"profile-section"},Bf={class:"avatar-wrapper"},Df=["title"],Af={class:"avatar-text"},_f={class:"identity-info"},$f={class:"character-title"},If={class:"character-subtitle"},Tf={class:"subtitle-item race-text"},jf={class:"subtitle-item age-text"},Mf={class:"subtitle-item origin-text"},qf={class:"core-stats-grid"},Of={class:"stat-card realm-card"},Pf={class:"card-icon"},Ff={class:"card-content"},Lf={class:"card-value realm-value"},Yf={key:0,class:"stat-card spirit-card"},Rf={class:"card-icon"},Uf={class:"card-content"},Gf={class:"card-value spirit-value"},Wf=["title"],Jf={class:"card-icon"},Hf={class:"card-content"},Qf={class:"card-value location-value"},Kf=["title"],Xf={class:"card-icon"},Zf={class:"card-content"},eb={class:"card-value origin-value"},nb={key:3,class:"stat-card reputation-card"},tb={class:"card-icon"},ab={class:"card-content"},ob={class:"card-value reputation-value"},rb={class:"cultivation-section"},lb={key:0,class:"cultivation-status mortal-status"},ib={class:"status-text"},cb={key:1,class:"cultivation-progress-card"},sb={class:"progress-header"},db={class:"progress-percentage"},mb={class:"progress-bar-container"},pb={class:"progress-bar-bg"},vb={class:"progress-text"},ub={key:2,class:"cultivation-status waiting-status"},gb={class:"content-grid"},fb={class:"info-section"},bb={class:"section-title"},hb={class:"title-icon"},yb={class:"vitals-grid"},xb={class:"vital-label"},kb={class:"vital-bar"},wb={class:"bar-container"},Nb={class:"vital-text"},Eb={class:"vital-item reputation-item"},Vb={class:"reputation-display"},Cb={class:"reputation-value"},zb={class:"info-section"},Sb={class:"section-title"},Bb={class:"title-icon"},Db={class:"basic-info-grid"},Ab={class:"basic-info-item"},_b={class:"info-value realm"},$b={key:0,class:"basic-info-item"},Ib={class:"basic-info-item"},Tb={class:"basic-info-item"},jb={class:"info-value"},Mb={key:1,class:"basic-info-item"},qb={class:"info-value location"},Ob={key:2,class:"basic-info-item"},Pb={class:"info-value world"},Fb={class:"info-section"},Lb={class:"section-title"},Yb={class:"title-icon"},Rb={class:"talent-content"},Ub={class:"talent-tier-card"},Gb={class:"tier-value-display"},Wb={key:0,class:"tier-description"},Jb={class:"root-main-info"},Hb={class:"property-badges"},Qb={class:"prop-badge speed-badge"},Kb={key:0,class:"root-description"},Xb={key:1,class:"root-effects"},Zb={class:"effects-tags"},eh={class:"talents-card"},nh={class:"talents-header"},th={key:0,class:"talents-count"},ah={key:0,class:"talents-container"},oh=["title"],rh={class:"talent-name"},lh={key:0,class:"talent-description-display"},ih={key:1,class:"talents-container no-talents"},ch={class:"info-section"},sh={class:"section-title"},dh={class:"title-icon"},mh={key:0,class:"empty-state"},ph={class:"empty-icon"},vh={key:1,class:"effects-list"},uh={class:"effect-header"},gh={class:"effect-name"},fh=["onClick"],bh={class:"effect-description"},hh={class:"effect-time-info"},yh={class:"effect-created"},xh={class:"effect-remaining"},kh={class:"info-section"},wh={class:"section-title"},Nh={class:"title-icon"},Eh={class:"attributes-display"},Vh={class:"final-attributes"},Ch={class:"attributes-grid"},zh={class:"attr-name"},Sh={class:"attr-value"},Bh={class:"attribute-breakdown"},Dh={class:"innate-attrs"},Ah={class:"attributes-grid compact"},_h={class:"attr-name"},$h={class:"attr-value"},Ih={class:"acquired-attrs"},Th={class:"attributes-grid compact"},jh={class:"attr-name"},Mh={class:"attr-value"},qh={key:0,class:"info-section"},Oh={class:"section-title"},Ph={class:"title-icon"},Fh={class:"body-parts-list"},Lh={class:"part-header"},Yh={class:"part-name"},Rh={key:0,class:"part-level"},Uh={class:"part-description"},Gh={class:"info-section"},Wh={class:"section-title"},Jh={class:"title-icon"},Hh={key:0,class:"empty-state"},Qh={class:"empty-icon"},Kh={key:1,class:"cultivation-display"},Xh={class:"technique-info"},Zh={class:"technique-main"},ey={class:"technique-quality"},ny={class:"technique-toggle"},ty={class:"technique-details"},ay={class:"technique-description"},oy={key:0,class:"technique-effects"},ry={class:"effects-list"},ly={key:0,class:"effect-item"},iy={class:"effect-value"},cy={key:1,class:"effect-item"},sy={class:"attribute-bonuses"},dy={key:1,class:"technique-effects no-effects"},my={class:"technique-progress"},py={key:0,class:"progress-item"},vy={class:"progress-bar"},uy={class:"progress-text"},gy={class:"progress-item"},fy={class:"progress-bar"},by={class:"progress-text"},hy={key:0,class:"learned-skills"},yy={class:"skills-count"},xy={class:"skills-preview"},ky={class:"skills-list-compact"},wy={key:0,class:"more-skills"},Ny={class:"skills-details"},Ey={key:0,class:"skill-category"},Vy={class:"skills-grid"},Cy=["onClick"],zy={class:"skill-name"},Sy={class:"skill-type"},By={class:"skill-source"},Dy={class:"skill-proficiency-mini"},Ay={class:"skill-status"},_y={key:1,class:"skill-category"},$y={class:"skills-grid"},Iy=["onClick"],Ty={class:"skill-name"},jy={class:"skill-type"},My={class:"skill-unlock"},qy={class:"info-section"},Oy={class:"section-title"},Py={class:"title-icon"},Fy={key:0,class:"empty-state"},Ly={class:"empty-icon"},Yy={key:1,class:"dao-list"},Ry={class:"dao-header-section"},Uy={class:"dao-summary"},Gy={class:"dao-count"},Wy={class:"dao-preview"},Jy=["onClick"],Hy={class:"dao-header"},Qy={class:"dao-name"},Ky={class:"dao-stage"},Xy={class:"dao-progress"},Zy={class:"progress-bar small"},ex={class:"progress-text small"},nx={key:0,class:"more-dao"},tx={class:"dao-details"},ax=["onClick"],ox={class:"dao-header"},rx={class:"dao-name"},lx={class:"dao-stage"},ix={class:"dao-progress"},cx={class:"progress-bar small"},sx={class:"progress-text small"},dx={class:"dao-stats"},mx={class:"stat-item"},px={class:"stat-value"},vx={class:"stat-item"},ux={class:"stat-value"},gx={class:"info-section"},fx={class:"section-title"},bx={class:"title-icon"},hx={key:0,class:"empty-state"},yx={class:"empty-icon"},xx={key:1,class:"relationships-summary"},kx={class:"relationship-stats"},wx={class:"stat-item"},Nx={class:"stat-value"},Ex={class:"stat-item"},Vx={class:"stat-value"},Cx={class:"info-section"},zx={class:"section-title"},Sx={class:"title-icon"},Bx={class:"inventory-summary"},Dx={class:"inventory-stats"},Ax={class:"stat-group"},_x={class:"stat-item"},$x={class:"stat-value"},Ix={class:"stat-item"},Tx={class:"stat-value"},jx={class:"stat-item"},Mx={class:"stat-value"},qx={class:"spirit-stones"},Ox={class:"stones-grid"},Px={class:"stone-name"},Fx={class:"stone-count"},Lx={key:1,class:"info-section"},Yx={class:"section-title"},Rx={class:"title-icon"},Ux={class:"sect-info"},Gx={class:"sect-header"},Wx={class:"sect-name"},Jx={class:"sect-type"},Hx={class:"sect-details"},Qx={class:"detail-row"},Kx={class:"detail-value"},Xx={class:"detail-row"},Zx={class:"detail-value"},ek={class:"detail-row"},nk={class:"modal-header"},tk={class:"modal-content"},ak={class:"skill-detail-grid"},ok={class:"skill-detail-item"},rk={class:"detail-value"},lk={class:"skill-detail-item"},ik={class:"skill-detail-item"},ck={class:"detail-value"},sk={class:"skill-detail-item"},dk={class:"detail-value"},mk={class:"skill-detail-item"},pk={class:"detail-value"},vk={class:"skill-description"},uk={class:"modal-header"},gk={class:"modal-content"},fk={class:"dao-progress-section"},bk={class:"dao-stage-info"},hk={class:"stage-value"},yk={class:"dao-progress-bar"},xk={class:"progress-bar-bg"},kk={class:"progress-text"},wk={class:"dao-stats-grid"},Nk={class:"dao-stat-item"},Ek={class:"stat-value"},Vk={class:"dao-stat-item"},Ck={class:"stat-value"},zk={class:"dao-description"},Sk={class:"modal-header"},Bk={class:"modal-content"},Dk={class:"spirit-root-detail-grid"},Ak={class:"detail-card"},_k={class:"detail-card"},$k={class:"detail-card"},Ik={class:"detail-value speed-value"},Tk={key:0,class:"spirit-root-effects-section"},jk={class:"effects-grid"},Mk={key:1,class:"advanced-details"},qk={class:"advanced-grid"},Ok={key:0,class:"advanced-item"},Pk={class:"advanced-value"},Fk={key:1,class:"advanced-item"},Lk={class:"advanced-value"},Yk=(0,a.defineComponent)({__name:"CharacterDetailsPanel",setup(e){const{saveData:n}=(0,Li.useUnifiedCharacterData)(),t=(0,q.useUIStore)(),o=(0,tn.useCharacterStore)(),r=(0,a.ref)(!1),l=(0,a.ref)(!1),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(!1),d=(0,a.ref)(!1),m=(0,a.ref)(!1),p=(0,a.ref)(null),v=(0,a.ref)(null),u=(0,a.computed)(()=>n.value?.角色基础信息),g=(0,a.computed)(()=>{const e=String(u.value?.名字||"").trim();return e?e.charAt(0):"?"}),f=(0,a.computed)(()=>n.value?.玩家角色状态),b=(0,a.computed)(()=>{const e=u.value?.出生日期,t=n.value?.游戏时间;return e&&t?(0,Uc.R)(e,t):u.value?.年龄||f.value?.寿命?.当前||0}),h=(0,a.computed)(()=>n.value?.修炼功法),y=(0,a.computed)(()=>n.value?.三千大道),x=(0,a.computed)(()=>y.value?.大道列表?Object.values(y.value.大道列表).filter(e=>e.是否解锁):[]),k=(0,a.computed)(()=>{if(!f.value)return[];const e=e=>("number"==typeof e?e:Number(e||0))||0,n=e=>{const n="number"==typeof e?e:Number(e||0);return isNaN(n)?0:Math.max(0,n)};return[{label:"气血",current:e(f.value.气血?.当前),max:n(f.value.气血?.上限),color:"red"},{label:"灵气",current:e(f.value.灵气?.当前),max:n(f.value.灵气?.上限),color:"blue"},{label:"神识",current:e(f.value.神识?.当前),max:n(f.value.神识?.上限),color:"gold"}]}),w=e=>{const n="number"==typeof e?e:Number(e||0);return isNaN(n)?0:Math.max(0,Math.min(10,Math.round(n)))},N=(0,a.computed)(()=>{const e=u.value?.先天六司||{};return{根骨:w(e.根骨),灵性:w(e.灵性),悟性:w(e.悟性),气运:w(e.气运),魅力:w(e.魅力),心性:w(e.心性)}}),E=(0,a.computed)(()=>{if(!n.value)return N.value;const e=(0,pf.MH)(N.value,n.value);return e?.最终六司||N.value}),V=((0,a.computed)(()=>{const e=n.value?.记忆;return e&&e.短期记忆&&Array.isArray(e.短期记忆)?e.短期记忆.slice(-3).reverse().map((e,n)=>({时间:"最近",事件:e})):[]}),(0,a.computed)(()=>{const e={根骨:0,灵性:0,悟性:0,气运:0,魅力:0,心性:0};if(!n.value)return e;const t=(0,pf.MH)(N.value,n.value);return t?.后天六司||e})),C=(0,a.computed)(()=>{const e=n.value?.身体部位开发;return e&&"object"==typeof e?Object.entries(e).filter(([,e])=>e&&"object"==typeof e).map(([e,n])=>({name:e,description:n.描述||"暂无描述",level:n.开发等级||0})):[]}),z=(0,a.computed)(()=>{const e=h.value?.功法效果;if(!e)return!1;const n=e.修炼速度加成&&e.修炼速度加成>0,t=e.属性加成&&Object.keys(e.属性加成).length>0;return n||t}),S=(0,a.computed)(()=>{const e=h.value;if(!e?.功法技能)return[];const n=[];return Object.entries(e.功法技能).forEach(([t,a])=>{const o=(e.已解锁技能||[]).includes(t),r=a;n.push({name:t,description:r?.技能描述||"",type:"功法技能",unlockCondition:"修炼解锁",unlocked:o})}),n}),B=(0,a.computed)(()=>{const e=n.value?.掌握技能||[],t=(h.value?.已解锁技能||[]).map(e=>{const n=h.value?.功法技能?.[e];return{name:e,proficiency:te(e,"technique"),source:h.value?.名称||"功法",type:"功法技能",description:n?.技能描述||"通过功法修炼掌握",unlocked:!0}}),a=[...e.map(e=>({name:e.技能名称,proficiency:e.熟练度,source:e.来源,type:"掌握技能",description:e.技能描述,unlocked:!0})),...t],o=new Map;return a.forEach(e=>{o.has(e.name)||o.set(e.name,e)}),Array.from(o.values())}),D=(0,a.computed)(()=>B.value.length),A=(0,a.computed)(()=>{const e=n.value?.人物关系||{};return Object.values(e).filter(e=>e&&e.名字).length}),_=(0,a.computed)(()=>{const e=Object.values(n.value?.人物关系||{}).filter(e=>e&&e.名字);if(0===e.length)return 0;const t=e.reduce((e,n)=>e+(n.好感度||0),0);return Math.round(t/e.length)}),$=(0,a.computed)(()=>{const e=n.value?.背包?.物品||{};return Object.entries(e).filter(([e,n])=>!String(e).startsWith("_")&&n&&"object"==typeof n&&"string"==typeof n.名称).length}),I=[{name:"下品",class:"grade-common"},{name:"中品",class:"grade-rare"},{name:"上品",class:"grade-epic"},{name:"极品",class:"grade-legend"}],T=()=>{const e=f.value?.境界?.名称;switch(e){case"凡人":case"普通人":return"等待仙缘";case"蛮兽":case"灵兽":return"野性本能";case"动物":return"自然状态";default:return"等待觉醒"}},j=()=>{const e=f.value?.境界?.当前进度,n=f.value?.境界?.下一级所需;return"number"==typeof e&&"number"==typeof n&&n>0},M=()=>{const e=f.value?.境界?.当前进度||0,n=f.value?.境界?.下一级所需||100;if(n>=1e4){const t=Math.floor(e/1e3),a=Math.floor(n/1e3);if(t>0&&a>0)return`${t}k/${a}k`}return`${e}/${n}`},O=e=>{if(e&&"object"==typeof e)return Yi({name:e.名称||"",阶段:e.阶段||"",当前进度:e.当前进度,下一级所需:e.下一级所需});const n="string"==typeof e?e:void 0,t=f.value?.境界?.当前进度,a=f.value?.境界?.下一级所需,o=f.value?.境界?.阶段;return Yi({name:n,阶段:o,当前进度:t,下一级所需:a})},P=()=>{const e=f.value?.境界?.当前进度||0,n=f.value?.境界?.下一级所需||100;return Math.round(e/n*100)},F=e=>e?"object"==typeof e&&null!==e&&"名称"in e?{name:e.名称||"未知",description:e.描述||""}:"string"==typeof e?{name:e,description:""}:{name:"未知",description:""}:{name:"未知",description:""},L=e=>F(e).name,Y=e=>F(e).description,R=e=>e&&Array.isArray(e)?e.map(e=>"string"==typeof e?{名称:e,描述:`天赋《${e}》的详细描述暂未开放，请期待后续更新。`}:{名称:e.名称,描述:e.描述||`天赋《${e.名称}》的详细描述暂未开放，请期待后续更新。`}):[],U=(e,n="border")=>e?`${n}-quality-${e.品质?.quality||"未知"}`:"",G=e=>y.value?.大道列表?.[e],W=e=>G(e)?.当前阶段||0,J=e=>{const n=G(e);if(!n)return 0;const t=n.当前阶段||0,a=n.阶段列表?.[t];if(!a)return 0;const o=a.突破经验;return o<=0?100:Math.min(100,Math.round(n.当前经验/o*100))},H=e=>G(e)?.当前经验||0,Q=e=>G(e)?.总经验||0,K=e=>{const t=n.value?.背包?.物品||{};return Object.entries(t).filter(([e,n])=>!String(e).startsWith("_")&&n&&"object"==typeof n).map(([,e])=>e).filter(n=>n.类型===e).length},X=e=>n.value?.背包?.灵石?.[e]||0,Z=e=>{if(!e||!e.状态描述)return"";let n=e.状态描述;const t=e.时间;return t&&n.includes(t)&&(n=n.replace(new RegExp(`[^。]*${t}[^。]*。`,"g"),"").replace(new RegExp(`持续时间[：][^。]*${t}[^。]*。`,"g"),"").replace(new RegExp(`剩余时间[：][^。]*${t}[^。]*。`,"g"),"").replace(new RegExp(`时间[：][^。]*${t}[^。]*。`,"g"),"").trim()),n||"无描述"},ee=e=>{if(!e.生成时间)return"未知";const{年:n,月:t,日:a,小时:o,分钟:r}=e.生成时间;return`${n}年${t}月${a}日 ${o||0}:${String(r??0).padStart(2,"0")}`},ne=e=>{if(!n.value?.游戏时间)return"未知";const t=(0,vf.E0)(e,n.value.游戏时间);return(0,vf.QS)(t)},te=(e,n)=>30+(e.split("").reduce((e,n)=>e+n.charCodeAt(0),0)+n.length)%66,ae=()=>{l.value=!l.value},oe=()=>{i.value=!i.value},re=()=>{c.value=!c.value},le=e=>{v.value=e,d.value=!0},ie=e=>{p.value=e,s.value=!0},ce=()=>{m.value=!0},se=()=>{s.value=!1,d.value=!1,m.value=!1,p.value=null,v.value=null},de=()=>{if(!v.value)return null;const e=G(v.value);if(!e)return{name:v.value,stage:"初始阶段",currentExp:0,totalExp:0,progressPercent:0,description:"此大道已解锁，但尚未开始修炼"};const n=e.当前阶段||0,t=e.当前经验||0,a=e.总经验||0,o=J(v.value);return{name:v.value,stage:`第${n}阶段`,currentExp:t,totalExp:a,progressPercent:o,description:e.描述||"此道深奥玄妙，需持之以恒方能有所成就"}},me=()=>{if(!p.value)return null;if("object"==typeof p.value&&"proficiency"in p.value){const e=p.value;return{name:e.name,type:e.type,status:"已解锁",condition:"已掌握",description:e.description,source:e.source,proficiency:e.proficiency}}if("string"==typeof p.value)return{name:p.value,type:"功法技能",status:"已解锁",condition:"修炼完成",description:"通过修炼功法获得的技能",source:"功法修炼"};const e=p.value;return{name:e.name,type:e.type,status:e.unlocked?"已解锁":"未解锁",condition:e.unlocked?"修炼完成":e.unlockCondition,description:e.description,source:"功法传承"}},pe=async()=>{r.value=!0,r.value=!1};(0,a.onMounted)(async()=>{bg.Yz.log("人物详情","组件挂载，同步数据"),await pe()});const ve=e=>e?"string"==typeof e?e:"object"==typeof e&&null!==e&&"名称"in e?e.名称||"待定":"格式错误":"待定",ue=e=>{if(!e)return{name:"未知",grade:"凡品",description:"暂无灵根信息"};if("object"==typeof e&&null!==e&&"名称"in e)return{name:e.名称||"未知",grade:e.品级||"凡品",description:e.描述||`关于${e.名称}的详细描述暂未开放。`};if("string"==typeof e){const n=e.match(/(下品|中品|上品|极品|神品|特殊|凡品)/),t=n?n[1]:"凡品";return{name:n?e.replace(n[1],"").trim():e,grade:t,description:`一种${t}灵根。`}}return{name:"未知",grade:"凡品",description:"灵根信息格式无法识别"}},ge=e=>{const n=ue(e);return n.name&&"未知"!==n.name?n.grade&&"未知"!==n.grade&&"凡品"!==n.grade?`${n.name}(${n.grade})`:n.name:"未知"},fe=e=>{const n=ue(e);return n.name&&"未知"!==n.name?n.name:"未知"},be=e=>ue(e).grade||"凡品",he=e=>ue(e).description||"未知",ye=e=>{const n=ue(e),t=n.grade?.toLowerCase()||"";return t.includes("神品")?"spirit-divine":t.includes("极品")?"spirit-supreme":t.includes("上品")?"spirit-superior":t.includes("中品")?"spirit-medium":t.includes("下品")?"spirit-inferior":t.includes("凡品")?"spirit-common":"spirit-unknown"},xe=e=>{const n=e?.灵根;if(n&&"object"==typeof n){if("base_multiplier"in n&&n.base_multiplier)return`${n.base_multiplier}x`;if("cultivation_speed"in n&&n.cultivation_speed)return n.cultivation_speed}return{凡品:"1.0x",下品:"1.1x",中品:"1.3x",上品:"1.6x",极品:"2.0x",神品:"2.8x",特殊:"特殊"}[ue(n).grade||""]||"1.0x"},ke=e=>{const n=e?.灵根;return n&&"object"==typeof n&&"special_effects"in n&&Array.isArray(n.special_effects)?n.special_effects:[]};return(e,p)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",kf,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",wf,p[4]||(p[4]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},null,-1),(0,a.createElementVNode)("p",null,"加载角色数据..",-1)]))):u.value&&(0,a.unref)(n)?u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vf,[(0,a.createCommentVNode)(" 顶部角色信息卡片 - 全新设计 "),(0,a.createElementVNode)("div",Cf,[(0,a.createCommentVNode)(" 背景装饰 "),p[19]||(p[19]=(0,a.createElementVNode)("div",{class:"header-bg-decoration"},null,-1)),(0,a.createCommentVNode)(" 主要信息区 "),(0,a.createElementVNode)("div",zf,[(0,a.createCommentVNode)(" 左侧：头像和基础信息 "),(0,a.createElementVNode)("div",Sf,[(0,a.createElementVNode)("div",Bf,[(0,a.createElementVNode)("div",{class:"avatar-circle",title:u.value.名字},[(0,a.createElementVNode)("span",Af,(0,a.toDisplayString)(g.value),1)],8,Df),p[6]||(p[6]=(0,a.createElementVNode)("div",{class:"avatar-glow"},null,-1))]),(0,a.createElementVNode)("div",_f,[(0,a.createElementVNode)("h1",$f,(0,a.toDisplayString)(u.value.名字),1),(0,a.createElementVNode)("div",If,[u.value.性别?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["subtitle-item",`gender-badge gender-${u.value.性别}`])},(0,a.toDisplayString)(("男"===u.value.性别?"♂":"♀")+" "+u.value.性别),3),p[7]||(p[7]=(0,a.createElementVNode)("span",{class:"subtitle-divider"},"·",-1))],64)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("span",Tf,(0,a.toDisplayString)(u.value.种族||"人族"),1),p[8]||(p[8]=(0,a.createElementVNode)("span",{class:"subtitle-divider"},"·",-1)),(0,a.createElementVNode)("span",jf,(0,a.toDisplayString)(b.value)+"岁",1),p[9]||(p[9]=(0,a.createElementVNode)("span",{class:"subtitle-divider"},"·",-1)),(0,a.createElementVNode)("span",Mf,(0,a.toDisplayString)(ve(u.value.出生)),1)])])]),(0,a.createCommentVNode)(" 中间：核心数据卡片组 "),(0,a.createElementVNode)("div",qf,[(0,a.createCommentVNode)(" 境界卡片 "),(0,a.createElementVNode)("div",Of,[(0,a.createElementVNode)("div",Pf,[(0,a.createVNode)((0,a.unref)(gf),{size:20})]),(0,a.createElementVNode)("div",Ff,[p[10]||(p[10]=(0,a.createElementVNode)("div",{class:"card-label"},"境界",-1)),(0,a.createElementVNode)("div",Lf,(0,a.toDisplayString)(O(f.value?.境界?.名称)||"凡人"),1)])]),(0,a.createCommentVNode)(" 灵根卡片 "),u.value.灵根?((0,a.openBlock)(),(0,a.createElementBlock)("div",Yf,[(0,a.createElementVNode)("div",Rf,[(0,a.createVNode)((0,a.unref)(Lc),{size:20})]),(0,a.createElementVNode)("div",Uf,[p[11]||(p[11]=(0,a.createElementVNode)("div",{class:"card-label"},"灵根",-1)),(0,a.createElementVNode)("div",Gf,(0,a.toDisplayString)(fe(u.value.灵根)),1)])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 位置卡片 "),f.value?.位置?.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"stat-card location-card",title:f.value.位置.描述},[(0,a.createElementVNode)("div",Jf,[(0,a.createVNode)((0,a.unref)(ff),{size:20})]),(0,a.createElementVNode)("div",Hf,[p[12]||(p[12]=(0,a.createElementVNode)("div",{class:"card-label"},"位置",-1)),(0,a.createElementVNode)("div",Qf,(0,a.toDisplayString)(f.value.位置.描述),1)])],8,Wf)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 出生卡片 "),u.value.出生?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:2,class:"stat-card origin-card clickable",onClick:p[0]||(p[0]=e=>(e=>{if(e&&"object"==typeof e&&null!==e&&"名称"in e&&"描述"in e){const n=e;t.showDetailModal({title:`出身背景: ${n.名称}`,content:n.描述})}})(u.value.出生)),title:"object"==typeof u.value.出生?"点击查看详情":""},[(0,a.createElementVNode)("div",Xf,[(0,a.createVNode)((0,a.unref)(bf),{size:20})]),(0,a.createElementVNode)("div",Zf,[p[13]||(p[13]=(0,a.createElementVNode)("div",{class:"card-label"},"出生",-1)),(0,a.createElementVNode)("div",eb,(0,a.toDisplayString)(ve(u.value.出生)),1)])],8,Kf)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 声望卡片 "),f.value?.声望?((0,a.openBlock)(),(0,a.createElementBlock)("div",nb,[(0,a.createElementVNode)("div",tb,[(0,a.createVNode)((0,a.unref)(Rc),{size:20})]),(0,a.createElementVNode)("div",ab,[p[14]||(p[14]=(0,a.createElementVNode)("div",{class:"card-label"},"声望",-1)),(0,a.createElementVNode)("div",ob,(0,a.toDisplayString)(f.value.声望),1)])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 右侧：修为进度 "),(0,a.createElementVNode)("div",rb,[(v=f.value?.境界?.名称,!v||["凡人","蛮兽","灵兽","动物","凡物","普通人"].includes(v)?((0,a.openBlock)(),(0,a.createElementBlock)("div",lb,[p[15]||(p[15]=(0,a.createElementVNode)("div",{class:"status-icon"},"🌱",-1)),(0,a.createElementVNode)("div",ib,(0,a.toDisplayString)(T()),1)])):j()?((0,a.openBlock)(),(0,a.createElementBlock)("div",cb,[(0,a.createElementVNode)("div",sb,[p[16]||(p[16]=(0,a.createElementVNode)("span",{class:"progress-label"},"修为进度",-1)),(0,a.createElementVNode)("span",db,(0,a.toDisplayString)(P())+"%",1)]),(0,a.createElementVNode)("div",mb,[(0,a.createElementVNode)("div",pb,[(0,a.createElementVNode)("div",{class:"progress-bar-fill",style:(0,a.normalizeStyle)({width:P()+"%"})},p[17]||(p[17]=[(0,a.createElementVNode)("div",{class:"progress-bar-shine"},null,-1)]),4)])]),(0,a.createElementVNode)("div",vb,(0,a.toDisplayString)(M()),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",ub,p[18]||(p[18]=[(0,a.createElementVNode)("div",{class:"status-icon"},"✨",-1),(0,a.createElementVNode)("div",{class:"status-text"},"等待仙缘",-1)]))))])])]),(0,a.createCommentVNode)(" 主要内容区域 "),(0,a.createElementVNode)("div",gb,[(0,a.createCommentVNode)(" 生命状态 "),(0,a.createElementVNode)("div",fb,[(0,a.createElementVNode)("h3",bb,[(0,a.createElementVNode)("div",hb,[(0,a.createVNode)((0,a.unref)(Pc),{size:18})]),p[20]||(p[20]=(0,a.createTextVNode)(" 生命状态 ",-1))]),(0,a.createElementVNode)("div",yb,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(k.value,e=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"vital-item",key:e.label},[(0,a.createElementVNode)("div",xb,(0,a.toDisplayString)(e.label),1),(0,a.createElementVNode)("div",kb,[(0,a.createElementVNode)("div",wb,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["bar-fill",`bar-${e.color}`]),style:(0,a.normalizeStyle)({width:(n=e.current,t=e.max,Math.round(n/t*100)+"%")})},null,6)]),(0,a.createElementVNode)("div",Nb,(0,a.toDisplayString)(e.current)+"/"+(0,a.toDisplayString)(e.max),1)])]);var n,t}),128)),(0,a.createCommentVNode)(" 声望显示 "),(0,a.createElementVNode)("div",Eb,[p[21]||(p[21]=(0,a.createElementVNode)("div",{class:"vital-label"},"声望",-1)),(0,a.createElementVNode)("div",Vb,[(0,a.createElementVNode)("span",Cb,(0,a.toDisplayString)(f.value?.声望||"籍籍无名"),1)])])])]),(0,a.createCommentVNode)(" 角色基础信息 "),(0,a.createElementVNode)("div",zb,[(0,a.createElementVNode)("h3",Sb,[(0,a.createElementVNode)("div",Bb,[(0,a.createVNode)((0,a.unref)(zi),{size:18})]),p[22]||(p[22]=(0,a.createTextVNode)(" 角色背景 ",-1))]),(0,a.createElementVNode)("div",Db,[(0,a.createElementVNode)("div",Ab,[p[23]||(p[23]=(0,a.createElementVNode)("span",{class:"info-label"},"境界",-1)),(0,a.createElementVNode)("span",_b,(0,a.toDisplayString)(O(f.value?.境界)),1)]),u.value.性别?((0,a.openBlock)(),(0,a.createElementBlock)("div",$b,[p[24]||(p[24]=(0,a.createElementVNode)("span",{class:"info-label"},"性别",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["info-value gender",`gender-${u.value.性别}`])},(0,a.toDisplayString)(u.value.性别),3)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Ib,[p[25]||(p[25]=(0,a.createElementVNode)("span",{class:"info-label"},"灵根",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["info-value spirit-root",`root-${ye(u.value.灵根)}`])},(0,a.toDisplayString)(ge(u.value.灵根)),3)]),(0,a.createElementVNode)("div",Tb,[p[26]||(p[26]=(0,a.createElementVNode)("span",{class:"info-label"},"年龄",-1)),(0,a.createElementVNode)("span",jb,(0,a.toDisplayString)(b.value)+"岁",1)]),f.value?.位置?.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",Mb,[p[27]||(p[27]=(0,a.createElementVNode)("span",{class:"info-label"},"位置",-1)),(0,a.createElementVNode)("span",qb,(0,a.toDisplayString)(f.value.位置.描述),1)])):u.value.世界?((0,a.openBlock)(),(0,a.createElementBlock)("div",Ob,[p[28]||(p[28]=(0,a.createElementVNode)("span",{class:"info-label"},"世界",-1)),(0,a.createElementVNode)("span",Pb,(0,a.toDisplayString)(u.value.世界),1)])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 天赋与灵根 "),(0,a.createElementVNode)("div",Fb,[(0,a.createElementVNode)("h3",Lb,[(0,a.createElementVNode)("div",Yb,[(0,a.createVNode)((0,a.unref)(Lc),{size:18})]),p[29]||(p[29]=(0,a.createTextVNode)(" 天赋与灵根 ",-1))]),(0,a.createElementVNode)("div",Rb,[(0,a.createCommentVNode)(" 天资等级卡片 "),(0,a.createElementVNode)("div",Ub,[p[30]||(p[30]=(0,a.createElementVNode)("div",{class:"tier-header"},[(0,a.createElementVNode)("div",{class:"tier-icon"},"🌟"),(0,a.createElementVNode)("span",{class:"tier-label"},"天资等级")],-1)),(0,a.createElementVNode)("div",Gb,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["tier-value",`tier-${L(u.value.天资)}`])},(0,a.toDisplayString)(L(u.value.天资)),3)]),Y(u.value.天资)?((0,a.openBlock)(),(0,a.createElementBlock)("div",Wb,(0,a.toDisplayString)(Y(u.value.天资)),1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 灵根属性卡片 (Re-designed) "),(0,a.createElementVNode)("div",{class:"spirit-root-card",onClick:ce},[p[31]||(p[31]=(0,a.createElementVNode)("div",{class:"root-header"},[(0,a.createElementVNode)("div",{class:"root-icon"},"⚡"),(0,a.createElementVNode)("span",{class:"root-label"},"灵根属性"),(0,a.createElementVNode)("span",{class:"click-hint"},"点击查看详情")],-1)),(0,a.createElementVNode)("div",Jb,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["root-name",`root-${ye(u.value.灵根)}`])},(0,a.toDisplayString)(ge(u.value.灵根)),3),(0,a.createElementVNode)("div",Hb,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["prop-badge grade-badge",`grade-${be(u.value.灵根)||"凡品"}`])},(0,a.toDisplayString)(be(u.value.灵根)||"凡品"),3),(0,a.createElementVNode)("span",Qb,(0,a.toDisplayString)(xe(u.value)),1)])]),he(u.value.灵根)?((0,a.openBlock)(),(0,a.createElementBlock)("div",Kb,(0,a.toDisplayString)(he(u.value.灵根)),1)):(0,a.createCommentVNode)("v-if",!0),ke(u.value).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",Xb,[(0,a.createElementVNode)("div",Zb,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ke(u.value),e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"effect-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 天赋列表卡片 "),(0,a.createElementVNode)("div",eh,[(0,a.createElementVNode)("div",nh,[p[32]||(p[32]=(0,a.createElementVNode)("div",{class:"talents-icon"},"✨",-1)),p[33]||(p[33]=(0,a.createElementVNode)("span",{class:"talents-label"},"天赋特质",-1)),R(u.value.天赋)?.length?((0,a.openBlock)(),(0,a.createElementBlock)("span",th,"("+(0,a.toDisplayString)(R(u.value.天赋).length)+")",1)):(0,a.createCommentVNode)("v-if",!0)]),R(u.value.天赋)?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",ah,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(R(u.value.天赋),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.名称,class:"talent-item",title:e.描述},[(0,a.createElementVNode)("div",rh,(0,a.toDisplayString)(e.名称),1),e.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",lh,(0,a.toDisplayString)(e.描述),1)):(0,a.createCommentVNode)("v-if",!0)],8,oh))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",ih,p[34]||(p[34]=[(0,a.createElementVNode)("div",{class:"talent-item no-talent"},[(0,a.createElementVNode)("div",{class:"talent-name"},"无")],-1)])))])])]),(0,a.createCommentVNode)(" 状态效果 "),(0,a.createElementVNode)("div",ch,[(0,a.createElementVNode)("h3",sh,[(0,a.createElementVNode)("div",dh,[(0,a.createVNode)((0,a.unref)(Rc),{size:18})]),p[35]||(p[35]=(0,a.createTextVNode)(" 状态效果 ",-1))]),f.value?.状态效果?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",vh,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(f.value.状态效果,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.状态名称,class:(0,a.normalizeClass)(["effect-item",`effect-${e.类型}`])},[(0,a.createElementVNode)("div",uh,[(0,a.createElementVNode)("span",gh,(0,a.toDisplayString)(e.状态名称),1),(0,a.createElementVNode)("button",{class:"effect-remove-btn",onClick:t=>(async e=>{if(n.value&&confirm(`确定要移除状态效果"${e}"吗？`))try{(0,vf.wG)(n.value,e)?(await o.syncFromTavern(),bg.Yz.log("角色详情面板",`已移除状态效果: ${e}`)):bg.Yz.warn("角色详情面板",`移除状态效果失败: ${e}`)}catch(e){bg.Yz.error("角色详情面板","移除状态效果失败:",e)}})(e.状态名称),title:"移除状态效果"},[(0,a.createVNode)((0,a.unref)(Ne),{size:14})],8,fh)]),(0,a.createElementVNode)("div",bh,(0,a.toDisplayString)(Z(e)),1),(0,a.createElementVNode)("div",hh,[(0,a.createElementVNode)("span",yh,"生成: "+(0,a.toDisplayString)(ee(e)),1),(0,a.createElementVNode)("span",xh,"剩余: "+(0,a.toDisplayString)(ne(e)),1)])],2))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",mh,[(0,a.createElementVNode)("div",ph,[(0,a.createVNode)((0,a.unref)(hf),{size:32})]),p[36]||(p[36]=(0,a.createElementVNode)("span",null,"当前无状态效果",-1))]))]),(0,a.createCommentVNode)(" 六司属性 "),(0,a.createElementVNode)("div",kh,[(0,a.createElementVNode)("h3",wh,[(0,a.createElementVNode)("div",Nh,[(0,a.createVNode)((0,a.unref)(Mi),{size:18})]),p[37]||(p[37]=(0,a.createTextVNode)(" 六司属性 ",-1))]),(0,a.createElementVNode)("div",Eh,[(0,a.createCommentVNode)(" 最终属性 "),(0,a.createElementVNode)("div",Vh,[p[38]||(p[38]=(0,a.createElementVNode)("h4",{class:"attribute-group-title"},"最终六司",-1)),(0,a.createElementVNode)("div",Ch,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(E.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"attribute-item final"},[(0,a.createElementVNode)("span",zh,(0,a.toDisplayString)(n),1),(0,a.createElementVNode)("span",Sh,(0,a.toDisplayString)(e),1)]))),128))])]),(0,a.createCommentVNode)(" 属性详�?"),(0,a.createElementVNode)("div",Bh,[(0,a.createElementVNode)("div",Dh,[p[39]||(p[39]=(0,a.createElementVNode)("h4",{class:"attribute-group-title"},"先天六司",-1)),(0,a.createElementVNode)("div",Ah,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(N.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"attribute-item innate"},[(0,a.createElementVNode)("span",_h,(0,a.toDisplayString)(n),1),(0,a.createElementVNode)("span",$h,(0,a.toDisplayString)(e),1)]))),128))])]),(0,a.createElementVNode)("div",Ih,[p[40]||(p[40]=(0,a.createElementVNode)("h4",{class:"attribute-group-title"},"后天六司",-1)),(0,a.createElementVNode)("div",Th,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(V.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:(0,a.normalizeClass)(["attribute-item acquired",{"has-bonus":e>0}])},[(0,a.createElementVNode)("span",jh,(0,a.toDisplayString)(n),1),(0,a.createElementVNode)("span",Mh,(0,a.toDisplayString)(e>0?`+${e}`:e),1)],2))),128))])])])])]),(0,a.createCommentVNode)(" 身体部位开发 "),C.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",qh,[(0,a.createElementVNode)("h3",Oh,[(0,a.createElementVNode)("div",Ph,[(0,a.createVNode)((0,a.unref)(Lc),{size:18})]),p[41]||(p[41]=(0,a.createTextVNode)(" 身体部位开发 ",-1))]),(0,a.createElementVNode)("div",Fh,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(C.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.name,class:"body-part-item"},[(0,a.createElementVNode)("div",Lh,[(0,a.createElementVNode)("span",Yh,(0,a.toDisplayString)(e.name),1),e.level>0?((0,a.openBlock)(),(0,a.createElementBlock)("span",Rh,"Lv."+(0,a.toDisplayString)(e.level),1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",Uh,(0,a.toDisplayString)(e.description),1)]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 修炼功法 "),(0,a.createElementVNode)("div",Gh,[(0,a.createElementVNode)("h3",Wh,[(0,a.createElementVNode)("div",Jh,[(0,a.createVNode)((0,a.unref)(Si),{size:18})]),p[42]||(p[42]=(0,a.createTextVNode)(" 修炼功法 ",-1))]),h.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Kh,[(0,a.createElementVNode)("div",Xh,[(0,a.createElementVNode)("div",{class:"technique-header",onClick:ae},[(0,a.createElementVNode)("div",Zh,[(0,a.createElementVNode)("h4",{class:(0,a.normalizeClass)(["technique-name",U(h.value,"text")])},(0,a.toDisplayString)(h.value?.名称),3),(0,a.createElementVNode)("div",ey,(0,a.toDisplayString)(h.value?.品质?.quality||"未知")+"品"+(0,a.toDisplayString)(h.value?.品质?.grade||0)+"阶",1)]),(0,a.createElementVNode)("div",ny,[(0,a.createVNode)((0,a.unref)(Ev),{size:16,class:(0,a.normalizeClass)([{rotated:l.value},"toggle-icon"])},null,8,["class"])])]),(0,a.createCommentVNode)(" 功法详情（可折叠�?"),(0,a.withDirectives)((0,a.createElementVNode)("div",ty,[(0,a.createElementVNode)("div",ay,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(h.value?.描述||"此功法奥妙无穷，随修炼加深方可领悟其真意。"),1)]),z.value&&h.value?.功法效果?((0,a.openBlock)(),(0,a.createElementBlock)("div",oy,[p[46]||(p[46]=(0,a.createElementVNode)("h5",{class:"effects-title"},"功法效果",-1)),(0,a.createElementVNode)("div",ry,[h.value.功法效果.修炼速度加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",ly,[p[44]||(p[44]=(0,a.createElementVNode)("span",{class:"effect-label"},"修炼加成：",-1)),(0,a.createElementVNode)("span",iy,(0,a.toDisplayString)((100*h.value.功法效果.修炼速度加成).toFixed(0))+"%",1)])):(0,a.createCommentVNode)("v-if",!0),h.value.功法效果.属性加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",cy,[p[45]||(p[45]=(0,a.createElementVNode)("span",{class:"effect-label"},"属性提升：",-1)),(0,a.createElementVNode)("div",sy,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(h.value.功法效果.属性加成,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"bonus-tag"},(0,a.toDisplayString)(n)+" +"+(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)])])):h.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",dy,p[47]||(p[47]=[(0,a.createElementVNode)("h5",{class:"effects-title"},"功法效果",-1),(0,a.createElementVNode)("p",{class:"no-effects-text"},"此功法无特殊效果",-1)]))):(0,a.createCommentVNode)("v-if",!0)],512),[[a.vShow,l.value]]),(0,a.createElementVNode)("div",my,[h.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",py,[p[48]||(p[48]=(0,a.createElementVNode)("span",{class:"progress-label"},"修炼进度",-1)),(0,a.createElementVNode)("div",vy,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:Math.max(2,h.value.修炼进度||0)+"%"})},null,4)]),(0,a.createElementVNode)("span",uy,(0,a.toDisplayString)(h.value.修炼进度||0)+"%",1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",gy,[p[49]||(p[49]=(0,a.createElementVNode)("span",{class:"progress-label"},"熟练度",-1)),(0,a.createElementVNode)("div",fy,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:Math.max(2,h.value.熟练度||0)+"%"})},null,4)]),(0,a.createElementVNode)("span",by,(0,a.toDisplayString)(h.value.熟练度||0)+"%",1)])])]),(0,a.createCommentVNode)(" 已学技能 "),B.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",hy,[(0,a.createElementVNode)("div",{class:"skills-header",onClick:oe},[p[50]||(p[50]=(0,a.createElementVNode)("h4",{class:"skills-title"},"已掌握技能",-1)),(0,a.createElementVNode)("div",yy,"("+(0,a.toDisplayString)(D.value)+"个)",1),(0,a.createVNode)((0,a.unref)(Ev),{size:14,class:(0,a.normalizeClass)([{rotated:i.value},"toggle-icon"])},null,8,["class"])]),(0,a.withDirectives)((0,a.createElementVNode)("div",xy,[(0,a.createElementVNode)("div",ky,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.value.slice(0,3),e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e.name,class:"skill-tag compact"},(0,a.toDisplayString)(e.name),1))),128)),D.value>3?((0,a.openBlock)(),(0,a.createElementBlock)("span",wy,"...")):(0,a.createCommentVNode)("v-if",!0)])],512),[[a.vShow,!i.value]]),(0,a.withDirectives)((0,a.createElementVNode)("div",Ny,[(0,a.createCommentVNode)(" 所有已掌握的技�?"),B.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Ey,[p[51]||(p[51]=(0,a.createElementVNode)("h5",{class:"category-title"},"所有技能",-1)),(0,a.createElementVNode)("div",Vy,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.name,class:"skill-card",onClick:n=>ie(e)},[(0,a.createElementVNode)("div",zy,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("div",Sy,(0,a.toDisplayString)(e.type),1),(0,a.createElementVNode)("div",By,(0,a.toDisplayString)(e.source),1),(0,a.createElementVNode)("div",Dy," 熟练度 "+(0,a.toDisplayString)(e.proficiency)+"% ",1),(0,a.createElementVNode)("div",Ay,[(0,a.createVNode)((0,a.unref)(Rc),{size:12,class:"unlock-icon"})])],8,Cy))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 未解锁的功法技能 "),S.value.some(e=>!e.unlocked)?((0,a.openBlock)(),(0,a.createElementBlock)("div",_y,[p[52]||(p[52]=(0,a.createElementVNode)("h5",{class:"category-title"},"未解锁技能",-1)),(0,a.createElementVNode)("div",$y,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(S.value.filter(e=>!e.unlocked),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.name,class:"skill-card skill-locked",onClick:n=>ie(e)},[(0,a.createElementVNode)("div",Ty,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("div",jy,(0,a.toDisplayString)(e.type),1),(0,a.createElementVNode)("div",My,(0,a.toDisplayString)(e.unlockCondition),1)],8,Iy))),128))])])):(0,a.createCommentVNode)("v-if",!0)],512),[[a.vShow,i.value]])])):(0,a.createCommentVNode)("v-if",!0)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Hh,[(0,a.createElementVNode)("div",Qh,[(0,a.createVNode)((0,a.unref)(Si),{size:32})]),p[43]||(p[43]=(0,a.createElementVNode)("span",null,"尚未修炼功法",-1))]))]),(0,a.createCommentVNode)(" 三千大道 "),(0,a.createElementVNode)("div",qy,[(0,a.createElementVNode)("h3",Oy,[(0,a.createElementVNode)("div",Py,[(0,a.createVNode)((0,a.unref)(Bi),{size:18})]),p[53]||(p[53]=(0,a.createTextVNode)(" 三千大道 ",-1))]),x.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Yy,[(0,a.createElementVNode)("div",Ry,[(0,a.createElementVNode)("div",Uy,[(0,a.createElementVNode)("span",Gy,"已解 "+(0,a.toDisplayString)(x.value.length)+" 条大道",1),(0,a.createElementVNode)("button",{class:"dao-expand-btn",onClick:re},[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(c.value?"收起":"展开"),1),(0,a.createVNode)((0,a.unref)(Ev),{size:14,class:(0,a.normalizeClass)([{rotated:c.value},"toggle-icon"])},null,8,["class"])])])]),(0,a.withDirectives)((0,a.createElementVNode)("div",Wy,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.slice(0,2).map(e=>e.道名),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"dao-item compact",onClick:n=>le(e)},[(0,a.createElementVNode)("div",Hy,[(0,a.createElementVNode)("span",Qy,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)("span",Ky,"第"+(0,a.toDisplayString)(W(e))+"阶段",1)]),(0,a.createElementVNode)("div",Xy,[(0,a.createElementVNode)("div",Zy,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:J(e)+"%"})},null,4)]),(0,a.createElementVNode)("span",ex,(0,a.toDisplayString)(J(e))+"%",1)])],8,Jy))),128)),x.value.length>2?((0,a.openBlock)(),(0,a.createElementBlock)("div",nx," 还有 "+(0,a.toDisplayString)(x.value.length-2)+" 条大道.. ",1)):(0,a.createCommentVNode)("v-if",!0)],512),[[a.vShow,!c.value]]),(0,a.withDirectives)((0,a.createElementVNode)("div",tx,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.map(e=>e.道名),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"dao-item detailed",onClick:n=>le(e)},[(0,a.createElementVNode)("div",ox,[(0,a.createElementVNode)("span",rx,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)("span",lx,"第"+(0,a.toDisplayString)(W(e))+"阶段",1)]),(0,a.createElementVNode)("div",ix,[(0,a.createElementVNode)("div",cx,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:J(e)+"%"})},null,4)]),(0,a.createElementVNode)("span",sx,(0,a.toDisplayString)(J(e))+"%",1)]),(0,a.createElementVNode)("div",dx,[(0,a.createElementVNode)("div",mx,[p[55]||(p[55]=(0,a.createElementVNode)("span",{class:"stat-label"},"当前经验",-1)),(0,a.createElementVNode)("span",px,(0,a.toDisplayString)(H(e)),1)]),(0,a.createElementVNode)("div",vx,[p[56]||(p[56]=(0,a.createElementVNode)("span",{class:"stat-label"},"总经验",-1)),(0,a.createElementVNode)("span",ux,(0,a.toDisplayString)(Q(e)),1)])])],8,ax))),128))],512),[[a.vShow,c.value]])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Fy,[(0,a.createElementVNode)("div",Ly,[(0,a.createVNode)((0,a.unref)(bf),{size:32})]),p[54]||(p[54]=(0,a.createElementVNode)("span",null,"尚未解锁大道",-1))]))]),(0,a.createCommentVNode)(" 人际关系 "),(0,a.createElementVNode)("div",gx,[(0,a.createElementVNode)("h3",fx,[(0,a.createElementVNode)("div",bx,[(0,a.createVNode)((0,a.unref)(zi),{size:18})]),p[57]||(p[57]=(0,a.createTextVNode)(" 人际关系 ",-1))]),A.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",xx,[(0,a.createElementVNode)("div",kx,[(0,a.createElementVNode)("div",wx,[p[59]||(p[59]=(0,a.createElementVNode)("span",{class:"stat-label"},"总人数",-1)),(0,a.createElementVNode)("span",Nx,(0,a.toDisplayString)(A.value),1)]),(0,a.createElementVNode)("div",Ex,[p[60]||(p[60]=(0,a.createElementVNode)("span",{class:"stat-label"},"平均好感",-1)),(0,a.createElementVNode)("span",Vx,(0,a.toDisplayString)(_.value)+"%",1)])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",hx,[(0,a.createElementVNode)("div",yx,[(0,a.createVNode)((0,a.unref)(yf),{size:32})]),p[58]||(p[58]=(0,a.createElementVNode)("span",null,"暂无人际关系",-1))]))]),(0,a.createCommentVNode)(" 背包概览 "),(0,a.createElementVNode)("div",Cx,[(0,a.createElementVNode)("h3",zx,[(0,a.createElementVNode)("div",Sx,[(0,a.createVNode)((0,a.unref)(xf),{size:18})]),p[61]||(p[61]=(0,a.createTextVNode)(" 背包概览 ",-1))]),(0,a.createElementVNode)("div",Bx,[(0,a.createElementVNode)("div",Dx,[(0,a.createElementVNode)("div",Ax,[(0,a.createElementVNode)("div",_x,[p[62]||(p[62]=(0,a.createElementVNode)("span",{class:"stat-label"},"物品总数",-1)),(0,a.createElementVNode)("span",$x,(0,a.toDisplayString)($.value),1)]),(0,a.createElementVNode)("div",Ix,[p[63]||(p[63]=(0,a.createElementVNode)("span",{class:"stat-label"},"法宝数量",-1)),(0,a.createElementVNode)("span",Tx,(0,a.toDisplayString)(K("法宝")),1)]),(0,a.createElementVNode)("div",jx,[p[64]||(p[64]=(0,a.createElementVNode)("span",{class:"stat-label"},"功法数量",-1)),(0,a.createElementVNode)("span",Mx,(0,a.toDisplayString)(K("功法")),1)])])]),(0,a.createElementVNode)("div",qx,[p[65]||(p[65]=(0,a.createElementVNode)("h4",{class:"stones-title"},"灵石储备",-1)),(0,a.createElementVNode)("div",Ox,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(I,e=>(0,a.createElementVNode)("div",{key:e.name,class:(0,a.normalizeClass)(["stone-item",e.class])},[(0,a.createElementVNode)("span",Px,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("span",Fx,(0,a.toDisplayString)(X(e.name)),1)],2)),64))])])])]),(0,a.createCommentVNode)(" 宗门信息 "),f.value?.宗门信息?((0,a.openBlock)(),(0,a.createElementBlock)("div",Lx,[(0,a.createElementVNode)("h3",Yx,[(0,a.createElementVNode)("div",Rx,[(0,a.createVNode)((0,a.unref)(gf),{size:18})]),p[66]||(p[66]=(0,a.createTextVNode)(" 宗门信息 ",-1))]),(0,a.createElementVNode)("div",Ux,[(0,a.createElementVNode)("div",Gx,[(0,a.createElementVNode)("h4",Wx,(0,a.toDisplayString)(f.value?.宗门信息?.sectName),1),(0,a.createElementVNode)("span",Jx,(0,a.toDisplayString)(f.value?.宗门信息?.sectType),1)]),(0,a.createElementVNode)("div",Hx,[(0,a.createElementVNode)("div",Qx,[p[67]||(p[67]=(0,a.createElementVNode)("span",{class:"detail-label"},"职位",-1)),(0,a.createElementVNode)("span",Kx,(0,a.toDisplayString)(f.value?.宗门信息?.position),1)]),(0,a.createElementVNode)("div",Xx,[p[68]||(p[68]=(0,a.createElementVNode)("span",{class:"detail-label"},"贡献值",-1)),(0,a.createElementVNode)("span",Zx,(0,a.toDisplayString)(f.value?.宗门信息?.contribution),1)]),(0,a.createElementVNode)("div",ek,[p[69]||(p[69]=(0,a.createElementVNode)("span",{class:"detail-label"},"关系",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["detail-value",`relationship-${f.value?.宗门信息?.relationship}`])},(0,a.toDisplayString)(f.value?.宗门信息?.relationship),3)])])])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 技能详情弹窗 "),s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:se},[(0,a.createElementVNode)("div",{class:"skill-modal",onClick:p[1]||(p[1]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",nk,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(me()?.name),1),(0,a.createElementVNode)("button",{class:"modal-close-btn",onClick:se},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",tk,[(0,a.createElementVNode)("div",ak,[(0,a.createElementVNode)("div",ok,[p[70]||(p[70]=(0,a.createElementVNode)("span",{class:"detail-label"},"类型",-1)),(0,a.createElementVNode)("span",rk,(0,a.toDisplayString)(me()?.type),1)]),(0,a.createElementVNode)("div",lk,[p[71]||(p[71]=(0,a.createElementVNode)("span",{class:"detail-label"},"状态",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["detail-value","status-"+("已解锁"===me()?.status?"unlocked":"locked")])},(0,a.toDisplayString)(me()?.status),3)]),(0,a.createElementVNode)("div",ik,[p[72]||(p[72]=(0,a.createElementVNode)("span",{class:"detail-label"},"熟练度",-1)),(0,a.createElementVNode)("span",ck,(0,a.toDisplayString)(me()?.proficiency?me()?.proficiency+"%":"未知"),1)]),(0,a.createElementVNode)("div",sk,[p[73]||(p[73]=(0,a.createElementVNode)("span",{class:"detail-label"},"解锁条件",-1)),(0,a.createElementVNode)("span",dk,(0,a.toDisplayString)(me()?.condition),1)]),(0,a.createElementVNode)("div",mk,[p[74]||(p[74]=(0,a.createElementVNode)("span",{class:"detail-label"},"技能来源",-1)),(0,a.createElementVNode)("span",pk,(0,a.toDisplayString)(me()?.source),1)])]),(0,a.createElementVNode)("div",vk,[p[75]||(p[75]=(0,a.createElementVNode)("h4",null,"技能描述",-1)),(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(me()?.description),1)])])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 大道详情弹窗 "),d.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"modal-overlay",onClick:se},[(0,a.createElementVNode)("div",{class:"dao-modal",onClick:p[2]||(p[2]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",uk,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(de()?.name),1),(0,a.createElementVNode)("button",{class:"modal-close-btn",onClick:se},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",gk,[(0,a.createElementVNode)("div",fk,[(0,a.createElementVNode)("div",bk,[p[76]||(p[76]=(0,a.createElementVNode)("span",{class:"stage-label"},"当前阶段",-1)),(0,a.createElementVNode)("span",hk,(0,a.toDisplayString)(de()?.stage),1)]),(0,a.createElementVNode)("div",yk,[(0,a.createElementVNode)("div",xk,[(0,a.createElementVNode)("div",{class:"progress-bar-fill",style:(0,a.normalizeStyle)({width:(de()?.progressPercent||0)+"%"})},null,4)]),(0,a.createElementVNode)("span",kk,(0,a.toDisplayString)(de()?.progressPercent)+"%",1)])]),(0,a.createElementVNode)("div",wk,[(0,a.createElementVNode)("div",Nk,[p[77]||(p[77]=(0,a.createElementVNode)("span",{class:"stat-label"},"当前经验",-1)),(0,a.createElementVNode)("span",Ek,(0,a.toDisplayString)(de()?.currentExp),1)]),(0,a.createElementVNode)("div",Vk,[p[78]||(p[78]=(0,a.createElementVNode)("span",{class:"stat-label"},"总经验",-1)),(0,a.createElementVNode)("span",Ck,(0,a.toDisplayString)(de()?.totalExp),1)])]),(0,a.createElementVNode)("div",zk,[p[79]||(p[79]=(0,a.createElementVNode)("h4",null,"修炼感悟",-1)),(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(de()?.description),1)])])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 灵根详情弹窗 (Re-designed) "),m.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:2,class:"modal-overlay",onClick:se},[(0,a.createElementVNode)("div",{class:"spirit-root-modal",onClick:p[3]||(p[3]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",Sk,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(ge(u.value.灵根))+" 详情",1),(0,a.createElementVNode)("button",{class:"modal-close-btn",onClick:se},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",Bk,[(0,a.createElementVNode)("div",Dk,[(0,a.createElementVNode)("div",Ak,[p[80]||(p[80]=(0,a.createElementVNode)("div",{class:"detail-header"},[(0,a.createElementVNode)("span",{class:"detail-icon"},"⚡"),(0,a.createElementVNode)("span",{class:"detail-title"},"灵根类型")],-1)),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["detail-value type-value",`root-${ye(u.value.灵根)}`])},(0,a.toDisplayString)(ge(u.value.灵根)),3)]),(0,a.createElementVNode)("div",_k,[p[81]||(p[81]=(0,a.createElementVNode)("div",{class:"detail-header"},[(0,a.createElementVNode)("span",{class:"detail-icon"},"⭐"),(0,a.createElementVNode)("span",{class:"detail-title"},"灵根品级")],-1)),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["detail-value grade-value",`grade-${be(u.value.灵根)||"凡品"}`])},(0,a.toDisplayString)(be(u.value.灵根)||"凡品"),3)]),(0,a.createElementVNode)("div",$k,[p[82]||(p[82]=(0,a.createElementVNode)("div",{class:"detail-header"},[(0,a.createElementVNode)("span",{class:"detail-icon"},"🚀"),(0,a.createElementVNode)("span",{class:"detail-title"},"修炼速度")],-1)),(0,a.createElementVNode)("div",Ik,(0,a.toDisplayString)(xe(u.value)),1)])]),ke(u.value).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",Tk,[p[83]||(p[83]=(0,a.createElementVNode)("h4",null,"特殊效果",-1)),(0,a.createElementVNode)("div",jk,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ke(u.value),e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"effect-tag-modal"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0),"object"==typeof u.value.灵根&&u.value.灵根?((0,a.openBlock)(),(0,a.createElementBlock)("div",Mk,[p[86]||(p[86]=(0,a.createElementVNode)("h4",null,"详细信息",-1)),(0,a.createElementVNode)("div",qk,[u.value.灵根.base_multiplier?((0,a.openBlock)(),(0,a.createElementBlock)("div",Ok,[p[84]||(p[84]=(0,a.createElementVNode)("span",{class:"advanced-label"},"基础倍率:",-1)),(0,a.createElementVNode)("span",Pk,(0,a.toDisplayString)(u.value.灵根.base_multiplier)+"x",1)])):(0,a.createCommentVNode)("v-if",!0),u.value.灵根.cultivation_speed?((0,a.openBlock)(),(0,a.createElementBlock)("div",Fk,[p[85]||(p[85]=(0,a.createElementVNode)("span",{class:"advanced-label"},"修炼速度:",-1)),(0,a.createElementVNode)("span",Lk,(0,a.toDisplayString)(u.value.灵根.cultivation_speed),1)])):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0)])])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",Nf,[(0,a.createElementVNode)("div",Ef,[(0,a.createVNode)((0,a.unref)(uf),{size:48})]),p[5]||(p[5]=(0,a.createElementVNode)("p",null,"无法加载角色数据",-1)),(0,a.createElementVNode)("button",{class:"retry-btn",onClick:pe},"重试")]))]);var v}}});var Rk=t(1932),Uk={};Uk.styleTagTransform=A(),Uk.setAttributes=z(),Uk.insert=V().bind(null,"head"),Uk.domAPI=N(),Uk.insertStyleElement=B(),k()(Rk.A,Uk),Rk.A&&Rk.A.locals&&Rk.A.locals;const Gk=(0,j.A)(Yk,[["__scopeId","data-v-5ffd8816"]]),Wk=(0,c.A)("sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]),Jk=(0,c.A)("gem",[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),Hk=(0,c.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Qk=(0,c.A)("square-dashed",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]);var Kk=t(3098);const Xk={class:"modal-header"},Zk={class:"modal-body"},ew={class:"item-info"},nw={class:"item-icon"},tw={class:"item-details"},aw={class:"item-name"},ow={class:"item-type"},rw={class:"available-quantity"},lw={key:0,class:"item-description"},iw={class:"quantity-selector"},cw={for:"quantity"},sw={class:"quantity-controls"},dw=["disabled"],mw=["max"],pw=["disabled"],vw={class:"quantity-shortcuts"},uw=["onClick","disabled"],gw={class:"modal-footer"},fw=["disabled"],bw=(0,a.defineComponent)({__name:"QuantitySelectModal",props:{visible:{type:Boolean},item:{},title:{},actionLabel:{},actionType:{},confirmText:{},description:{}},emits:["close","confirm"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)(1),l=(0,a.computed)(()=>{const e=t.item?.数量||1;return[{label:"1个",value:1},{label:"5个",value:5},{label:"10个",value:10},{label:"全部",value:e}].filter(n=>n.value<=e)});function i(){r.value<(t.item?.数量||1)&&r.value++}function c(){r.value>1&&r.value--}function s(){r.value>0&&r.value<=(t.item?.数量||1)&&o("confirm",r.value)}function d(){o("close")}return(0,a.watch)(()=>t.item,e=>{e&&(r.value=1)}),(e,n)=>{return e.visible?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"quantity-modal-overlay",onClick:d},[(0,a.createElementVNode)("div",{class:"quantity-modal",onClick:n[3]||(n[3]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",Xk,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(e.title||"选择数量"),1),(0,a.createElementVNode)("button",{class:"close-btn",onClick:n[0]||(n[0]=n=>e.$emit("close"))},"×")]),(0,a.createElementVNode)("div",Zk,[(0,a.createElementVNode)("div",ew,[(0,a.createElementVNode)("div",nw,(0,a.toDisplayString)((o=e.item?.类型,{装备:"⚔️",功法:"📜",其他:"📦"}[o||"其他"]||"📦")),1),(0,a.createElementVNode)("div",tw,[(0,a.createElementVNode)("div",aw,(0,a.toDisplayString)(e.item?.名称),1),(0,a.createElementVNode)("div",ow,(0,a.toDisplayString)(e.item?.类型),1),(0,a.createElementVNode)("div",rw,"可用数量："+(0,a.toDisplayString)(e.item?.数量||0),1),e.description?((0,a.openBlock)(),(0,a.createElementBlock)("div",lw,(0,a.toDisplayString)(e.description),1)):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createElementVNode)("div",iw,[(0,a.createElementVNode)("label",cw,(0,a.toDisplayString)(e.actionLabel||"选择数量")+"：",1),(0,a.createElementVNode)("div",sw,[(0,a.createElementVNode)("button",{class:"quantity-btn",onClick:c,disabled:r.value<=1}," - ",8,dw),(0,a.withDirectives)((0,a.createElementVNode)("input",{id:"quantity","onUpdate:modelValue":n[1]||(n[1]=e=>r.value=e),type:"number",min:1,max:e.item?.数量||1,class:"quantity-input"},null,8,mw),[[a.vModelText,r.value,void 0,{number:!0}]]),(0,a.createElementVNode)("button",{class:"quantity-btn",onClick:i,disabled:r.value>=(e.item?.数量||1)}," + ",8,pw)])]),(0,a.createElementVNode)("div",vw,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value,n=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:n.value,class:"preset-btn",onClick:e=>{return a=n.value,void(r.value=Math.min(a,t.item?.数量||1));var a},disabled:n.value>(e.item?.数量||1)},(0,a.toDisplayString)(n.label),9,uw))),128))])]),(0,a.createElementVNode)("div",gw,[(0,a.createElementVNode)("button",{class:"cancel-btn",onClick:n[2]||(n[2]=n=>e.$emit("close"))},"取消"),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["confirm-btn","discard"===e.actionType?"discard-confirm":""]),onClick:s,disabled:r.value<=0},(0,a.toDisplayString)(e.confirmText||"确定"),11,fw)])])])):(0,a.createCommentVNode)("v-if",!0);var o}}});var hw=t(7393),yw={};yw.styleTagTransform=A(),yw.setAttributes=z(),yw.insert=V().bind(null,"head"),yw.domAPI=N(),yw.insertStyleElement=B(),k()(hw.A,yw),hw.A&&hw.A.locals&&hw.A.locals;const xw=(0,j.A)(bw,[["__scopeId","data-v-8f332e7a"]]),kw={class:"inventory-content"},ww={class:"tabs-header"},Nw={class:"tabs-nav"},Ew=["onClick"],Vw={key:0,class:"tools-section"},Cw={class:"search-box"},zw=["placeholder"],Sw={class:"filter-buttons"},Bw=["value"],Dw=["disabled"],Aw={class:"tab-content"},_w={key:0,class:"items-tab"},$w={class:"confirm-header"},Iw={class:"confirm-content"},Tw={class:"confirm-actions"},jw={class:"modal-header"},Mw={class:"modal-content"},qw={class:"item-type-text"},Ow={class:"modal-info"},Pw={class:"modal-meta"},Fw={class:"modal-description"},Lw={key:0,class:"modal-attributes"},Yw={class:"attribute-text"},Rw={class:"modal-actions"},Uw=["disabled"],Gw=["disabled"],Ww={class:"items-grid"},Jw={key:0,class:"grid-placeholder"},Hw={key:1,class:"grid-placeholder"},Qw={key:0},Kw={key:1},Xw={key:2},Zw={key:3},eN={key:4},nN={key:5,class:"filter-tip"},tN=["onClick"],aN={class:"item-top-section"},oN={class:"item-type-icon"},rN={key:0,class:"item-quantity-display"},lN={class:"item-name-section"},iN=["title"],cN={class:"item-bottom-section"},sN={class:"item-type-label"},dN={key:2,class:"item-details-sidebar"},mN={key:0,class:"details-content"},pN={class:"details-header"},vN={class:"item-type-text-large"},uN={class:"details-title-area"},gN={class:"details-meta"},fN={class:"details-body"},bN={class:"details-description"},hN={key:0,class:"details-attributes"},yN={class:"skill-effects"},xN={key:0,class:"effect-item"},kN={class:"effect-value"},wN={key:1,class:"effect-item"},NN={class:"effect-value"},EN={key:2,class:"effect-item"},VN={class:"special-abilities"},CN={key:1,class:"details-attributes"},zN={class:"technique-skills"},SN={class:"skill-header"},BN={class:"skill-name"},DN={key:0,class:"skill-unlock-requirement"},AN={class:"skill-description"},_N={key:0,class:"skill-cost"},$N={key:1,class:"details-attributes"},IN={class:"attribute-text"},TN={class:"details-actions"},jN=["disabled"],MN=["disabled"],qN={key:1,class:"details-placeholder"},ON={key:1,class:"equipment-tab"},PN={class:"equipment-content"},FN={class:"equipment-grid"},LN={class:"slot-header"},YN={class:"slot-name"},RN={key:0,class:"slot-actions"},UN=["disabled","onClick"],GN={class:"item-info"},WN=["title"],JN={class:"item-quality"},HN=["title"],QN={key:1,class:"item-effects"},KN={class:"effects-text"},XN={key:1,class:"empty-equipment-slot"},ZN={class:"empty-icon"},eE={key:2,class:"currency-tab"},nE={class:"currency-grid"},tE={class:"currency-card-top"},aE={class:"currency-info"},oE={class:"currency-amount"},rE={class:"currency-label"},lE={key:0,class:"currency-exchange"},iE=["onClick","disabled","title"],cE=["onClick","disabled","title"],sE=(0,a.defineComponent)({__name:"InventoryPanel",setup(e){const{characterData:n,saveData:o}=(0,Li.useUnifiedCharacterData)(),r=(0,Sv.useActionQueueStore)(),l=Bv.getInstance(),i=(0,a.ref)(!1),c=(0,a.ref)(!1),s=(0,a.ref)(null),m=(0,a.ref)(""),p=(0,a.ref)("all"),v=(0,a.ref)("default"),u=(0,a.ref)("items"),g=(0,a.ref)(!1),f=(0,a.ref)(""),b=(0,a.ref)(""),h=(0,a.ref)(!1),y=(0,a.ref)(null),x=(0,a.ref)(""),k=(0,a.ref)(""),w=(0,a.ref)("use"),N=(0,a.ref)(""),E=(0,a.ref)(""),V=(0,a.ref)(null),C=(0,a.ref)(!1),z=(0,a.ref)(null),S=(0,a.ref)(!1),B=(0,a.ref)(!1),D=(0,a.computed)(()=>window.innerWidth<=768),A=(0,a.computed)(()=>[{id:"items",label:"物品",icon:Ei},{id:"equipment",label:"装备",icon:Wk},{id:"currency",label:"灵石",icon:Jk}]);(0,a.onMounted)(async()=>{try{const e=o.value;if(e){const n=(0,Kk.qj)(e);if(n.修炼功法&&(void 0===n.修炼功法.正在修炼&&(n.修炼功法.正在修炼=!0),void 0===n.修炼功法.修炼进度&&(n.修炼功法.修炼进度=0)),JSON.stringify(n)!==JSON.stringify(e)){const{useCharacterStore:e}=await Promise.resolve().then(t.bind(t,948)),a=e();a.activeSaveSlot.存档数据=n,await a.syncToTavernAndSave(),bg.Yz.log("背包面板","已迁移旧数据结构并保存")}}}catch(e){bg.Yz.warn("背包面板","面板初始化迁移失败",e)}});const _=(0,a.computed)(()=>{const e=n.value?.装备栏,t=["装备1","装备2","装备3","装备4","装备5","装备6"];return e?t.map(t=>{const a=e[t];let o=null;if(a&&"object"==typeof a&&"物品ID"in a&&"名称"in a){const e=a.物品ID,t=(n.value?.背包_物品||{})[e];o=t&&"object"==typeof t?t:{物品ID:e,名称:a.名称,类型:"装备",品质:{quality:"凡",grade:1},描述:"装备数据缺失",数量:1,已装备:!0}}else o=null;return{name:t,item:o}}):t.map(e=>({name:e,item:null}))}),$=(0,a.computed)(()=>{const e=n.value?.背包_物品||{};return Object.entries(e).filter(([e,n])=>!e.startsWith("_")&&n&&"object"==typeof n).map(([,e])=>{const n=e;return n.品质||"功法"!==n.类型&&"装备"!==n.类型||console.warn("[背包面板-警告] 物品缺少品质数据:",{物品ID:n.物品ID,名称:n.名称,类型:n.类型,完整数据:n}),{...n,物品ID:String(n.物品ID||""),名称:String(n.名称||""),类型:String(n.类型||"其他"),品质:n.品质||{quality:"凡",grade:1},描述:String(n.描述||""),数量:Number(n.数量||1)}}).filter(e=>e.名称&&e.类型)}),I=(0,a.computed)(()=>["装备","功法","其他"]),T={凡:1,凡阶:1,黄:2,黄阶:2,玄:3,玄阶:3,地:4,地阶:4,天:5,天阶:5,仙:6,仙阶:6,神:7,神阶:7},j=(0,a.computed)(()=>{let e=[...$.value];if(e=e.map(e=>{const n="装备"===e.类型||"功法"===e.类型?e.类型:"其他";let t=e.品质;return t&&"object"==typeof t?(t.quality&&["凡","黄","玄","地","天","仙","神"].includes(t.quality)||(t.quality="凡"),("number"!=typeof t.grade||t.grade<0||t.grade>10)&&(t.grade=1)):t={quality:"凡",grade:1},{...e,类型:n,品质:t}}),m.value&&(e=e.filter(e=>e.名称.includes(m.value))),"all"!==p.value&&(e=e.filter(e=>("装备"===e.类型||"功法"===e.类型?e.类型:"其他")===p.value)),"quality"===v.value){const n=e=>T[String(e??"凡")]||0;e.sort((e,t)=>n(t.品质?.quality)-n(e.品质?.quality))}else"name"===v.value&&e.sort((e,n)=>e.名称.localeCompare(n.名称));return e}),M=e=>{if(!e||"object"!=typeof e)return"无特殊属性";const n=[];for(const[t,a]of Object.entries(e))if(null!=a)if("object"!=typeof a||Array.isArray(a))n.push(`${t}+${a}`);else{const e=Object.entries(a).filter(([,e])=>"number"==typeof e||"string"==typeof e).map(([e,n])=>`${e}+${n}`).join("、");e&&n.push(`${t}(${e})`)}return n.length?n.join("、"):"无特殊属性"},q=e=>{if(!e||"object"!=typeof e)return"无属性加成";const n=[];for(const[t,a]of Object.entries(e))a&&"number"==typeof a&&n.push(`${t}+${a}`);return n.length>0?n.join("、"):"无属性加成"},O=e=>0===e?"残缺":e>=1&&e<=3?"下品":e>=4&&e<=6?"中品":e>=7&&e<=9?"上品":10===e?"极品":"未知",P=e=>0===e?"grade-broken":e>=1&&e<=3?"grade-low":e>=4&&e<=6?"grade-mid":e>=7&&e<=9?"grade-high":10===e?"grade-perfect":"grade-unknown",F=async e=>{if(!B.value)if("功法"===e.类型){B.value=!0;try{Q(e)?await l.stopCultivation(e):await l.cultivateItem(e)}finally{B.value=!1}}else d.o.error("只有功法才能修炼")},L=async e=>{if(e){if(bg.Yz.log("背包面板","使用物品",e.名称),e.数量>1)return y.value=e,x.value="使用物品",k.value="使用数量",w.value="use",N.value="确定使用",E.value=("其他"===e.类型?e.使用效果:"")||"暂无特殊效果",V.value=n=>Y(e,n),void(h.value=!0);await Y(e,1)}},Y=async(e,n)=>{try{if("其他"!==e.类型)return void d.o.error("该物品无法直接使用");await l.useItem(e,n),D.value&&(C.value=!1),s.value=null,bg.Yz.log("背包面板","使用物品成功",e.名称)}catch(e){bg.Yz.error("背包面板","使用物品失败",e),d.o.error("使用物品失败")}},R=async e=>{V.value&&await V.value(e),U()},U=()=>{h.value=!1,y.value=null,x.value="",k.value="",w.value="use",N.value="",E.value="",V.value=null},G=async e=>{if(!e)return;if(e.数量>1){const n=e.品质?.quality||"凡",t="凡"===n?"":`【${n}】`;return y.value=e,x.value="丢弃物品",k.value="丢弃数量",w.value="discard",N.value="确定丢弃",E.value=`${t}${e.名称} - 此操作不可撤销！`,V.value=n=>W(e,n),void(h.value=!0)}const n=e.品质?.quality||"凡",t="凡"===n?"":`【${n}】`;f.value="丢弃物品",b.value=`确定要丢弃 ${t}${e.名称} 吗？\n\n此操作不可撤销！`,z.value=async()=>{await W(e,1)},g.value=!0},W=async(e,a)=>{bg.Yz.log("背包面板","丢弃物品",{物品名称:e.名称,数量:a});try{if(a>=e.数量)await(async e=>{const a=n.value?.背包_物品;if(!a||"object"!=typeof a)throw new Error("背包数据不存在或格式不正确");delete a[e.物品ID];const{useCharacterStore:o}=await Promise.resolve().then(t.bind(t,948)),r=o();await r.syncToTavernAndSave({fullSync:!0}),bg.Yz.log("背包面板","物品移除成功",e.名称),s.value?.物品ID===e.物品ID&&(s.value=null),D.value&&(C.value=!1)})(e),d.o.success(`已丢弃《${e.名称}》`);else{const o={...e,数量:e.数量-a};await(async e=>{const a=n.value?.背包_物品;if(!a||"object"!=typeof a)throw new Error("背包数据不存在或格式不正确");if(!a[e.物品ID])throw new Error(`尝试更新一个不存在于背包的物品: ${e.名称}`);{a[e.物品ID]=e;const{useCharacterStore:n}=await Promise.resolve().then(t.bind(t,948)),o=n();await o.syncToTavernAndSave({fullSync:!0}),bg.Yz.log("背包面板","物品更新成功",e.名称)}s.value?.物品ID===e.物品ID&&(s.value=e)})(o),d.o.success(`已丢弃 ${a} 个《${e.名称}》`)}D.value&&(C.value=!1),s.value=null}catch(e){bg.Yz.error("背包面板","丢弃失败",e),d.o.error("丢弃物品失败")}},J=async e=>{if(e&&!S.value)if("装备"===e.类型){S.value=!0;try{H(e)?await l.unequipItem(e):await l.equipItem(e)}catch(e){console.error("装备切换失败:",e),d.o.error("装备操作失败，请稍后重试")}finally{S.value=!1}}else d.o.error("只有装备才能穿戴")},H=e=>{if(!e||!e.物品ID)return!1;const t=n.value?.背包_物品;if(!t)return!1;const a=t[e.物品ID];return!!a&&!0===a.已装备},Q=e=>{if(!e||!e.物品ID)return!1;const t=n.value?.背包_物品;if(t){const n=t[e.物品ID];if(n&&!0===n.已装备)return!0}const a=n.value?.修炼功法;return!(!a||a.物品ID!==e.物品ID)&&!1!==a.正在修炼},K=(e,n="border")=>{if(!e)return"";const t=(e=>{const n=String(e||"").trim();if(!n)return"未知";const t=n.endsWith("阶")?n.slice(0,-1):n;return["凡","黄","玄","地","天","仙","神"].includes(t)?t:"未知"})(e.品质?.quality);return"未知"===t?"":`${n}-quality-${t}`},X=[{name:"极品",colorClass:"grade-legend",canExchange:!1,canExchangeDown:!0,exchangeDown:"上品"},{name:"上品",colorClass:"grade-epic",canExchange:!0,canExchangeDown:!0,exchangeUp:"极品",exchangeDown:"中品"},{name:"中品",colorClass:"grade-rare",canExchange:!0,canExchangeDown:!0,exchangeUp:"上品",exchangeDown:"下品"},{name:"下品",colorClass:"grade-common",canExchange:!0,canExchangeDown:!1,exchangeUp:"中品"}],Z=()=>{z.value&&z.value(),g.value=!1},ee=()=>{C.value=!1},ne=async(e,a)=>{const o=X.find(n=>n.name===e);if(o)if("up"===a&&o.canExchange&&o.exchangeUp){const a=n.value?.背包_灵石?.[e]||0;if(a>=100&&n.value?.背包_灵石){n.value.背包_灵石[e]=a-100;const r=o.exchangeUp,l=n.value.背包_灵石[r]||0;n.value.背包_灵石[r]=l+1;const{useCharacterStore:i}=await Promise.resolve().then(t.bind(t,948)),c=i();await c.syncToTavernAndSave()}}else if("down"===a&&o.canExchangeDown&&o.exchangeDown){const a=n.value?.背包_灵石?.[e]||0;if(a>=1&&n.value?.背包_灵石){n.value.背包_灵石[e]=a-1;const r=o.exchangeDown,l=n.value.背包_灵石[r]||0;n.value.背包_灵石[r]=l+100;const{useCharacterStore:i}=await Promise.resolve().then(t.bind(t,948)),c=i();await c.syncToTavernAndSave()}}},te=async()=>{if(!c.value){c.value=!0;try{bg.Yz.log("背包面板","手动刷新酒馆数据");const{useCharacterStore:e}=await Promise.resolve().then(t.bind(t,948)),n=e();await n.syncFromTavern()}catch(e){bg.Yz.error("背包面板","刷新数据失败",e)}finally{c.value=!1}}};return(e,l)=>((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createCommentVNode)(" 移除容器，让内容直接填充GameView提供的panel-content区域 "),(0,a.createElementVNode)("div",kw,[(0,a.createCommentVNode)(" 标签页导航 "),(0,a.createElementVNode)("div",ww,[(0,a.createElementVNode)("div",Nw,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(A.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e.id,class:(0,a.normalizeClass)(["tab-btn",{active:u.value===e.id}]),onClick:n=>u.value=e.id},[((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(e.icon),{size:16})),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.label),1)],10,Ew))),128))]),(0,a.createCommentVNode)(" 搜索和筛选区域 "),"items"===u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Vw,[(0,a.createElementVNode)("div",Cw,[(0,a.createVNode)((0,a.unref)(Hk),{size:16,class:"search-icon"}),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=e=>m.value=e),placeholder:D.value?"搜索...":"搜索物品..."},null,8,zw),[[a.vModelText,m.value]])]),(0,a.createElementVNode)("div",Sw,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>p.value=e),class:"filter-select"},[l[20]||(l[20]=(0,a.createElementVNode)("option",{value:"all"},"全部物品",-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(I.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("option",{key:e,value:e},(0,a.toDisplayString)(e),9,Bw))),128))],512),[[a.vModelSelect,p.value]]),(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>v.value=e),class:"filter-select"},l[21]||(l[21]=[(0,a.createElementVNode)("option",{value:"default"},"默认排序",-1),(0,a.createElementVNode)("option",{value:"quality"},"品质排序",-1),(0,a.createElementVNode)("option",{value:"name"},"名称排序",-1)]),512),[[a.vModelSelect,v.value]]),(0,a.createElementVNode)("button",{class:"refresh-btn",onClick:te,disabled:c.value,title:"从酒馆同步最新数据"},[(0,a.createVNode)((0,a.unref)(Vv),{size:16,class:(0,a.normalizeClass)({spinning:c.value})},null,8,["class"])],8,Dw)])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 标签内容 "),(0,a.createElementVNode)("div",Aw,[(0,a.createCommentVNode)(" 物品标签 "),"items"===u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",_w,[(0,a.createCommentVNode)(" 自定义确认弹窗 "),g.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"custom-confirm-overlay",onClick:l[6]||(l[6]=e=>g.value=!1)},[(0,a.createElementVNode)("div",{class:"custom-confirm-modal",onClick:l[5]||(l[5]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",$w,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(f.value),1),(0,a.createElementVNode)("button",{class:"confirm-close-btn",onClick:l[3]||(l[3]=e=>g.value=!1)},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",Iw,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(b.value),1)]),(0,a.createElementVNode)("div",Tw,[(0,a.createElementVNode)("button",{class:"confirm-btn cancel-btn",onClick:l[4]||(l[4]=e=>g.value=!1)}," 取消 "),(0,a.createElementVNode)("button",{class:"confirm-btn confirm-btn",onClick:Z},"确定")])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 移动端：模态框详情 "),C.value&&D.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"item-modal-overlay",onClick:ee},[(0,a.createElementVNode)("div",{class:"item-modal",onClick:l[13]||(l[13]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",jw,[(0,a.createElementVNode)("h3",{class:(0,a.normalizeClass)(K(s.value,"text"))},(0,a.toDisplayString)(s.value?.名称),3),(0,a.createElementVNode)("button",{class:"modal-close-btn",onClick:ee},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",Mw,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["modal-icon-simple",K(s.value)])},[(0,a.createElementVNode)("div",qw,(0,a.toDisplayString)(s.value?.类型),1)],2),(0,a.createElementVNode)("div",Ow,[(0,a.createElementVNode)("div",Pw,[(0,a.createTextVNode)((0,a.toDisplayString)(s.value?.类型)+" / "+(0,a.toDisplayString)(s.value?.品质?.quality||"未知")+" ",1),void 0!==s.value?.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["grade-display",P(s.value.品质.grade)])},(0,a.toDisplayString)(O(s.value.品质.grade))+"("+(0,a.toDisplayString)(s.value.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("p",Fw,(0,a.toDisplayString)(s.value?.描述),1),"装备"===s.value?.类型&&s.value?.装备增幅?((0,a.openBlock)(),(0,a.createElementBlock)("div",Lw,[l[22]||(l[22]=(0,a.createElementVNode)("h4",null,"装备增幅:",-1)),(0,a.createElementVNode)("div",Yw,(0,a.toDisplayString)(M(s.value.装备增幅)),1)])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createElementVNode)("div",Rw,[(0,a.createCommentVNode)(" 装备：装备和丢弃 "),"装备"===s.value?.类型?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["action-btn",H(s.value)?"unequip-btn":"equip-btn"]),disabled:S.value,onClick:l[7]||(l[7]=e=>J(s.value))},(0,a.toDisplayString)(H(s.value)?"卸下":"装备"),11,Uw),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[8]||(l[8]=e=>G(s.value))}," 丢弃 ")],64)):"功法"===s.value?.类型?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 功法：修炼和丢弃 "),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["action-btn",Q(s.value)?"stop-cultivate-btn":"cultivate-btn"]),disabled:B.value,onClick:l[9]||(l[9]=e=>F(s.value))},(0,a.toDisplayString)(Q(s.value)?"停止修炼":"修炼"),11,Gw),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[10]||(l[10]=e=>G(s.value))}," 丢弃 ")],64)):s.value?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(" 其他物品：使用和丢弃 "),(0,a.createElementVNode)("button",{class:"action-btn use-btn",onClick:l[11]||(l[11]=e=>L(s.value))},"使用"),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[12]||(l[12]=e=>G(s.value))}," 丢弃 ")],64)):(0,a.createCommentVNode)("v-if",!0)])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",Ww,[i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",Jw,l[23]||(l[23]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},null,-1),(0,a.createElementVNode)("p",null,"加载中...",-1)]))):0===j.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",Hw,[(0,a.createVNode)((0,a.unref)(Qk),{size:48}),"all"===p.value?((0,a.openBlock)(),(0,a.createElementBlock)("p",Qw,"空空如也")):"装备"===p.value?((0,a.openBlock)(),(0,a.createElementBlock)("p",Kw,"暂无装备")):"功法"===p.value?((0,a.openBlock)(),(0,a.createElementBlock)("p",Xw,"暂无功法")):"其他"===p.value?((0,a.openBlock)(),(0,a.createElementBlock)("p",Zw,"暂无其他物品")):((0,a.openBlock)(),(0,a.createElementBlock)("p",eN,"暂无"+(0,a.toDisplayString)(p.value),1)),"all"!==p.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",nN," 可以试试搜索其他分类 ")):(0,a.createCommentVNode)("v-if",!0)])):((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:2},(0,a.renderList)(j.value,e=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.物品ID,class:(0,a.normalizeClass)(["item-card",K(e,"card")]),onClick:n=>(e=>{s.value=e,D.value&&(C.value=!0)})(e)},[(0,a.createCommentVNode)(" 物品图标和品质 "),(0,a.createElementVNode)("div",aN,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["item-icon-area",K(e,"border")])},[(0,a.createElementVNode)("div",oN,(0,a.toDisplayString)((n=e.类型,{装备:"⚔️",功法:"📜",其他:"📦"}[n]||"📦")),1),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["item-quality-badge",K(e,"text")])},(0,a.toDisplayString)(e.品质?.quality||"未知"),3)],2)]),(0,a.createCommentVNode)(" 数量显示 "),e.数量>1?((0,a.openBlock)(),(0,a.createElementBlock)("div",rN,"×"+(0,a.toDisplayString)(e.数量),1)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 物品名称 "),(0,a.createElementVNode)("div",lN,[(0,a.createElementVNode)("div",{class:"item-name",title:e.名称},(0,a.toDisplayString)(e.名称),9,iN)]),(0,a.createCommentVNode)(" 底部信息：类型和品级 "),(0,a.createElementVNode)("div",cN,[(0,a.createElementVNode)("div",sN,(0,a.toDisplayString)(e.类型),1),void 0!==e.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:(0,a.normalizeClass)(["item-grade-info",P(e.品质.grade)])},(0,a.toDisplayString)(O(e.品质.grade))+"("+(0,a.toDisplayString)(e.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)])],10,tN);var n}),128))]),(0,a.createCommentVNode)(" 桌面端物品详情侧边栏 "),D.value?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",dN,[s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",mN,[(0,a.createElementVNode)("div",pN,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["details-icon-large",K(s.value)])},[(0,a.createElementVNode)("div",vN,(0,a.toDisplayString)(s.value.类型),1)],2),(0,a.createElementVNode)("div",uN,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(s.value.名称),1),(0,a.createElementVNode)("div",gN,[(0,a.createTextVNode)((0,a.toDisplayString)(s.value.类型)+" / "+(0,a.toDisplayString)(s.value.品质?.quality||"未知")+" ",1),void 0!==s.value.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["grade-display",P(s.value.品质.grade)])},(0,a.toDisplayString)(O(s.value.品质.grade))+"("+(0,a.toDisplayString)(s.value.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)])])]),(0,a.createElementVNode)("div",fN,[(0,a.createElementVNode)("p",bN,(0,a.toDisplayString)(s.value.描述),1),(0,a.createCommentVNode)(" 功法特有属性 "),"功法"===s.value.类型?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createCommentVNode)(" 功法效果 "),s.value.功法效果?((0,a.openBlock)(),(0,a.createElementBlock)("div",hN,[l[27]||(l[27]=(0,a.createElementVNode)("h4",null,"功法效果:",-1)),(0,a.createElementVNode)("div",yN,[s.value.功法效果.修炼速度加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",xN,[l[24]||(l[24]=(0,a.createElementVNode)("span",{class:"effect-label"},"修炼速度:",-1)),(0,a.createElementVNode)("span",kN,"+"+(0,a.toDisplayString)((100*s.value.功法效果.修炼速度加成).toFixed(0))+"%",1)])):(0,a.createCommentVNode)("v-if",!0),s.value.功法效果.属性加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",wN,[l[25]||(l[25]=(0,a.createElementVNode)("span",{class:"effect-label"},"属性加成:",-1)),(0,a.createElementVNode)("span",NN,(0,a.toDisplayString)(q(s.value.功法效果.属性加成)),1)])):(0,a.createCommentVNode)("v-if",!0),s.value.功法效果.特殊能力?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",EN,[l[26]||(l[26]=(0,a.createElementVNode)("span",{class:"effect-label"},"特殊能力:",-1)),(0,a.createElementVNode)("div",VN,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.value.功法效果.特殊能力,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"ability-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 功法技能 "),s.value.功法技能&&Array.isArray(s.value.功法技能)&&s.value.功法技能.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",CN,[l[28]||(l[28]=(0,a.createElementVNode)("h4",null,"功法技能:",-1)),(0,a.createElementVNode)("div",zN,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.value.功法技能,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"skill-item"},[(0,a.createElementVNode)("div",SN,[(0,a.createElementVNode)("span",BN,(0,a.toDisplayString)(e.技能名称),1),e.解锁需要熟练度?((0,a.openBlock)(),(0,a.createElementBlock)("span",DN," 需要: "+(0,a.toDisplayString)(e.解锁需要熟练度)+"% ",1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",AN,(0,a.toDisplayString)(e.技能描述),1),e.消耗?((0,a.openBlock)(),(0,a.createElementBlock)("div",_N,"消耗: "+(0,a.toDisplayString)(e.消耗),1)):(0,a.createCommentVNode)("v-if",!0)]))),128))])])):(0,a.createCommentVNode)("v-if",!0)],64)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 装备装备增幅 "),"装备"===s.value.类型&&s.value.装备增幅?((0,a.openBlock)(),(0,a.createElementBlock)("div",$N,[l[29]||(l[29]=(0,a.createElementVNode)("h4",null,"装备增幅:",-1)),(0,a.createElementVNode)("div",IN,(0,a.toDisplayString)(M(s.value.装备增幅)),1)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",TN,[(0,a.createCommentVNode)(" 装备：装备和丢弃 "),"装备"===s.value?.类型?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["action-btn",H(s.value)?"unequip-btn":"equip-btn"]),disabled:S.value,onClick:l[14]||(l[14]=e=>J(s.value))},(0,a.toDisplayString)(H(s.value)?"卸下":"装备"),11,jN),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[15]||(l[15]=e=>G(s.value))}," 丢弃 ")],64)):"功法"===s.value?.类型?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 功法：修炼和丢弃 "),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["action-btn",Q(s.value)?"stop-cultivate-btn":"cultivate-btn"]),disabled:B.value,onClick:l[16]||(l[16]=e=>F(s.value))},(0,a.toDisplayString)(Q(s.value)?"停止修炼":"修炼"),11,MN),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[17]||(l[17]=e=>G(s.value))}," 丢弃 ")],64)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(" 其他物品：使用和丢弃 "),(0,a.createElementVNode)("button",{class:"action-btn use-btn",onClick:l[18]||(l[18]=e=>L(s.value))},"使用"),(0,a.createElementVNode)("button",{class:"action-btn discard-btn",onClick:l[19]||(l[19]=e=>G(s.value))}," 丢弃 ")],64))])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",qN,[(0,a.createVNode)((0,a.unref)(Qk),{size:48}),l[30]||(l[30]=(0,a.createElementVNode)("p",null,"选择物品查看详情",-1))]))]))])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 装备标签 "),"equipment"===u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",ON,[(0,a.createElementVNode)("div",PN,[(0,a.createElementVNode)("div",FN,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(_.value,(e,i)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:i,class:(0,a.normalizeClass)(["equipment-slot",{"has-equipment":e.item,"empty-slot":!e.item}])},[(0,a.createElementVNode)("div",LN,[(0,a.createElementVNode)("div",YN,(0,a.toDisplayString)(e.name),1),e.item?((0,a.openBlock)(),(0,a.createElementBlock)("div",RN,[(0,a.createElementVNode)("button",{class:"action-btn unequip-btn",disabled:S.value,onClick:a=>(async e=>{if(S.value)return;if(!e.item)return;S.value=!0;const a=e.item;bg.Yz.log("背包面板","卸下装备",a.名称);try{if(!n.value?.装备栏)return void d.o.error("装备栏数据不存在");if(!n.value?.背包_物品)return void d.o.error("背包数据不存在");n.value.装备栏[e.name]=null;const l=n.value.背包_物品?.[a.物品ID];l&&(l.已装备=!1);const{useCharacterStore:i}=await Promise.resolve().then(t.bind(t,948)),c=i();await c.syncToTavernAndSave(),await(async()=>{try{const e=(0,an.getTavernHelper)();if(!e)return void bg.Yz.warn("背包面板","酒馆环境不可用，跳过同步");await(0,Kk.aD)(e);const n=o.value;if(!n)return void bg.Yz.warn("背包面板","存档数据不存在，跳过同步");(0,Kk.qj)(n),bg.Yz.log("背包面板","数据已同步到酒馆变量")}catch(e){bg.Yz.error("背包面板","同步酒馆变量失败",e)}})(),r.addAction({type:"unequip",itemName:a.名称,itemType:a.类型,description:`卸下了《${a.名称}》装备`}),d.o.success(`已卸下《${a.名称}》`),bg.Yz.log("背包面板","装备卸下成功",a.名称)}catch(e){bg.Yz.error("背包面板","卸下装备失败",e),d.o.error("卸下装备失败")}finally{S.value=!1}})(e),title:"卸下装备"},[(0,a.createVNode)((0,a.unref)(Ne),{size:12})],8,UN)])):(0,a.createCommentVNode)("v-if",!0)]),e.item?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:(0,a.normalizeClass)(["equipment-item",K(e.item)])},[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["item-icon",K(e.item,"border")])},l[31]||(l[31]=[(0,a.createElementVNode)("div",{class:"item-type-text"},"装备",-1)]),2),(0,a.createElementVNode)("div",GN,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["item-name",K(e.item,"text")]),title:e.item.名称},(0,a.toDisplayString)(e.item.名称),11,WN),(0,a.createElementVNode)("div",JN,[(0,a.createTextVNode)((0,a.toDisplayString)(e.item.品质?.quality||"？")+"品 ",1),void 0!==e.item.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["item-grade",P(e.item.品质.grade)])},(0,a.toDisplayString)(O(e.item.品质.grade))+"("+(0,a.toDisplayString)(e.item.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)]),e.item.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"item-description",title:e.item.描述},(0,a.toDisplayString)(e.item.描述),9,HN)):(0,a.createCommentVNode)("v-if",!0),"装备"===e.item.类型&&e.item.装备增幅?((0,a.openBlock)(),(0,a.createElementBlock)("div",QN,[l[32]||(l[32]=(0,a.createElementVNode)("div",{class:"effects-title"},"增幅效果：",-1)),(0,a.createElementVNode)("div",KN,(0,a.toDisplayString)(M(e.item.装备增幅)),1)])):(0,a.createCommentVNode)("v-if",!0)])],2)):((0,a.openBlock)(),(0,a.createElementBlock)("div",XN,[(0,a.createElementVNode)("div",ZN,[(0,a.createVNode)((0,a.unref)(Ei),{size:24})]),l[33]||(l[33]=(0,a.createElementVNode)("div",{class:"empty-text"},"空槽位",-1)),l[34]||(l[34]=(0,a.createElementVNode)("div",{class:"empty-hint"},"可装备装备",-1))]))],2))),128))])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 灵石标签 "),"currency"===u.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",eE,[(0,a.createElementVNode)("div",nE,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(X,e=>(0,a.createElementVNode)("div",{key:e.name,class:(0,a.normalizeClass)(["currency-card",e.colorClass])},[(0,a.createElementVNode)("div",tE,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["currency-icon",`icon-${e.colorClass}`])},[(0,a.createVNode)((0,a.unref)(Jk),{size:D.value?32:40},null,8,["size"])],2),(0,a.createElementVNode)("div",aE,[(0,a.createElementVNode)("div",oE,(0,a.toDisplayString)((0,a.unref)(n)?.背包_灵石?.[e.name]||0),1),(0,a.createElementVNode)("div",rE,(0,a.toDisplayString)(e.name)+"灵石",1)])]),e.canExchange||e.canExchangeDown?((0,a.openBlock)(),(0,a.createElementBlock)("div",lE,[e.canExchange?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,class:"exchange-btn",onClick:n=>ne(e.name,"up"),disabled:((0,a.unref)(n)?.背包_灵石?.[e.name]||0)<100,title:`兑换为${e.exchangeUp}灵石 (100:1)`}," ↑ 兑换 ",8,iE)):(0,a.createCommentVNode)("v-if",!0),e.canExchangeDown?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:1,class:"exchange-btn down",onClick:n=>ne(e.name,"down"),disabled:((0,a.unref)(n)?.背包_灵石?.[e.name]||0)<1,title:`分解为${e.exchangeDown}灵石 (1:100)`}," ↓ 分解 ",8,cE)):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0)],2)),64))])])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 数量选择弹窗 "),(0,a.createVNode)(xw,{visible:h.value,item:y.value,title:x.value,"action-label":k.value,"action-type":w.value,"confirm-text":N.value,description:E.value,onClose:U,onConfirm:R},null,8,["visible","item","title","action-label","action-type","confirm-text","description"])],64))}});var dE=t(7280),mE={};mE.styleTagTransform=A(),mE.setAttributes=z(),mE.insert=V().bind(null,"head"),mE.domAPI=N(),mE.insertStyleElement=B(),k()(dE.A,mE),dE.A&&dE.A.locals&&dE.A.locals;const pE=(0,j.A)(sE,[["__scopeId","data-v-61146166"]]),vE=(0,c.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),uE=(0,c.A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),gE=(0,c.A)("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),fE={class:"relationship-network-panel"},bE={class:"panel-content"},hE={class:"relationship-list"},yE={class:"list-header"},xE={class:"search-bar"},kE={class:"list-content"},wE={key:0,class:"loading-state"},NE={key:1,class:"empty-state"},EE={key:2,class:"person-list"},VE=["onClick"],CE={class:"person-avatar"},zE={class:"avatar-text"},SE={class:"person-info"},BE={class:"person-name"},DE={class:"person-meta"},AE={class:"relationship-type"},_E={class:"card-actions"},$E=["onClick","title"],IE=["onClick"],TE={key:0,class:"person-realm"},jE={class:"realm-value"},ME={class:"intimacy-info"},qE={class:"intimacy-bar"},OE={class:"intimacy-value"},PE={class:"relationship-detail"},FE={class:"detail-header"},LE={class:"detail-avatar"},YE={class:"avatar-text"},RE={class:"detail-info"},UE={class:"name-and-actions"},GE={class:"detail-name"},WE={class:"detail-badges"},JE={class:"relationship-badge"},HE={class:"race-badge"},QE={key:0,class:"faction-badge"},KE={class:"detail-body"},XE={class:"detail-tabs"},ZE=["onClick"],eV={class:"tab-content"},nV={class:"tab-panel"},tV={class:"detail-section"},aV={class:"info-grid-responsive"},oV={class:"info-item-row"},rV={class:"info-value"},lV={class:"info-item-row"},iV={class:"info-value"},cV={class:"info-item-row"},sV={class:"info-value"},dV={class:"info-item-row"},mV={class:"info-value"},pV={key:0,class:"info-item-row"},vV={class:"info-value"},uV={key:1,class:"info-item-row"},gV={class:"info-value"},fV={key:0,class:"detail-section"},bV={key:0,class:"appearance-description"},hV={class:"description-text"},yV={key:1,class:"talents-grid",style:{"margin-top":"1rem"}},xV={key:1,class:"detail-section"},kV={key:0},wV={class:"talents-grid"},NV=["title"],EV={key:1,style:{"margin-top":"1rem"}},VV={class:"attributes-grid"},CV={class:"attribute-item"},zV={class:"attr-value"},SV={class:"attribute-item"},BV={class:"attr-value"},DV={class:"attribute-item"},AV={class:"attr-value"},_V={class:"attribute-item"},$V={class:"attr-value"},IV={class:"attribute-item"},TV={class:"attr-value"},jV={class:"attribute-item"},MV={class:"attr-value"},qV={key:2,class:"detail-section"},OV={class:"npc-memories-list"},PV={class:"npc-memory-content"},FV={class:"detail-section personality-section"},LV={class:"personality-bottomlines"},YV={key:0,class:"bottomline-tags"},RV={key:1,class:"bottomline-empty"},UV={class:"tab-panel"},GV={class:"detail-section highlight-section"},WV={class:"realtime-status"},JV={class:"status-item"},HV={class:"status-content"},QV={class:"status-text"},KV={class:"status-item"},XV={class:"status-content"},ZV={class:"status-text"},eC={key:0,class:"tab-panel"},nC={class:"detail-section nsfw-section"},tC={class:"nsfw-subsection"},aC={class:"info-grid"},oC={class:"info-item"},rC={class:"info-item"},lC={class:"info-value"},iC={class:"dev-bar-item",style:{"margin-top":"0.5rem"}},cC={class:"dev-bar-track"},sC={class:"nsfw-subsection"},dC={class:"info-grid"},mC={class:"info-item"},pC={class:"info-value"},vC={class:"info-item"},uC={class:"info-value"},gC={class:"info-item"},fC={class:"info-value"},bC={key:0,class:"partner-list"},hC={class:"mini-label"},yC={class:"talents-grid"},xC={class:"nsfw-subsection"},kC={class:"experience-grid"},wC={class:"exp-item"},NC={class:"exp-content"},EC={class:"exp-value"},VC={class:"exp-item"},CC={class:"exp-content"},zC={class:"exp-value"},SC={key:0,class:"last-time-info"},BC={class:"last-time-value"},DC={key:0,class:"nsfw-subsection"},AC={class:"body-parts-list"},_C={class:"part-header"},$C={class:"part-name"},IC={key:0,class:"part-mark"},TC={key:0,class:"part-description"},jC={class:"part-stats"},MC={class:"part-stat"},qC={class:"stat-bar-mini"},OC={class:"stat-value"},PC={class:"part-stat"},FC={class:"stat-bar-mini"},LC={class:"stat-value"},YC={key:1,class:"nsfw-subsection"},RC={class:"fluid-status"},UC={key:2,class:"nsfw-subsection"},GC={key:0,style:{"margin-bottom":"0.75rem"}},WC={class:"talents-grid"},JC={key:1},HC={class:"talents-grid"},QC={class:"tab-panel"},KC={key:0,class:"detail-section"},XC={class:"memory-header"},ZC={class:"memory-actions-header"},ez={key:0,class:"memory-count"},nz={key:1,class:"summarize-controls"},tz=["max"],az=["disabled"],oz={key:0,class:"memory-summary-list"},rz={class:"summary-text"},lz={key:1,class:"memory-list"},iz={class:"memory-content"},cz={class:"memory-time"},sz={class:"memory-event"},dz={class:"memory-actions"},mz=["onClick"],pz=["onClick"],vz={key:2,class:"memory-pagination"},uz=["disabled"],gz={class:"pagination-info"},fz=["disabled"],bz={key:3,class:"empty-state-small"},hz={class:"detail-section"},yz={class:"raw-data-container"},xz={class:"tab-panel"},kz={class:"detail-section"},wz={key:0,class:"spirit-stones-grid"},Nz={class:"spirit-stone-item"},Ez={class:"spirit-stone-item"},Vz={class:"spirit-stone-item"},Cz={class:"spirit-stone-item"},zz={class:"npc-inventory",style:{"margin-top":"1rem"}},Sz={key:0,class:"npc-items-grid"},Bz={class:"item-header"},Dz={class:"item-name"},Az={class:"item-type"},_z={key:0,class:"item-quality"},$z={class:"quality-text"},Iz={key:1,class:"item-quantity"},Tz={key:2,class:"item-description"},jz={class:"item-actions"},Mz=["onClick"],qz=["onClick"],Oz=["onClick"],Pz={key:1,class:"empty-inventory"},Fz={key:1,class:"no-selection"},Lz=(0,a.defineComponent)({__name:"RelationshipNetworkPanel",setup(e){const{characterData:n}=(0,Li.useUnifiedCharacterData)(),o=(0,Sv.useActionQueueStore)(),r=(0,q.useUIStore)(),l=(0,tn.useCharacterStore)(),i=(0,a.ref)(!1),c=(0,a.ref)(null),s=(0,a.ref)(""),m=(0,a.ref)(!1),p=(0,a.ref)("basic"),v=(0,a.computed)(()=>{const e=[{id:"basic",label:"基本信息",icon:"📋"},{id:"status",label:"实时状态",icon:"💭"}];return c.value?.私密信息&&e.push({id:"nsfw",label:"私密资料",icon:"🔞"}),e.push({id:"memory",label:"记忆档案",icon:"📝"}),e.push({id:"inventory",label:"背包",icon:"🎒"}),e}),u=(0,a.ref)(!1),g=(0,a.ref)(10),f=(0,a.ref)(5),b=(0,a.ref)(1),h=(0,a.computed)(()=>{if(!c.value?.记忆?.length)return[];const e=c.value.记忆,n=(b.value-1)*f.value,t=n+f.value;return e.slice(n,t)}),y=(0,a.computed)(()=>c.value?.记忆?.length?Math.ceil(c.value.记忆.length/f.value):0),x=e=>{e>=1&&e<=y.value&&(b.value=e)},k=()=>{b.value=1},w=e=>"string"==typeof e?"未知时间":e&&"object"==typeof e&&e.时间||"未知时间",N=e=>"string"==typeof e?e:e&&"object"==typeof e&&e.事件||"",E=e=>{const n=e.境界;if(!n)return"未知";if("object"==typeof n&&null!==n){const e=n.名称||"",t=n.阶段||"";if(e)return t?`${e}${t}`:e}return"string"==typeof n?n:"未知"},V=e=>e.记忆&&Array.isArray(e.记忆)?e.记忆.slice(-3).reverse().map(e=>"string"==typeof e?e:"object"==typeof e&&e.事件?e.事件:"").filter(e=>e.length>0):[],C=e=>{if(!e)return"未知";if("string"==typeof e)return e;if("object"==typeof e){if(e.名称&&e.品级)return`${e.名称}(${e.品级})`;if(e.名称)return`${e.名称}(未知品级)`}return"格式错误"},z=e=>{if(!e||"object"!=typeof e)return!1;const n=e,t="string"==typeof n.名字&&n.名字.length>0;return t||console.warn("[人脉系统] 检测到无效的人物关系条目，已自动过滤:",e),t},S=(0,a.computed)(()=>n.value?.人物关系&&"object"==typeof n.value.人物关系?Object.values(n.value.人物关系).filter(z):[]),B=(0,a.computed)(()=>{let e=[...S.value];if(s.value.trim()){const n=s.value.toLowerCase();e=e.filter(e=>e.名字.toLowerCase().includes(n)||(e.与玩家关系||"").toLowerCase().includes(n))}return e.sort((e,n)=>(n.好感度||0)-(e.好感度||0))}),D=e=>`intimacy-${(e=>{const n=e||0;return n>=80?"high":n>=60?"good":n>=40?"medium":n>=20?"low":n>=0?"neutral":n>=-20?"dislike":n>=-40?"hostile":"enemy"})(e)}`;(0,a.watch)(c,e=>{e&&k()}),(0,a.onMounted)(async()=>{console.log("[人脉系统] 人物关系面板已载入，开始同步数据"),i.value=!0;try{B.value.length>0&&(c.value=B.value[0])}catch(e){console.error("[人脉系统] 同步数据失败:",e),d.o.error("人脉数据同步失败")}finally{i.value=!1}});const A=e=>n.value?.人物关系&&Object.keys(n.value.人物关系).find(t=>n.value.人物关系[t]?.名字===e)||null,_=e=>{const n=e.背包?.物品;return!!n&&Object.keys(n).length>0},$=e=>e.实时关注||!1,I=async()=>{if(!c.value)return;const e=c.value.名字;u.value=!0;try{const a=(0,an.getTavernHelper)();if(!a)throw new Error("无法连接到酒馆助手");const o=c.value.记忆||[];if(0===o.length)throw new Error("没有记忆可以总结");const r=Math.min(Math.max(3,g.value||10),o.length),l=o.slice(0,r).map((e,n)=>`${n+1}. [${w(e)}] ${N(e)}`).join("\n"),i=`你是一个专业的记忆总结助手，擅长将NPC的记忆总结为详细的档案。\n\n总结要求：\n1. 必须包含小说六要素：时间、地点、人物、事件、原因、结果\n2. 用第三人称描述，以「${e}」为主视角\n3. 完整记录所有关键事件、人物关系变化、情感波动\n4. 按时间顺序梳理事件脉络\n5. 字数控制在200-300字，确保信息完整详实\n6. 使用修仙小说的语言风格\n7. 只返回总结内容，不要有任何前缀、后缀或标题`,s=`请将以下NPC「${e}」的记忆总结成详细的档案，务必包含时间、地点、人物、事件、原因、结果六要素：\n\n${l}`,m=await a.generateRaw({ordered_prompts:[{role:"system",content:i},{role:"user",content:s}],should_stream:!1});if(!m||"string"!=typeof m)throw new Error("AI响应格式错误");const p=m.trim();if(!p)throw new Error("总结内容为空");if(!n.value?.人物关系)throw new Error("存档数据不存在");const v=Object.keys(n.value.人物关系).find(t=>n.value.人物关系[t]?.名字===e);if(!v)throw new Error(`找不到NPC: ${e}`);n.value.人物关系[v].记忆总结||(n.value.人物关系[v].记忆总结=[]),n.value.人物关系[v].记忆总结.push(p),n.value.人物关系[v].记忆=o.slice(r);const{useCharacterStore:u}=await Promise.resolve().then(t.bind(t,948)),f=u();await f.syncToTavernAndSave({fullSync:!0}),c.value={...n.value.人物关系[v]},d.o.success(`已将 ${e} 最旧的 ${r} 条记忆总结并同步到酒馆`)}catch(e){const n=e instanceof Error?e.message:"未知错误";d.o.error(`记忆总结失败: ${n}`)}finally{u.value=!1}},T=e=>{e&&r.showRetryDialog({title:"删除人物",message:`你确定要从这个世界中永久删除【${e.名字}】吗？此操作无法撤销，所有与该人物相关的数据都将消失。`,confirmText:"确认删除",cancelText:"取消",onConfirm:async()=>{const n=e.名字,t=c.value?.名字===n;t&&(c.value=null,m.value=!1);try{await l.deleteNpc(n)}catch(e){const a=e instanceof Error?e.message:"未知错误";if(d.o.error(`删除失败: ${a}`),console.error("删除NPC失败:",e),t){const e=S.value.find(e=>e.名字===n);e&&(c.value=e,m.value=!0)}}},onCancel:()=>{}})};return(e,z)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",fE,[(0,a.createElementVNode)("div",bE,[(0,a.createCommentVNode)(" 人物关系列表 "),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["relationships-container",{"details-active":m.value}])},[(0,a.createCommentVNode)(" 左侧：人物列表 "),(0,a.createElementVNode)("div",hE,[(0,a.createElementVNode)("div",yE,[z[6]||(z[6]=(0,a.createElementVNode)("h3",{class:"panel-title"},"人物关系",-1)),(0,a.createElementVNode)("div",xE,[(0,a.createVNode)((0,a.unref)(Hk),{size:16}),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":z[0]||(z[0]=e=>s.value=e),placeholder:"搜索人物...",class:"search-input"},null,512),[[a.vModelText,s.value]])])]),(0,a.createElementVNode)("div",kE,[i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",wE,[(0,a.createVNode)((0,a.unref)(Cv),{size:32,class:"animate-spin"}),z[7]||(z[7]=(0,a.createElementVNode)("p",null,"正在读取人际关系...",-1))])):0===B.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",NE,[(0,a.createVNode)((0,a.unref)(qi),{size:48,class:"empty-icon"}),z[8]||(z[8]=(0,a.createElementVNode)("p",{class:"empty-text"},"尚未建立人际关系",-1)),z[9]||(z[9]=(0,a.createElementVNode)("p",{class:"empty-hint"},"在游戏中与更多人物互动建立关系",-1))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",EE,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(B.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.名字,class:(0,a.normalizeClass)(["person-card",{selected:c.value?.名字===e.名字}]),onClick:n=>(e=>{const n=c.value?.名字!==e.名字;c.value=c.value?.名字===e.名字?null:e,n&&c.value&&(k(),p.value="basic"),c.value?m.value=!0:m.value=!1})(e)},[(0,a.createElementVNode)("div",CE,[(0,a.createElementVNode)("span",zE,(0,a.toDisplayString)(e.名字.charAt(0)),1)]),(0,a.createElementVNode)("div",SE,[(0,a.createElementVNode)("div",BE,(0,a.toDisplayString)(e.名字),1),(0,a.createElementVNode)("div",DE,[(0,a.createElementVNode)("span",AE,(0,a.toDisplayString)(e.与玩家关系||"相识"),1),(0,a.createElementVNode)("div",_E,[(0,a.createElementVNode)("button",{class:"attention-toggle",onClick:(0,a.withModifiers)(n=>(async e=>{const n=e.名字,t=l.activeSaveSlot;if(!t?.存档数据?.人物关系)return void d.o.error("人物关系数据不存在");const a=Object.keys(t.存档数据.人物关系).find(e=>t.存档数据.人物关系[e]?.名字===n);if(a)try{const e=!t.存档数据.人物关系[a].实时关注;t.存档数据.人物关系[a].实时关注=e,await l.syncToTavernAndSave({changedPaths:[`人物关系.${a}.实时关注`]}),d.o.success(e?`已关注 ${n}`:`已取消关注 ${n}`),c.value?.名字===n&&(c.value={...t.存档数据.人物关系[a]})}catch(e){const n=e instanceof Error?e.message:"未知错误";d.o.error(`操作失败: ${n}`)}else d.o.error(`找不到名为 ${n} 的人物`)})(e),["stop","prevent"]),title:$(e)?"取消关注":"添加关注"},[$(e)?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(vE),{key:0,size:14,class:"attention-icon active"})):((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(uE),{key:1,size:14,class:"attention-icon inactive"}))],8,$E),(0,a.createElementVNode)("button",{onClick:(0,a.withModifiers)(n=>T(e),["stop"]),class:"delete-btn-card",title:"删除人物"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,IE)])]),"未知"!==E(e)?((0,a.openBlock)(),(0,a.createElementBlock)("div",TE,[z[10]||(z[10]=(0,a.createElementVNode)("span",{class:"realm-label"},"境界:",-1)),(0,a.createElementVNode)("span",jE,(0,a.toDisplayString)(E(e)),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",ME,[(0,a.createElementVNode)("div",qE,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["intimacy-fill",D(e.好感度)]),style:(0,a.normalizeStyle)({width:Math.max(5,Math.abs(e.好感度||0))+"%"})},null,6)]),(0,a.createElementVNode)("span",OE,(0,a.toDisplayString)(e.好感度||0),1)])]),(0,a.createVNode)((0,a.unref)(rc),{size:16,class:"arrow-icon"})],10,VE))),128))]))])]),(0,a.createCommentVNode)(" 右侧：人物详情 "),(0,a.createElementVNode)("div",PE,[c.value?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createCommentVNode)(" 详情头部 "),(0,a.createElementVNode)("div",FE,[(0,a.createElementVNode)("button",{onClick:z[1]||(z[1]=e=>m.value=!1),class:"back-to-list-btn"},[(0,a.createVNode)((0,a.unref)(ud),{size:20})]),(0,a.createElementVNode)("div",LE,[(0,a.createElementVNode)("span",YE,(0,a.toDisplayString)(c.value.名字.charAt(0)),1)]),(0,a.createElementVNode)("div",RE,[(0,a.createElementVNode)("div",UE,[(0,a.createElementVNode)("h3",GE,(0,a.toDisplayString)(c.value.名字),1),c.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,onClick:z[2]||(z[2]=e=>T(c.value)),class:"delete-npc-btn",title:"删除此人物"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:16})])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",WE,[(0,a.createElementVNode)("span",JE,(0,a.toDisplayString)(c.value.与玩家关系||"相识"),1),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["intimacy-badge",D(c.value.好感度)])}," 好感 "+(0,a.toDisplayString)(c.value.好感度||0),3),(0,a.createElementVNode)("span",HE,(0,a.toDisplayString)(c.value.种族||"人族"),1),c.value.势力归属?((0,a.openBlock)(),(0,a.createElementBlock)("span",QE,(0,a.toDisplayString)(c.value.势力归属),1)):(0,a.createCommentVNode)("v-if",!0)])])]),(0,a.createCommentVNode)(" 详情主体 "),(0,a.createElementVNode)("div",KE,[(0,a.createCommentVNode)(" 选项卡导航 "),(0,a.createElementVNode)("div",XE,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(v.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:e.id,class:(0,a.normalizeClass)(["tab-btn",{active:p.value===e.id}]),onClick:n=>p.value=e.id},(0,a.toDisplayString)(e.icon)+" "+(0,a.toDisplayString)(e.label),11,ZE))),128))]),(0,a.createCommentVNode)(" 选项卡内容 "),(0,a.createElementVNode)("div",eV,[(0,a.createCommentVNode)(" Tab 1: 基本信息 "),(0,a.withDirectives)((0,a.createElementVNode)("div",nV,[(0,a.createCommentVNode)(" 基础档案 "),(0,a.createElementVNode)("div",tV,[z[17]||(z[17]=(0,a.createElementVNode)("h5",{class:"section-title"},"基础档案",-1)),(0,a.createElementVNode)("div",aV,[(0,a.createElementVNode)("div",oV,[z[11]||(z[11]=(0,a.createElementVNode)("span",{class:"info-label"},"境界",-1)),(0,a.createElementVNode)("span",rV,(0,a.toDisplayString)(E(c.value)),1)]),(0,a.createElementVNode)("div",lV,[z[12]||(z[12]=(0,a.createElementVNode)("span",{class:"info-label"},"性别",-1)),(0,a.createElementVNode)("span",iV,(0,a.toDisplayString)(c.value.性别||"未知"),1)]),(0,a.createElementVNode)("div",cV,[z[13]||(z[13]=(0,a.createElementVNode)("span",{class:"info-label"},"年龄",-1)),(0,a.createElementVNode)("span",sV,(0,a.toDisplayString)(c.value.年龄?`${c.value.年龄}岁`:"未知"),1)]),(0,a.createElementVNode)("div",dV,[z[14]||(z[14]=(0,a.createElementVNode)("span",{class:"info-label"},"灵根",-1)),(0,a.createElementVNode)("span",mV,(0,a.toDisplayString)((j=c.value,C(j.灵根))),1)]),c.value.当前位置?((0,a.openBlock)(),(0,a.createElementBlock)("div",pV,[z[15]||(z[15]=(0,a.createElementVNode)("span",{class:"info-label"},"位置",-1)),(0,a.createElementVNode)("span",vV,(0,a.toDisplayString)(c.value.当前位置.描述),1)])):(0,a.createCommentVNode)("v-if",!0),c.value.出生?((0,a.openBlock)(),(0,a.createElementBlock)("div",uV,[z[16]||(z[16]=(0,a.createElementVNode)("span",{class:"info-label"},"出生",-1)),(0,a.createElementVNode)("span",gV,(0,a.toDisplayString)((S=c.value.出生,S?"string"==typeof S?S:"object"==typeof S&&(S.描述||S.name)||"未知":"未知")),1)])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 外貌与性格 "),c.value.外貌描述||c.value.性格特征?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",fV,[z[18]||(z[18]=(0,a.createElementVNode)("h5",{class:"section-title"},"外貌与性格",-1)),c.value.外貌描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",bV,[(0,a.createElementVNode)("p",hV,(0,a.toDisplayString)(c.value.外貌描述),1)])):(0,a.createCommentVNode)("v-if",!0),c.value.性格特征?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",yV,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.性格特征,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"talent-tag"},(0,a.toDisplayString)(e),1))),128))])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 天赋与六司 "),c.value.天赋?.length||c.value.先天六司?((0,a.openBlock)(),(0,a.createElementBlock)("div",xV,[z[27]||(z[27]=(0,a.createElementVNode)("h5",{class:"section-title"},"天赋与六司",-1)),c.value.天赋?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",kV,[z[19]||(z[19]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"天赋能力",-1)),(0,a.createElementVNode)("div",wV,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.天赋,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e.名称,class:"talent-tag",title:e.描述},(0,a.toDisplayString)(e.名称),9,NV))),128))])])):(0,a.createCommentVNode)("v-if",!0),c.value.先天六司?((0,a.openBlock)(),(0,a.createElementBlock)("div",EV,[z[26]||(z[26]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"先天六司",-1)),(0,a.createElementVNode)("div",VV,[(0,a.createElementVNode)("div",CV,[z[20]||(z[20]=(0,a.createElementVNode)("span",{class:"attr-label"},"根骨",-1)),(0,a.createElementVNode)("span",zV,(0,a.toDisplayString)(c.value.先天六司.根骨||0),1)]),(0,a.createElementVNode)("div",SV,[z[21]||(z[21]=(0,a.createElementVNode)("span",{class:"attr-label"},"灵性",-1)),(0,a.createElementVNode)("span",BV,(0,a.toDisplayString)(c.value.先天六司.灵性||0),1)]),(0,a.createElementVNode)("div",DV,[z[22]||(z[22]=(0,a.createElementVNode)("span",{class:"attr-label"},"悟性",-1)),(0,a.createElementVNode)("span",AV,(0,a.toDisplayString)(c.value.先天六司.悟性||0),1)]),(0,a.createElementVNode)("div",_V,[z[23]||(z[23]=(0,a.createElementVNode)("span",{class:"attr-label"},"气运",-1)),(0,a.createElementVNode)("span",$V,(0,a.toDisplayString)(c.value.先天六司.气运||0),1)]),(0,a.createElementVNode)("div",IV,[z[24]||(z[24]=(0,a.createElementVNode)("span",{class:"attr-label"},"魅力",-1)),(0,a.createElementVNode)("span",TV,(0,a.toDisplayString)(c.value.先天六司.魅力||0),1)]),(0,a.createElementVNode)("div",jV,[z[25]||(z[25]=(0,a.createElementVNode)("span",{class:"attr-label"},"心性",-1)),(0,a.createElementVNode)("span",MV,(0,a.toDisplayString)(c.value.先天六司.心性||0),1)])])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 最近记忆 "),V(c.value).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",qV,[z[28]||(z[28]=(0,a.createElementVNode)("h5",{class:"section-title"},"📝 最近记忆",-1)),(0,a.createElementVNode)("div",OV,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(V(c.value),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"npc-memory-item"},[(0,a.createElementVNode)("div",PV,(0,a.toDisplayString)(e),1)]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 人格底线（所有NPC都有）"),(0,a.createElementVNode)("div",FV,[z[29]||(z[29]=(0,a.createElementVNode)("h5",{class:"section-title"},"⚠️ 人格底线",-1)),(0,a.createElementVNode)("div",LV,[c.value.人格底线?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",YV,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.人格底线,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"bottomline-tag"},(0,a.toDisplayString)(e),1))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",RV,"未记录人格底线"))]),z[30]||(z[30]=(0,a.createElementVNode)("div",{class:"bottomline-warning"},[(0,a.createElementVNode)("span",{class:"warning-icon"},"⚡"),(0,a.createElementVNode)("span",{class:"warning-text"},"触犯人格底线将导致好感度断崖式下跌（-30 ~ -60），关系破裂且极难修复")],-1))])],512),[[a.vShow,"basic"===p.value]]),(0,a.createCommentVNode)(" Tab 2: 实时状态 "),(0,a.withDirectives)((0,a.createElementVNode)("div",UV,[(0,a.createElementVNode)("div",GV,[z[35]||(z[35]=(0,a.createElementVNode)("h5",{class:"section-title"},"💭 当前状态（实时）",-1)),(0,a.createElementVNode)("div",WV,[(0,a.createElementVNode)("div",JV,[z[32]||(z[32]=(0,a.createElementVNode)("span",{class:"status-icon"},"😶",-1)),(0,a.createElementVNode)("div",HV,[z[31]||(z[31]=(0,a.createElementVNode)("div",{class:"status-label"},"外貌状态",-1)),(0,a.createElementVNode)("div",QV,(0,a.toDisplayString)(c.value.当前外貌状态||"神态自然，衣衫整洁"),1)])]),(0,a.createElementVNode)("div",KV,[z[34]||(z[34]=(0,a.createElementVNode)("span",{class:"status-icon"},"💭",-1)),(0,a.createElementVNode)("div",XV,[z[33]||(z[33]=(0,a.createElementVNode)("div",{class:"status-label"},"内心想法",-1)),(0,a.createElementVNode)("div",ZV,(0,a.toDisplayString)(c.value.当前内心想法||"心如止水，平静无波"),1)])])])])],512),[[a.vShow,"status"===p.value]]),(0,a.createCommentVNode)(" Tab 3: 私密资料 (NSFW) "),c.value.私密信息?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("div",eC,[(0,a.createElementVNode)("div",nC,[z[56]||(z[56]=(0,a.createElementVNode)("h5",{class:"section-title"},"🔞 私密信息",-1)),(0,a.createCommentVNode)(" 性欲与状态 "),(0,a.createElementVNode)("div",tC,[z[38]||(z[38]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"状态与欲望",-1)),(0,a.createElementVNode)("div",aC,[(0,a.createElementVNode)("div",oC,[z[36]||(z[36]=(0,a.createElementVNode)("span",{class:"info-label"},"性状态",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["info-value status-badge","status-"+c.value.私密信息.当前性状态])},(0,a.toDisplayString)(c.value.私密信息.当前性状态),3)]),(0,a.createElementVNode)("div",rC,[z[37]||(z[37]=(0,a.createElementVNode)("span",{class:"info-label"},"性渴望",-1)),(0,a.createElementVNode)("span",lC,(0,a.toDisplayString)(c.value.私密信息.性渴望程度||0)+"%",1)])]),(0,a.createElementVNode)("div",iC,[(0,a.createElementVNode)("div",cC,[(0,a.createElementVNode)("div",{class:"dev-bar-fill desire-fill",style:(0,a.normalizeStyle)({width:(c.value.私密信息.性渴望程度||0)+"%"})},null,4)])])]),(0,a.createCommentVNode)(" 基础信息 "),(0,a.createElementVNode)("div",sC,[z[42]||(z[42]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"基础信息",-1)),(0,a.createElementVNode)("div",dC,[(0,a.createElementVNode)("div",mC,[z[39]||(z[39]=(0,a.createElementVNode)("span",{class:"info-label"},"贞洁",-1)),(0,a.createElementVNode)("span",pC,(0,a.toDisplayString)("女"===c.value.性别||"其他"===c.value.性别?c.value.私密信息.是否为处女?"✓ 处女":"✗ 非处":c.value.私密信息.是否为处男?"✓ 处男":"✗ 非处"),1)]),(0,a.createElementVNode)("div",vC,[z[40]||(z[40]=(0,a.createElementVNode)("span",{class:"info-label"},"性格倾向",-1)),(0,a.createElementVNode)("span",uC,(0,a.toDisplayString)(c.value.私密信息.性格倾向||"未知"),1)]),(0,a.createElementVNode)("div",gC,[z[41]||(z[41]=(0,a.createElementVNode)("span",{class:"info-label"},"性取向",-1)),(0,a.createElementVNode)("span",fC,(0,a.toDisplayString)(c.value.私密信息.性取向||"异性恋"),1)])]),(0,a.createCommentVNode)(" 性伴侣名单 "),c.value.私密信息.性伴侣名单?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",bC,[(0,a.createElementVNode)("div",hC,"性伴侣名单 ("+(0,a.toDisplayString)(c.value.私密信息.性伴侣数量||0)+"人)",1),(0,a.createElementVNode)("div",yC,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)([...new Set(c.value.私密信息.性伴侣名单)],(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"partner-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 性经验统计 "),(0,a.createElementVNode)("div",xC,[z[48]||(z[48]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"性经验统计",-1)),(0,a.createElementVNode)("div",kC,[(0,a.createElementVNode)("div",wC,[z[44]||(z[44]=(0,a.createElementVNode)("div",{class:"exp-icon"},"💕",-1)),(0,a.createElementVNode)("div",NC,[z[43]||(z[43]=(0,a.createElementVNode)("div",{class:"exp-label"},"性交总次数",-1)),(0,a.createElementVNode)("div",EC,(0,a.toDisplayString)(c.value.私密信息.性交总次数||0)+"次",1)])]),(0,a.createElementVNode)("div",VC,[z[46]||(z[46]=(0,a.createElementVNode)("div",{class:"exp-icon"},"👥",-1)),(0,a.createElementVNode)("div",CC,[z[45]||(z[45]=(0,a.createElementVNode)("div",{class:"exp-label"},"性伴侣数量",-1)),(0,a.createElementVNode)("div",zC,(0,a.toDisplayString)(c.value.私密信息.性伴侣数量||0)+"人",1)])])]),c.value.私密信息.最近一次性行为时间?((0,a.openBlock)(),(0,a.createElementBlock)("div",SC,[z[47]||(z[47]=(0,a.createElementVNode)("span",{class:"last-time-label"},"最近一次：",-1)),(0,a.createElementVNode)("span",BC,(0,a.toDisplayString)(c.value.私密信息.最近一次性行为时间),1)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 身体部位开发 "),c.value.私密信息.身体部位?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",DC,[z[51]||(z[51]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"身体部位开发",-1)),(0,a.createElementVNode)("div",AC,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.私密信息.身体部位,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.部位名称,class:"body-part-item"},[(0,a.createElementVNode)("div",_C,[(0,a.createElementVNode)("span",$C,(0,a.toDisplayString)(e.部位名称),1),e.特殊标记?((0,a.openBlock)(),(0,a.createElementBlock)("span",IC,(0,a.toDisplayString)(e.特殊标记),1)):(0,a.createCommentVNode)("v-if",!0)]),e.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",TC,(0,a.toDisplayString)(e.描述),1)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",jC,[(0,a.createElementVNode)("div",MC,[z[49]||(z[49]=(0,a.createElementVNode)("span",{class:"stat-label"},"敏感度",-1)),(0,a.createElementVNode)("div",qC,[(0,a.createElementVNode)("div",{class:"stat-bar-fill sensitivity",style:(0,a.normalizeStyle)({width:(e.敏感度||0)+"%"})},null,4)]),(0,a.createElementVNode)("span",OC,(0,a.toDisplayString)(e.敏感度||0)+"%",1)]),(0,a.createElementVNode)("div",PC,[z[50]||(z[50]=(0,a.createElementVNode)("span",{class:"stat-label"},"开发度",-1)),(0,a.createElementVNode)("div",FC,[(0,a.createElementVNode)("div",{class:"stat-bar-fill development",style:(0,a.normalizeStyle)({width:(e.开发程度||0)+"%"})},null,4)]),(0,a.createElementVNode)("span",LC,(0,a.toDisplayString)(e.开发程度||0)+"%",1)])])]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 体液状态 "),c.value.私密信息.体液分泌状态?((0,a.openBlock)(),(0,a.createElementBlock)("div",YC,[z[52]||(z[52]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"体液状态",-1)),(0,a.createElementVNode)("div",RC,"💧 "+(0,a.toDisplayString)(c.value.私密信息.体液分泌状态),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 性癖好与体质 "),c.value.私密信息.性癖好?.length||c.value.私密信息.特殊体质?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",UC,[z[55]||(z[55]=(0,a.createElementVNode)("h6",{class:"subsection-title"},"癖好与体质",-1)),c.value.私密信息.性癖好?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",GC,[z[53]||(z[53]=(0,a.createElementVNode)("div",{class:"mini-label"},"性癖好",-1)),(0,a.createElementVNode)("div",WC,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.私密信息.性癖好,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"fetish-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0),c.value.私密信息.特殊体质?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",JC,[z[54]||(z[54]=(0,a.createElementVNode)("div",{class:"mini-label"},"特殊体质",-1)),(0,a.createElementVNode)("div",HC,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.私密信息.特殊体质,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"special-trait-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0)])],512)),[[a.vShow,"nsfw"===p.value]]):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" Tab 4: 记忆档案 "),(0,a.withDirectives)((0,a.createElementVNode)("div",QC,[c.value.记忆?.length||c.value.记忆总结?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",KC,[(0,a.createElementVNode)("div",XC,[z[57]||(z[57]=(0,a.createElementVNode)("h5",{class:"section-title",style:{border:"none",padding:"0",margin:"0"}},"记忆",-1)),(0,a.createElementVNode)("div",ZC,[y.value>1?((0,a.openBlock)(),(0,a.createElementBlock)("div",ez,(0,a.toDisplayString)(c.value.记忆?.length||0)+" 条",1)):(0,a.createCommentVNode)("v-if",!0),(c.value.记忆?.length||0)>=3?((0,a.openBlock)(),(0,a.createElementBlock)("div",nz,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number","onUpdate:modelValue":z[3]||(z[3]=e=>g.value=e),min:3,max:c.value.记忆?.length||3,class:"summarize-input",placeholder:"条数",title:"从最旧开始总结的记忆条数"},null,8,tz),[[a.vModelText,g.value,void 0,{number:!0}]]),(0,a.createElementVNode)("button",{class:"summarize-btn",onClick:I,disabled:u.value,title:"总结最旧的记忆"},(0,a.toDisplayString)(u.value?"总结中...":"📝 总结"),9,az)])):(0,a.createCommentVNode)("v-if",!0)])]),c.value.记忆总结?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",oz,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.记忆总结,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"memory-summary-item"},[z[58]||(z[58]=(0,a.createElementVNode)("div",{class:"summary-icon"},"📜",-1)),(0,a.createElementVNode)("div",rz,(0,a.toDisplayString)(e),1)]))),128))])):(0,a.createCommentVNode)("v-if",!0),c.value.记忆?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",lz,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(h.value,(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:o,class:"memory-item"},[(0,a.createElementVNode)("div",iz,[(0,a.createElementVNode)("div",cz,(0,a.toDisplayString)(w(e)),1),(0,a.createElementVNode)("div",sz,(0,a.toDisplayString)(N(e)),1)]),(0,a.createElementVNode)("div",dz,[(0,a.createElementVNode)("button",{class:"memory-btn edit",onClick:e=>(async e=>{if(!c.value)return;const a=c.value.名字,o=A(a);if(!o)return;if(!n.value?.人物关系?.[o]?.记忆)return;const r=n.value.人物关系[o].记忆[e];let l="",i="";"string"==typeof r?(i=r,l="未知时间"):r&&"object"==typeof r&&(l=r.时间||"未知时间",i=r.事件||"");const s=window.prompt("编辑记忆时间",l);if(null===s)return;const d=window.prompt("编辑记忆事件",i);if(null===d)return;n.value.人物关系[o].记忆[e]={时间:s.trim(),事件:d.trim()},c.value={...n.value.人物关系[o]};const{useCharacterStore:m}=await Promise.resolve().then(t.bind(t,948)),p=m();await p.saveCurrentGame()})((b.value-1)*f.value+o)},"编辑",8,mz),(0,a.createElementVNode)("button",{class:"memory-btn delete",onClick:e=>(async e=>{c.value&&r.showRetryDialog({title:"删除记忆",message:"确定要删除这条记忆吗？",confirmText:"删除",cancelText:"取消",onConfirm:async()=>{const a=c.value.名字,o=A(a);if(!o)return;if(!n.value?.人物关系?.[o]?.记忆)return;n.value.人物关系[o].记忆.splice(e,1),c.value={...n.value.人物关系[o]};const{useCharacterStore:r}=await Promise.resolve().then(t.bind(t,948)),l=r();await l.syncToTavernAndSave({fullSync:!0})},onCancel:()=>{}})})((b.value-1)*f.value+o)},"删除",8,pz)])]))),128))])):(0,a.createCommentVNode)("v-if",!0),y.value>1?((0,a.openBlock)(),(0,a.createElementBlock)("div",vz,[(0,a.createElementVNode)("button",{class:"pagination-btn",disabled:b.value<=1,onClick:z[4]||(z[4]=e=>x(b.value-1))},"上一页",8,uz),(0,a.createElementVNode)("div",gz,(0,a.toDisplayString)(b.value)+" / "+(0,a.toDisplayString)(y.value),1),(0,a.createElementVNode)("button",{class:"pagination-btn",disabled:b.value>=y.value,onClick:z[5]||(z[5]=e=>x(b.value+1))},"下一页",8,fz)])):(0,a.createCommentVNode)("v-if",!0),c.value.记忆?.length||c.value.记忆总结?.length?(0,a.createCommentVNode)("v-if",!0):((0,a.openBlock)(),(0,a.createElementBlock)("div",bz,"此人暂无记忆"))])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 原始数据 "),(0,a.createElementVNode)("div",hz,[z[59]||(z[59]=(0,a.createElementVNode)("h5",{class:"section-title"},"原始数据 (JSON)",-1)),(0,a.createElementVNode)("div",yz,[(0,a.createElementVNode)("pre",null,[(0,a.createElementVNode)("code",null,(0,a.toDisplayString)(JSON.stringify(c.value,null,2)),1)])])])],512),[[a.vShow,"memory"===p.value]]),(0,a.createCommentVNode)(" End of Tab 4: 记忆档案 "),(0,a.createCommentVNode)(" Tab 5: 背包 "),(0,a.withDirectives)((0,a.createElementVNode)("div",xz,[(0,a.createElementVNode)("div",kz,[z[66]||(z[66]=(0,a.createElementVNode)("h5",{class:"section-title"},"背包",-1)),c.value.背包?.灵石?((0,a.openBlock)(),(0,a.createElementBlock)("div",wz,[(0,a.createElementVNode)("div",Nz,[z[60]||(z[60]=(0,a.createElementVNode)("span",null,"下品灵石",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(c.value.背包.灵石.下品||0),1)]),(0,a.createElementVNode)("div",Ez,[z[61]||(z[61]=(0,a.createElementVNode)("span",null,"中品灵石",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(c.value.背包.灵石.中品||0),1)]),(0,a.createElementVNode)("div",Vz,[z[62]||(z[62]=(0,a.createElementVNode)("span",null,"上品灵石",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(c.value.背包.灵石.上品||0),1)]),(0,a.createElementVNode)("div",Cz,[z[63]||(z[63]=(0,a.createElementVNode)("span",null,"极品灵石",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(c.value.背包.灵石.极品||0),1)])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",zz,[_(c.value)?((0,a.openBlock)(),(0,a.createElementBlock)("div",Sz,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value.背包.物品,(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:(0,a.normalizeClass)(["npc-item-card",(r=e.品质?.quality,r?`quality-${r.toLowerCase()}`:"quality-unknown")])},[(0,a.createElementVNode)("div",Bz,[(0,a.createElementVNode)("span",Dz,(0,a.toDisplayString)(e.名称||n),1),(0,a.createElementVNode)("span",Az,(0,a.toDisplayString)(e.类型||"其他"),1)]),e.品质?((0,a.openBlock)(),(0,a.createElementBlock)("div",_z,[(0,a.createElementVNode)("span",$z,(0,a.toDisplayString)(e.品质?.quality||"未知")+(0,a.toDisplayString)(e.品质?.grade?(t=e.品质.grade,null==t?"":0===t?"残缺":t>=1&&t<=3?"下品":t>=4&&t<=6?"中品":t>=7&&t<=9?"上品":10===t?"极品":""):""),1)])):(0,a.createCommentVNode)("v-if",!0),e.数量>1?((0,a.openBlock)(),(0,a.createElementBlock)("div",Iz,[(0,a.createElementVNode)("span",null,"x"+(0,a.toDisplayString)(e.数量),1)])):(0,a.createCommentVNode)("v-if",!0),e.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",Tz,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(e.描述),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",jz,[(0,a.createElementVNode)("button",{class:"trade-btn",onClick:n=>((e,n)=>{const t=`尝试与 ${e.名字} 交易 ${n.名称}`;o.addAction({type:"npc_trade",itemName:n.名称,itemType:"NPC交易",description:t,npcName:e.名字,itemId:n.物品ID||n.名称,tradeType:"trade"}),d.o.success(`已将与 ${e.名字} 的交易请求加入动作队列`)})(c.value,e),title:"尝试交易此物品"},[(0,a.createVNode)((0,a.unref)(gE),{size:12}),z[64]||(z[64]=(0,a.createTextVNode)("交易",-1))],8,Mz),(0,a.createElementVNode)("button",{class:"request-btn",onClick:n=>((e,n)=>{const t=`向 ${e.名字} 索要 ${n.名称}`;o.addAction({type:"npc_request",itemName:n.名称,itemType:"NPC索要",description:t,npcName:e.名字,itemId:n.物品ID||n.名称,tradeType:"request"}),d.o.success(`已将向 ${e.名字} 索要物品的请求加入动作队列`)})(c.value,e),title:"请求获得此物品"},"🙏 索要",8,qz),(0,a.createElementVNode)("button",{class:"steal-btn",onClick:n=>((e,n)=>{const t=`尝试从 ${e.名字} 身上偷取 ${n.名称}`;o.addAction({type:"npc_steal",itemName:n.名称,itemType:"NPC偷窃",description:t,npcName:e.名字,itemId:n.物品ID||n.名称,tradeType:"steal"}),d.o.success(`已将偷窃 ${e.名字} 物品的计划加入动作队列`)})(c.value,e),title:"尝试偷取此物品"},"🥷 偷窃",8,Oz)])],2);var t,r}),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Pz,[(0,a.createVNode)((0,a.unref)(Ei),{size:24,class:"empty-icon"}),z[65]||(z[65]=(0,a.createElementVNode)("p",null,"此人身上没有物品",-1))]))])])],512),[[a.vShow,"inventory"===p.value]]),(0,a.createCommentVNode)(" End of Tab 5: 背包 ")]),(0,a.createCommentVNode)(" End of tab-content ")]),(0,a.createCommentVNode)(" End of detail-body ")],64)):((0,a.openBlock)(),(0,a.createElementBlock)("div",Fz,[(0,a.createVNode)((0,a.unref)(qi),{size:64,class:"placeholder-icon"}),z[67]||(z[67]=(0,a.createElementVNode)("p",{class:"placeholder-text"},"选择一个人物查看详细信息",-1)),z[68]||(z[68]=(0,a.createElementVNode)("p",{class:"placeholder-hint"},"在游戏中与人物互动会建立关系记录",-1))]))])],2)])]);var S,j}}});var Yz=t(9477),Rz={};Rz.styleTagTransform=A(),Rz.setAttributes=z(),Rz.insert=V().bind(null,"head"),Rz.domAPI=N(),Rz.insertStyleElement=B(),k()(Yz.A,Rz),Yz.A&&Yz.A.locals&&Yz.A.locals;const Uz=(0,j.A)(Lz,[["__scopeId","data-v-1a2c11e6"]]),Gz={class:"deep-cultivation-modal"},Wz={class:"modal-header"},Jz={class:"modal-content"},Hz={key:0,class:"technique-info-section"},Qz={class:"info-header"},Kz={class:"technique-details"},Xz={class:"technique-quality"},Zz={class:"progress-section"},eS={class:"progress-label"},nS={class:"progress-percent"},tS={class:"progress-bar-bg"},aS={key:0,class:"effects-section"},oS={class:"effects-list"},rS={key:0},lS={key:1},iS={class:"cultivation-days-section"},cS={class:"input-group"},sS={class:"preset-buttons"},dS=["onClick"],mS={class:"modal-footer"},pS=["disabled"],vS=(0,a.defineComponent)({__name:"DeepCultivationModal",props:{visible:{type:Boolean},technique:{},currentProgress:{default:0}},emits:["close","confirm"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)(7),l=[{label:"1天",value:1},{label:"7天",value:7},{label:"30天",value:30},{label:"90天",value:90},{label:"180天",value:180},{label:"365天",value:365}],i=(0,a.computed)(()=>r.value>=1&&r.value<=3650),c=(0,a.computed)(()=>`quality-${t.technique?.品质?.quality||"凡"}`),s=()=>{o("close")},d=()=>{i.value&&o("confirm",r.value)};return(0,a.watch)(()=>t.visible,e=>{e||(r.value=7)}),(e,n)=>e.visible?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:(0,a.withModifiers)(s,["self"])},[(0,a.createElementVNode)("div",Gz,[(0,a.createElementVNode)("div",Wz,[n[1]||(n[1]=(0,a.createElementVNode)("h3",null,"深度修炼",-1)),(0,a.createElementVNode)("button",{class:"close-btn",onClick:s},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",Jz,[(0,a.createCommentVNode)(" 功法信息 "),e.technique?((0,a.openBlock)(),(0,a.createElementBlock)("div",Hz,[(0,a.createElementVNode)("div",Qz,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-icon",c.value])},"📖",2),(0,a.createElementVNode)("div",Kz,[(0,a.createElementVNode)("h4",{class:(0,a.normalizeClass)(["technique-name",c.value])},(0,a.toDisplayString)(e.technique.名称),3),(0,a.createElementVNode)("div",Xz,(0,a.toDisplayString)(e.technique.品质?.quality||"凡")+"品 "+(0,a.toDisplayString)(e.technique.品质?.grade||0)+"阶 ",1)])]),(0,a.createCommentVNode)(" 当前修炼进度 "),(0,a.createElementVNode)("div",Zz,[(0,a.createElementVNode)("div",eS,[n[2]||(n[2]=(0,a.createElementVNode)("span",null,"当前修炼进度",-1)),(0,a.createElementVNode)("span",nS,(0,a.toDisplayString)(e.currentProgress)+"%",1)]),(0,a.createElementVNode)("div",tS,[(0,a.createElementVNode)("div",{class:"progress-bar-fill",style:(0,a.normalizeStyle)({width:e.currentProgress+"%"})},null,4)])]),(0,a.createCommentVNode)(" 功法效果 "),e.technique.功法效果?((0,a.openBlock)(),(0,a.createElementBlock)("div",aS,[n[6]||(n[6]=(0,a.createElementVNode)("h5",null,"功法效果",-1)),(0,a.createElementVNode)("ul",oS,[e.technique.功法效果.修炼速度加成?((0,a.openBlock)(),(0,a.createElementBlock)("li",rS,[n[3]||(n[3]=(0,a.createElementVNode)("span",{class:"effect-icon"},"🚀",-1)),(0,a.createTextVNode)(" 修炼速度: +"+(0,a.toDisplayString)((100*(e.technique.功法效果.修炼速度加成-1)).toFixed(0))+"% ",1)])):(0,a.createCommentVNode)("v-if",!0),e.technique.功法效果.属性加成?((0,a.openBlock)(),(0,a.createElementBlock)("li",lS,[n[4]||(n[4]=(0,a.createElementVNode)("span",{class:"effect-icon"},"💪",-1)),n[5]||(n[5]=(0,a.createTextVNode)(" 属性加成: ",-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.technique.功法效果.属性加成,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"attr-bonus"},(0,a.toDisplayString)(n)+"+"+(0,a.toDisplayString)(e),1))),128))])):(0,a.createCommentVNode)("v-if",!0)])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 修炼天数选择 "),(0,a.createElementVNode)("div",iS,[n[8]||(n[8]=(0,a.createElementVNode)("label",{class:"section-label"},"选择修炼天数",-1)),n[9]||(n[9]=(0,a.createElementVNode)("p",{class:"section-hint"},"AI将根据修炼天数生成详细的修炼过程和结果",-1)),(0,a.createElementVNode)("div",cS,[(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),type:"number",min:1,max:3650,step:1,class:"days-input",placeholder:"输入天数"},null,512),[[a.vModelText,r.value,void 0,{number:!0}]]),n[7]||(n[7]=(0,a.createElementVNode)("span",{class:"input-unit"},"天",-1))]),(0,a.createCommentVNode)(" 快捷选择 "),(0,a.createElementVNode)("div",sS,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l,e=>(0,a.createElementVNode)("button",{key:e.value,class:(0,a.normalizeClass)(["preset-btn",{active:r.value===e.value}]),onClick:n=>r.value=e.value},(0,a.toDisplayString)(e.label),11,dS)),64))])])]),(0,a.createElementVNode)("div",mS,[(0,a.createElementVNode)("button",{class:"btn btn-cancel",onClick:s},"取消"),(0,a.createElementVNode)("button",{class:"btn btn-confirm",disabled:!i.value,onClick:d}," 开始修炼 ",8,pS)])])])):(0,a.createCommentVNode)("v-if",!0)}});var uS=t(5885),gS={};gS.styleTagTransform=A(),gS.setAttributes=z(),gS.insert=V().bind(null,"head"),gS.domAPI=N(),gS.insertStyleElement=B(),k()(uS.A,gS),uS.A&&uS.A.locals&&uS.A.locals;const fS=(0,j.A)(vS,[["__scopeId","data-v-2e089ec8"]]),bS={class:"cultivation-panel game-panel"},hS={class:"panel-header"},yS={class:"header-actions"},xS=["disabled"],kS={class:"panel-content"},wS={key:0,class:"loading-state"},NS={key:1,class:"cultivation-sections"},ES={class:"detail-section cultivation-card"},VS={class:"detail-header"},CS={class:"cultivation-status"},zS={key:0,class:"empty-state"},SS={key:1,class:"cultivation-info"},BS={key:0,class:"technique-item"},DS={class:"technique-info"},AS={class:"technique-quality"},_S={class:"technique-progress"},$S={class:"progress-bar"},IS={class:"progress-text"},TS={key:1,class:"technique-details"},jS={class:"detail-block"},MS={class:"detail-block-content description-text"},qS={key:0,class:"detail-block"},OS={class:"effects-list"},PS={key:0},FS={key:1},LS={key:2,class:"skills-section"},YS={class:"skills-header"},RS={class:"skills-count"},US={class:"skills-list"},GS=["onClick"],WS={class:"skill-icon"},JS={class:"skill-info"},HS={class:"skill-header-info"},QS={class:"skill-name"},KS={class:"skill-type"},XS={key:0,class:"skill-unlock-requirement"},ZS={class:"skill-proficiency"},eB={class:"proficiency-bar"},nB={class:"proficiency-text"},tB=(0,a.defineComponent)({__name:"CultivationPanel",setup(e){const{saveData:n}=(0,Li.F)(),{basicInfo:o}=(0,Li.p)(),{characterData:r}=(0,Li.useUnifiedCharacterData)(),l=(0,tn.useCharacterStore)(),i=(0,a.ref)(!1),c=(0,a.computed)(()=>!n.value&&!o.value),s=(0,a.computed)(()=>v.value?.功法效果),m=(0,a.computed)(()=>{const e=s.value?.属性加成;return e?Object.entries(e).map(([e,n])=>({key:e,value:n})):[]}),p=(0,a.computed)(()=>{if(!s.value)return!1;const e=s.value,n=!!e.修炼速度加成,t=m.value.length>0,a=Array.isArray(e.特殊能力)&&e.特殊能力.length>0;return n||t||a}),v=(0,a.computed)(()=>{const e=r.value?.背包_物品;if(!e)return null;const n=Object.values(e).find(e=>"功法"===e?.类型&&!0===e?.已装备);return n?(console.log("[修炼面板-调试] 当前修炼功法数据:",{名称:n.名称,品质字段存在:!!n.品质,品质内容:n.品质,完整数据:n}),n):null}),u=(0,a.computed)(()=>{const e=v.value;if(!e)return[];const n=[],t=new Set;return e?.功法技能&&(Array.isArray(e.功法技能)?e.功法技能:[]).forEach(a=>{const o=a.技能名称;t.has(o)||f(o,e)&&(t.add(o),n.push({name:o,proficiency:g(o,"technique"),source:"功法传承",type:"功法技能",description:a.技能描述||"通过功法修炼掌握的技能",unlocked:!0,unlockRequirement:a.解锁需要熟练度}))}),n}),g=(e,n)=>30+(e.split("").reduce((e,n)=>e+n.charCodeAt(0),0)+n.length)%66,f=(e,n)=>{if(!n.功法技能)return!1;const t=(Array.isArray(n.功法技能)?n.功法技能:[]).find(n=>n.技能名称===e);return!!t&&(n.修炼进度||0)>=(t.解锁需要熟练度||0)},b=(e,n="border")=>e?`${n}-quality-${e.品质?.quality||"凡"}`:"",h=e=>e>=90?"宗师":e>=75?"精通":e>=50?"熟练":e>=25?"入门":"初学",y=async()=>{d.o.info("数据已通过中央存储自动更新")},x=async()=>{if(!v.value)return void d.o.error("当前没有正在修炼的功法");const e=v.value;bg.Yz.log("修炼面板","请求停止修炼",e.名称);try{await l.unequipTechnique(e.物品ID),d.o.success(`已停止修炼《${e.名称}》`),bg.Yz.log("修炼面板","停止修炼成功",e.名称)}catch(e){bg.Yz.error("修炼面板","停止修炼失败",e),d.o.error(`停止修炼失败: ${e instanceof Error?e.message:"未知错误"}`)}},k=()=>{v.value?i.value=!0:d.o.error("当前没有正在修炼的功法")},w=async e=>{if(i.value=!1,!v.value)return void d.o.error("当前没有正在修炼的功法");const n=v.value;try{const{useActionQueueStore:a}=await Promise.resolve().then(t.bind(t,3310));a().addAction({type:"cultivate",itemName:n.名称,itemType:"功法",description:`对《${n.名称}》进行${e}天的深度修炼`}),d.o.success(`已开始${e}天的深度修炼`),bg.Yz.log("修炼面板",`已添加${e}天深度修炼到动作队列:`,n.名称)}catch(e){bg.Yz.error("修炼面板","添加深度修炼动作失败:",e),d.o.error("添加修炼动作失败")}};return(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",bS,[(0,a.createCommentVNode)(" 头部统计 "),(0,a.createElementVNode)("div",hS,[n[2]||(n[2]=(0,a.createStaticVNode)('<div class="header-left" data-v-13a846e5><div class="header-icon" data-v-13a846e5>⚡</div><div class="header-info" data-v-13a846e5><h3 class="panel-title" data-v-13a846e5>修炼系统</h3><span class="panel-subtitle" data-v-13a846e5>功法与天赋</span></div></div>',1)),(0,a.createElementVNode)("div",yS,[(0,a.createElementVNode)("button",{class:"action-btn",onClick:y,disabled:c.value},[(0,a.createVNode)((0,a.unref)(te),{size:16,class:(0,a.normalizeClass)({"animate-spin":c.value})},null,8,["class"]),n[1]||(n[1]=(0,a.createElementVNode)("span",{class:"btn-text"},"刷新",-1))],8,xS)])]),(0,a.createElementVNode)("div",kS,[c.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",wS,n[3]||(n[3]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},"⏳",-1),(0,a.createElementVNode)("div",{class:"loading-text"},"正在读取修炼数据...",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",NS,[(0,a.createCommentVNode)(" 修炼功法卡片 "),(0,a.createElementVNode)("div",ES,[(0,a.createElementVNode)("div",VS,[n[4]||(n[4]=(0,a.createElementVNode)("div",{class:"header-icon"},"📖",-1)),n[5]||(n[5]=(0,a.createElementVNode)("h4",{class:"detail-title"},"修炼功法",-1)),(0,a.createElementVNode)("div",CS,(0,a.toDisplayString)(v.value?"修炼中":"未修炼"),1)]),v.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",SS,[v.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",BS,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-icon",b(v.value)])},"📖",2),(0,a.createElementVNode)("div",DS,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-name",b(v.value,"text")])},(0,a.toDisplayString)(v.value.名称),3),(0,a.createElementVNode)("div",AS,(0,a.toDisplayString)(v.value.品质?.quality||"凡")+"阶 "+(0,a.toDisplayString)((t=v.value.品质?.grade||0,0===t?"残缺":t>=1&&t<=3?"下品":t>=4&&t<=6?"中品":t>=7&&t<=9?"上品":10===t?"极品":"未知"))+"("+(0,a.toDisplayString)(v.value.品质?.grade||0)+") ",1),(0,a.createElementVNode)("div",_S,[(0,a.createElementVNode)("div",$S,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:Math.max(2,Math.min(100,Math.max(0,v.value.修炼进度||0)))+"%"})},null,4)]),(0,a.createElementVNode)("span",IS,(0,a.toDisplayString)(Math.min(100,Math.max(0,v.value.修炼进度||0)).toFixed(0))+"%",1)])]),(0,a.createElementVNode)("div",{class:"technique-actions"},[(0,a.createElementVNode)("button",{class:"action-btn cultivate-btn",onClick:k}," 深度修炼 "),(0,a.createElementVNode)("button",{class:"action-btn stop-cultivation-btn",onClick:x}," 停止修炼 ")])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 功法详情 "),v.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",TS,[(0,a.createCommentVNode)(" 功法描述 "),(0,a.createElementVNode)("div",jS,[n[7]||(n[7]=(0,a.createElementVNode)("h5",{class:"detail-block-title"},"功法描述",-1)),(0,a.createElementVNode)("p",MS,(0,a.toDisplayString)(v.value.描述||"暂无描述"),1)]),(0,a.createCommentVNode)(" 功法效果 "),p.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",qS,[n[14]||(n[14]=(0,a.createElementVNode)("h5",{class:"detail-block-title"},"功法效果",-1)),(0,a.createElementVNode)("ul",OS,[s.value?.修炼速度加成?((0,a.openBlock)(),(0,a.createElementBlock)("li",PS,[n[8]||(n[8]=(0,a.createElementVNode)("span",{class:"effect-icon"},"🚀",-1)),n[9]||(n[9]=(0,a.createElementVNode)("strong",null,"修炼速度:",-1)),(0,a.createTextVNode)(" +"+(0,a.toDisplayString)((100*(s.value?.修炼速度加成||1)-100).toFixed(0))+"% ",1)])):(0,a.createCommentVNode)("v-if",!0),m.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("li",FS,[n[10]||(n[10]=(0,a.createElementVNode)("span",{class:"effect-icon"},"💪",-1)),n[11]||(n[11]=(0,a.createElementVNode)("strong",null,"属性加成:",-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:n,class:"attribute-bonus"},(0,a.toDisplayString)(e.key)+" +"+(0,a.toDisplayString)(e.value),1))),128))])):(0,a.createCommentVNode)("v-if",!0),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.value?.特殊能力||[],(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("li",{key:t},[n[12]||(n[12]=(0,a.createElementVNode)("span",{class:"effect-icon"},"✨",-1)),n[13]||(n[13]=(0,a.createElementVNode)("strong",null,"特殊能力:",-1)),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e),1)]))),128))])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 已学技能列表 "),v.value&&u.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",LS,[(0,a.createElementVNode)("div",YS,[n[15]||(n[15]=(0,a.createElementVNode)("h5",{class:"skills-title"},"已掌握技能",-1)),(0,a.createElementVNode)("div",RS,"("+(0,a.toDisplayString)(u.value.length)+"个)",1)]),(0,a.createElementVNode)("div",US,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(u.value,e=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.name,class:"skill-item",onClick:n=>(e=>{const n=h(e.proficiency),t=(e=>{const n=e.proficiency;return n>=90?"技能威力极大提升，消耗降低，可触发特殊效果":n>=75?"技能威力大幅提升，消耗适中，偶有精妙表现":n>=50?"技能威力中等，消耗正常，表现稳定":n>=25?"技能威力较弱，消耗较高，偶有失误":"技能威力微弱，消耗很高，容易失误"})(e),a=`${e.name}\n\n类型：${e.type}\n来源：${e.source}\n熟练度：${e.proficiency}% (${n})\n\n技能描述：\n${e.description||"暂无描述"}\n\n修炼效果：\n${t}`;alert(a)})(e)},[(0,a.createElementVNode)("div",WS,(0,a.toDisplayString)((r=e.type,{主动技能:"⚡",被动技能:"🛡️",辅助技能:"✨",攻击技能:"⚔️",防御技能:"🛡️",治疗技能:"💚",辅助:"✨",攻击:"⚔️",防御:"🛡️",治疗:"💚"}[r]||"⚡")),1),(0,a.createElementVNode)("div",JS,[(0,a.createElementVNode)("div",HS,[(0,a.createElementVNode)("div",QS,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)("div",KS,(0,a.toDisplayString)(e.type),1)]),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["skill-source-tag",(o=e.source,{修炼习得:"source-direct",功法传承:"source-technique"}[o]||"source-default")])},(0,a.toDisplayString)(e.source),3),(0,a.createCommentVNode)(" 显示解锁条件（如果有） "),e.unlockRequirement?((0,a.openBlock)(),(0,a.createElementBlock)("div",XS," 解锁条件：功法熟练度 "+(0,a.toDisplayString)(e.unlockRequirement)+"% ",1)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",ZS,[n[16]||(n[16]=(0,a.createElementVNode)("span",{class:"proficiency-label"},"当前进度：",-1)),(0,a.createElementVNode)("div",eB,[(0,a.createElementVNode)("div",{class:"proficiency-fill",style:(0,a.normalizeStyle)({width:Math.min(100,Math.max(0,v.value?.修炼进度||0))+"%"})},null,4)]),(0,a.createElementVNode)("span",nB,(0,a.toDisplayString)(Math.min(100,Math.max(0,v.value?.修炼进度||0)).toFixed(0))+"%",1)])]),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["skill-level",(t=v.value?.修炼进度||0,t>=90?"level-master":t>=75?"level-expert":t>=50?"level-proficient":t>=25?"level-beginner":"level-novice")])},(0,a.toDisplayString)(h(v.value?.修炼进度||0)),3)],8,GS);var t,o,r}),128))])])):(0,a.createCommentVNode)("v-if",!0)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",zS,n[6]||(n[6]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"📕",-1),(0,a.createElementVNode)("div",{class:"empty-text"},"尚未修炼功法",-1),(0,a.createElementVNode)("div",{class:"empty-hint"},"前往背包装备功法开始修炼",-1)])))])]))]),(0,a.createCommentVNode)(" 深度修炼弹窗 "),(0,a.createVNode)(fS,{visible:i.value,technique:v.value,"current-progress":v.value?.修炼进度||0,onClose:n[0]||(n[0]=e=>i.value=!1),onConfirm:w},null,8,["visible","technique","current-progress"])]);var t}}});var aB=t(4440),oB={};oB.styleTagTransform=A(),oB.setAttributes=z(),oB.insert=V().bind(null,"head"),oB.domAPI=N(),oB.insertStyleElement=B(),k()(aB.A,oB),aB.A&&aB.A.locals&&aB.A.locals;const rB=(0,j.A)(tB,[["__scopeId","data-v-13a846e5"]]),lB=["aria-valuenow"],iB={key:0,class:"progress-label"},cB=(0,a.defineComponent)({__name:"ProgressBar",props:{value:{},max:{default:100},showLabel:{type:Boolean,default:!0},size:{default:"md"},format:{type:[Function,null],default:null}},setup(e){const n=e,t=(0,a.computed)(()=>{const e=1===n.max?100*n.value:n.value/n.max*100,t=Math.max(0,Math.min(100,e));return Math.round(t)}),o=(0,a.computed)(()=>n.format?n.format(n.value):`${t.value}%`);return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{class:(0,a.normalizeClass)(["progress",e.size]),role:"progressbar","aria-valuenow":t.value,"aria-valuemin":"0","aria-valuemax":"100"},[(0,a.createElementVNode)("div",{class:"progress-bar",style:(0,a.normalizeStyle)({width:t.value+"%"})},null,4),e.showLabel?((0,a.openBlock)(),(0,a.createElementBlock)("div",iB,(0,a.toDisplayString)(o.value),1)):(0,a.createCommentVNode)("v-if",!0)],10,lB))}});var sB=t(8205),dB={};dB.styleTagTransform=A(),dB.setAttributes=z(),dB.insert=V().bind(null,"head"),dB.domAPI=N(),dB.insertStyleElement=B(),k()(sB.A,dB),sB.A&&sB.A.locals&&sB.A.locals;const mB=(0,j.A)(cB,[["__scopeId","data-v-d9bb4e4a"]]),pB={class:"skills-main"},vB={class:"current-technique-section"},uB={key:0,class:"technique-content"},gB={class:"technique-info"},fB={class:"technique-quality"},bB={class:"technique-progress"},hB={class:"progress-bar-wrapper"},yB={class:"progress-text"},xB={key:1,class:"empty-slot-placeholder"},kB={class:"skills-and-library-grid"},wB={class:"skills-column"},NB={key:0,class:"unmastered-skills-section"},EB={class:"section-header"},VB={class:"count-badge"},CB={class:"unmastered-skills-grid"},zB={class:"skill-card-body"},SB={class:"skill-card-name"},BB={class:"skill-card-source"},DB={class:"skill-card-progress"},AB={class:"skill-progress-bar"},_B={class:"skill-card-desc"},$B={class:"learned-skills-section"},IB={class:"section-header"},TB={class:"count-badge"},jB={key:0,class:"empty-library"},MB={key:1,class:"learned-skills-grid"},qB={class:"skill-card-body"},OB={class:"skill-card-name"},PB={class:"skill-card-source"},FB={class:"skill-card-desc"},LB={key:0,class:"skill-card-cost"},YB={class:"section-header"},RB={class:"count-badge"},UB={key:1,class:"empty-library"},GB={key:2,class:"technique-grid"},WB=["onClick"],JB={class:"card-body"},HB={class:"card-quality"},QB={key:0,class:"card-desc"},KB=["disabled"],XB={key:0,class:"skill-details-content"},ZB={class:"card-header"},eD={class:"skill-type-text-large"},nD={class:"details-title-area"},tD={class:"details-meta"},aD={class:"meta-tag type-tag"},oD={class:"details-description"},rD={class:"details-tabs"},lD={class:"details-body"},iD={key:0,class:"tab-content"},cD={key:0,class:"skill-effects-section"},sD={class:"effect-details"},dD={key:0,class:"effect-item"},mD={class:"effect-value"},pD={key:1,class:"effect-item"},vD={class:"effect-value"},uD={key:2,class:"effect-item"},gD={class:"special-abilities"},fD={key:1,class:"empty-tab"},bD={key:1,class:"tab-content"},hD={key:0,class:"technique-skills-section"},yD={class:"skills-list"},xD={class:"skill-header"},kD={class:"skill-name"},wD={key:0,class:"skill-status unlocked"},ND={key:1,class:"skill-status locked"},ED={class:"skill-description"},VD={key:0,class:"skill-unlock-condition"},CD={key:1,class:"empty-tab"},zD={class:"details-actions"},SD={key:1,class:"details-placeholder"},BD=(0,a.defineComponent)({__name:"SkillsPanel",setup(e){const{characterData:n,saveData:o}=(0,Li.useUnifiedCharacterData)(),r=(0,q.useUIStore)(),l=(0,a.ref)(null),i=(0,a.ref)(""),c=(0,a.ref)("effects"),s=(0,a.ref)(!1),d=(0,a.ref)(!1),m=()=>{"undefined"!=typeof window&&(d.value=window.innerWidth<=768,d.value||(s.value=!1))};(0,a.onMounted)(()=>{m(),"undefined"!=typeof window&&window.addEventListener("resize",m)}),(0,a.onBeforeUnmount)(()=>{"undefined"!=typeof window&&window.removeEventListener("resize",m)});const p=(0,a.ref)(!1),v=(0,a.computed)(()=>l.value&&"功法"===l.value.类型?l.value:null),u=()=>{const e=o.value;return e?.修炼功法&&e.修炼功法?.修炼进度||0},g=(0,a.computed)(()=>{const e=n.value?.背包_物品,t=o.value;if(!e)return null;const a=Object.values(e).find(e=>"功法"===e?.类型&&!0===e?.已装备);return a?{...a,修炼进度:t?.修炼功法?.修炼进度||0,已解锁技能:t?.修炼功法?.已解锁技能||[]}:null}),f=(0,a.computed)(()=>{const e=n.value?.背包_物品;return e?Object.values(e).filter(e=>e&&"object"==typeof e&&"功法"===e.类型&&!!e.名称?.trim()&&!e.已装备):[]}),b=(0,a.computed)(()=>{const e=[];if(!g.value)return e;const n=g.value.已解锁技能||[],t=g.value.功法技能;return Array.isArray(t)?(t.forEach(t=>{n.includes(t.技能名称)&&e.push({技能名称:t.技能名称,技能描述:t.技能描述,消耗:t.消耗,来源功法:g.value.名称,解锁需要熟练度:t.解锁需要熟练度||0})}),e):e}),h=(0,a.computed)(()=>{const e=[];if(!g.value)return e;const n=g.value.已解锁技能||[],t=g.value.功法技能;return Array.isArray(t)?(t.forEach(t=>{n.includes(t.技能名称)||e.push({技能名称:t.技能名称,技能描述:t.技能描述,消耗:t.消耗,来源功法:g.value.名称,解锁需要熟练度:t.解锁需要熟练度||0})}),e):e}),y=(e,n=50)=>e?e.length<=n?e:e.substring(0,n)+"...":"",x=(e,n)=>{l.value=e,i.value=n,d.value&&(s.value=!1)},k=(e,n="border")=>{if(!e)return"";const t=e;return`${n}-quality-${t.品质?.quality||"凡"}`},w=e=>0===e?"残缺":e>=1&&e<=3?"下品":e>=4&&e<=6?"中品":e>=7&&e<=9?"上品":10===e?"极品":"未知",N=e=>0===e?"grade-broken":e>=1&&e<=3?"grade-low":e>=4&&e<=6?"grade-mid":e>=7&&e<=9?"grade-high":10===e?"grade-perfect":"grade-unknown",E=(0,a.computed)(()=>{const e=new Set;if(!g.value)return e;const n=g.value.修炼进度||0,t=g.value.功法技能;return Array.isArray(t)?(t.forEach(t=>{const a=t.解锁需要熟练度||0;n>=a&&e.add(t.技能名称)}),e):e}),V=(0,a.computed)(()=>{const e=l.value;if(!e?.功法效果?.修炼速度加成)return"无";const n=e.功法效果.修炼速度加成;if("number"==typeof n){const e=100*(n-1);return Math.abs(e)<1?"无":`${e>0?"+":""}${e.toFixed(0)}%`}return"无"}),C=()=>{l.value&&i.value&&(p.value=!0)},z=()=>{p.value=!1},S=async e=>{p.value=!1,l.value&&await B(e)},B=async e=>{if(!(e<=0)&&l.value)try{const n=l.value;console.log(`[技能面板] 添加${e}天深度修炼动作:`,n.名称);const{useActionQueueStore:a}=await Promise.resolve().then(t.bind(t,3310));a().addAction({type:"cultivate",itemName:n.名称,itemType:"功法",description:`对《${n.名称}》进行${e}天的深度修炼`}),console.log(`[技能面板] ${e}天深度修炼已添加到动作队列`),z()}catch(e){console.error("[技能面板] 添加深度修炼动作失败:",e)}},D=async()=>{if(!l.value||!i.value)return;const e=l.value;r.showRetryDialog({title:"卸下功法",message:`确定要卸下《${e.名称}》吗？`,confirmText:"确认卸下",cancelText:"取消",onConfirm:async()=>{try{const e=o.value;if(e?.修炼功法){const n=e.修炼功法;if(n&&e.背包?.物品){const t=n.物品ID;t&&e.背包.物品[t]&&(e.背包.物品[t].已装备=!1,console.log("[技能面板] 功法标记已清除:",n.名称))}e.修炼功法=null;const{useCharacterStore:a}=await Promise.resolve().then(t.bind(t,948)),o=a();await o.syncToTavernAndSave(),console.log("[技能面板] 功法卸下成功"),l.value=null,i.value=""}}catch(e){console.error("[技能面板] 卸下失败:",e)}},onCancel:()=>{}})},A=async()=>{if(!l.value||"背包功法"!==i.value)return;const e=l.value;console.log("[技能面板] 装备功法:",e.名称);try{const n=o.value;if(!n)return void console.error("[技能面板] 存档数据不存在");if(n.修炼功法){const t=n.修炼功法;if(t.物品ID!==e.物品ID)return void r.showRetryDialog({title:"切换功法",message:`当前正在修炼《${t.名称}》，确定要切换到《${e.名称}》吗？`,confirmText:"确认切换",cancelText:"取消",onConfirm:async()=>{const t=n.修炼功法;if(t?.物品ID&&n.背包?.物品){const e=n.背包.物品[t.物品ID];e&&(e.已装备=!1,console.log("[技能面板] 之前的功法已标记为未装备:",t.名称))}await _(e)},onCancel:()=>{}})}await _(e)}catch(e){console.error("[技能面板] 装备功法失败:",e)}},_=async e=>{const n=o.value;if(!n)return;if(n.修炼功法={物品ID:e.物品ID||"",名称:e.名称},n.背包?.物品&&e.物品ID){const t=n.背包.物品[e.物品ID];t&&(t.已装备=!0)}const{useCharacterStore:a}=await Promise.resolve().then(t.bind(t,948)),r=a();await r.syncToTavernAndSave(),console.log("[技能面板] 功法装备成功:",e.名称),e.物品ID&&n.背包?.物品?.[e.物品ID]?l.value=n.背包.物品[e.物品ID]:l.value=null,i.value="功法"};return(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createCommentVNode)(" 左侧：当前修炼+功法库 "),(0,a.createElementVNode)("div",pB,[(0,a.createCommentVNode)(" 当前修炼功法槽位 "),(0,a.createElementVNode)("div",vB,[n[8]||(n[8]=(0,a.createElementVNode)("h3",{class:"section-header"},[(0,a.createElementVNode)("span",{class:"header-icon"},"⚡"),(0,a.createElementVNode)("span",{class:"header-text"},"当前修炼")],-1)),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["current-technique-slot",{"has-technique":g.value}]),onClick:n[0]||(n[0]=e=>g.value&&x(g.value,"功法"))},[g.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",uB,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-icon-wrapper",k(g.value)])},n[6]||(n[6]=[(0,a.createElementVNode)("span",{class:"technique-icon-text"},"功",-1)]),2),(0,a.createElementVNode)("div",gB,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-name",k(g.value,"text")])},(0,a.toDisplayString)(g.value.名称),3),(0,a.createElementVNode)("div",fB,[(0,a.createTextVNode)((0,a.toDisplayString)(g.value.品质?.quality||"凡")+"品 ",1),void 0!==g.value.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["grade-display",N(g.value.品质.grade)])},(0,a.toDisplayString)(w(g.value.品质.grade))+"("+(0,a.toDisplayString)(g.value.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",bB,[(0,a.createElementVNode)("div",hB,[(0,a.createVNode)(mB,(0,a.normalizeProps)((0,a.guardReactiveProps)({value:Math.min(100,Math.max(0,g.value.修炼进度||0)),max:100,size:"sm",showLabel:!1})),null,16)]),(0,a.createElementVNode)("span",yB,(0,a.toDisplayString)(Math.min(100,Math.max(0,g.value.修炼进度||0)).toFixed(1))+"/100",1)])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",xB,n[7]||(n[7]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"📜",-1),(0,a.createElementVNode)("span",{class:"empty-text"},"未修炼功法",-1),(0,a.createElementVNode)("span",{class:"empty-hint"},"从下方功法库选择装备",-1)])))],2)]),(0,a.createElementVNode)("div",kB,[(0,a.createElementVNode)("div",wB,[(0,a.createCommentVNode)(" 未掌握技能列表 "),h.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",NB,[(0,a.createElementVNode)("h3",EB,[n[9]||(n[9]=(0,a.createElementVNode)("span",{class:"header-icon"},"🔒",-1)),n[10]||(n[10]=(0,a.createElementVNode)("span",{class:"header-text"},"未掌握技能",-1)),(0,a.createElementVNode)("span",VB,(0,a.toDisplayString)(h.value.length),1)]),(0,a.createElementVNode)("div",CB,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(h.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.技能名称,class:"unmastered-skill-card"},[n[11]||(n[11]=(0,a.createElementVNode)("div",{class:"skill-card-icon"},"🔒",-1)),(0,a.createElementVNode)("div",zB,[(0,a.createElementVNode)("div",SB,(0,a.toDisplayString)(e.技能名称),1),(0,a.createElementVNode)("div",BB," 当前: "+(0,a.toDisplayString)((g.value?.修炼进度||0).toFixed(1))+"% / 需要: "+(0,a.toDisplayString)(e.解锁需要熟练度)+"% ",1),(0,a.createElementVNode)("div",DB,[(0,a.createElementVNode)("div",AB,[(0,a.createElementVNode)("div",{class:"skill-progress-fill",style:(0,a.normalizeStyle)({width:Math.min(100,(g.value?.修炼进度||0)/e.解锁需要熟练度*100)+"%"})},null,4)])]),(0,a.createElementVNode)("div",_B,(0,a.toDisplayString)(y(e.技能描述,60)),1)])]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 已学技能列表 "),(0,a.createElementVNode)("div",$B,[(0,a.createElementVNode)("h3",IB,[n[12]||(n[12]=(0,a.createElementVNode)("span",{class:"header-icon"},"⚔️",-1)),n[13]||(n[13]=(0,a.createElementVNode)("span",{class:"header-text"},"已学技能",-1)),(0,a.createElementVNode)("span",TB,(0,a.toDisplayString)(b.value.length),1)]),0===b.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",jB,n[14]||(n[14]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"📖",-1),(0,a.createElementVNode)("div",{class:"empty-text"},"暂无已学技能",-1),(0,a.createElementVNode)("div",{class:"empty-hint"},"修炼功法解锁技能",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",MB,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(b.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.技能名称,class:"learned-skill-card"},[n[15]||(n[15]=(0,a.createElementVNode)("div",{class:"skill-card-icon"},"⚡",-1)),(0,a.createElementVNode)("div",qB,[(0,a.createElementVNode)("div",OB,(0,a.toDisplayString)(e.技能名称),1),(0,a.createElementVNode)("div",PB,"来源: "+(0,a.toDisplayString)(e.来源功法),1),(0,a.createElementVNode)("div",FB,(0,a.toDisplayString)(y(e.技能描述,60)),1),e.消耗?((0,a.openBlock)(),(0,a.createElementBlock)("div",LB,"消耗: "+(0,a.toDisplayString)(e.消耗),1)):(0,a.createCommentVNode)("v-if",!0)])]))),128))]))])]),(0,a.createCommentVNode)(" 功法库列表 "),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["technique-library-section",{"is-mobile":d.value,"is-open":s.value}])},[(0,a.createElementVNode)("h3",YB,[n[16]||(n[16]=(0,a.createElementVNode)("span",{class:"header-icon"},"📚",-1)),n[17]||(n[17]=(0,a.createElementVNode)("span",{class:"header-text"},"功法库",-1)),(0,a.createElementVNode)("span",RB,(0,a.toDisplayString)(f.value.length),1)]),d.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,type:"button",class:"mobile-library-close",onClick:n[1]||(n[1]=e=>s.value=!1)}," 收起 ")):(0,a.createCommentVNode)("v-if",!0),0===f.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",UB,n[18]||(n[18]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"📦",-1),(0,a.createElementVNode)("div",{class:"empty-text"},"功法库为空",-1),(0,a.createElementVNode)("div",{class:"empty-hint"},"从世界中获取功法秘籍",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",GB,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(f.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.物品ID,class:(0,a.normalizeClass)(["technique-card",[k(e),{selected:l.value===e}]]),onClick:n=>x(e,"背包功法")},[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["card-icon",k(e)])},n[19]||(n[19]=[(0,a.createElementVNode)("span",{class:"icon-text"},"功",-1)]),2),(0,a.createElementVNode)("div",JB,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["card-title",k(e,"text")])},(0,a.toDisplayString)(e.名称),3),(0,a.createElementVNode)("div",HB,[(0,a.createTextVNode)((0,a.toDisplayString)(e.品质?.quality||"凡")+"品 ",1),void 0!==e.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["grade-display",N(e.品质.grade)])},(0,a.toDisplayString)(w(e.品质.grade))+"("+(0,a.toDisplayString)(e.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)]),e.描述?((0,a.openBlock)(),(0,a.createElementBlock)("div",QB,(0,a.toDisplayString)(y(e.描述,50)),1)):(0,a.createCommentVNode)("v-if",!0)])],10,WB))),128))]))],2)]),(0,a.createCommentVNode)(" 功法详情侧边栏 "),d.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,type:"button",class:"mobile-library-toggle",disabled:s.value,onClick:n[2]||(n[2]=e=>s.value=!0)},[n[20]||(n[20]=(0,a.createElementVNode)("span",{class:"toggle-icon"},"📚",-1)),(0,a.createElementVNode)("span",null,"功法库 ("+(0,a.toDisplayString)(f.value.length)+")",1)],8,KB)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["skill-details-sidebar",{"no-selection":!l.value}])},[l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",XB,[(0,a.createCommentVNode)(" 顶部信息卡片 "),(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["details-card",k(l.value)])},[n[21]||(n[21]=(0,a.createElementVNode)("div",{class:"card-bg-glow"},null,-1)),(0,a.createElementVNode)("div",ZB,[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(["details-icon-large",k(l.value)])},[(0,a.createElementVNode)("span",eD,(0,a.toDisplayString)((o=i.value,"功法"===o?"功":"技")),1)],2),(0,a.createElementVNode)("div",nD,[(0,a.createElementVNode)("h3",{class:(0,a.normalizeClass)(k(l.value,"text"))},(0,a.toDisplayString)(l.value.名称),3),(0,a.createElementVNode)("div",tD,[(0,a.createElementVNode)("span",aD,(0,a.toDisplayString)(i.value),1),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["meta-tag quality-tag",k(l.value,"text")])},(0,a.toDisplayString)(l.value.品质?.quality||"凡")+"品 ",3),void 0!==l.value.品质?.grade?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)(["grade-display",N(l.value.品质.grade)])},(0,a.toDisplayString)(w(l.value.品质.grade))+"("+(0,a.toDisplayString)(l.value.品质.grade)+") ",3)):(0,a.createCommentVNode)("v-if",!0)])])]),(0,a.createElementVNode)("p",oD,(0,a.toDisplayString)(l.value.描述),1)],2),(0,a.createCommentVNode)(" 标签页导航 "),(0,a.createElementVNode)("div",rD,[(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["tab-btn",{active:"effects"===c.value}]),onClick:n[3]||(n[3]=e=>c.value="effects")},"功法效果",2),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["tab-btn",{active:"skills"===c.value}]),onClick:n[4]||(n[4]=e=>c.value="skills")},"功法技能",2)]),(0,a.createCommentVNode)(" 标签页内容 "),(0,a.createElementVNode)("div",lD,[(0,a.createCommentVNode)(" 功法效果 "),"effects"===c.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",iD,[l.value.功法效果?((0,a.openBlock)(),(0,a.createElementBlock)("div",cD,[(0,a.createElementVNode)("div",sD,[l.value.功法效果.修炼速度加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",dD,[n[22]||(n[22]=(0,a.createElementVNode)("span",{class:"effect-label"},"修炼速度",-1)),(0,a.createElementVNode)("span",mD,(0,a.toDisplayString)(V.value),1)])):(0,a.createCommentVNode)("v-if",!0),l.value.功法效果.属性加成?((0,a.openBlock)(),(0,a.createElementBlock)("div",pD,[n[23]||(n[23]=(0,a.createElementVNode)("span",{class:"effect-label"},"属性加成",-1)),(0,a.createElementVNode)("span",vD,(0,a.toDisplayString)((t=l.value.功法效果.属性加成,t&&"object"==typeof t&&Object.entries(t).map(([e,n])=>`${e}+${n}`).join("、")||"无")),1)])):(0,a.createCommentVNode)("v-if",!0),l.value.功法效果.特殊能力?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",uD,[n[24]||(n[24]=(0,a.createElementVNode)("span",{class:"effect-label"},"特殊能力",-1)),(0,a.createElementVNode)("div",gD,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.功法效果.特殊能力,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"ability-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",fD,"此功法无特殊效果"))])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 功法技能 "),"skills"===c.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",bD,[l.value.功法技能?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",hD,[(0,a.createElementVNode)("div",yD,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.功法技能,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"skill-item"},[(0,a.createElementVNode)("div",xD,[(0,a.createElementVNode)("span",kD,(0,a.toDisplayString)(e.技能名称),1),E.value.has(e.技能名称)?((0,a.openBlock)(),(0,a.createElementBlock)("div",wD,"已掌握")):((0,a.openBlock)(),(0,a.createElementBlock)("div",ND,"未掌握"))]),(0,a.createElementVNode)("div",ED,(0,a.toDisplayString)(e.技能描述),1),e.解锁需要熟练度?((0,a.openBlock)(),(0,a.createElementBlock)("div",VD," 解锁条件：修炼进度 "+(0,a.toDisplayString)(e.解锁需要熟练度)+"% ",1)):(0,a.createCommentVNode)("v-if",!0)]))),128))])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",CD,"此功法无附加技能"))])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 底部操作按钮 "),(0,a.createElementVNode)("div",zD,["功法"===i.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,class:"action-btn cultivate-btn",onClick:C},"深度修炼")):(0,a.createCommentVNode)("v-if",!0),"功法"===i.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:1,class:"action-btn unequip-btn",onClick:D},"卸下")):(0,a.createCommentVNode)("v-if",!0),"背包功法"===i.value?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:2,class:"action-btn equip-btn",onClick:A},"装备")):(0,a.createCommentVNode)("v-if",!0)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",SD,n[25]||(n[25]=[(0,a.createElementVNode)("div",{class:"placeholder-icon"},"📜",-1),(0,a.createElementVNode)("p",null,"选择一部功法",-1),(0,a.createElementVNode)("span",{class:"placeholder-tip"},"点击功法卡片查看详情",-1)])))],2),d.value&&s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"mobile-library-backdrop",onClick:n[5]||(n[5]=e=>s.value=!1)})):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 深度修炼对话框 "),(0,a.createVNode)(fS,{visible:p.value,technique:v.value,"current-progress":u(),onClose:z,onConfirm:S},null,8,["visible","technique","current-progress"])])],2112);var t,o}}});var DD=t(1417),AD={};AD.styleTagTransform=A(),AD.setAttributes=z(),AD.insert=V().bind(null,"head"),AD.domAPI=N(),AD.insertStyleElement=B(),k()(DD.A,AD),DD.A&&DD.A.locals&&DD.A.locals;const _D=(0,j.A)(BD,[["__scopeId","data-v-075e9794"]]),$D={class:"thousand-dao-content"},ID={class:"dao-main"},TD={key:0,class:"loading-placeholder"},jD={class:"dao-overview"},MD={class:"dao-stats"},qD={class:"stat-card"},OD={class:"stat-info"},PD={class:"stat-value"},FD={class:"stat-card"},LD={class:"stat-info"},YD={class:"stat-value"},RD={class:"stat-card"},UD={class:"stat-info"},GD={class:"stat-value"},WD={class:"dao-sections"},JD={class:"dao-section"},HD={class:"section-title"},QD={key:0,class:"empty-state"},KD={key:1,class:"dao-grid"},XD=["onClick"],ZD={class:"dao-card-header"},eA={class:"dao-name"},nA={class:"dao-stage"},tA={key:2,class:"dao-details-sidebar"},aA={class:"details-header"},oA={class:"details-content"},rA={key:0,class:"detail-section"},lA={class:"dao-description"},iA={class:"detail-section"},cA={class:"dao-stats-detail"},sA={class:"stat-row"},dA={class:"stat-highlight"},mA={class:"stat-row"},pA={class:"stat-highlight"},vA={key:0,class:"stat-row"},uA={class:"next-stage"},gA={key:1,class:"stat-row"},fA={class:"stat-highlight"},bA={key:1,class:"detail-section"},hA={class:"stages-list"},yA={class:"stage-marker"},xA={key:0},kA={key:1},wA={key:2},NA={class:"stage-details"},EA={class:"stage-name"},VA={class:"stage-desc"},CA={key:0,class:"stage-req"},zA={class:"details-actions"},SA=(0,a.defineComponent)({__name:"ThousandDaoPanel",setup(e){const{characterData:n}=(0,Li.useUnifiedCharacterData)(),t=(0,tn.useCharacterStore)(),o=(0,Sv.useActionQueueStore)(),r=(0,a.ref)(!1),l=(0,a.ref)(null),i=(0,a.computed)(()=>n.value?.三千大道||{大道列表:{}}),c=(0,a.computed)(()=>Object.entries(i.value.大道列表).filter(([e,n])=>n.是否解锁).map(([e,n])=>e)),s=(0,a.computed)(()=>c.value.length),d=(0,a.computed)(()=>l.value&&i.value.大道列表[l.value]||null),m=(0,a.computed)(()=>Object.values(i.value.大道列表).reduce((e,n)=>e+(n.总经验??0),0)),p=(0,a.computed)(()=>Object.values(i.value.大道列表).filter(e=>(e.当前阶段??0)>=5).length),v=e=>i.value.大道列表[e]||null,u=e=>{const n=v(e);if(!n)return"未门";const t=n.当前阶段??0;return n.阶段列表?.[t]?n.阶段列表[t].名称:0===t?"未门":`第${t}阶段`},g=e=>{const n=v(e);if(!n)return null;const t=(n.当前阶段??0)+1;return n.阶段列表?.[t]?.名称||null},f=e=>{const n=v(e);if(!n)return 100;const t=n.当前阶段??0;return n.阶段列表?.[t]?.突破经验?n.阶段列表[t].突破经验:100*(t+1)};return(0,a.onMounted)(async()=>{console.log("[三千大道面板] 组件挂载..."),Oi.on("refresh",()=>(async()=>{r.value=!0;try{await t.syncFromTavern()}catch(e){console.error("[三千大道面板] 刷新数据失败:",e)}finally{r.value=!1}})())}),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",$D,[(0,a.createCommentVNode)(" 主要内容 "),(0,a.createElementVNode)("div",ID,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",TD,n[2]||(n[2]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},null,-1),(0,a.createElementVNode)("p",null,"加载三千大道数据中...",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 大道概览 "),(0,a.createElementVNode)("div",jD,[(0,a.createCommentVNode)(" 三千大道页不再显示功法，当前修炼已移至修炼面板 "),(0,a.createElementVNode)("div",MD,[(0,a.createElementVNode)("div",qD,[n[4]||(n[4]=(0,a.createElementVNode)("div",{class:"stat-icon"},"🎯",-1)),(0,a.createElementVNode)("div",OD,[(0,a.createElementVNode)("div",PD,(0,a.toDisplayString)(s.value),1),n[3]||(n[3]=(0,a.createElementVNode)("div",{class:"stat-label"},"已解锁大道",-1))])]),(0,a.createElementVNode)("div",FD,[n[6]||(n[6]=(0,a.createElementVNode)("div",{class:"stat-icon"},"⚡",-1)),(0,a.createElementVNode)("div",LD,[(0,a.createElementVNode)("div",YD,(0,a.toDisplayString)(m.value),1),n[5]||(n[5]=(0,a.createElementVNode)("div",{class:"stat-label"},"总感悟经验",-1))])]),(0,a.createElementVNode)("div",RD,[n[8]||(n[8]=(0,a.createElementVNode)("div",{class:"stat-icon"},"🏆",-1)),(0,a.createElementVNode)("div",UD,[(0,a.createElementVNode)("div",GD,(0,a.toDisplayString)(p.value),1),n[7]||(n[7]=(0,a.createElementVNode)("div",{class:"stat-label"},"高阶段大道",-1))])])]),(0,a.createCommentVNode)(" 大道列表 "),(0,a.createElementVNode)("div",WD,[(0,a.createCommentVNode)(" 已解锁大道 "),(0,a.createElementVNode)("div",JD,[(0,a.createElementVNode)("h4",HD,[n[9]||(n[9]=(0,a.createElementVNode)("span",{class:"title-icon"},"✨",-1)),(0,a.createTextVNode)(" 已解锁大道 ("+(0,a.toDisplayString)(s.value)+") ",1)]),0===s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",QD,n[10]||(n[10]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"🌱",-1),(0,a.createElementVNode)("p",null,"尚未解锁任何大道",-1),(0,a.createElementVNode)("span",{class:"empty-tip"},"通过机缘、顿悟和修行来解锁新的大道",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",KD,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:(0,a.normalizeClass)(["dao-card",{selected:l.value===e}]),onClick:n=>(e=>{l.value=l.value===e?null:e})(e)},[(0,a.createElementVNode)("div",ZD,[(0,a.createElementVNode)("h5",eA,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)("div",nA,(0,a.toDisplayString)(u(e)),1)])],10,XD))),128))]))]),(0,a.createCommentVNode)(" 可解锁大道提示 "),n[11]||(n[11]=(0,a.createStaticVNode)('<div class="dao-section" data-v-3c90b3e6><h4 class="section-title" data-v-3c90b3e6><span class="title-icon" data-v-3c90b3e6>🔮</span> 大道感悟 </h4><div class="dao-discover-hint" data-v-3c90b3e6><div class="discover-card" data-v-3c90b3e6><div class="discover-icon" data-v-3c90b3e6>🌌</div><div class="discover-content" data-v-3c90b3e6><h5 data-v-3c90b3e6>无量大道，由心而生</h5><p data-v-3c90b3e6>大道三千，各有奥妙。通过机缘、顿悟、修行，可解锁更多大道路径。</p><ul class="discover-methods" data-v-3c90b3e6><li data-v-3c90b3e6>🧘 深度感悟现有功法</li><li data-v-3c90b3e6>💫 感悟天地自然规律</li><li data-v-3c90b3e6>🎁 获得特殊机缘造化</li><li data-v-3c90b3e6>📚 研习古籍典藏</li></ul></div></div></div></div>',1))])])],2112)),(0,a.createCommentVNode)(" 大道详情侧边栏 "),l.value&&d.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",tA,[(0,a.createElementVNode)("div",aA,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(l.value),1),(0,a.createElementVNode)("button",{class:"close-details",onClick:n[0]||(n[0]=e=>l.value=null)},[(0,a.createVNode)((0,a.unref)(Ne),{size:20})])]),(0,a.createElementVNode)("div",oA,[v(l.value)?((0,a.openBlock)(),(0,a.createElementBlock)("div",rA,[n[12]||(n[12]=(0,a.createElementVNode)("h4",null,"大道描述",-1)),(0,a.createElementVNode)("p",lA,(0,a.toDisplayString)(v(l.value)?.描述||"此道深奥，需要进一步感悟才能理解其精髓。"),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",iA,[n[17]||(n[17]=(0,a.createElementVNode)("h4",null,"感悟统计",-1)),(0,a.createElementVNode)("div",cA,[(0,a.createElementVNode)("div",sA,[n[13]||(n[13]=(0,a.createElementVNode)("span",null,"当前经验:",-1)),(0,a.createElementVNode)("span",dA,(0,a.toDisplayString)(d.value.当前经验??0),1)]),(0,a.createElementVNode)("div",mA,[n[14]||(n[14]=(0,a.createElementVNode)("span",null,"当前阶段:",-1)),(0,a.createElementVNode)("span",pA,(0,a.toDisplayString)(u(l.value)),1)]),g(l.value)?((0,a.openBlock)(),(0,a.createElementBlock)("div",vA,[n[15]||(n[15]=(0,a.createElementVNode)("span",null,"下一阶段:",-1)),(0,a.createElementVNode)("span",uA,(0,a.toDisplayString)(g(l.value)),1)])):(0,a.createCommentVNode)("v-if",!0),f(l.value)?((0,a.openBlock)(),(0,a.createElementBlock)("div",gA,[n[16]||(n[16]=(0,a.createElementVNode)("span",null,"突破所需:",-1)),(0,a.createElementVNode)("span",fA,(0,a.toDisplayString)(f(l.value)),1)])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 大道阶段列表 "),v(l.value)?.阶段列表?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",bA,[n[18]||(n[18]=(0,a.createElementVNode)("h4",null,"境界阶段",-1)),(0,a.createElementVNode)("div",hA,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(v(l.value)?.阶段列表,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:(0,a.normalizeClass)(["stage-item",{completed:n<(d.value?.当前阶段??0),current:n===(d.value?.当前阶段??0),locked:n>(d.value?.当前阶段??0)}])},[(0,a.createElementVNode)("div",yA,[n<(d.value?.当前阶段??0)?((0,a.openBlock)(),(0,a.createElementBlock)("span",xA,"✅")):n===(d.value?.当前阶段??0)?((0,a.openBlock)(),(0,a.createElementBlock)("span",kA,"🔥")):((0,a.openBlock)(),(0,a.createElementBlock)("span",wA,"🔒"))]),(0,a.createElementVNode)("div",NA,[(0,a.createElementVNode)("div",EA,(0,a.toDisplayString)(e.名称),1),(0,a.createElementVNode)("div",VA,(0,a.toDisplayString)(e.描述),1),(0,a.createCommentVNode)(' 只有未达到的阶段才显示"需要经验" '),n>(d.value?.当前阶段??0)?((0,a.openBlock)(),(0,a.createElementBlock)("div",CA," 突破所需: "+(0,a.toDisplayString)(e.突破经验),1)):(0,a.createCommentVNode)("v-if",!0)])],2))),128))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",zA,[(0,a.createElementVNode)("button",{class:"action-btn cultivate-dao",onClick:n[1]||(n[1]=e=>{return n=l.value,console.log("[三千大道面板] 开始感悟大道:",n),o.addAction({type:"comprehend",itemName:n,itemType:"大道",description:`深入感悟《${n}》，领悟其中奥义`}),void console.log("[三千大道面板] 已将感悟大道动作加入队列");var n})},[(0,a.createVNode)((0,a.unref)(Bi),{size:16}),n[19]||(n[19]=(0,a.createTextVNode)(" 深入感悟此道 ",-1))])])])):(0,a.createCommentVNode)("v-if",!0)])]))}});var BA=t(4244),DA={};DA.styleTagTransform=A(),DA.setAttributes=z(),DA.insert=V().bind(null,"head"),DA.domAPI=N(),DA.insertStyleElement=B(),k()(BA.A,DA),BA.A&&BA.A.locals&&BA.A.locals;const AA=(0,j.A)(SA,[["__scopeId","data-v-3c90b3e6"]]),_A={class:"settings-panel"},$A={class:"panel-header"},IA={class:"header-actions"},TA={class:"settings-container"},jA={class:"settings-section"},MA={class:"settings-list"},qA={class:"setting-item"},OA={class:"setting-control"},PA={class:"setting-item"},FA={class:"setting-control"},LA={class:"range-container"},YA={class:"range-value"},RA={class:"setting-item"},UA={class:"setting-control"},GA={class:"settings-section"},WA={class:"settings-list"},JA={class:"setting-item"},HA={class:"setting-control"},QA={class:"setting-switch"},KA={class:"setting-item"},XA={class:"setting-control"},ZA={class:"setting-switch"},e_={class:"settings-section"},n_={class:"settings-list"},t_={class:"setting-item"},a_={class:"setting-control"},o_={class:"setting-switch"},r_={key:0,class:"setting-item"},l_={class:"setting-control"},i_={class:"setting-switch"},c_={key:1,class:"setting-item"},s_={class:"setting-control"},d_={class:"setting-switch"},m_={class:"setting-item"},p_={class:"setting-control"},v_={class:"setting-switch"},u_={key:2,class:"setting-item"},g_={class:"setting-control"},f_={class:"settings-section"},b_={class:"settings-list"},h_={class:"setting-item"},y_={class:"setting-control"},x_={class:"setting-switch"},k_={key:0,class:"setting-item"},w_={class:"setting-control"},N_={class:"setting-switch"},E_={key:1,class:"setting-item"},V_={class:"setting-control"},C_={class:"setting-switch"},z_={class:"setting-item"},S_={class:"setting-control"},B_={class:"setting-item"},D_={class:"setting-control"},A_={class:"setting-item"},__={class:"setting-control"},$_=(0,a.defineComponent)({__name:"SettingsPanel",setup(e){const n=(0,a.reactive)({theme:"auto",uiScale:100,fontSize:"medium",fastAnimations:!1,showHints:!0,debugMode:!1,consoleDebug:!1,performanceMonitor:!1,enableQuestSystem:!0,questNotifications:!0,autoAcceptQuests:!1,enableNsfwMode:!0,nsfwGenderFilter:"all",enableSoundEffects:!0,backgroundMusic:!0,notificationSounds:!0,autoSyncTavern:!0,validateData:!0,backupBeforeSave:!0}),o=(0,a.ref)(!1),r=(0,a.ref)(!1);(0,a.watch)(n,()=>{r.value=!0},{deep:!0}),(0,a.watch)(()=>n.debugMode,e=>{bg.Yz.setMode(e),bg.Yz.log("设置面板","调试模式"+(e?"已启用":"已禁用"))});const l=()=>{r.value=!0},i=async()=>{if(!o.value){o.value=!0,bg.Yz.timeStart("保存设置");try{c(),localStorage.setItem("dad_game_settings",JSON.stringify(n)),bg.Yz.log("设置面板","设置已保存到localStorage",n);try{const{useCharacterStore:e}=await Promise.resolve().then(t.bind(t,948)),a=e(),{useUnifiedCharacterData:o}=await Promise.resolve().then(t.bind(t,9142)),{characterData:r}=o();r.value&&r.value.系统?(r.value.系统.nsfwMode=n.enableNsfwMode,r.value.系统.nsfwGenderFilter=n.nsfwGenderFilter,await a.syncToTavernAndSave({changedPaths:["系统.nsfwMode","系统.nsfwGenderFilter"]}),bg.Yz.log("设置面板","NSFW设置已同步到存档和酒馆")):bg.Yz.warn("设置面板","当前没有激活的存档，NSFW设置仅保存到localStorage")}catch(e){bg.Yz.error("设置面板","同步NSFW设置到存档失败（非致命）",e)}await s(),r.value=!1,d.o.success("设置已保存并应用")}catch(e){bg.Yz.error("设置面板","保存设置失败",e),d.o.error(`保存设置失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{o.value=!1,bg.Yz.timeEnd("保存设置")}}},c=()=>{bg.Yz.group("设置验证");try{(n.uiScale<50||n.uiScale>200)&&(n.uiScale=Math.max(50,Math.min(200,n.uiScale)),bg.Yz.warn("设置面板",`UI缩放值已修正为: ${n.uiScale}%`)),bg.Yz.log("设置面板","设置验证完成")}catch(e){throw bg.Yz.error("设置面板","设置验证失败",e),new Error("设置验证失败")}finally{bg.Yz.groupEnd()}},s=async()=>{bg.Yz.group("应用设置");try{m(),p(),v(),u(),bg.Yz.setMode(n.debugMode),bg.Yz.log("设置面板","所有设置已应用")}catch(e){throw bg.Yz.error("设置面板","应用设置时出错",e),e}finally{bg.Yz.groupEnd()}},m=()=>{let e=n.theme;"auto"===n.theme&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme",e),bg.Yz.log("设置面板",`主题已应用: ${e}`)},p=()=>{const e=n.uiScale/100;document.documentElement.style.setProperty("--ui-scale",e.toString()),bg.Yz.log("设置面板",`UI缩放已应用: ${n.uiScale}%`)},v=()=>{const e={small:"0.875rem",medium:"1rem",large:"1.125rem"}[n.fontSize]||"1rem";document.documentElement.style.setProperty("--base-font-size",e),bg.Yz.log("设置面板",`字体大小已应用: ${n.fontSize} (${e})`)},u=()=>{const e=n.fastAnimations?"0.5":"1";document.documentElement.style.setProperty("--animation-speed",e),bg.Yz.log("设置面板",`动画速度已应用: ${e}x`)},g=(0,q.useUIStore)(),f=()=>{g.showRetryDialog({title:"重置设置",message:"确定要重置所有设置为默认值吗？这将清除所有自定义配置。",confirmText:"确认重置",cancelText:"取消",onConfirm:()=>{bg.Yz.log("设置面板","开始重置设置"),Object.assign(n,{theme:"auto",uiScale:100,fontSize:"medium",fastAnimations:!1,showHints:!0,debugMode:!1,consoleDebug:!1,performanceMonitor:!1,enableQuestSystem:!0,questNotifications:!0,autoAcceptQuests:!1,enableNsfwMode:!0,nsfwGenderFilter:"all",enableSoundEffects:!0,backgroundMusic:!0,notificationSounds:!0,autoSyncTavern:!0,validateData:!0,backupBeforeSave:!0}),i(),d.o.info("设置已重置为默认值")},onCancel:()=>{}})},b=async()=>{g.showRetryDialog({title:"清理缓存",message:"确定要清理缓存吗？这将删除临时数据但不会影响存档。",confirmText:"确认清理",cancelText:"取消",onConfirm:async()=>{bg.Yz.log("设置面板","开始清理缓存");try{const e=[];for(let n=0;n<localStorage.length;n++){const t=localStorage.key(n);t&&(t.startsWith("dad_cache_")||t.startsWith("temp_")||t.startsWith("debug_")||t.includes("_temp"))&&e.push(t)}e.forEach(e=>localStorage.removeItem(e)),sessionStorage.clear(),bg.Yz.log("设置面板",`缓存清理完成，共清理 ${e.length} 项数据`),d.o.success(`已清理 ${e.length} 项缓存数据`)}catch(e){bg.Yz.error("设置面板","清理缓存失败",e),d.o.error("清理缓存失败")}},onCancel:()=>{}})},h=()=>{bg.Yz.log("设置面板","开始导出设置");try{const e={settings:n,exportInfo:{timestamp:(new Date).toISOString(),version:"1.0.0",userAgent:navigator.userAgent,gameVersion:"大道朝天 v1.0.0"}},t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(a);const r=(new Date).toISOString().split("T")[0];o.download=`大道朝天-设置备份-${r}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href),bg.Yz.log("设置面板","设置导出成功"),d.o.success("设置已导出")}catch(e){bg.Yz.error("设置面板","导出设置失败",e),d.o.error("导出设置失败")}},y=()=>{bg.Yz.log("设置面板","开始导入设置");const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files?.[0];if(t)try{const e=await t.text(),a=JSON.parse(e);if(!a.settings)throw new Error("无效的设置文件格式");{const e={...n,...a.settings};Object.assign(n,e),await i(),bg.Yz.log("设置面板","设置导入成功",a),d.o.success("设置导入成功并已应用")}}catch(e){bg.Yz.error("设置面板","导入设置失败",e),d.o.error("导入设置失败，请检查文件格式")}},e.click()};return(0,a.onMounted)(()=>{bg.Yz.log("设置面板","组件已加载"),(async()=>{bg.Yz.timeStart("加载设置");try{const e=localStorage.getItem("dad_game_settings");if(e){const t=JSON.parse(e);Object.assign(n,t),bg.Yz.log("设置面板","设置加载成功",t)}else bg.Yz.log("设置面板","使用默认设置");try{const{useUnifiedCharacterData:e}=await Promise.resolve().then(t.bind(t,9142)),{characterData:a}=e();if(a.value&&a.value.系统){const e=a.value.系统.nsfwMode,t=a.value.系统.nsfwGenderFilter;void 0!==e&&(n.enableNsfwMode=e,bg.Yz.log("设置面板",`已从存档读取nsfwMode: ${e}`)),void 0!==t&&(n.nsfwGenderFilter=t,bg.Yz.log("设置面板",`已从存档读取nsfwGenderFilter: ${t}`))}}catch{bg.Yz.log("设置面板","当前没有激活的存档，使用localStorage中的NSFW设置")}}catch(e){bg.Yz.error("设置面板","加载设置失败",e),d.o.error("加载设置失败，将使用默认设置")}finally{bg.Yz.timeEnd("加载设置")}})()}),(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",_A,[(0,a.createCommentVNode)(" 头部 "),(0,a.createElementVNode)("div",$A,[t[15]||(t[15]=(0,a.createStaticVNode)('<div class="header-left" data-v-1063ac62><div class="header-icon" data-v-1063ac62>⚙️</div><div class="header-info" data-v-1063ac62><h3 class="panel-title" data-v-1063ac62>游戏设置</h3><span class="settings-subtitle" data-v-1063ac62>自定义您的游戏体验</span></div></div>',1)),(0,a.createElementVNode)("div",IA,[(0,a.createElementVNode)("button",{class:"action-btn",onClick:f},[(0,a.createVNode)((0,a.unref)(Vv),{size:16}),t[13]||(t[13]=(0,a.createElementVNode)("span",{class:"btn-text"},"重置",-1))]),(0,a.createElementVNode)("button",{class:"action-btn primary",onClick:i},[(0,a.createVNode)((0,a.unref)(Ai),{size:16}),t[14]||(t[14]=(0,a.createElementVNode)("span",{class:"btn-text"},"保存",-1))])])]),(0,a.createCommentVNode)(" 设置内容 "),(0,a.createElementVNode)("div",TA,[(0,a.createCommentVNode)(" 显示设置 "),(0,a.createElementVNode)("div",jA,[t[21]||(t[21]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h4",{class:"section-title"},"🎨 显示设置")],-1)),(0,a.createElementVNode)("div",MA,[(0,a.createElementVNode)("div",qA,[t[17]||(t[17]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"主题模式"),(0,a.createElementVNode)("span",{class:"setting-desc"},"选择明亮或暗黑主题")],-1)),(0,a.createElementVNode)("div",OA,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.theme=e),class:"setting-select",onChange:l},t[16]||(t[16]=[(0,a.createElementVNode)("option",{value:"light"},"明亮",-1),(0,a.createElementVNode)("option",{value:"dark"},"暗黑",-1),(0,a.createElementVNode)("option",{value:"auto"},"跟随系统",-1)]),544),[[a.vModelSelect,n.theme]])])]),(0,a.createElementVNode)("div",PA,[t[18]||(t[18]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"界面缩放"),(0,a.createElementVNode)("span",{class:"setting-desc"},"调整UI界面大小")],-1)),(0,a.createElementVNode)("div",FA,[(0,a.createElementVNode)("div",LA,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>n.uiScale=e),min:"80",max:"120",step:"5",class:"setting-range",onInput:p},null,544),[[a.vModelText,n.uiScale,void 0,{number:!0}]]),(0,a.createElementVNode)("span",YA,(0,a.toDisplayString)(n.uiScale)+"%",1)])])]),(0,a.createElementVNode)("div",RA,[t[20]||(t[20]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"文字大小"),(0,a.createElementVNode)("span",{class:"setting-desc"},"调整游戏文字显示大小")],-1)),(0,a.createElementVNode)("div",UA,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.fontSize=e),class:"setting-select",onChange:v},t[19]||(t[19]=[(0,a.createElementVNode)("option",{value:"small"},"小",-1),(0,a.createElementVNode)("option",{value:"medium"},"中",-1),(0,a.createElementVNode)("option",{value:"large"},"大",-1)]),544),[[a.vModelSelect,n.fontSize]])])])])]),(0,a.createCommentVNode)(" 游戏设置 "),(0,a.createElementVNode)("div",GA,[t[26]||(t[26]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h4",{class:"section-title"},"🎮 游戏设置")],-1)),(0,a.createElementVNode)("div",WA,[(0,a.createElementVNode)("div",JA,[t[23]||(t[23]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"快速动画"),(0,a.createElementVNode)("span",{class:"setting-desc"},"加速界面动画和过渡效果")],-1)),(0,a.createElementVNode)("div",HA,[(0,a.createElementVNode)("label",QA,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>n.fastAnimations=e)},null,512),[[a.vModelCheckbox,n.fastAnimations]]),t[22]||(t[22]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])]),(0,a.createElementVNode)("div",KA,[t[25]||(t[25]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"显示提示"),(0,a.createElementVNode)("span",{class:"setting-desc"},"显示操作提示和帮助信息")],-1)),(0,a.createElementVNode)("div",XA,[(0,a.createElementVNode)("label",ZA,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>n.showHints=e)},null,512),[[a.vModelCheckbox,n.showHints]]),t[24]||(t[24]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])])])]),(0,a.createCommentVNode)(" 游戏功能 "),(0,a.createElementVNode)("div",e_,[t[37]||(t[37]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h4",{class:"section-title"},"🎮 游戏功能")],-1)),(0,a.createElementVNode)("div",n_,[(0,a.createElementVNode)("div",t_,[t[28]||(t[28]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"任务系统"),(0,a.createElementVNode)("span",{class:"setting-desc"},"启用任务追踪和完成系统")],-1)),(0,a.createElementVNode)("div",a_,[(0,a.createElementVNode)("label",o_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>n.enableQuestSystem=e)},null,512),[[a.vModelCheckbox,n.enableQuestSystem]]),t[27]||(t[27]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])]),n.enableQuestSystem?((0,a.openBlock)(),(0,a.createElementBlock)("div",r_,[t[30]||(t[30]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"任务提醒"),(0,a.createElementVNode)("span",{class:"setting-desc"},"新任务和完成时的通知提醒")],-1)),(0,a.createElementVNode)("div",l_,[(0,a.createElementVNode)("label",i_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>n.questNotifications=e)},null,512),[[a.vModelCheckbox,n.questNotifications]]),t[29]||(t[29]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])])):(0,a.createCommentVNode)("v-if",!0),n.enableQuestSystem?((0,a.openBlock)(),(0,a.createElementBlock)("div",c_,[t[32]||(t[32]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"自动接取任务"),(0,a.createElementVNode)("span",{class:"setting-desc"},"自动接取适合等级的任务")],-1)),(0,a.createElementVNode)("div",s_,[(0,a.createElementVNode)("label",d_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>n.autoAcceptQuests=e)},null,512),[[a.vModelCheckbox,n.autoAcceptQuests]]),t[31]||(t[31]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",m_,[t[34]||(t[34]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"🔞 启用成人内容（私密信息）"),(0,a.createElementVNode)("span",{class:"setting-desc"},"生成和显示NPC的私密信息模块（包含成人向内容，默认开启）")],-1)),(0,a.createElementVNode)("div",p_,[(0,a.createElementVNode)("label",v_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>n.enableNsfwMode=e)},null,512),[[a.vModelCheckbox,n.enableNsfwMode]]),t[33]||(t[33]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])]),n.enableNsfwMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",u_,[t[36]||(t[36]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"👥 私密信息生成范围"),(0,a.createElementVNode)("span",{class:"setting-desc"},"选择为哪些性别的NPC生成私密信息")],-1)),(0,a.createElementVNode)("div",g_,[(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.nsfwGenderFilter=e),class:"setting-select"},t[35]||(t[35]=[(0,a.createElementVNode)("option",{value:"all"},"所有NPC",-1),(0,a.createElementVNode)("option",{value:"female"},"仅女性",-1),(0,a.createElementVNode)("option",{value:"male"},"仅男性",-1)]),512),[[a.vModelSelect,n.nsfwGenderFilter]])])])):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createCommentVNode)(" 高级设置 "),(0,a.createElementVNode)("div",f_,[t[50]||(t[50]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h4",{class:"section-title"},"🔧 高级设置")],-1)),(0,a.createElementVNode)("div",b_,[(0,a.createElementVNode)("div",h_,[t[39]||(t[39]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"调试模式"),(0,a.createElementVNode)("span",{class:"setting-desc"},"启用开发者调试信息和详细日志")],-1)),(0,a.createElementVNode)("div",y_,[(0,a.createElementVNode)("label",x_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>n.debugMode=e),onChange:l},null,544),[[a.vModelCheckbox,n.debugMode]]),t[38]||(t[38]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])]),n.debugMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",k_,[t[41]||(t[41]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"控制台调试"),(0,a.createElementVNode)("span",{class:"setting-desc"},"在浏览器控制台显示详细调试信息")],-1)),(0,a.createElementVNode)("div",w_,[(0,a.createElementVNode)("label",N_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>n.consoleDebug=e),onChange:l},null,544),[[a.vModelCheckbox,n.consoleDebug]]),t[40]||(t[40]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])])):(0,a.createCommentVNode)("v-if",!0),n.debugMode?((0,a.openBlock)(),(0,a.createElementBlock)("div",E_,[t[43]||(t[43]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"性能监控"),(0,a.createElementVNode)("span",{class:"setting-desc"},"监控组件性能和加载时间")],-1)),(0,a.createElementVNode)("div",V_,[(0,a.createElementVNode)("label",C_,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>n.performanceMonitor=e),onChange:l},null,544),[[a.vModelCheckbox,n.performanceMonitor]]),t[42]||(t[42]=(0,a.createElementVNode)("span",{class:"switch-slider"},null,-1))])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",z_,[t[45]||(t[45]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"导入设置"),(0,a.createElementVNode)("span",{class:"setting-desc"},"从文件恢复设置配置")],-1)),(0,a.createElementVNode)("div",S_,[(0,a.createElementVNode)("button",{class:"utility-btn",onClick:y},[(0,a.createVNode)((0,a.unref)(fd),{size:16}),t[44]||(t[44]=(0,a.createTextVNode)(" 导入 ",-1))])])]),(0,a.createElementVNode)("div",B_,[t[47]||(t[47]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"清理缓存"),(0,a.createElementVNode)("span",{class:"setting-desc"},"清除游戏临时数据和缓存")],-1)),(0,a.createElementVNode)("div",D_,[(0,a.createElementVNode)("button",{class:"utility-btn",onClick:b},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:16}),t[46]||(t[46]=(0,a.createTextVNode)(" 清理 ",-1))])])]),(0,a.createElementVNode)("div",A_,[t[49]||(t[49]=(0,a.createElementVNode)("div",{class:"setting-info"},[(0,a.createElementVNode)("label",{class:"setting-name"},"导出设置"),(0,a.createElementVNode)("span",{class:"setting-desc"},"备份当前设置配置")],-1)),(0,a.createElementVNode)("div",__,[(0,a.createElementVNode)("button",{class:"utility-btn",onClick:h},[(0,a.createVNode)((0,a.unref)(gd),{size:16}),t[48]||(t[48]=(0,a.createTextVNode)(" 导出 ",-1))])])])])])])]))}});var I_=t(9262),T_={};T_.styleTagTransform=A(),T_.setAttributes=z(),T_.insert=V().bind(null,"head"),T_.domAPI=N(),T_.insertStyleElement=B(),k()(I_.A,T_),I_.A&&I_.A.locals&&I_.A.locals;const j_=(0,j.A)($_,[["__scopeId","data-v-1063ac62"]]),M_=(0,c.A)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),q_=(0,c.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),O_={class:"save-panel"},P_={class:"saves-container"},F_={key:0,class:"current-save-section"},L_={class:"section-header"},Y_={class:"section-title"},R_={class:"current-save-card"},U_={class:"save-preview"},G_={class:"preview-avatar"},W_={class:"preview-info"},J_={class:"character-name"},H_={class:"character-details"},Q_={class:"detail-item"},K_={class:"detail-item"},X_={key:0,class:"current-save-hint last"},Z_={class:"save-stats"},e$={class:"stat-item"},n$={class:"stat-value"},t$={class:"stat-item"},a$={class:"stat-value"},o$={class:"saves-section"},r$={class:"section-header"},l$={class:"header-actions"},i$=["disabled"],c$={class:"saves-count"},s$={key:0,class:"loading-state"},d$={key:1,class:"empty-state"},m$={key:2,class:"saves-list"},p$=["onClick"],v$={class:"card-header"},u$={class:"save-preview small"},g$={class:"preview-avatar small"},f$={class:"preview-info"},b$={class:"save-name"},h$={class:"character-name-small"},y$={class:"save-time"},x$={class:"card-actions"},k$=["onClick","disabled"],w$=["onClick","disabled"],N$=["onClick","disabled"],E$=["onClick","disabled","title"],V$={class:"card-content"},C$={class:"save-details"},z$={class:"detail-row"},S$={class:"detail-value"},B$={class:"detail-row"},D$={class:"detail-value"},A$={class:"detail-row"},_$={class:"detail-value"},$$={class:"operations-section"},I$={class:"operations-list"},T$=["disabled"],j$=["disabled"],M$=["disabled"],q$=(0,a.defineComponent)({__name:"SavePanel",setup(e){const n=(0,tn.useCharacterStore)(),{characterData:o,saveData:r}=(0,Li.useUnifiedCharacterData)(),l=(0,a.ref)(!1),i=(0,a.ref)(),c=(0,a.computed)(()=>n.saveSlots.filter(e=>null!==e&&null!==e.存档数据)),s=(0,a.computed)(()=>n.activeSaveSlot),m=(0,a.computed)(()=>null!==n.activeCharacterProfile),p=(0,a.computed)(()=>c.value.filter(e=>"上次对话"!==e.存档名).length),v=async()=>{l.value=!0;try{await n.loadSaves()}catch(e){bg.Yz.error("存档面板","刷新失败",e),d.o.error("刷新存档列表失败")}finally{l.value=!1}},u=async()=>{if(!m.value)return void d.o.warning("当前没有可存档的游戏状态");const e=window.prompt("请输入新存档的名称：",`存档_${(new Date).toLocaleString("zh-CN",{month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})}`);if(e&&""!==e.trim()){l.value=!0;try{await n.syncToTavernAndSave(),await n.saveAsNewSlot(e.trim())&&await v()}catch(e){bg.Yz.error("存档面板","新建存档失败",e),d.o.error("新建存档失败")}finally{l.value=!1}}else d.o.info("已取消新建存档")},g=(0,q.useUIStore)(),f=()=>{try{const e={saves:c.value,exportTime:(new Date).toISOString(),version:"1.0.0"},n=JSON.stringify(e,null,2),t=new Blob([n],{type:"application/json"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=`大道朝天-存档备份-${(new Date).toISOString().split("T")[0]}.json`,a.click(),d.o.success("存档已导出")}catch(e){bg.Yz.error("存档面板","导出失败",e),d.o.error("导出存档失败")}},b=()=>{i.value?.click()},h=async e=>{const t=e.target.files?.[0];if(t){l.value=!0;try{const e=await t.text(),a=JSON.parse(e);if(!a.saves||!Array.isArray(a.saves))throw new Error("无效的存档文件格式");for(const e of a.saves)await n.importSave(e);await v(),d.o.success(`成功导入 ${a.saves.length} 个存档`)}catch(e){bg.Yz.error("存档面板","导入失败",e),d.o.error("导入存档失败: "+e.message)}finally{l.value=!1,i.value&&(i.value.value="")}}},y=async()=>{g.showRetryDialog({title:"清空所有存档",message:"确定要删除所有存档吗？此操作不可撤销！",confirmText:"继续",cancelText:"取消",onConfirm:()=>{g.showRetryDialog({title:"再次确认",message:"再次确认：这将永久删除所有存档数据！",confirmText:"确认清空",cancelText:"取消",onConfirm:async()=>{l.value=!0;try{await n.clearAllSaves(),d.o.success("所有存档已清空")}catch(e){bg.Yz.error("存档面板","清空失败",e),d.o.error("清空存档失败")}finally{l.value=!1}},onCancel:()=>{}})},onCancel:()=>{}})},x=e=>{if(!e)return"未知";const n=new Date(e);if(isNaN(n.getTime()))return"未知";const t=(new Date).getTime()-n.getTime();return t<6e4?"刚刚":t<36e5?`${Math.floor(t/6e4)}分钟前`:t<864e5?`${Math.floor(t/36e5)}小时前`:n.toLocaleDateString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return(0,a.onMounted)(()=>{v(),Oi.on("refresh",()=>v()),Oi.on("save",()=>(async()=>{if(m.value){l.value=!0;try{await n.syncToTavernAndSave(),d.o.success("快速存档完成")}catch(e){bg.Yz.error("存档面板","快速存档失败",e),d.o.error("快速存档失败")}finally{l.value=!1}}else d.o.warning("当前没有可存档的游戏状态")})())}),(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",O_,[(0,a.createCommentVNode)(" 存档容器 "),(0,a.createElementVNode)("div",P_,[(0,a.createCommentVNode)(" 当前存档状态 "),s.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",F_,[(0,a.createElementVNode)("div",L_,[(0,a.createElementVNode)("h4",Y_,["上次对话"===s.value.存档名?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(M_),{key:0,size:16,class:"last-save-icon"})):(0,a.createCommentVNode)("v-if",!0),(0,a.createTextVNode)(" 📍 当前进度 - "+(0,a.toDisplayString)(s.value.存档名),1)])]),(0,a.createElementVNode)("div",R_,[(0,a.createElementVNode)("div",U_,[(0,a.createElementVNode)("div",G_,(0,a.toDisplayString)(s.value.角色名字?.[0]||"道"),1),(0,a.createElementVNode)("div",W_,[(0,a.createElementVNode)("div",J_,(0,a.toDisplayString)(s.value.角色名字||"无名道友"),1),(0,a.createElementVNode)("div",H_,[(0,a.createElementVNode)("span",Q_,(0,a.toDisplayString)(s.value.境界||"凡人"),1),o[0]||(o[0]=(0,a.createElementVNode)("span",{class:"detail-separator"},"·",-1)),(0,a.createElementVNode)("span",K_,(0,a.toDisplayString)(s.value.位置||"未知"),1)]),(0,a.createCommentVNode)(" 特殊存档说明 "),"上次对话"===s.value.存档名?((0,a.openBlock)(),(0,a.createElementBlock)("div",X_," 🔄 每次对话前自动备份，可用于回退到上次对话前的状态 ")):(0,a.createCommentVNode)("v-if",!0)])]),(0,a.createElementVNode)("div",Z_,[(0,a.createElementVNode)("div",e$,[o[1]||(o[1]=(0,a.createElementVNode)("span",{class:"stat-label"},"创建时间",-1)),(0,a.createElementVNode)("span",n$,(0,a.toDisplayString)(x(s.value.保存时间||"")),1)]),(0,a.createElementVNode)("div",t$,[o[2]||(o[2]=(0,a.createElementVNode)("span",{class:"stat-label"},"最后保存",-1)),(0,a.createElementVNode)("span",a$,(0,a.toDisplayString)(x(s.value.最后保存时间||s.value.保存时间||"")),1)])])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 存档列表 "),(0,a.createElementVNode)("div",o$,[(0,a.createElementVNode)("div",r$,[o[3]||(o[3]=(0,a.createElementVNode)("h4",{class:"section-title"},"💿 存档列表",-1)),(0,a.createElementVNode)("div",l$,[(0,a.createElementVNode)("button",{class:"new-save-btn",onClick:u,disabled:l.value,title:"新建存档"},[(0,a.createVNode)((0,a.unref)(Ce),{size:16})],8,i$),(0,a.createElementVNode)("div",c$,(0,a.toDisplayString)(c.value.length)+"/10",1)])]),l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",s$,o[4]||(o[4]=[(0,a.createElementVNode)("div",{class:"loading-spinner"},"⏳",-1),(0,a.createElementVNode)("div",{class:"loading-text"},"正在加载存档...",-1)]))):0===c.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",d$,o[5]||(o[5]=[(0,a.createElementVNode)("div",{class:"empty-icon"},"📂",-1),(0,a.createElementVNode)("div",{class:"empty-text"},"修仙路上尚未留存，创建存档记录道途",-1),(0,a.createElementVNode)("div",{class:"empty-hint"},"开始游戏后可以创建存档",-1)]))):((0,a.openBlock)(),(0,a.createElementBlock)("div",m$,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value,(e,r)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.id,class:(0,a.normalizeClass)(["save-card",{active:e.id===s.value?.id}]),onClick:n=>(e=>{bg.Yz.log("存档面板","选择存档",e)})(e)},[(0,a.createElementVNode)("div",v$,[(0,a.createElementVNode)("div",u$,[(0,a.createElementVNode)("div",g$,(0,a.toDisplayString)(e.角色名字?.[0]||"道"),1),(0,a.createElementVNode)("div",f$,[(0,a.createElementVNode)("div",b$,["上次对话"===e.存档名?((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(M_),{key:0,size:14,class:"last-save-icon"})):(0,a.createCommentVNode)("v-if",!0),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.存档名||`存档${r+1}`),1)]),(0,a.createElementVNode)("div",h$,(0,a.toDisplayString)(e.角色名字||"无名道友"),1),(0,a.createCommentVNode)(" 显示最后保存时间 "),(0,a.createElementVNode)("div",y$,(0,a.toDisplayString)(x(e.最后保存时间||e.保存时间||"")),1)])]),(0,a.createElementVNode)("div",x$,[e.id!==s.value?.id&&"上次对话"!==e.存档名?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:0,class:"card-btn",onClick:(0,a.withModifiers)(t=>(async e=>{if(e){l.value=!0;try{await n.loadGameById(e.存档名),d.o.success(`已加载存档: ${e.存档名}`)}catch(e){bg.Yz.error("存档面板","加载失败",e),d.o.error("加载存档失败")}finally{l.value=!1}}})(e),["stop"]),disabled:l.value,title:"读取存档"},[(0,a.createVNode)((0,a.unref)(q_),{size:14})],8,k$)):(0,a.createCommentVNode)("v-if",!0),"上次对话"===e.存档名?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:1,class:"card-btn warning",onClick:(0,a.withModifiers)(a=>(async e=>{if(!s.value)return void d.o.warning("没有当前激活的存档");const{useUIStore:a}=await Promise.resolve().then(t.bind(t,9173));a().showRetryDialog({title:"回滚到上次对话",message:`确定要将"${e.存档名}"的数据覆盖到当前存档"${s.value.存档名}"吗？当前进度将被替换为上次对话前的状态。`,confirmText:"确认回滚",cancelText:"取消",onConfirm:async()=>{l.value=!0;try{await n.rollbackToLastConversation(),d.o.success("已回滚到上次对话前的状态"),await v()}catch(e){bg.Yz.error("存档面板","回滚失败",e),d.o.error(`回滚失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{l.value=!1}},onCancel:()=>{}})})(e),["stop"]),disabled:l.value||!s.value,title:"用上次对话的数据覆盖当前存档（回滚）"},[(0,a.createVNode)((0,a.unref)(te),{size:14})],8,w$)):(0,a.createCommentVNode)("v-if",!0),"上次对话"!==e.存档名?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:2,class:"card-btn primary",onClick:(0,a.withModifiers)(t=>(async e=>{m.value?g.showRetryDialog({title:"覆盖存档",message:`确定要用当前游戏进度覆盖存档"${e.存档名}"吗？原存档数据将丢失。`,confirmText:"确认覆盖",cancelText:"取消",onConfirm:async()=>{l.value=!0;try{await n.syncToTavernAndSave(),await n.saveToSlot(e.存档名),d.o.success(`已覆盖存档: ${e.存档名}`),await v()}catch(e){bg.Yz.error("存档面板","覆盖存档失败",e),d.o.error("覆盖存档失败")}finally{l.value=!1}},onCancel:()=>{}}):d.o.warning("当前没有可存档的游戏状态")})(e),["stop"]),disabled:l.value||!s.value,title:"用当前进度覆盖此存档"},[(0,a.createVNode)((0,a.unref)(Ai),{size:14})],8,N$)):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("button",{class:"card-btn danger",onClick:(0,a.withModifiers)(t=>(async e=>{g.showRetryDialog({title:"删除存档",message:`确定要删除存档"${e.存档名||"存档"}"吗？此操作不可撤销。`,confirmText:"确认删除",cancelText:"取消",onConfirm:async()=>{l.value=!0;try{await n.deleteSaveById(e.存档名),d.o.success("存档已删除"),await v()}catch(e){bg.Yz.error("存档面板","删除失败",e),d.o.error("删除存档失败")}finally{l.value=!1}},onCancel:()=>{}})})(e),["stop"]),disabled:l.value||"上次对话"===e.存档名||p.value<=1,title:"上次对话"===e.存档名?"上次对话存档不可删除":p.value<=1?"最后一个存档，无法删除":"删除存档"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:14})],8,E$)])]),(0,a.createElementVNode)("div",V$,[(0,a.createElementVNode)("div",C$,[(0,a.createElementVNode)("div",z$,[o[6]||(o[6]=(0,a.createElementVNode)("span",{class:"detail-label"},"境界:",-1)),(0,a.createElementVNode)("span",S$,(0,a.toDisplayString)(e.境界||"凡人"),1)]),(0,a.createElementVNode)("div",B$,[o[7]||(o[7]=(0,a.createElementVNode)("span",{class:"detail-label"},"位置:",-1)),(0,a.createElementVNode)("span",D$,(0,a.toDisplayString)(e.位置||"未知"),1)]),(0,a.createElementVNode)("div",A$,[o[8]||(o[8]=(0,a.createElementVNode)("span",{class:"detail-label"},"修改:",-1)),(0,a.createElementVNode)("span",_$,(0,a.toDisplayString)(x(e.最后保存时间||e.保存时间||"")),1)])])])],10,p$))),128))]))]),(0,a.createCommentVNode)(" 存档操作 "),(0,a.createElementVNode)("div",$$,[o[12]||(o[12]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h4",{class:"section-title"},"🛠️ 存档操作")],-1)),(0,a.createElementVNode)("div",I$,[(0,a.createElementVNode)("button",{class:"operation-btn",onClick:f,disabled:l.value||0===c.value.length},[(0,a.createVNode)((0,a.unref)(gd),{size:16}),o[9]||(o[9]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-title"},"导出存档"),(0,a.createElementVNode)("span",{class:"btn-desc"},"备份所有存档到文件")],-1))],8,T$),(0,a.createElementVNode)("button",{class:"operation-btn",onClick:b,disabled:l.value},[(0,a.createVNode)((0,a.unref)(fd),{size:16}),o[10]||(o[10]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-title"},"导入存档"),(0,a.createElementVNode)("span",{class:"btn-desc"},"从文件恢复存档")],-1))],8,j$),(0,a.createElementVNode)("button",{class:"operation-btn danger",onClick:y,disabled:l.value||0===c.value.length},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:16}),o[11]||(o[11]=(0,a.createElementVNode)("div",{class:"btn-content"},[(0,a.createElementVNode)("span",{class:"btn-title"},"清空存档"),(0,a.createElementVNode)("span",{class:"btn-desc"},"删除所有存档数据")],-1))],8,M$)])])]),(0,a.createCommentVNode)(" 隐藏的文件输入 "),(0,a.createElementVNode)("input",{ref_key:"fileInput",ref:i,type:"file",accept:".json",onChange:h,style:{display:"none"}},null,544)]))}});var O$=t(3329),P$={};P$.styleTagTransform=A(),P$.setAttributes=z(),P$.insert=V().bind(null,"head"),P$.domAPI=N(),P$.insertStyleElement=B(),k()(O$.A,P$),O$.A&&O$.A.locals&&O$.A.locals;const F$=(0,j.A)(q$,[["__scopeId","data-v-60408b0c"]]),L$=(0,c.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Y$=(0,c.A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),R$=(0,c.A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),U$=(0,c.A)("skull",[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]]),G$={class:"map-panel"},W$={key:0,class:"world-info-header"},J$={class:"world-name"},H$={class:"world-background"},Q$={class:"map-controls-left"},K$={class:"map-status-mini"},X$=["viewBox"],Z$=["transform"],eI={class:"continent-layer"},nI=["points","onClick"],tI=["x","y"],aI={class:"territory-bounds-layer"},oI=["points","fill","stroke","onClick","onMouseenter"],rI=["x","y","fill"],lI={class:"location-markers-layer"},iI=["transform","onClick","onMouseenter"],cI={class:"location-icon-group"},sI={key:0},dI=["x","y","width","height"],mI=["x","y","width","height"],pI=["x","y","width","height"],vI=["x","y","width","height"],uI=["x","y","width","height"],gI=["x","y","width","height"],fI=["x","y","width","height"],bI=["r","fill"],hI=["fill"],yI={key:0,class:"player-position-layer"},xI=["transform"],kI=["x","y"],wI={class:"selected-info"},NI={class:"info-header"},EI={class:"info-content"},VI={class:"info-type"},CI={class:"info-desc"},zI={key:0,class:"info-detail"},SI={key:1,class:"info-detail"},BI={key:2,class:"info-detail"},DI={key:3,class:"info-detail"},AI={class:"map-legend"},_I={class:"legend-title"},$I={class:"legend-items"},II={class:"legend-item"},TI={class:"legend-icon"},jI={class:"legend-item"},MI={class:"legend-icon"},qI={class:"legend-item"},OI={class:"legend-icon"},PI={class:"legend-item"},FI={class:"legend-icon"},LI={class:"legend-item"},YI={class:"legend-icon"},RI={class:"legend-item"},UI={class:"legend-icon"},GI={class:"legend-item"},WI={class:"legend-icon"},JI=(0,a.defineComponent)({__name:"WorldMapPanel",setup(e){const{characterData:n}=(0,Li.useUnifiedCharacterData)(),t=(0,a.ref)(3600),o=(0,a.ref)(2400),r=(0,a.ref)(null),l=(0,a.ref)(.8),i=(0,a.ref)(0),c=(0,a.ref)(0),s=(0,a.ref)(!1),m=(0,a.ref)({x:0,y:0}),p=(0,a.ref)(0),v=(0,a.ref)([]),u=(0,a.ref)(0),g=(0,a.ref)(null),f=(0,a.ref)(null),b=(0,a.ref)("正在加载修仙世界..."),h=(0,a.ref)(""),y=(0,a.ref)([]),x=(0,a.ref)([]),k=(0,a.computed)(()=>{const e=n.value?.世界信息;return e?.世界名称||"修仙界"}),w=(0,a.computed)(()=>{const e=n.value?.世界信息;return e?.世界背景||""}),N=(0,a.ref)({}),E=(0,a.computed)(()=>{const e=N.value?.player_location_marker;if(e&&e.coordinates){console.log("[玩家定位] 从位置标点获取坐标:",e.coordinates);const n=e.coordinates;if(void 0!==n.longitude&&void 0!==n.latitude){const e=Y(n.longitude,n.latitude);return console.log("[玩家定位] 标点转换结果:",e),e}if(void 0!==n.x&&void 0!==n.y)return{x:n.x,y:n.y}}const t=n.value?.位置;if(t&&void 0!==t.x&&void 0!==t.y)return console.log("[玩家定位] 从位置分片获取坐标:",{x:t.x,y:t.y}),{x:t.x,y:t.y};if(t&&"object"==typeof t){const e=t;if(void 0!==e.X&&void 0!==e.Y)return{x:e.X,y:e.Y};if(e.坐标){const n=e.坐标;if(void 0!==n.x&&void 0!==n.y)return{x:n.x,y:n.y};if(void 0!==n.X&&void 0!==n.Y)return{x:n.X,y:n.Y}}else if(void 0!==e.longitude&&void 0!==e.latitude){const n=Y(e.longitude,e.latitude);return console.log("[玩家定位] 转换结果:",n),n}}return console.warn("[玩家定位] 无法解析坐标"),null});let V=0;const C=(e,n="info")=>{setTimeout(()=>{d.o[n](e)},200*V),V++,V>5&&(V=0)},z=e=>{e.preventDefault();const n=e.deltaY>0?-.1:.1;l.value=Math.max(.1,Math.min(4,l.value+n))},S=e=>{s.value=!0,m.value={x:e.clientX,y:e.clientY},p.value=0,g.value&&(g.value=null)},B=e=>{if(!s.value)return;const n=e.clientX-m.value.x,a=e.clientY-m.value.y;p.value+=Math.abs(n)+Math.abs(a);const r=i.value+n,d=c.value+a,v=f.value?.getBoundingClientRect();if(v){const e=t.value*l.value,n=o.value*l.value,a=Math.min(0,v.width-e),s=Math.max(0,v.width-e),m=Math.min(0,v.height-n),p=Math.max(0,v.height-n);i.value=Math.max(a,Math.min(s,r)),c.value=Math.max(m,Math.min(p,d))}else i.value=r,c.value=d;m.value={x:e.clientX,y:e.clientY}},D=()=>{s.value=!1},A=e=>{if(e.preventDefault(),v.value=Array.from(e.touches).map(e=>({identifier:e.identifier,x:e.clientX,y:e.clientY})),1===v.value.length)s.value=!0,m.value={x:v.value[0].x,y:v.value[0].y},p.value=0,g.value&&(g.value=null);else if(2===v.value.length){s.value=!1;const e=v.value[0].x-v.value[1].x,n=v.value[0].y-v.value[1].y;u.value=Math.sqrt(e*e+n*n)}},_=e=>{if(e.preventDefault(),0===e.touches.length)return;const n=Array.from(e.touches).map(e=>({identifier:e.identifier,x:e.clientX,y:e.clientY}));if(1===n.length&&s.value){const e=n[0].x-m.value.x,a=n[0].y-m.value.y;p.value+=Math.abs(e)+Math.abs(a);const r=i.value+e,s=c.value+a,d=f.value?.getBoundingClientRect();if(d){const e=t.value*l.value,n=o.value*l.value,a=Math.min(0,d.width-e),m=Math.max(0,d.width-e),p=Math.min(0,d.height-n),v=Math.max(0,d.height-n);i.value=Math.max(a,Math.min(m,r)),c.value=Math.max(p,Math.min(v,s))}else i.value=r,c.value=s;m.value={x:n[0].x,y:n[0].y}}else if(2===n.length){const e=n[0].x-n[1].x,t=n[0].y-n[1].y,a=Math.sqrt(e*e+t*t);if(u.value>0){const e=a/u.value,n=l.value*e;l.value=Math.max(.1,Math.min(4,n))}u.value=a}v.value=n},$=e=>{e.preventDefault(),0===e.touches.length?(s.value=!1,u.value=0,v.value=[]):(v.value=Array.from(e.touches).map(e=>({identifier:e.identifier,x:e.clientX,y:e.clientY})),1===v.value.length&&(s.value=!0,m.value={x:v.value[0].x,y:v.value[0].y},p.value=0,u.value=0))},I=()=>{f.value&&(document.fullscreenElement?document.exitFullscreen():f.value.requestFullscreen())},T=(0,a.ref)(null),j=e=>{T.value=e.id},M=()=>{T.value=null},q=e=>{if(s.value||p.value>5)return;console.log("[坤舆图志] 选中地点:",e.name),console.log("[坤舆图志] 是否全屏模式:",!!document.fullscreenElement);const n=O(e.coordinates?.x||0,e.coordinates?.y||0);console.log("[坤舆图志] 地点屏幕位置:",n),g.value={id:e.id,name:e.name,type:e.type,description:e.description,danger_level:e.danger_level,suitable_for:e.suitable_for,screenPosition:n},console.log("[坤舆图志] 弹窗数据已设置，selectedInfo存在:",!!g.value)},O=(e,n)=>{if(!f.value)return{x:0,y:0};const a=f.value.getBoundingClientRect(),r=e*l.value+i.value,s=n*l.value+c.value;let d,m,p=0,v=0;return document.fullscreenElement?(d=window.innerWidth,m=window.innerHeight,p=0,v=0):(d=a.width,m=a.height,p=a.left,v=a.top),{x:r/t.value*d+p,y:s/o.value*m+v}},P=e=>{if(!e||0===e.length)return{x:0,y:0};const n=e.reduce((e,n)=>e+n.x,0),t=e.reduce((e,n)=>e+n.y,0);return{x:n/e.length,y:t/e.length}},F=e=>{if(!e||0===e.length)return{x:0,y:0};const n=e.reduce((e,n)=>e+n.longitude,0),t=e.reduce((e,n)=>e+n.latitude,0),a=n/e.length,o=t/e.length;return Y(a,o)},L=()=>{if(!g.value?.screenPosition)return{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",zIndex:"9999"};const{x:e,y:n}=g.value.screenPosition,t=!!document.fullscreenElement;let a,o;t?(a=window.innerWidth,o=window.innerHeight):(a=f.value?.clientWidth||800,o=f.value?.clientHeight||600);let r=e-175,l=n-200-30;return r<10&&(r=10),r+350>a-10&&(r=a-350-10),l<10&&(l=n+30),l+200>o-10&&(l=o-200-10),console.log(`[弹窗定位] 模式: ${t?"全屏":"普通"}, 原始坐标: (${e}, ${n}), 弹窗位置: (${r}, ${l})`),{position:t?"fixed":"absolute",left:`${r}px`,top:`${l}px`,transform:"none",zIndex:t?"99999":"1001"}},Y=(e,n)=>{let a=100,l=130,i=25,c=45;r.value&&(a=r.value.minLng,l=r.value.maxLng,i=r.value.minLat,c=r.value.maxLat);const s=Math.max(a,Math.min(l,e)),d=Math.max(i,Math.min(c,n));return(Math.abs(s-e)>.1||Math.abs(d-n)>.1)&&console.warn(`[地图边界] 坐标超出世界范围被裁剪: (${e.toFixed(2)}, ${n.toFixed(2)}) -> (${s.toFixed(2)}, ${d.toFixed(2)})`),{x:(s-a)/(l-a)*(.85*t.value)+.075*t.value,y:(c-d)/(c-i)*(.85*o.value)+.075*o.value}},R=e=>({natural_landmark:"natural_landmark",sect_power:"sect_power",city_town:"city_town",blessed_land:"blessed_land",treasure_land:"treasure_land",dangerous_area:"dangerous_area",special_other:"special_other",名山大川:"natural_landmark",宗门势力:"sect_power",城镇坊市:"city_town",洞天福地:"blessed_land",奇珍异地:"treasure_land",凶险之地:"dangerous_area",其他特殊:"special_other",门派宗门:"sect_power",城镇:"city_town",危险秘境:"blessed_land",自然地貌:"natural_landmark",修炼圣地:"blessed_land",古战场遗迹:"dangerous_area",天材地宝产地:"treasure_land",灵兽栖息地:"dangerous_area",传承洞府:"blessed_land",跨界传送阵:"special_other",魔域入口:"dangerous_area",仙人遗府:"blessed_land",major_city:"city_town",sect_headquarters:"sect_power",secret_realm:"blessed_land",cultivation_site:"blessed_land",mountain:"natural_landmark",village:"city_town",battlefield_ruins:"dangerous_area",treasure_source:"treasure_land",spirit_beast_habitat:"dangerous_area",inheritance_cave:"blessed_land",teleportation_array:"special_other",demon_realm_gate:"dangerous_area",immortal_mansion:"blessed_land"}[e]||"special_other"),U=e=>"门派宗门"===e?"large":"城镇"===e||"危险秘境"===e?"medium":"small",G=e=>({natural_landmark:"#2D7D32",sect_power:"#1565C0",city_town:"#F57C00",blessed_land:"#7B1FA2",treasure_land:"#388E3C",dangerous_area:"#D32F2F",special_other:"#6B7280",sect_headquarters:"#1565C0",major_city:"#F57C00",secret_realm:"#7B1FA2",mountain:"#2D7D32",cultivation_site:"#7B1FA2",village:"#F57C00",battlefield_ruins:"#D32F2F",treasure_source:"#388E3C",spirit_beast_habitat:"#D32F2F",inheritance_cave:"#7B1FA2",teleportation_array:"#6B7280",demon_realm_gate:"#D32F2F",immortal_mansion:"#7B1FA2"}[e]||"#6B7280"),W=async()=>{try{console.log("[坤舆图志] 开始加载酒馆世界数据..."),y.value=[],x.value=[],await J(),await H(),await Q(),0===y.value.length?(C("未找到有效的地点数据，将显示测试数据","warning"),(()=>{console.log("[坤舆图志] 添加测试数据");const e=[{id:"test_1",name:"西北山脉",type:"natural_landmark",coordinates:Y(102,48),description:"测试地点1 - 西北角",x:0,y:0,size:8,color:"#2D7D32",iconColor:"#2D7D32",iconSize:"medium",isTerritory:!1},{id:"test_2",name:"东北城市",type:"city_town",coordinates:Y(107,47),description:"测试地点2 - 东北角",x:0,y:0,size:10,color:"#F57C00",iconColor:"#F57C00",iconSize:"medium",isTerritory:!1},{id:"test_3",name:"西南宗门",type:"sect_power",coordinates:Y(103,42),description:"测试地点3 - 西南角",x:0,y:0,size:12,color:"#1565C0",iconColor:"#1565C0",iconSize:"large",isTerritory:!1},{id:"test_4",name:"东南秘境",type:"blessed_land",coordinates:Y(106,41),description:"测试地点4 - 东南角",x:0,y:0,size:8,color:"#7B1FA2",iconColor:"#7B1FA2",iconSize:"medium",isTerritory:!1},{id:"test_5",name:"中央之地",type:"special_other",coordinates:Y(104.5,44.5),description:"测试地点5 - 中心位置",x:0,y:0,size:15,color:"#6B7280",iconColor:"#6B7280",iconSize:"large",isTerritory:!1}];e.forEach(e=>{e.x=e.coordinates?.x||0,e.y=e.coordinates?.y||0,console.log(`[测试数据] ${e.name}: 地理坐标未知 -> 虚拟坐标(${e.x.toFixed(1)}, ${e.y.toFixed(1)})`)}),y.value=e,console.log("[坤舆图志] ✅ 测试数据加载完成，共",y.value.length,"个地点")})()):(b.value=`已加载 ${y.value.length} 个地点`,console.log("[坤舆图志] 加载完成的数据统计:",{大陆数量:x.value.length,地点数量:y.value.length,前5个大陆:x.value.slice(0,5).map(e=>({名称:e.名称||e.name,边界点数:(e.大洲边界||e.continent_bounds)?.length||0})),前5个地点:y.value.slice(0,5).map(e=>({名称:e.name,类型:e.type,坐标:e.coordinates}))}))}catch(e){console.error("[坤舆图志] 加载修仙世界数据失败:",e),b.value="数据加载失败",C("加载世界数据失败: "+e.message,"error")}},J=async()=>{try{console.log("🏔️ [大陆加载] 开始加载大陆数据");const e=n.value?.世界信息,t=e?.大陆信息||[];if(console.log("🏔️ [大陆加载] 从世界信息读取到大陆数量:",t.length),console.log("🏔️ [大陆加载] 世界信息结构:",e),0===t.length)return void console.warn("🏔️ [大陆加载] 没有找到大陆数据");console.log("🏔️ [大陆加载] 最终大陆数据:",t),Array.isArray(t)&&t.forEach((e,n)=>{try{const t=e,a=t.名称||t.name||`大陆${n+1}`;console.log(`[坤舆图志] ✅ 已加载大洲: ${a}`),x.value.push(t)}catch(e){console.error(`[坤舆图志] 处理大洲${n+1}时出错:`,e)}})}catch(e){console.error("[坤舆图志] 加载大洲数据失败:",e)}},H=async()=>{try{console.log("⚔️ [势力加载] 开始加载势力数据");const e=n.value?.世界信息,t=e?.势力信息||[];if(console.log("⚔️ [势力加载] 从世界信息读取到势力数量:",t.length),0===t.length)return void console.warn("⚔️ [势力加载] 没有找到势力数据");console.log("⚔️ [势力加载] 最终势力数据:",t),Array.isArray(t)&&t.forEach((e,n)=>{try{const t=e;let a=[];const o=t.势力范围||t.territory_bounds||t.territoryBounds;if(o&&Array.isArray(o)&&o.length>=3){const e=[];o.forEach(n=>{const t=Number(n?.longitude),a=Number(n?.latitude);if(Number.isFinite(t)&&Number.isFinite(a)){const n=Y(t,a);e.push({x:n.x,y:n.y})}}),e.length>=3&&(a=e)}let r;const l=t.位置||t.headquarters||t.总部位置;if(l&&"object"==typeof l&&"longitude"in l&&"latitude"in l){const e=l;r=Y(e.longitude,e.latitude)}else if("string"==typeof l){const e=l.match(/(-?\d+\.?\d*)\D+(-?\d+\.?\d*)/);if(e){const n=parseFloat(e[1]),t=parseFloat(e[2]),a=isFinite(n)?Math.min(114,Math.max(107,n)):110,o=isFinite(t)?Math.min(38,Math.max(33,t)):35;r=Y(a,o)}}if(!r){const e=Y(110,36);r={x:e.x,y:e.y}}if((!a||a.length<3)&&r){const e=r.x,n=r.y;a=[{x:e-60,y:n-40},{x:e+70,y:n-20},{x:e+50,y:n+60},{x:e-50,y:n+40}]}const i=t.名称||t.name||`势力${n+1}`,c=t.类型||t.type||"中立宗门",s={id:t.id||`faction_${n}`,name:i,type:c,coordinates:r||P(a),description:t.描述||t.description||"",x:r?.x||P(a).x,y:r?.y||P(a).y,size:15,color:t.color||G(c),iconColor:t.color||G(c),iconSize:"large",isTerritory:!0,territoryBounds:a,headquarters:r};y.value.push(s),console.log(`[坤舆图志] ✅ 已加载势力: ${s.name} (${s.type})`)}catch(e){console.error(`[坤舆图志] 处理势力${n+1}时出错:`,e)}})}catch(e){console.error("[坤舆图志] 加载势力数据失败:",e)}},Q=async()=>{try{console.log("🏯 [地点加载] 开始加载地点数据");const e=n.value?.世界信息,t=e?.地点信息||[];if(console.log("🏯 [地点加载] 从世界信息读取到地点数量:",t.length),0===t.length)return void console.warn("🏯 [地点加载] 没有找到地点数据");console.log("🏯 [地点加载] 最终地点数据:",t),Array.isArray(t)&&(t.forEach((e,n)=>{try{const a=e;let o;if(a.coordinates&&"object"==typeof a.coordinates&&"longitude"in a.coordinates){const e=a.coordinates;o=Y(Number(e.longitude),Number(e.latitude)),console.log(`🏯 [地点加载] 使用coordinates字段加载地点: ${a.名称||a.name}`,a.coordinates)}else if(a.位置&&"object"==typeof a.位置&&"longitude"in a.位置){const e=a.位置;o=Y(Number(e.longitude),Number(e.latitude)),console.log(`🏯 [地点加载] 使用位置字段加载地点: ${a.名称||a.name}`,a.位置)}else{const e=107+7*Math.random(),n=33+5*Math.random();o=Y(e,n),console.warn(`🏯 [地点加载] 地点坐标缺失，使用经纬度回退: ${a.名称||a.name}`,{longitude:e,latitude:n})}const r=a.名称||a.name||`地点${n+1}`,l=a.类型||a.type||"其他",i={id:a.id||`location_${n}`,name:r,type:R(l),coordinates:o,description:a.描述||a.description||"",x:o.x,y:o.y,size:(t=l,{门派宗门:10,城镇:8,危险秘境:6,自然地貌:4,修炼圣地:5}[t]||4),color:G(R(l)),iconColor:G(R(l)),iconSize:U(l),danger_level:a.安全等级||a.danger_level||"较安全",suitable_for:Array.isArray(a.适合境界)?a.适合境界.join(", "):Array.isArray(a.suitable_for)?a.suitable_for.join(", "):a.适合境界||a.suitable_for||"",isTerritory:!1};y.value.push(i),console.log(`[坤舆图志] ✅ 已加载地点: ${i.name} (${i.type})`)}catch(e){console.error(`[坤舆图志] 处理地点${n+1}时出错:`,e)}var t}),y.value=y.value.filter(e=>{const n=e,t=Boolean(n?.importance)||Boolean(n?.重要)||Boolean(n?.is_key)||Boolean(n?.isKey);return!!e.isTerritory||!!t||Boolean(e.name&&e.name.length>2)})),e&&e.地点信息?(console.log(`[坤舆图志] ✅ 从世界信息找到 ${e.地点信息.length} 个地点信息`),console.log("[坤舆图志] 地点数据详情:",e.地点信息)):console.warn("[坤舆图志] 未找到有效的地点数据")}catch(e){console.error("[坤舆图志] 加载地点数据失败:",e)}},K=async()=>{try{const e=(0,an.getTavernHelper)();if(!e)return void C("酒馆系统不可用","error");console.log("[调试] ===== 测试坐标转换 ====="),[{lng:102,lat:27.5,desc:"西南角"},{lng:109,lat:33,desc:"东北角"},{lng:104,lat:30,desc:"中心点"},{lng:105.5,lat:31.5,desc:"偏东北"}].forEach(e=>{const n=Y(e.lng,e.lat);console.log(`[调试] ${e.desc} (${e.lng}, ${e.lat}) -> (${n.x.toFixed(1)}, ${n.y.toFixed(1)})`)}),console.log("[调试] ===== 开始详细调试 =====");const t=await e.getVariables({type:"chat"}),a=await e.getVariables({type:"global"});console.log("[调试] Chat变量键值:",Object.keys(t)),console.log("[调试] Global变量键值:",Object.keys(a));const o=n.value?.世界信息;o?(console.log("[调试] ===== 找到世界数据结构 ====="),console.log("[调试] 世界信息:",o),o.大陆信息&&console.log("[调试] 大陆信息数量:",o.大陆信息.length),o.势力信息&&console.log("[调试] 势力信息数量:",o.势力信息.length),o.地点信息&&console.log("[调试] 地点信息数量:",o.地点信息.length)):console.log("[调试] ===== 未找到世界数据结构 ====="),t.world_factions&&(console.log("[调试] ===== 找到旧格式势力数据 ====="),console.log("[调试] world_factions:",t.world_factions)),t.world_locations&&(console.log("[调试] ===== 找到旧格式地点数据 ====="),console.log("[调试] world_locations:",t.world_locations)),t.world_continents&&(console.log("[调试] ===== 找到旧格式大陆数据 ====="),console.log("[调试] world_continents:",t.world_continents)),console.log("[调试] ===== Chat变量详细内容 ====="),Object.entries(t).forEach(([e,n])=>{if(console.log(`[调试] "${e}":`,typeof n,n),n&&"object"==typeof n){const t=Object.keys(n);console.log(`[调试] "${e}" 的属性:`,t),t.includes("world")&&console.log(`[调试] "${e}.world":`,n.world),t.includes("mapData")&&console.log(`[调试] "${e}.mapData":`,n.mapData)}}),await W(),console.log("[调试] ===== 当前加载的地点坐标 ====="),y.value.forEach((e,n)=>{console.log(`[调试] ${n+1}. ${e.name}:`),console.log(`  - 原始坐标: ${JSON.stringify(e.coordinates)}`),console.log(`  - 显示坐标: (${e.x}, ${e.y})`),console.log(`  - 类型: ${e.type}, 是否势力: ${e.isTerritory}`)}),console.log("[调试] ===== 坐标范围统计 =====");const r=y.value.map(e=>e.x),l=y.value.map(e=>e.y);console.log(`[调试] X坐标范围: ${Math.min(...r).toFixed(1)} - ${Math.max(...r).toFixed(1)}`),console.log(`[调试] Y坐标范围: ${Math.min(...l).toFixed(1)} - ${Math.max(...l).toFixed(1)}`);const i=new Set(r.map(e=>e.toFixed(1))),c=new Set(l.map(e=>e.toFixed(1)));console.log(`[调试] 不同X坐标数量: ${i.size}/${r.length}`),console.log(`[调试] 不同Y坐标数量: ${c.size}/${l.length}`),1===i.size&&1===c.size?(console.error("[调试] ❌ 发现问题：所有地点都在同一个坐标！"),console.log("[调试] 可能的原因："),console.log("[调试] 1. AI生成的坐标超出了geoToVirtual函数的处理范围"),console.log("[调试] 2. 坐标转换函数有bug"),console.log("[调试] 3. 数据解析有问题")):console.log(`[调试] ✅ 坐标分布正常，有${i.size}个不同X坐标，${c.size}个不同Y坐标`)}catch(e){console.error("[调试] 调试过程出错:",e),C("调试失败: "+e.message,"error")}},X=()=>{E.value?(i.value=t.value/2-E.value.x*l.value,c.value=o.value/2-E.value.y*l.value,l.value=.9,C("已定位到当前位置","success")):C("无法定位玩家位置","warning")},Z=e=>{const n={natural_landmark:{size:20,offset:10},sect_power:{size:18,offset:9},city_town:{size:18,offset:9},blessed_land:{size:16,offset:8},treasure_land:{size:16,offset:8},dangerous_area:{size:16,offset:8},special_other:{size:14,offset:7},default:{size:16,offset:8}};return n[e]||n.default};return(0,a.onMounted)(async()=>{await(async()=>{try{b.value="正在从天机阁加载世界数据...";const e=(0,an.getTavernHelper)();if(!e)return console.warn("[坤舆图志] 酒馆Helper不可用"),void(b.value="酒馆系统不可用，请重新生成世界后再打开地图");const a=await e.getVariables({type:"chat"}),l=await e.getVariables({type:"global"});N.value=a&&l?{...a,...l}:{},h.value=l["character.name"]||"道友",await(async()=>{try{console.log("[地图配置] 开始加载地图配置...");const e=n.value?.世界信息,a=e?.地图配置;a?(console.log("[地图配置] 找到地图配置:",a),r.value=a,a.width&&a.height&&(t.value=a.width,o.value=a.height,console.log(`[地图配置] 地图尺寸已更新: ${a.width}x${a.height}`))):(console.log("[地图配置] 未找到地图配置，使用默认值"),r.value=null)}catch(e){console.error("[地图配置] 加载地图配置失败:",e),r.value=null}})(),await W(),0===y.value.length&&(console.warn("[坤舆图志] 未找到世界数据"),b.value="未找到世界数据，请重新生成世界"),b.value="修仙世界加载完成"}catch(e){console.error("[坤舆图志] 地图初始化失败:",e),b.value="天机阁连接失败",C("世界数据加载失败: "+e.message,"error")}})()}),(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",G$,[(0,a.createCommentVNode)(" 世界信息显示区域 (顶部) "),w.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",W$,[(0,a.createElementVNode)("div",J$,(0,a.toDisplayString)(k.value),1),(0,a.createElementVNode)("div",H$,(0,a.toDisplayString)(w.value),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 修仙世界地图容器 "),(0,a.createElementVNode)("div",{class:"custom-map-container",ref_key:"mapContainer",ref:f},[(0,a.createCommentVNode)(" 地图内控制按钮 (左侧) "),(0,a.createElementVNode)("div",Q$,[(0,a.createElementVNode)("button",{class:"control-btn",onClick:X,title:"定位到玩家位置"},[(0,a.createVNode)((0,a.unref)(L$),{size:14})]),(0,a.createElementVNode)("button",{class:"control-btn",onClick:I,title:"全屏显示"},[(0,a.createVNode)((0,a.unref)(Y$),{size:14})]),(0,a.createElementVNode)("button",{class:"control-btn",onClick:K,title:"调试地图数据"}," 📊 "),(0,a.createElementVNode)("div",K$,(0,a.toDisplayString)(b.value),1)]),(0,a.createCommentVNode)(" SVG 修仙世界地图 "),((0,a.openBlock)(),(0,a.createElementBlock)("svg",{class:"world-map-svg",viewBox:`0 0 ${t.value} ${o.value}`,onWheel:z,onMousedown:S,onMousemove:B,onMouseup:D,onMouseleave:D,onTouchstart:A,onTouchmove:_,onTouchend:$,style:{"user-select":"none","-webkit-user-select":"none","-moz-user-select":"none","touch-action":"none"}},[(0,a.createCommentVNode)(" 地图定义和效果 "),n[6]||(n[6]=(0,a.createStaticVNode)('<defs data-v-3006c0a9><pattern id="gridPattern" patternUnits="userSpaceOnUse" width="50" height="50" data-v-3006c0a9><rect width="50" height="50" fill="none" stroke="#cbd5e1" stroke-width="0.3" opacity="0.4" data-v-3006c0a9></rect></pattern>\x3c!-- 优雅的世界背景 --\x3e<radialGradient id="chaosVoid" cx="50%" cy="50%" data-v-3006c0a9><stop offset="0%" style="stop-color:#fefefe;stop-opacity:1;" data-v-3006c0a9></stop><stop offset="50%" style="stop-color:#f8fafc;stop-opacity:1;" data-v-3006c0a9></stop><stop offset="100%" style="stop-color:#e2e8f0;stop-opacity:1;" data-v-3006c0a9></stop></radialGradient>\x3c!-- 细致的纹理效果 --\x3e<filter id="chaosEffect" x="0%" y="0%" width="100%" height="100%" data-v-3006c0a9><feTurbulence baseFrequency="0.008 0.008" numOctaves="2" result="turbulence" data-v-3006c0a9></feTurbulence><feColorMatrix in="turbulence" type="saturate" values="0" result="grayscale" data-v-3006c0a9></feColorMatrix><feComponentTransfer in="grayscale" data-v-3006c0a9><feFuncA type="discrete" tableValues="0 0.05 0.1 0.15" data-v-3006c0a9></feFuncA></feComponentTransfer><feComposite in2="SourceGraphic" operator="multiply" result="composite" data-v-3006c0a9></feComposite></filter>\x3c!-- 地点光辉效果 --\x3e<filter id="locationGlow" data-v-3006c0a9><feGaussianBlur stdDeviation="3" result="coloredBlur" data-v-3006c0a9></feGaussianBlur><feMerge data-v-3006c0a9><feMergeNode in="coloredBlur" data-v-3006c0a9></feMergeNode><feMergeNode in="SourceGraphic" data-v-3006c0a9></feMergeNode></feMerge></filter></defs>',1)),(0,a.createCommentVNode)(" 世界背景与大气层效果 "),n[7]||(n[7]=(0,a.createStaticVNode)('<defs data-v-3006c0a9><radialGradient id="mapBackground" cx="50%" cy="50%" r="100%" data-v-3006c0a9><stop offset="0%" stop-color="#fefefe" data-v-3006c0a9></stop><stop offset="70%" stop-color="#f8fafc" data-v-3006c0a9></stop><stop offset="100%" stop-color="#e1e7ef" data-v-3006c0a9></stop></radialGradient><radialGradient id="atmosphereGlow" cx="50%" cy="50%" r="100%" data-v-3006c0a9><stop offset="0%" stop-color="rgba(59, 130, 246, 0.02)" data-v-3006c0a9></stop><stop offset="100%" stop-color="rgba(147, 51, 234, 0.04)" data-v-3006c0a9></stop></radialGradient></defs><rect width="100%" height="100%" fill="url(#mapBackground)" data-v-3006c0a9></rect><rect width="100%" height="100%" fill="url(#atmosphereGlow)" data-v-3006c0a9></rect>',3)),(0,a.createCommentVNode)(" 世界边界网格 (仅在大陆区域显示) "),n[8]||(n[8]=(0,a.createElementVNode)("rect",{width:"100%",height:"100%",fill:"url(#gridPattern)",opacity:"0.02"},null,-1)),(0,a.createCommentVNode)(" 地图内容组 (支持平移和缩放) "),(0,a.createElementVNode)("g",{transform:`translate(${i.value}, ${c.value}) scale(${l.value})`},[(0,a.createCommentVNode)(" 大洲层 "),(0,a.createElementVNode)("g",eI,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("g",{key:"continent-"+e.id},[(0,a.createCommentVNode)(" 大洲范围多边形 - 优化紧密分布的显示效果 "),(e.continent_bounds||e.大洲边界)&&(e.continent_bounds||e.大洲边界).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("polygon",{key:0,points:(e.continent_bounds||e.大洲边界).map(e=>{const n=Y(e.longitude,e.latitude);return`${n.x},${n.y}`}).join(" "),fill:"rgba(59, 130, 246, 0.12)",stroke:"#2563eb","stroke-width":"2.5","stroke-dasharray":"8,4","fill-opacity":"0.12","stroke-opacity":"0.75",class:"continent-polygon",onClick:n=>(e=>{if(s.value||p.value>5)return;console.log("[坤舆图志] 选中大洲:",e.name||e.名称),console.log("[坤舆图志] 是否全屏模式:",!!document.fullscreenElement);const n=e.continent_bounds||e.大洲边界||[],t=F(n),a=O(t.x,t.y);console.log("[坤舆图志] 大洲屏幕位置:",a),g.value={id:e.id,name:e.name||e.名称||"未知大洲",type:"大洲",description:e.description||e.描述||"广阔的修仙大陆",climate:e.climate||e.气候,terrain_features:e.terrain_features||e.地理特征,natural_barriers:e.natural_barriers||e.天然屏障,screenPosition:a}})(e)},null,8,nI)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 大洲名称标签 "),(e.continent_bounds||e.大洲边界)&&(e.continent_bounds||e.大洲边界).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("text",{key:1,x:F(e.continent_bounds||e.大洲边界||[]).x,y:F(e.continent_bounds||e.大洲边界||[]).y,class:"continent-name-label","text-anchor":"middle",fill:"#1e40af","font-weight":"bold","font-size":"18px",opacity:"0.85"},(0,a.toDisplayString)(e.name||e.名称),9,tI)):(0,a.createCommentVNode)("v-if",!0)]))),128))]),(0,a.createCommentVNode)(" 势力范围层 "),(0,a.createElementVNode)("g",aI,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(y.value.filter(e=>e.isTerritory&&e.territoryBounds&&e.territoryBounds.length>0),e=>((0,a.openBlock)(),(0,a.createElementBlock)("g",{key:"territory-"+e.id},[(0,a.createCommentVNode)(" 势力范围多边形 "),(0,a.createElementVNode)("polygon",{points:(e.territoryBounds||[]).map(e=>`${e.x},${e.y}`).join(" "),fill:e.color,stroke:e.iconColor,"stroke-width":"2","fill-opacity":"0.15","stroke-opacity":"0.6",class:"territory-polygon",onClick:n=>q(e),onMouseenter:n=>j(e),onMouseleave:M},null,40,oI),(0,a.createCommentVNode)(" 势力名称标签 (在范围中心) "),(0,a.createElementVNode)("text",{x:P(e.territoryBounds||[]).x,y:P(e.territoryBounds||[]).y,class:"territory-name-label","text-anchor":"middle",fill:e.iconColor,"font-weight":"bold","font-size":"14px"},(0,a.toDisplayString)(e.name),9,rI)]))),128))]),(0,a.createCommentVNode)(" 地点标记层 "),(0,a.createElementVNode)("g",lI,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(y.value.filter(e=>!e.isTerritory),e=>((0,a.openBlock)(),(0,a.createElementBlock)("g",{key:"location-"+e.id},[(0,a.createElementVNode)("g",{transform:`translate(${e.coordinates?.x||0}, ${e.coordinates?.y||0})`,class:"location-marker",onClick:n=>q(e),onMouseenter:n=>j(e),onMouseleave:M},[(0,a.createCommentVNode)(" 地点类型图标 "),(0,a.createElementVNode)("g",cI,[(0,a.createCommentVNode)(" ⛰️ 名山大川 "),"natural_landmark"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)("g",sI,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(gf),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,dI))])):"sect_power"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 🏛️ 宗门势力 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(R$),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,mI))])],2112)):"city_town"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(" 🏮 城镇坊市 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)($i),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,pI))])],2112)):"blessed_land"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:3},[(0,a.createCommentVNode)(" ⛩️ 洞天福地 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(Lc),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,vI))])],2112)):"treasure_land"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:4},[(0,a.createCommentVNode)(" 💰 奇珍异地 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(Jk),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,uI))])],2112)):"dangerous_area"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:5},[(0,a.createCommentVNode)(" ☠️ 凶险之地 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(U$),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,gI))])],2112)):"special_other"===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:6},[(0,a.createCommentVNode)(" 🌟 其他特殊 "),(0,a.createElementVNode)("g",null,[((0,a.openBlock)(),(0,a.createElementBlock)("foreignObject",{x:-Z(e.type).offset,y:-Z(e.type).offset,width:Z(e.type).size,height:Z(e.type).size},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)([{display:"flex","align-items":"center","justify-content":"center"},{width:Z(e.type).size+"px",height:Z(e.type).size+"px"}])},[(0,a.createVNode)((0,a.unref)(Bi),{size:Z(e.type).size-4,color:e.iconColor},null,8,["size","color"])],4)],8,fI))])],2112)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:7},[(0,a.createCommentVNode)(" 默认图标 "),(0,a.createElementVNode)("g",null,[(0,a.createElementVNode)("circle",{r:Z("default").offset-2,fill:e.iconColor,stroke:"white","stroke-width":"1"},null,8,bI),n[1]||(n[1]=(0,a.createElementVNode)("text",{class:"location-icon-text","text-anchor":"middle",dy:"2",fill:"white","font-size":"10px"},"?",-1))])],2112))]),(0,a.createCommentVNode)(" 地点名称标签 "),(0,a.createElementVNode)("text",{class:"location-name-label","text-anchor":"middle",y:"18",fill:e.iconColor},(0,a.toDisplayString)(e.name),9,hI)],40,iI)]))),128))]),(0,a.createCommentVNode)(" 玩家位置层 "),E.value?((0,a.openBlock)(),(0,a.createElementBlock)("g",yI,[(0,a.createElementVNode)("g",{transform:`translate(${E.value.x}, ${E.value.y})`},[(0,a.createCommentVNode)(" 玩家灵气光环 "),n[2]||(n[2]=(0,a.createStaticVNode)('<circle class="player-aura" r="20" fill="#EF4444" opacity="0.25" data-v-3006c0a9><animate attributeName="r" values="15;25;15" dur="3s" repeatCount="indefinite" data-v-3006c0a9></animate><animate attributeName="opacity" values="0.4;0.1;0.4" dur="3s" repeatCount="indefinite" data-v-3006c0a9></animate></circle><circle class="player-inner-aura" r="12" fill="#FBBF24" opacity="0.4" data-v-3006c0a9><animate attributeName="r" values="8;16;8" dur="2s" repeatCount="indefinite" data-v-3006c0a9></animate><animate attributeName="opacity" values="0.6;0.2;0.6" dur="2s" repeatCount="indefinite" data-v-3006c0a9></animate></circle>',2)),(0,a.createCommentVNode)(" 玩家标记 "),n[3]||(n[3]=(0,a.createElementVNode)("polygon",{points:"0,-12 -8,8 8,8",fill:"#dc2626",stroke:"#fef2f2","stroke-width":"2"},null,-1)),n[4]||(n[4]=(0,a.createElementVNode)("circle",{r:"3",fill:"#fef2f2"},null,-1)),n[5]||(n[5]=(0,a.createElementVNode)("circle",{r:"1.5",fill:"#dc2626"},null,-1))],8,xI),(0,a.createCommentVNode)(" 玩家名称 "),(0,a.createElementVNode)("text",{x:E.value.x,y:E.value.y+25,class:"player-name-label","text-anchor":"middle",fill:"#DC2626"},(0,a.toDisplayString)(h.value),9,kI)])):(0,a.createCommentVNode)("v-if",!0)],8,Z$)],40,X$))],512),(0,a.createCommentVNode)(" 选中详情显示面板 (动态位置在地点顶部) "),g.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:1,class:"selected-info-overlay",style:(0,a.normalizeStyle)(L())},[(0,a.createElementVNode)("div",wI,[(0,a.createElementVNode)("div",NI,[(0,a.createElementVNode)("h4",null,(0,a.toDisplayString)(g.value.name),1),(0,a.createElementVNode)("button",{onClick:n[0]||(n[0]=e=>g.value=null),class:"close-info"},"×")]),(0,a.createElementVNode)("div",EI,[(0,a.createElementVNode)("p",VI,(0,a.toDisplayString)("大洲"===g.value.type?"大洲":(r=g.value.type,{natural_landmark:"名山大川",sect_power:"宗门势力",city_town:"城镇坊市",blessed_land:"洞天福地",treasure_land:"奇珍异地",dangerous_area:"凶险之地",special_other:"其他特殊",sect_headquarters:"宗门势力",major_city:"城镇坊市",secret_realm:"洞天福地",mountain:"名山大川",cultivation_site:"洞天福地",trade_center:"城镇坊市",village:"城镇坊市",neutral_zone:"其他特殊",immortal_empire:"宗门势力",orthodox_sect:"宗门势力",demonic_cult:"宗门势力",immortal_family:"宗门势力",merchant_guild:"宗门势力",neutral_academy:"宗门势力",rogue_alliance:"宗门势力",demon_tribe:"宗门势力",battlefield_ruins:"凶险之地",treasure_source:"奇珍异地",spirit_beast_habitat:"凶险之地",inheritance_cave:"洞天福地",teleportation_array:"其他特殊",demon_realm_gate:"凶险之地",immortal_mansion:"洞天福地"}[r]||"其他特殊")),1),(0,a.createElementVNode)("p",CI,(0,a.toDisplayString)(g.value.description),1),g.value.danger_level?((0,a.openBlock)(),(0,a.createElementBlock)("div",zI,[n[9]||(n[9]=(0,a.createElementVNode)("strong",null,"安全等级：",-1)),(0,a.createTextVNode)((0,a.toDisplayString)(g.value.danger_level),1)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 大洲特有信息 "),g.value.climate?((0,a.openBlock)(),(0,a.createElementBlock)("div",SI,[n[10]||(n[10]=(0,a.createElementVNode)("strong",null,"气候类型：",-1)),(0,a.createTextVNode)((0,a.toDisplayString)(g.value.climate),1)])):(0,a.createCommentVNode)("v-if",!0),g.value.terrain_features&&g.value.terrain_features.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",BI,[n[11]||(n[11]=(0,a.createElementVNode)("strong",null,"地形特征：",-1)),(0,a.createTextVNode)((0,a.toDisplayString)(Array.isArray(g.value.terrain_features)?g.value.terrain_features.join("、"):g.value.terrain_features),1)])):(0,a.createCommentVNode)("v-if",!0),g.value.natural_barriers&&g.value.natural_barriers.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",DI,[n[12]||(n[12]=(0,a.createElementVNode)("strong",null,"天然屏障：",-1)),(0,a.createTextVNode)((0,a.toDisplayString)(Array.isArray(g.value.natural_barriers)?g.value.natural_barriers.join("、"):g.value.natural_barriers),1)])):(0,a.createCommentVNode)("v-if",!0)])])],4)):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 地图图例 (右下角) "),(0,a.createElementVNode)("div",AI,[(0,a.createElementVNode)("div",_I,(0,a.toDisplayString)(k.value)+"图例",1),(0,a.createElementVNode)("div",$I,[(0,a.createElementVNode)("div",II,[(0,a.createElementVNode)("div",TI,[(0,a.createVNode)((0,a.unref)(gf),{size:16,color:"#2D7D32"})]),n[13]||(n[13]=(0,a.createElementVNode)("span",null,"名山大川",-1))]),(0,a.createElementVNode)("div",jI,[(0,a.createElementVNode)("div",MI,[(0,a.createVNode)((0,a.unref)(R$),{size:16,color:"#1565C0"})]),n[14]||(n[14]=(0,a.createElementVNode)("span",null,"宗门势力",-1))]),(0,a.createElementVNode)("div",qI,[(0,a.createElementVNode)("div",OI,[(0,a.createVNode)((0,a.unref)($i),{size:16,color:"#F57C00"})]),n[15]||(n[15]=(0,a.createElementVNode)("span",null,"城镇坊市",-1))]),(0,a.createElementVNode)("div",PI,[(0,a.createElementVNode)("div",FI,[(0,a.createVNode)((0,a.unref)(Lc),{size:16,color:"#7B1FA2"})]),n[16]||(n[16]=(0,a.createElementVNode)("span",null,"洞天福地",-1))]),(0,a.createElementVNode)("div",LI,[(0,a.createElementVNode)("div",YI,[(0,a.createVNode)((0,a.unref)(Jk),{size:16,color:"#388E3C"})]),n[17]||(n[17]=(0,a.createElementVNode)("span",null,"奇珍异地",-1))]),(0,a.createElementVNode)("div",RI,[(0,a.createElementVNode)("div",UI,[(0,a.createVNode)((0,a.unref)(U$),{size:16,color:"#D32F2F"})]),n[18]||(n[18]=(0,a.createElementVNode)("span",null,"凶险之地",-1))]),(0,a.createElementVNode)("div",GI,[(0,a.createElementVNode)("div",WI,[(0,a.createVNode)((0,a.unref)(Bi),{size:16,color:"#6B7280"})]),n[19]||(n[19]=(0,a.createElementVNode)("span",null,"其他特殊",-1))])])])]);var r}}});var HI=t(875),QI={};QI.styleTagTransform=A(),QI.setAttributes=z(),QI.insert=V().bind(null,"head"),QI.domAPI=N(),QI.insertStyleElement=B(),k()(HI.A,QI),HI.A&&HI.A.locals&&HI.A.locals;const KI=(0,j.A)(JI,[["__scopeId","data-v-3006c0a9"]]),XI={class:"quest-panel"},ZI={class:"quest-header"},eT={class:"header-title"},nT={key:0,class:"count-badge"},tT={class:"header-actions"},aT=["title"],oT={key:0,class:"config-panel"},rT={class:"config-row"},lT={class:"config-row"},iT={class:"config-row"},cT={key:0,class:"config-row custom-prompt-row"},sT={key:1,class:"tasks-container"},dT={class:"task-header"},mT={class:"task-title-area"},pT={class:"task-icon"},vT={class:"task-title"},uT={class:"task-type-badge"},gT=["onClick","title"],fT={key:0,class:"task-body"},bT={class:"task-description"},hT={class:"task-conditions"},yT={class:"condition-icon"},xT={class:"condition-text"},kT={key:0,class:"condition-progress"},wT={class:"progress-bar-mini"},NT={class:"progress-text-mini"},ET={class:"task-rewards"},VT={class:"rewards-list"},CT={class:"reward-icon"},zT={class:"reward-text"},ST={key:0,class:"task-footer"},BT={key:0,class:"time-limit"},DT={class:"footer-value"},AT={key:1,class:"failure-penalty"},_T={class:"footer-value penalty-text"},$T={class:"task-meta"},IT={class:"meta-value"},TT={key:3,class:"completed-section"},jT={class:"count-badge"},MT={class:"expand-icon"},qT={key:0,class:"completed-list"},OT={class:"completed-name"},PT={key:0,class:"more-hint"},FT=(0,a.defineComponent)({__name:"QuestPanel",setup(e){const n=(0,tn.useCharacterStore)(),t=(0,a.ref)(!1),o=(0,a.ref)(!1),r=(0,a.ref)(new Set),l=(0,a.computed)(()=>n.activeSaveSlot?.存档数据?.系统任务),i=(0,a.computed)(()=>l.value?.配置?.启用||!1),c=(0,a.computed)({get:()=>l.value?.配置?.任务类型||"all",set:e=>{l.value?.配置&&(l.value.配置.任务类型=e)}}),s=(0,a.computed)({get:()=>l.value?.配置?.颁发数量||3,set:e=>{l.value?.配置&&(l.value.配置.颁发数量=e)}}),m=(0,a.computed)({get:()=>l.value?.配置?.自定义提示词||"",set:e=>{l.value?.配置&&(l.value.配置.自定义提示词=e)}}),p=(0,a.computed)(()=>l.value?.进行中任务||[]),v=(0,a.computed)(()=>p.value.length),u=(0,a.computed)(()=>l.value?.已完成任务名称||[]);function g(){const e=n.activeSaveSlot?.存档数据;if(!e?.系统任务?.配置)return void d.o.error("系统任务配置不存在");const t=e.系统任务.配置,a=[];t.任务类型!==c.value&&(t.任务类型=c.value,a.push("系统任务.配置.任务类型")),t.颁发数量!==s.value&&(t.颁发数量=s.value,a.push("系统任务.配置.颁发数量")),"custom"===c.value&&t.自定义提示词!==m.value&&(t.自定义提示词=m.value,a.push("系统任务.配置.自定义提示词")),a.length>0&&n.syncToTavernAndSave({changedPaths:a}),d.o.success("配置已更新")}function f(){const e=n.activeSaveSlot?.存档数据;e?.系统任务?.配置?(e.系统任务.配置.启用=!e.系统任务.配置.启用,n.syncToTavernAndSave({changedPaths:["系统任务.配置.启用"],fullSync:!0}),e.系统任务.配置.启用?d.o.success("✓ 系统任务已启用，AI将根据配置自动颁发任务"):d.o.info("✗ 系统任务已禁用")):d.o.error("系统任务配置不存在")}function b(e){return r.value.has(e)}function h(e){return{all:"🎯",relationship:"👥",companion:"💑",cultivation:"⚡",exploration:"🗺️",combat:"⚔️",custom:"🎲"}[e]||"📌"}function y(e){return{all:"综合",relationship:"交友",companion:"道侣",cultivation:"修炼",exploration:"探索",combat:"战斗",custom:"自定义"}[e]||e}function x(e){return{灵石:"💎",物品:"📦",经验:"✨",属性:"💪",技能:"📜",好感度:"💗"}[e]||"🎁"}return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",XI,[(0,a.createCommentVNode)(" 系统任务开关和配置 "),(0,a.createElementVNode)("div",ZI,[(0,a.createElementVNode)("div",eT,[n[5]||(n[5]=(0,a.createElementVNode)("span",{class:"header-icon"},"🎯",-1)),n[6]||(n[6]=(0,a.createElementVNode)("span",{class:"header-text"},"系统任务",-1)),l.value?((0,a.openBlock)(),(0,a.createElementBlock)("span",nT,(0,a.toDisplayString)(v.value)+"/"+(0,a.toDisplayString)(5),1)):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",tT,[(0,a.createElementVNode)("button",{class:"config-btn",onClick:n[0]||(n[0]=e=>t.value=!t.value),title:t.value?"隐藏配置":"显示配置"}," ⚙️ 配置 ",8,aT)])]),(0,a.createCommentVNode)(" 配置面板 "),t.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",oT,[(0,a.createElementVNode)("div",rT,[n[7]||(n[7]=(0,a.createElementVNode)("label",{class:"config-label"},"系统任务：",-1)),(0,a.createElementVNode)("button",{class:(0,a.normalizeClass)(["toggle-btn",{active:i.value}]),onClick:f},(0,a.toDisplayString)(i.value?"✓ 已启用":"✗ 已禁用"),3)]),(0,a.createElementVNode)("div",lT,[n[9]||(n[9]=(0,a.createElementVNode)("label",{class:"config-label"},"任务类型：",-1)),(0,a.withDirectives)((0,a.createElementVNode)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),onChange:g,class:"config-select"},n[8]||(n[8]=[(0,a.createStaticVNode)('<option value="all" data-v-7e802482>综合系统（全部类型）</option><option value="relationship" data-v-7e802482>交友系统</option><option value="companion" data-v-7e802482>道侣系统</option><option value="cultivation" data-v-7e802482>修炼系统</option><option value="exploration" data-v-7e802482>探索系统</option><option value="combat" data-v-7e802482>战斗系统</option><option value="custom" data-v-7e802482>自定义</option>',7)]),544),[[a.vModelSelect,c.value]])]),(0,a.createElementVNode)("div",iT,[n[10]||(n[10]=(0,a.createElementVNode)("label",{class:"config-label"},"颁发数量：",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>s.value=e),onChange:g,class:"config-input",min:"1",max:"10"},null,544),[[a.vModelText,s.value,void 0,{number:!0}]])]),"custom"===c.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",cT,[n[11]||(n[11]=(0,a.createElementVNode)("label",{class:"config-label"},"自定义规则：",-1)),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[3]||(n[3]=e=>m.value=e),onChange:g,class:"config-textarea",placeholder:"输入任务颁发规则，AI会根据此规则生成任务...",rows:"4"},null,544),[[a.vModelText,m.value]])])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 进行中的任务 "),p.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",sT,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(p.value,e=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.任务ID,class:(0,a.normalizeClass)(["task-card",(l=e.任务类型,`task-type-${l}`)])},[(0,a.createElementVNode)("div",dT,[(0,a.createElementVNode)("div",mT,[(0,a.createElementVNode)("span",pT,(0,a.toDisplayString)(h(e.任务类型)),1),(0,a.createElementVNode)("h4",vT,(0,a.toDisplayString)(e.任务名称),1),(0,a.createElementVNode)("span",uT,(0,a.toDisplayString)(y(e.任务类型)),1)]),(0,a.createElementVNode)("button",{class:"expand-btn",onClick:n=>{return t=e.任务ID,void(r.value.has(t)?r.value.delete(t):r.value.add(t));var t},title:b(e.任务ID)?"收起":"展开"},(0,a.toDisplayString)(b(e.任务ID)?"▲":"▼"),9,gT)]),b(e.任务ID)?((0,a.openBlock)(),(0,a.createElementBlock)("div",fT,[(0,a.createElementVNode)("p",bT,(0,a.toDisplayString)(e.任务描述),1),(0,a.createCommentVNode)(" 任务条件 "),(0,a.createElementVNode)("div",hT,[n[12]||(n[12]=(0,a.createElementVNode)("h5",{class:"subsection-title"},"任务条件",-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.条件,(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:(0,a.normalizeClass)(["condition-item",{completed:e.完成}])},[(0,a.createElementVNode)("span",yT,(0,a.toDisplayString)(e.完成?"✓":"○"),1),(0,a.createElementVNode)("span",xT,(0,a.toDisplayString)(e.描述),1),e.进度?((0,a.openBlock)(),(0,a.createElementBlock)("div",kT,[(0,a.createElementVNode)("div",wT,[(0,a.createElementVNode)("div",{class:"progress-fill",style:(0,a.normalizeStyle)({width:(t=e.进度,(0===t.目标?100:Math.min(100,t.当前/t.目标*100))+"%")})},null,4)]),(0,a.createElementVNode)("span",NT,(0,a.toDisplayString)(e.进度.当前)+"/"+(0,a.toDisplayString)(e.进度.目标),1)])):(0,a.createCommentVNode)("v-if",!0)],2);var t}),128))]),(0,a.createCommentVNode)(" 任务奖励 "),(0,a.createElementVNode)("div",ET,[n[13]||(n[13]=(0,a.createElementVNode)("h5",{class:"subsection-title"},"任务奖励",-1)),(0,a.createElementVNode)("div",VT,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.奖励,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"reward-item"},[(0,a.createElementVNode)("span",CT,(0,a.toDisplayString)(x(e.类型)),1),(0,a.createElementVNode)("span",zT,(0,a.toDisplayString)(e.描述),1)]))),128))])]),(0,a.createCommentVNode)(" 任务有效期和惩罚 "),e.有效期||e.失败惩罚?((0,a.openBlock)(),(0,a.createElementBlock)("div",ST,[e.有效期?((0,a.openBlock)(),(0,a.createElementBlock)("div",BT,[n[14]||(n[14]=(0,a.createElementVNode)("span",{class:"footer-label"},"⏰ 有效期：",-1)),(0,a.createElementVNode)("span",DT,(0,a.toDisplayString)((o=e.有效期,o<60?`${o}分钟`:o<1440?`${Math.floor(o/60)}小时`:o<43200?`${Math.floor(o/1440)}天`:`${Math.floor(o/43200)}月`)),1)])):(0,a.createCommentVNode)("v-if",!0),e.失败惩罚?((0,a.openBlock)(),(0,a.createElementBlock)("div",AT,[n[15]||(n[15]=(0,a.createElementVNode)("span",{class:"footer-label"},"⚠️ 失败惩罚：",-1)),(0,a.createElementVNode)("span",_T,(0,a.toDisplayString)(e.失败惩罚),1)])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 颁发时间 "),(0,a.createElementVNode)("div",$T,[n[16]||(n[16]=(0,a.createElementVNode)("span",{class:"meta-label"},"颁发时间：",-1)),(0,a.createElementVNode)("span",IT,(0,a.toDisplayString)((t=e.颁发时间,`仙历${t.年}年${t.月}月${t.日}日`)),1)])])):(0,a.createCommentVNode)("v-if",!0)],2);var t,o,l}),128))])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(" 无任务提示 "),n[17]||(n[17]=(0,a.createElementVNode)("div",{class:"empty-tasks"},[(0,a.createElementVNode)("div",{class:"empty-icon"},"📋"),(0,a.createElementVNode)("div",{class:"empty-text"},"暂无进行中的任务"),(0,a.createElementVNode)("div",{class:"empty-hint"},"AI会根据你的配置自动颁发任务")],-1))],2112)),(0,a.createCommentVNode)(" 已完成任务历史 "),u.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",TT,[(0,a.createElementVNode)("button",{class:"completed-header",onClick:n[4]||(n[4]=e=>o.value=!o.value)},[n[18]||(n[18]=(0,a.createElementVNode)("span",{class:"header-icon"},"✓",-1)),n[19]||(n[19]=(0,a.createElementVNode)("span",{class:"header-text"},"已完成任务",-1)),(0,a.createElementVNode)("span",jT,(0,a.toDisplayString)(u.value.length),1),(0,a.createElementVNode)("span",MT,(0,a.toDisplayString)(o.value?"▲":"▼"),1)]),o.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",qT,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(u.value.slice(0,20),(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"completed-item"},[n[20]||(n[20]=(0,a.createElementVNode)("span",{class:"completed-icon"},"🏆",-1)),(0,a.createElementVNode)("span",OT,(0,a.toDisplayString)(e),1)]))),128)),u.value.length>20?((0,a.openBlock)(),(0,a.createElementBlock)("div",PT," 还有 "+(0,a.toDisplayString)(u.value.length-20)+" 个已完成任务... ",1)):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0)])):(0,a.createCommentVNode)("v-if",!0)]))}});var LT=t(3811),YT={};YT.styleTagTransform=A(),YT.setAttributes=z(),YT.insert=V().bind(null,"head"),YT.domAPI=N(),YT.insertStyleElement=B(),k()(LT.A,YT),LT.A&&LT.A.locals&&LT.A.locals;const RT=(0,j.A)(FT,[["__scopeId","data-v-7e802482"]]),UT=(0,c.A)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),GT=(0,c.A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),WT=(0,c.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),JT=(0,c.A)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),HT=(0,c.A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),QT=(0,c.A)("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),KT=(0,c.A)("book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),XT={练气:1,练气初期:1,练气中期:1,练气后期:1,练气圆满:1,练气极境:1,筑基:2,筑基初期:2,筑基中期:2,筑基后期:2,筑基圆满:2,筑基极境:2,金丹:3,金丹初期:3,金丹中期:3,金丹后期:3,金丹圆满:3,金丹极境:3,元婴:4,元婴初期:4,元婴中期:4,元婴后期:4,元婴圆满:4,元婴极境:4,化神:5,化神初期:5,化神中期:5,化神后期:5,化神圆满:5,化神极境:5,炼虚:6,炼虚初期:6,炼虚中期:6,炼虚后期:6,炼虚圆满:6,炼虚极境:6,合体:7,合体初期:7,合体中期:7,合体后期:7,合体圆满:7,合体极境:7,渡劫:8,渡劫初期:8,渡劫中期:8,渡劫后期:8,渡劫圆满:8,渡劫极境:8,练气期:1,筑基期:2,金丹期:3,元婴期:4,化神期:5,炼虚期:6,合体期:7,渡劫期:8};function ZT(e){return XT[e]||0}const ej={class:"sect-panel"},nj={class:"panel-content"},tj={class:"sect-container"},aj={class:"sect-list"},oj={class:"list-header"},rj={class:"search-bar"},lj={class:"list-content"},ij={key:0,class:"loading-state"},cj={key:1,class:"empty-state"},sj={class:"debug-info",style:{"margin-top":"1rem","font-size":"0.8rem",color:"#666","text-align":"left"}},dj={style:{"margin-top":"0.5rem"}},mj={key:2,class:"sect-list-content"},pj=["onClick"],vj={class:"sect-icon"},uj={class:"sect-emoji"},gj={class:"sect-info"},fj={class:"sect-name"},bj={class:"sect-meta"},hj={class:"sect-type"},yj={class:"sect-detail"},xj={key:0,class:"detail-content"},kj={class:"detail-header"},wj={class:"detail-icon"},Nj={class:"sect-emoji-large"},Ej={class:"detail-info"},Vj={class:"detail-name"},Cj={class:"detail-badges"},zj={class:"detail-body"},Sj={class:"detail-section"},Bj={class:"section-title"},Dj={class:"info-grid"},Aj={class:"info-item"},_j={class:"info-value"},$j={class:"info-item"},Ij={class:"info-value"},Tj={class:"info-item"},jj={class:"info-value"},Mj={class:"info-item"},qj={class:"info-value"},Oj={key:0,class:"leadership-info"},Pj={class:"leader-grid"},Fj={class:"leader-item primary-leader"},Lj={class:"leader-name"},Yj={key:0,class:"leader-realm"},Rj={key:0,class:"leader-item"},Uj={class:"leader-name"},Gj={class:"sect-strength"},Wj={class:"strength-item"},Jj={class:"strength-value peak-power"},Hj={key:0,class:"strength-item"},Qj={class:"power-level"},Kj={class:"sect-description"},Xj={class:"desc-text"},Zj={key:2,class:"sect-specialties"},eM={class:"specialties-tags"},nM={key:0,class:"detail-section"},tM={class:"section-title"},aM={class:"member-stats"},oM={class:"total-members"},rM={class:"total-value"},lM={key:0,class:"realm-distribution"},iM={class:"realm-stats"},cM={class:"realm-name"},sM={class:"realm-count"},dM={key:1,class:"position-distribution"},mM={class:"position-stats"},pM={class:"position-name"},vM={class:"position-count"},uM={class:"detail-section missing-data-notice"},gM={class:"section-title"},fM={class:"detail-section"},bM={class:"section-title"},hM={class:"relationship-info"},yM={class:"relationship-item"},xM={class:"relationship-item"},kM={class:"reputation-level"},wM={key:2,class:"detail-section"},NM={class:"section-title"},EM={class:"territory-info"},VM={class:"influence-description"},CM={key:0,class:"controlled-areas"},zM={class:"areas-list"},SM={class:"strategic-value"},BM={class:"value-display"},DM={class:"value-bar"},AM={class:"value-text"},_M={key:3,class:"detail-section"},$M={class:"section-title"},IM={class:"join-requirements"},TM={key:0,class:"requirements-list"},jM={class:"requirement-text"},MM={key:1,class:"no-requirements"},qM={key:0,class:"join-benefits"},OM={class:"benefits-list"},PM={class:"benefit-text"},FM={class:"join-actions"},LM={key:4,class:"detail-section"},YM={class:"section-title"},RM={class:"current-member-info"},UM={class:"member-status"},GM={class:"status-item"},WM={class:"status-value position"},JM={class:"status-item"},HM={class:"status-value contribution"},QM={class:"status-item"},KM={class:"status-value reputation"},XM={class:"status-item"},ZM={class:"status-value join-date"},eq={class:"sect-actions"},nq={class:"action-buttons"},tq={key:1,class:"no-selection"},aq=(0,a.defineComponent)({__name:"SectPanel",setup(e){const n=(0,tn.useCharacterStore)(),{characterData:t,saveData:o}=(0,Li.useUnifiedCharacterData)(),r=(0,a.ref)(!1),l=(0,a.ref)(null),i=(0,a.ref)(""),c=(0,a.computed)(()=>{const e=o.value;if(console.log("[宗门系统] 开始获取数据"),console.log("[宗门系统] saveData存在:",!!e),console.log("[宗门系统] 完整存档数据结构:",Object.keys(e||{})),!e)return console.log("[宗门系统] 存档数据不存在，返回空数组"),{availableSects:[]};let n=[];const t=e.世界信息;if(t?.势力信息){console.log("[宗门系统] 发现世界信息.势力信息，数量:",t.势力信息.length),console.log("[宗门系统] 势力信息类型:",t.势力信息.map(e=>e.类型));const e=t.势力信息.filter(e=>{if(!e.类型)return!1;const n=e.类型.toLowerCase();return["秘境","遗迹","禁地","森林","山脉","湖泊","城池"].some(e=>n.includes(e.toLowerCase()))?(console.log("[宗门系统] 排除非宗门势力:",e.名称,e.类型),!1):(console.log("[宗门系统] 包含势力:",e.名称,e.类型),!0)});n=e}const a=e?.宗门系统;if(a?.availableSects&&a.availableSects.length>0){console.log("[宗门系统] 发现宗门系统.availableSects，数量:",a.availableSects.length);const e=a.availableSects.map(e=>({...e,名称:e.name,类型:e.type,等级:e.level,描述:e.description,特色:e.specialties,与玩家关系:e.relationshipToPlayer}));n=[...n,...e]}Object.keys(e).forEach(t=>{const a=t.toLowerCase(),o=e[t];(a.includes("宗门")||a.includes("sect"))&&Array.isArray(o)&&(console.log("[宗门系统] 发现可能的宗门数据字段:",t,"数量:",o.length),n=[...n,...o])});const r=(l=n.filter((e,n,t)=>t.findIndex(n=>n.名称===e.名称)===n),Array.isArray(l)?l.map(e=>{const n=function(e){if(!e)return e;console.log("[宗门验证] 开始验证宗门数据:",e.名称);const n=e.leadership?.最强修为||e.最强修为,t=ZT(n);if(console.log("[宗门验证] 最强修为:",n,"等级:",t),e.memberCount?.byRealm){const n=e.memberCount.byRealm,a={...n};Object.keys(n).forEach(e=>{const a=ZT(e);a>t&&(console.log(`[宗门验证] 移除超越最强修为的境界: ${e} (等级${a} > ${t})`),delete n[e])}),console.log("[宗门验证] 修复前境界分布:",a),console.log("[宗门验证] 修复后境界分布:",n)}if(e.leadership?.长老数量&&e.memberCount?.byRealm){const n=e.leadership.长老数量,t=e.memberCount.byRealm;let a=0;if(Object.keys(t).forEach(e=>{ZT(e)>=4&&(a+=t[e]||0)}),console.log(`[宗门验证] 长老数量: ${n}, 高境界修士: ${a}`),a>1.5*n){console.log("[宗门验证] 高境界修士数量过多，进行调整");const e=1.2*n/a;Object.keys(t).forEach(n=>{if(ZT(n)>=4){const a=t[n];t[n]=Math.max(1,Math.round(a*e)),console.log(`[宗门验证] 调整${n}: ${a} -> ${t[n]}`)}})}}return e}(e),t=function(e){const n=[];if(!e)return n.push("宗门数据为空"),{isValid:!1,errors:n};const t=e.leadership?.最强修为||e.最强修为,a=ZT(t);e.memberCount?.byRealm&&Object.keys(e.memberCount.byRealm).forEach(e=>{ZT(e)>a&&n.push(`境界分布错误: 存在${e}期修士，但最强修为仅为${t}`)});const o=e.leadership?.长老数量;if(o&&e.memberCount?.byRealm){let t=0;Object.keys(e.memberCount.byRealm).forEach(n=>{ZT(n)>=4&&(t+=e.memberCount.byRealm[n]||0)}),t>2*o&&n.push(`人员配置不合理: 长老${o}位，但元婴期以上修士${t}人`)}return{isValid:0===n.length,errors:n}}(n);return t.isValid||console.warn(`[宗门验证] ${e.名称||"未知宗门"}存在问题:`,t.errors),n}):l);var l;return console.log("[宗门系统] 最终宗门数量:",r.length),console.log("[宗门系统] 最终宗门列表:",r.map(e=>e.名称)),{availableSects:r}}),s=(0,a.computed)(()=>o.value?.玩家角色状态?.宗门信息),m=(0,a.computed)(()=>c.value.availableSects),p=(0,a.computed)(()=>{let e=[...m.value];if(i.value.trim()){const n=i.value.toLowerCase();e=e.filter(e=>e.名称.toLowerCase().includes(n)||e.类型.toLowerCase().includes(n)||e.描述&&e.描述.toLowerCase().includes(n))}const n=["超级","一流","二流","三流","末流"],t=e=>{if(!e)return 999;const t=n.findIndex(n=>e.includes(n));return-1===t?999:t};return e.sort((e,n)=>t(e.等级)-t(n.等级))}),v=e=>{if(e.所在大洲)return e.所在大洲;const n=o.value?.世界信息,t=n?.continents||n?.大陆信息;if(t)for(const n of t){if(e.id&&(n.主要势力?.includes(e.id)||n.factions?.includes(e.id)))return n.名称||n.name||"未命名大洲";if(n.主要势力?.includes(e.名称)||n.factions?.includes(e.名称))return n.名称||n.name||"未命名大洲"}if(n?.势力信息)for(const t of n.势力信息)if((t.id&&e.id&&t.id===e.id||t.名称===e.名称)&&t.所在大洲)return t.所在大洲;if(e.位置&&"object"==typeof e.位置&&"longitude"in e.位置&&"latitude"in e.位置){const n=e.位置.longitude,t=e.位置.latitude;return n<110&&t>40?"北境雪域":n<110&&t<30?"南疆荒漠":n>120&&t>35?"东海群岛":n>120&&t<35?"东南丛林":"中土大陆"}return"未知大洲"},u=e=>{const n=e;if(n.主要资源&&Array.isArray(n.主要资源))return n.主要资源.slice(0,3).join("、");if(n.resources&&Array.isArray(n.resources))return n.resources.slice(0,3).join("、");const t=e.类型||"";return t.includes("剑")?"神铁、剑谱、磨剑石":t.includes("丹")?"灵药、丹炉、药圃":t.includes("符")||t.includes("阵")?"符纸、阵法、法器":t.includes("魔")||t.includes("邪")?"魔石、煞气、秘法":t.includes("商")?"灵石、珍宝、情报":t.includes("世家")?"传承、人脉、底蕴":"灵石、功法、修炼资源"},g=e=>{const n=[];return e.specialties&&Array.isArray(e.specialties)&&n.push(...e.specialties),e.特色&&(Array.isArray(e.特色)?n.push(...e.特色):"string"==typeof e.特色&&n.push(e.特色)),Array.from(new Set(n))},f=e=>String("object"==typeof e&&null!==e&&"name"in e?e.name:e||"中立"),b=e=>"object"==typeof e&&null!==e&&"value"in e?Number(e.value):Number(e)||0,h=e=>({正道宗门:"⛩️",修仙宗门:"⛩️",魔道宗门:"🏴",魔道势力:"🏴",中立宗门:"🏯",修仙世家:"🏘️",世家:"🏘️",商会:"🏪",商会组织:"🏪",散修联盟:"🤝"}[e]||"🏛️"),y=e=>({正道宗门:"righteous",修仙宗门:"righteous",魔道宗门:"demonic",魔道势力:"demonic",中立宗门:"neutral",修仙世家:"family",世家:"family",商会:"merchant",商会组织:"merchant",散修联盟:"alliance"}[e]||"neutral"),x=e=>e>=90?"天下无双":e>=80?"称霸一方":e>=70?"实力雄厚":e>=60?"颇有实力":e>=50?"中等水平":e>=40?"略有实力":"实力一般",k=e=>e>=25?"声名远扬":e>=20?"享有盛誉":e>=15?"名声在外":e>=10?"小有名气":e>=5?"略有声望":"默默无闻",w=e=>{if(!e)return"未知";try{return new Date(e).toLocaleDateString("zh-CN")}catch{return"未知"}},N=()=>d.o.info("宗门任务（功能开发中）"),E=()=>d.o.info("贡献兑换（功能开发中）"),V=()=>d.o.info("宗门藏书（功能开发中）"),C=()=>d.o.info("同门师兄弟（功能开发中）"),z=async()=>{try{await n.syncFromTavern()}catch(e){console.error("[宗门系统] 同步失败:",e),d.o.error("同步失败: "+(e instanceof Error?e.message:"未知错误"))}},S=()=>{n.reloadFromStorage(),d.o.info("已强制刷新数据")};return(0,a.onMounted)(()=>{console.log("[宗门系统] 宗门势力面板已载入"),console.log("[宗门系统] characterStore状态:",n),console.log("[宗门系统] activeSaveSlot:",n.activeSaveSlot),console.log("[宗门系统] 存档数据:",o.value),console.log("[宗门系统] 世界信息:",o.value?.世界信息),console.log("[宗门系统] 势力信息:",o.value?.世界信息?.势力信息),console.log("[宗门系统] sectSystemData:",c.value),console.log("[宗门系统] filteredSects:",p.value),setInterval(()=>{console.log("[宗门系统] 定时检查 - 筛选后宗门数量:",p.value?.length||0),console.log("[宗门系统] 定时检查 - 是否加载中:",r.value),console.log("[宗门系统] 定时检查 - 存档数据存在:",!!o.value),console.log("[宗门系统] 定时检查 - 世界信息存在:",!!o.value?.世界信息),console.log("[宗门系统] 定时检查 - 势力信息存在:",!!o.value?.世界信息?.势力信息)},5e3)}),(e,n)=>{return(0,a.openBlock)(),(0,a.createElementBlock)("div",ej,[(0,a.createElementVNode)("div",nj,[(0,a.createElementVNode)("div",tj,[(0,a.createCommentVNode)(" 左侧：宗门列表 "),(0,a.createElementVNode)("div",aj,[(0,a.createElementVNode)("div",oj,[n[2]||(n[2]=(0,a.createElementVNode)("h3",{class:"panel-title"},"势力宗门",-1)),(0,a.createElementVNode)("div",rj,[(0,a.createVNode)((0,a.unref)(Hk),{size:16}),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),placeholder:"搜索宗门...",class:"search-input"},null,512),[[a.vModelText,i.value]])])]),(0,a.createElementVNode)("div",lj,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",ij,[(0,a.createVNode)((0,a.unref)(Cv),{size:32,class:"animate-spin"}),n[3]||(n[3]=(0,a.createElementVNode)("p",null,"正在读取宗门信息...",-1))])):0===p.value.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",cj,[(0,a.createVNode)((0,a.unref)(UT),{size:48,class:"empty-icon"}),n[5]||(n[5]=(0,a.createElementVNode)("p",{class:"empty-text"},"暂无宗门信息",-1)),n[6]||(n[6]=(0,a.createElementVNode)("p",{class:"empty-hint"},"世界信息将由AI根据游戏进程生成",-1)),(0,a.createCommentVNode)(" 调试信息显示 "),(0,a.createElementVNode)("div",sj,[(0,a.createElementVNode)("details",null,[n[4]||(n[4]=(0,a.createElementVNode)("summary",{style:{cursor:"pointer"}},"调试信息 (点击展开)",-1)),(0,a.createElementVNode)("div",dj,[(0,a.createElementVNode)("p",null,"存档数据存在: "+(0,a.toDisplayString)(!!(0,a.unref)(o)),1),(0,a.createElementVNode)("p",null,"存档数据字段: "+(0,a.toDisplayString)((0,a.unref)(o)?Object.keys((0,a.unref)(o)).join(", "):"无"),1),(0,a.createElementVNode)("p",null,"世界信息存在: "+(0,a.toDisplayString)(!!(0,a.unref)(o)?.世界信息),1),(0,a.createElementVNode)("p",null,"世界信息.势力信息存在: "+(0,a.toDisplayString)(!!(0,a.unref)(o)?.世界信息?.势力信息),1),(0,a.createElementVNode)("p",null,"世界信息.势力信息数量: "+(0,a.toDisplayString)((0,a.unref)(o)?.世界信息?.势力信息?.length||0),1),(0,a.createElementVNode)("p",null,"宗门系统存在: "+(0,a.toDisplayString)(!!(0,a.unref)(o)?.宗门系统),1),(0,a.createElementVNode)("p",null,"宗门系统.availableSects数量: "+(0,a.toDisplayString)((0,a.unref)(o)?.宗门系统?.availableSects?.length||0),1),(0,a.createElementVNode)("p",null,"筛选后数量: "+(0,a.toDisplayString)(p.value.length),1),(0,a.createElementVNode)("button",{onClick:z,style:{"margin-top":"0.5rem",padding:"0.25rem 0.5rem",background:"#22c55e",color:"white",border:"none","border-radius":"4px",cursor:"pointer"}}," 从酒馆同步数据 "),(0,a.createElementVNode)("button",{onClick:S,style:{"margin-top":"0.5rem",padding:"0.25rem 0.5rem",background:"#f59e0b",color:"white",border:"none","border-radius":"4px",cursor:"pointer","margin-left":"0.5rem"}}," 强制刷新 ")])])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",mj,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(p.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.名称,class:(0,a.normalizeClass)(["sect-card",{selected:l.value?.名称===e.名称,[`type-${y(e.类型)}`]:!0,"can-join":e.canJoin}]),onClick:n=>(e=>{l.value=l.value?.名称===e.名称?null:e})(e)},[(0,a.createElementVNode)("div",vj,[(0,a.createElementVNode)("span",uj,(0,a.toDisplayString)(h(e.类型)),1)]),(0,a.createElementVNode)("div",gj,[(0,a.createElementVNode)("div",fj,(0,a.toDisplayString)(e.名称),1),(0,a.createElementVNode)("div",bj,[(0,a.createElementVNode)("span",hj,(0,a.toDisplayString)(e.类型),1)])]),(0,a.createVNode)((0,a.unref)(rc),{size:16,class:"arrow-icon"})],10,pj))),128))]))])]),(0,a.createCommentVNode)(" 右侧：宗门详情 "),(0,a.createElementVNode)("div",yj,[l.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",xj,[(0,a.createCommentVNode)(" 详情头部 "),(0,a.createElementVNode)("div",kj,[(0,a.createElementVNode)("div",wj,[(0,a.createElementVNode)("span",Nj,(0,a.toDisplayString)(h(l.value.类型)),1)]),(0,a.createElementVNode)("div",Ej,[(0,a.createElementVNode)("h3",Vj,(0,a.toDisplayString)(l.value.名称),1),(0,a.createElementVNode)("div",Cj,[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["type-badge",`type-${y(l.value.类型)}`])},(0,a.toDisplayString)(l.value.类型),3),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["level-badge",`level-${l.value.等级}`])},(0,a.toDisplayString)((D=l.value.等级,D?D.includes("宗门")?D:D+"宗门":"未知")),3)])])]),(0,a.createCommentVNode)(" 详情主体 "),(0,a.createElementVNode)("div",zj,[(0,a.createCommentVNode)(" 基础信息 "),(0,a.createElementVNode)("div",Sj,[(0,a.createElementVNode)("h5",Bj,[(0,a.createVNode)((0,a.unref)(UT),{size:16}),n[7]||(n[7]=(0,a.createElementVNode)("span",null,"基础信息",-1))]),(0,a.createElementVNode)("div",Dj,[(0,a.createElementVNode)("div",Aj,[n[8]||(n[8]=(0,a.createElementVNode)("span",{class:"info-label"},"宗门类型",-1)),(0,a.createElementVNode)("span",_j,(0,a.toDisplayString)(l.value.类型),1)]),(0,a.createElementVNode)("div",$j,[n[9]||(n[9]=(0,a.createElementVNode)("span",{class:"info-label"},"宗门等级",-1)),(0,a.createElementVNode)("span",Ij,(0,a.toDisplayString)(l.value.等级),1)]),(0,a.createElementVNode)("div",Tj,[n[10]||(n[10]=(0,a.createElementVNode)("span",{class:"info-label"},"所在大洲",-1)),(0,a.createElementVNode)("span",jj,(0,a.toDisplayString)(v(l.value)),1)]),(0,a.createElementVNode)("div",Mj,[n[11]||(n[11]=(0,a.createElementVNode)("span",{class:"info-label"},"主要资源",-1)),(0,a.createElementVNode)("span",qj,(0,a.toDisplayString)(u(l.value)),1)])]),(0,a.createCommentVNode)(" 宗门领导层 "),l.value.leadership?((0,a.openBlock)(),(0,a.createElementBlock)("div",Oj,[n[16]||(n[16]=(0,a.createElementVNode)("h6",{class:"leadership-title"},"宗门领导",-1)),(0,a.createElementVNode)("div",Pj,[(0,a.createElementVNode)("div",Fj,[n[12]||(n[12]=(0,a.createElementVNode)("span",{class:"leader-role"},"宗主",-1)),(0,a.createElementVNode)("span",Lj,(0,a.toDisplayString)(l.value.leadership.宗主),1),l.value.leadership.宗主修为?((0,a.openBlock)(),(0,a.createElementBlock)("span",Yj,(0,a.toDisplayString)(l.value.leadership.宗主修为),1)):(0,a.createCommentVNode)("v-if",!0)]),l.value.leadership.副宗主?((0,a.openBlock)(),(0,a.createElementBlock)("div",Rj,[n[13]||(n[13]=(0,a.createElementVNode)("span",{class:"leader-role"},"副宗主",-1)),(0,a.createElementVNode)("span",Uj,(0,a.toDisplayString)(l.value.leadership.副宗主),1)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",Gj,[(0,a.createElementVNode)("div",Wj,[n[14]||(n[14]=(0,a.createElementVNode)("span",{class:"strength-label"},"最强修为",-1)),(0,a.createElementVNode)("span",Jj,(0,a.toDisplayString)(l.value.leadership.最强修为),1)]),l.value.leadership?.综合战力?((0,a.openBlock)(),(0,a.createElementBlock)("div",Hj,[n[15]||(n[15]=(0,a.createElementVNode)("span",{class:"strength-label"},"综合战力",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["strength-value power-rating",(B=l.value.leadership.综合战力||0,B>=90?"power-legendary":B>=80?"power-supreme":B>=70?"power-strong":B>=60?"power-good":B>=50?"power-average":B>=40?"power-weak":"power-poor")])},[(0,a.createTextVNode)((0,a.toDisplayString)(l.value.leadership.综合战力||0)+"/100 ",1),(0,a.createElementVNode)("span",Qj,"("+(0,a.toDisplayString)(x(l.value.leadership.综合战力||0))+")",1)],2)])):(0,a.createCommentVNode)("v-if",!0)])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 领导层信息缺失提示 "),n[17]||(n[17]=(0,a.createElementVNode)("div",{class:"missing-data-notice"},[(0,a.createElementVNode)("h6",{class:"notice-title"},"宗门领导信息"),(0,a.createElementVNode)("p",{class:"notice-text"},"暂无详细的宗门领导层信息"),(0,a.createElementVNode)("p",{class:"notice-hint"},"需要重新生成世界数据以获取完整信息")],-1))],2112)),(0,a.createElementVNode)("div",Kj,[n[18]||(n[18]=(0,a.createElementVNode)("h6",{class:"desc-title"},"宗门描述",-1)),(0,a.createElementVNode)("p",Xj,(0,a.toDisplayString)(l.value.描述),1)]),(0,a.createCommentVNode)(" 宗门特色 "),g(l.value).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",Zj,[n[19]||(n[19]=(0,a.createElementVNode)("h6",{class:"specialties-title"},"宗门特色",-1)),(0,a.createElementVNode)("div",eM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(g(l.value),e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"specialty-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createCommentVNode)(" 成员统计 "),l.value.memberCount?((0,a.openBlock)(),(0,a.createElementBlock)("div",nM,[(0,a.createElementVNode)("h5",tM,[(0,a.createVNode)((0,a.unref)(zi),{size:16}),n[20]||(n[20]=(0,a.createElementVNode)("span",null,"成员统计",-1))]),(0,a.createElementVNode)("div",aM,[(0,a.createCommentVNode)(" 总体统计 "),(0,a.createElementVNode)("div",oM,[n[21]||(n[21]=(0,a.createElementVNode)("span",{class:"total-label"},"总人数",-1)),(0,a.createElementVNode)("span",rM,(0,a.toDisplayString)(l.value.memberCount.total)+"人",1)]),(0,a.createCommentVNode)(" 境界分布 "),l.value.memberCount.byRealm?((0,a.openBlock)(),(0,a.createElementBlock)("div",lM,[n[22]||(n[22]=(0,a.createElementVNode)("h6",{class:"distribution-title"},"境界分布",-1)),(0,a.createElementVNode)("div",iM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.memberCount.byRealm,(e,n)=>(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"realm-item"},[(0,a.createElementVNode)("span",cM,(0,a.toDisplayString)(n.includes("期")?n:n+"期"),1),(0,a.createElementVNode)("span",sM,(0,a.toDisplayString)(e)+"人",1)])),[[a.vShow,e>0]])),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 职位分布 "),l.value.memberCount.byPosition?((0,a.openBlock)(),(0,a.createElementBlock)("div",dM,[n[23]||(n[23]=(0,a.createElementVNode)("h6",{class:"distribution-title"},"职位分布",-1)),(0,a.createElementVNode)("div",mM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.memberCount.byPosition,(e,n)=>(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:n,class:"position-item"},[(0,a.createElementVNode)("span",pM,(0,a.toDisplayString)(n),1),(0,a.createElementVNode)("span",vM,(0,a.toDisplayString)(e)+"人",1)])),[[a.vShow,e>0]])),128))])])):(0,a.createCommentVNode)("v-if",!0)])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(" 成员统计缺失提示 "),(0,a.createElementVNode)("div",uM,[(0,a.createElementVNode)("h5",gM,[(0,a.createVNode)((0,a.unref)(zi),{size:16}),n[24]||(n[24]=(0,a.createElementVNode)("span",null,"成员统计",-1))]),n[25]||(n[25]=(0,a.createElementVNode)("div",{class:"notice-content"},[(0,a.createElementVNode)("p",{class:"notice-text"},"暂无详细的成员统计信息"),(0,a.createElementVNode)("p",{class:"notice-hint"},"包括境界分布、职位分布等数据需要重新生成世界获取")],-1))])],2112)),(0,a.createCommentVNode)(" 关系状态 "),(0,a.createElementVNode)("div",fM,[(0,a.createElementVNode)("h5",bM,[(0,a.createVNode)((0,a.unref)(Pc),{size:16}),n[26]||(n[26]=(0,a.createElementVNode)("span",null,"关系状态",-1))]),(0,a.createElementVNode)("div",hM,[(0,a.createElementVNode)("div",yM,[n[27]||(n[27]=(0,a.createElementVNode)("span",{class:"relationship-label"},"与你的关系",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["relationship-value",(m=f(l.value.与玩家关系),{仇敌:"enemy",敌对:"hostile",冷淡:"cold",中立:"neutral",友好:"friendly",盟友:"ally",附庸:"vassal"}[m]||"neutral")])},(0,a.toDisplayString)(f(l.value.与玩家关系)),3)]),(0,a.createElementVNode)("div",xM,[n[28]||(n[28]=(0,a.createElementVNode)("span",{class:"relationship-label"},"声望值",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["relationship-value reputation-value",(c=b(l.value.声望值),c>=25?"reputation-legendary":c>=20?"reputation-excellent":c>=15?"reputation-good":c>=10?"reputation-fair":c>=5?"reputation-low":"reputation-none")])},[(0,a.createTextVNode)((0,a.toDisplayString)(b(l.value.声望值))+" ",1),(0,a.createElementVNode)("span",kM,"("+(0,a.toDisplayString)(k(b(l.value.声望值)))+")",1)],2)])])]),(0,a.createCommentVNode)(" 势力范围 "),l.value.territoryInfo?((0,a.openBlock)(),(0,a.createElementBlock)("div",wM,[(0,a.createElementVNode)("h5",NM,[(0,a.createVNode)((0,a.unref)(_i),{size:16}),n[29]||(n[29]=(0,a.createElementVNode)("span",null,"势力范围",-1))]),(0,a.createElementVNode)("div",EM,[(0,a.createElementVNode)("div",VM,[n[30]||(n[30]=(0,a.createElementVNode)("strong",null,"影响范围：",-1)),(0,a.createTextVNode)((0,a.toDisplayString)(l.value.territoryInfo.influenceRange||"未知"),1)]),l.value.territoryInfo.controlledAreas?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",CM,[n[31]||(n[31]=(0,a.createElementVNode)("strong",null,"控制区域：",-1)),(0,a.createElementVNode)("div",zM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.territoryInfo.controlledAreas,e=>((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:e,class:"area-tag"},(0,a.toDisplayString)(e),1))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createElementVNode)("div",SM,[n[32]||(n[32]=(0,a.createElementVNode)("strong",null,"战略价值：",-1)),(0,a.createElementVNode)("div",BM,[(0,a.createElementVNode)("div",DM,[(0,a.createElementVNode)("div",{class:"value-fill",style:(0,a.normalizeStyle)({width:10*(l.value.territoryInfo.strategicValue||5)+"%"})},null,4)]),(0,a.createElementVNode)("span",AM,(0,a.toDisplayString)(l.value.territoryInfo.strategicValue||5)+"/10",1)])])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 加入条件 "),l.value.canJoin?((0,a.openBlock)(),(0,a.createElementBlock)("div",_M,[(0,a.createElementVNode)("h5",$M,[(0,a.createVNode)((0,a.unref)(GT),{size:16}),n[33]||(n[33]=(0,a.createElementVNode)("span",null,"加入条件",-1))]),(0,a.createElementVNode)("div",IM,[l.value.joinRequirements?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",TM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.joinRequirements,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"requirement-item"},[(0,a.createVNode)((0,a.unref)(WT),{size:14,class:"requirement-icon"}),(0,a.createElementVNode)("span",jM,(0,a.toDisplayString)(e),1)]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",MM,n[34]||(n[34]=[(0,a.createElementVNode)("p",null,"暂无特殊加入条件",-1)])))]),(0,a.createCommentVNode)(" 加入好处 "),l.value.benefits?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",qM,[n[35]||(n[35]=(0,a.createElementVNode)("h6",{class:"benefits-title"},"加入好处",-1)),(0,a.createElementVNode)("div",OM,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value.benefits,e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e,class:"benefit-item"},[(0,a.createVNode)((0,a.unref)(JT),{size:14,class:"benefit-icon"}),(0,a.createElementVNode)("span",PM,(0,a.toDisplayString)(e),1)]))),128))])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 加入按钮 "),(0,a.createElementVNode)("div",FM,[(0,a.createElementVNode)("button",{class:"join-btn",onClick:n[1]||(n[1]=e=>{return n=l.value,void d.o.info(`申请加入 ${n.名称}（功能开发中）`);var n})},[(0,a.createVNode)((0,a.unref)(GT),{size:16}),n[36]||(n[36]=(0,a.createElementVNode)("span",null,"申请加入",-1))])])])):(0,a.createCommentVNode)("v-if",!0),(0,a.createCommentVNode)(" 已加入宗门信息 "),(t=l.value,s.value?.sectName===t.名称?((0,a.openBlock)(),(0,a.createElementBlock)("div",LM,[(0,a.createElementVNode)("h5",YM,[(0,a.createVNode)((0,a.unref)(HT),{size:16}),n[37]||(n[37]=(0,a.createElementVNode)("span",null,"我的宗门身份",-1))]),(0,a.createElementVNode)("div",RM,[(0,a.createElementVNode)("div",UM,[(0,a.createElementVNode)("div",GM,[n[38]||(n[38]=(0,a.createElementVNode)("span",{class:"status-label"},"职位",-1)),(0,a.createElementVNode)("span",WM,(0,a.toDisplayString)(s.value?.position||"散修"),1)]),(0,a.createElementVNode)("div",JM,[n[39]||(n[39]=(0,a.createElementVNode)("span",{class:"status-label"},"贡献点",-1)),(0,a.createElementVNode)("span",HM,(0,a.toDisplayString)(s.value?.contribution||0),1)]),(0,a.createElementVNode)("div",QM,[n[40]||(n[40]=(0,a.createElementVNode)("span",{class:"status-label"},"声望",-1)),(0,a.createElementVNode)("span",KM,(0,a.toDisplayString)(s.value?.reputation||0),1)]),(0,a.createElementVNode)("div",XM,[n[41]||(n[41]=(0,a.createElementVNode)("span",{class:"status-label"},"加入时间",-1)),(0,a.createElementVNode)("span",ZM,(0,a.toDisplayString)(w(s.value?.joinDate)),1)])])]),(0,a.createCommentVNode)(" 宗门任务 "),(0,a.createElementVNode)("div",eq,[n[46]||(n[46]=(0,a.createElementVNode)("h6",{class:"actions-title"},"宗门势力",-1)),(0,a.createElementVNode)("div",nq,[(0,a.createElementVNode)("button",{class:"sect-action-btn",onClick:N},[(0,a.createVNode)((0,a.unref)(Di),{size:16}),n[42]||(n[42]=(0,a.createElementVNode)("span",null,"宗门任务",-1))]),(0,a.createElementVNode)("button",{class:"sect-action-btn",onClick:E},[(0,a.createVNode)((0,a.unref)(QT),{size:16}),n[43]||(n[43]=(0,a.createElementVNode)("span",null,"贡献兑换",-1))]),(0,a.createElementVNode)("button",{class:"sect-action-btn",onClick:V},[(0,a.createVNode)((0,a.unref)(KT),{size:16}),n[44]||(n[44]=(0,a.createElementVNode)("span",null,"宗门藏书",-1))]),(0,a.createElementVNode)("button",{class:"sect-action-btn",onClick:C},[(0,a.createVNode)((0,a.unref)(zi),{size:16}),n[45]||(n[45]=(0,a.createElementVNode)("span",null,"同门师兄弟",-1))])])])])):(0,a.createCommentVNode)("v-if",!0))])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",tq,[(0,a.createVNode)((0,a.unref)(UT),{size:64,class:"placeholder-icon"}),n[47]||(n[47]=(0,a.createElementVNode)("p",{class:"placeholder-text"},"选择一个宗门查看详细信息",-1)),n[48]||(n[48]=(0,a.createElementVNode)("p",{class:"placeholder-hint"},"尘世间的宗门势力等你探索",-1))]))])])])]);var t,c,m,B,D}}});var oq=t(9074),rq={};rq.styleTagTransform=A(),rq.setAttributes=z(),rq.insert=V().bind(null,"head"),rq.domAPI=N(),rq.insertStyleElement=B(),k()(oq.A,rq),oq.A&&oq.A.locals&&oq.A.locals;const lq=(0,j.A)(aq,[["__scopeId","data-v-f9a2cde8"]]),iq={class:"tavern-data-header"},cq={class:"panel-header"},sq={class:"panel-title"},dq={class:"header-actions"},mq={class:"search-bar"},pq=["value"],vq=(0,a.defineComponent)({__name:"TavernDataHeader",props:{isRefreshing:{type:Boolean},searchQuery:{}},emits:["update:search-query","refresh","export","show-stats"],setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",iq,[(0,a.createElementVNode)("div",cq,[(0,a.createElementVNode)("h2",sq,[(0,a.createVNode)((0,a.unref)(Ii),{size:20}),n[1]||(n[1]=(0,a.createElementVNode)("span",null,"酒馆数据查看",-1))]),(0,a.createElementVNode)("div",dq,[(0,a.createElementVNode)("div",mq,[(0,a.createVNode)((0,a.unref)(Hk),{size:16}),(0,a.createElementVNode)("input",{value:e.searchQuery,onInput:n[0]||(n[0]=n=>e.$emit("update:search-query",n.target.value)),placeholder:"搜索数据...",class:"search-input"},null,40,pq)])])])]))});var uq=t(7281),gq={};gq.styleTagTransform=A(),gq.setAttributes=z(),gq.insert=V().bind(null,"head"),gq.domAPI=N(),gq.insertStyleElement=B(),k()(uq.A,gq),uq.A&&uq.A.locals&&uq.A.locals;const fq=(0,j.A)(vq,[["__scopeId","data-v-1f5353f3"]]),bq={class:"data-status"},hq={class:"status-item"},yq={class:"status-item"},xq={class:"status-value"},kq=(0,a.defineComponent)({__name:"TavernDataStatus",props:{tavernConnected:{type:Boolean},lastUpdateTime:{}},setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",bq,[(0,a.createElementVNode)("div",hq,[n[0]||(n[0]=(0,a.createElementVNode)("span",{class:"status-label"},"连接状态:",-1)),(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(["status-value",{connected:e.tavernConnected,disconnected:!e.tavernConnected}])},(0,a.toDisplayString)(e.tavernConnected?"已连接":"未连接"),3)]),(0,a.createElementVNode)("div",yq,[n[1]||(n[1]=(0,a.createElementVNode)("span",{class:"status-label"},"数据更新时间:",-1)),(0,a.createElementVNode)("span",xq,(0,a.toDisplayString)(e.lastUpdateTime||"从未更新"),1)])]))});var wq=t(4381),Nq={};Nq.styleTagTransform=A(),Nq.setAttributes=z(),Nq.insert=V().bind(null,"head"),Nq.domAPI=N(),Nq.insertStyleElement=B(),k()(wq.A,Nq),wq.A&&wq.A.locals&&wq.A.locals;const Eq=(0,j.A)(kq,[["__scopeId","data-v-45214445"]]),Vq=(0,c.A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),Cq=(0,c.A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),zq=(0,c.A)("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]),Sq={class:"data-type-selector"},Bq=["onClick"],Dq={key:0,class:"count-badge"},Aq=(0,a.defineComponent)({__name:"TavernDataSelector",props:{dataTypes:{},selectedType:{},getDataCount:{type:Function}},emits:["update:selected-type"],setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Sq,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.dataTypes,n=>{return(0,a.openBlock)(),(0,a.createElementBlock)("button",{key:n.key,onClick:t=>e.$emit("update:selected-type",n.key),class:(0,a.normalizeClass)(["type-btn",{active:e.selectedType===n.key}])},[((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)((t=n.icon,{MessageSquare:Vq,Globe:lc,Users:zi,Archive:Cq,Book:KT,Brain:Ci,Code:zq}[t]||zq)),{size:16})),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.label),1),e.getDataCount(n.key)>0?((0,a.openBlock)(),(0,a.createElementBlock)("span",Dq,(0,a.toDisplayString)(e.getDataCount(n.key)),1)):(0,a.createCommentVNode)("v-if",!0)],10,Bq);var t}),128))]))});var _q=t(6597),$q={};$q.styleTagTransform=A(),$q.setAttributes=z(),$q.insert=V().bind(null,"head"),$q.domAPI=N(),$q.insertStyleElement=B(),k()(_q.A,$q),_q.A&&_q.A.locals&&_q.A.locals;const Iq=(0,j.A)(Aq,[["__scopeId","data-v-b66d579e"]]),Tq=(0,c.A)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),jq=(0,c.A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Mq={class:"variable-section"},qq={class:"section-header"},Oq={class:"section-title"},Pq={class:"variable-content"},Fq={key:0,class:"variable-list"},Lq={class:"variable-header"},Yq={class:"variable-key"},Rq={class:"variable-type"},Uq={class:"variable-actions"},Gq=["onClick"],Wq=["onClick"],Jq=["onClick"],Hq={class:"variable-value"},Qq={key:0,class:"code-pre"},Kq={key:1},Xq={key:1,class:"empty-state"},Zq={key:0},eO={key:1},nO={class:"debug-info"},tO={class:"debug-content"},aO={class:"debug-actions"},oO=(0,a.defineComponent)({__name:"TavernVariableSection",props:{type:{},variables:{},searchQuery:{},chatVariables:{},globalVariables:{}},emits:["edit-variable","copy-variable","delete-variable","add-new-variable","debug-log"],setup(e){const n=e=>null===e?"null":void 0===e?"undefined":Array.isArray(e)?`array[${e.length}]`:"object"==typeof e?`object{${Object.keys(e).length}}`:typeof e;return(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",Mq,[(0,a.createElementVNode)("div",qq,[(0,a.createElementVNode)("h3",Oq,(0,a.toDisplayString)("chat"===e.type?"Chat Variables (聊天变量)":"Global Variables (全局变量)"),1),(0,a.createElementVNode)("button",{onClick:t[0]||(t[0]=n=>e.$emit("add-new-variable",e.type)),class:"add-btn"},[(0,a.createVNode)((0,a.unref)(Ce),{size:14}),t[2]||(t[2]=(0,a.createElementVNode)("span",null,"新增变量",-1))])]),(0,a.createElementVNode)("div",Pq,[Object.keys(e.variables).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",Fq,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.variables,(t,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:o,class:"variable-item"},[(0,a.createElementVNode)("div",Lq,[(0,a.createElementVNode)("span",Yq,(0,a.toDisplayString)(o),1),(0,a.createElementVNode)("span",Rq,(0,a.toDisplayString)(n(t)),1),(0,a.createElementVNode)("div",Uq,[(0,a.createElementVNode)("button",{onClick:n=>e.$emit("edit-variable",{type:e.type,key:o,value:t}),class:"action-btn edit",title:"编辑"},[(0,a.createVNode)((0,a.unref)(Tq),{size:12})],8,Gq),(0,a.createElementVNode)("button",{onClick:n=>e.$emit("copy-variable",{key:o,value:t}),class:"action-btn copy",title:"复制"},[(0,a.createVNode)((0,a.unref)(jq),{size:12})],8,Wq),(0,a.createElementVNode)("button",{onClick:n=>e.$emit("delete-variable",{type:e.type,key:o}),class:"action-btn delete",title:"删除"},[(0,a.createVNode)((0,a.unref)(Gn.A),{size:12})],8,Jq)])]),(0,a.createElementVNode)("div",Hq,["object"==typeof t?((0,a.openBlock)(),(0,a.createElementBlock)("pre",Qq,(0,a.toDisplayString)(JSON.stringify(t,null,2)),1)):((0,a.openBlock)(),(0,a.createElementBlock)("span",Kq,(0,a.toDisplayString)(t),1))])]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",Xq,[(0,a.createVNode)((0,a.unref)(Ei),{size:32}),e.searchQuery?((0,a.openBlock)(),(0,a.createElementBlock)("p",Zq,"无匹配的变量")):((0,a.openBlock)(),(0,a.createElementBlock)("p",eO,(0,a.toDisplayString)("chat"===e.type?"暂无聊天变量":"暂无全局变量"),1)),(0,a.createElementVNode)("div",nO,[(0,a.createElementVNode)("details",null,[t[4]||(t[4]=(0,a.createElementVNode)("summary",null,"🔍 调试信息 (点击展开)",-1)),(0,a.createElementVNode)("div",tO,[t[3]||(t[3]=(0,a.createElementVNode)("p",null,[(0,a.createElementVNode)("strong",null,"连接状态:"),(0,a.createTextVNode)(" ✅已连接")],-1)),(0,a.createElementVNode)("p",null,[(0,a.createElementVNode)("strong",null,(0,a.toDisplayString)("chat"===e.type?"聊天":"全局")+"变量数量:",1),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(Object.keys("chat"===e.type?e.chatVariables:e.globalVariables).length),1)]),(0,a.createElementVNode)("div",aO,[(0,a.createElementVNode)("button",{onClick:t[1]||(t[1]=n=>e.$emit("debug-log")),class:"debug-btn"}," 🖼️ 控制台输出 ")])])])])]))])]))}});var rO=t(6973),lO={};lO.styleTagTransform=A(),lO.setAttributes=z(),lO.insert=V().bind(null,"head"),lO.domAPI=N(),lO.insertStyleElement=B(),k()(rO.A,lO),rO.A&&rO.A.locals&&rO.A.locals;const iO=(0,j.A)(oO,[["__scopeId","data-v-28e177ee"]]),cO={class:"character-section"},sO={key:0,class:"character-info"},dO={class:"info-grid"},mO={class:"info-item"},pO={class:"info-value"},vO={class:"info-item"},uO={class:"info-value"},gO={class:"data-detail"},fO={class:"code-pre"},bO={key:1,class:"empty-state"},hO=(0,a.defineComponent)({__name:"TavernCharacterSection",props:{characterData:{}},setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",cO,[n[4]||(n[4]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h3",{class:"section-title"},"Character Data (角色数据)")],-1)),e.characterData?((0,a.openBlock)(),(0,a.createElementBlock)("div",sO,[(0,a.createElementVNode)("div",dO,[(0,a.createElementVNode)("div",mO,[n[0]||(n[0]=(0,a.createElementVNode)("span",{class:"info-label"},"角色名称:",-1)),(0,a.createElementVNode)("span",pO,(0,a.toDisplayString)(e.characterData?.name||e.characterData?.名字||"未知"),1)]),(0,a.createElementVNode)("div",vO,[n[1]||(n[1]=(0,a.createElementVNode)("span",{class:"info-label"},"角色ID:",-1)),(0,a.createElementVNode)("span",uO,(0,a.toDisplayString)(e.characterData?.id||"未知"),1)])]),(0,a.createElementVNode)("div",gO,[n[2]||(n[2]=(0,a.createElementVNode)("h4",{class:"detail-title"},"完整角色数据:",-1)),(0,a.createElementVNode)("pre",fO,(0,a.toDisplayString)(JSON.stringify(e.characterData,null,2)),1)])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",bO,[(0,a.createVNode)((0,a.unref)(zi),{size:32}),n[3]||(n[3]=(0,a.createElementVNode)("p",null,"暂无角色数据",-1))]))]))});var yO=t(1021),xO={};xO.styleTagTransform=A(),xO.setAttributes=z(),xO.insert=V().bind(null,"head"),xO.domAPI=N(),xO.insertStyleElement=B(),k()(yO.A,xO),yO.A&&yO.A.locals&&yO.A.locals;const kO=(0,j.A)(hO,[["__scopeId","data-v-6885fec6"]]),wO={class:"save-data-section"},NO={class:"save-data-content"},EO={key:0,class:"data-tree"},VO={key:1,class:"empty-state"},CO=(0,a.defineComponent)({__name:"TavernSaveDataSection",props:{saveData:{}},setup(e){const n=(0,a.defineAsyncComponent)(()=>Promise.resolve().then(t.bind(t,2231))),o=(0,tn.useCharacterStore)(),r=async e=>{if(bg.Yz.log("[TavernSaveData]",`请求删除: ${e}`),confirm(`确定要删除此项目吗？\n路径: ${e}\n\n此操作不可撤销！`))try{const n=e.split("."),t=o.activeSaveSlot;if(!t||!t.存档数据)throw new Error("没有激活的存档数据");const a=JSON.parse(JSON.stringify(t.存档数据));let r=a;for(let t=0;t<n.length-1;t++)if(r=r[n[t]],void 0===r)throw new Error(`路径无效: ${e}`);delete r[n[n.length-1]],await o.updateSaveDataDirectly(a),await o.syncToTavernAndSave({fullSync:!0}),d.o.success(`项目 ${e} 已删除`),bg.Yz.log("[TavernSaveData]",`成功删除并同步: ${e}`)}catch(e){bg.Yz.error("[TavernSaveData]","删除失败",e),d.o.error(`删除失败: ${e instanceof Error?e.message:"未知错误"}`)}};return(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",wO,[t[1]||(t[1]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h3",{class:"section-title"},"Save Data (存档数据)")],-1)),(0,a.createElementVNode)("div",NO,[e.saveData&&Object.keys(e.saveData).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",EO,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.saveData,(e,t)=>((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(n),{key:t,"node-key":t,value:e,path:String(t),onDeleteItem:r},null,8,["node-key","value","path"]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",VO,[(0,a.createVNode)((0,a.unref)(Cq),{size:32}),t[0]||(t[0]=(0,a.createElementVNode)("p",null,"暂无存档数据",-1))]))])]))}});var zO=t(8264),SO={};SO.styleTagTransform=A(),SO.setAttributes=z(),SO.insert=V().bind(null,"head"),SO.domAPI=N(),SO.insertStyleElement=B(),k()(zO.A,SO),zO.A&&zO.A.locals&&zO.A.locals;const BO=(0,j.A)(CO,[["__scopeId","data-v-0e1d4ac2"]]),DO={class:"world-info-section"},AO={class:"world-info-content"},_O={key:0,class:"data-display"},$O={class:"code-pre"},IO={key:1,class:"empty-state"},TO=(0,a.defineComponent)({__name:"TavernWorldInfoSection",props:{worldInfo:{}},setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",DO,[n[1]||(n[1]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h3",{class:"section-title"},"World Info (世界信息)")],-1)),(0,a.createElementVNode)("div",AO,[e.worldInfo&&Object.keys(e.worldInfo).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",_O,[(0,a.createElementVNode)("pre",$O,(0,a.toDisplayString)(JSON.stringify(e.worldInfo,null,2)),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",IO,[(0,a.createVNode)((0,a.unref)(KT),{size:32}),n[0]||(n[0]=(0,a.createElementVNode)("p",null,"暂无世界信息",-1))]))])]))});var jO=t(7816),MO={};MO.styleTagTransform=A(),MO.setAttributes=z(),MO.insert=V().bind(null,"head"),MO.domAPI=N(),MO.insertStyleElement=B(),k()(jO.A,MO),jO.A&&jO.A.locals&&jO.A.locals;const qO=(0,j.A)(TO,[["__scopeId","data-v-23f9de7c"]]),OO={class:"memory-section"},PO={class:"memory-content"},FO={key:0,class:"data-display"},LO={class:"code-pre"},YO={key:1,class:"empty-state"},RO=(0,a.defineComponent)({__name:"TavernMemorySection",props:{memoryData:{}},setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",OO,[n[1]||(n[1]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h3",{class:"section-title"},"Memory Data (记忆数据)")],-1)),(0,a.createElementVNode)("div",PO,[e.memoryData&&Object.keys(e.memoryData).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",FO,[(0,a.createElementVNode)("pre",LO,(0,a.toDisplayString)(JSON.stringify(e.memoryData,null,2)),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",YO,[(0,a.createVNode)((0,a.unref)(Ci),{size:32}),n[0]||(n[0]=(0,a.createElementVNode)("p",null,"暂无记忆数据",-1))]))])]))});var UO=t(6478),GO={};GO.styleTagTransform=A(),GO.setAttributes=z(),GO.insert=V().bind(null,"head"),GO.domAPI=N(),GO.insertStyleElement=B(),k()(UO.A,GO),UO.A&&UO.A.locals&&UO.A.locals;const WO=(0,j.A)(RO,[["__scopeId","data-v-70b78bf0"]]),JO={class:"raw-data-section"},HO={class:"raw-data-content"},QO={key:0,class:"data-display"},KO={class:"code-pre"},XO={key:1,class:"empty-state"},ZO=(0,a.defineComponent)({__name:"TavernRawDataSection",props:{allTavernData:{}},setup:e=>(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",JO,[n[1]||(n[1]=(0,a.createElementVNode)("div",{class:"section-header"},[(0,a.createElementVNode)("h3",{class:"section-title"},"Raw Data (原始数据)")],-1)),(0,a.createElementVNode)("div",HO,[e.allTavernData&&Object.keys(e.allTavernData).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",QO,[(0,a.createElementVNode)("pre",KO,(0,a.toDisplayString)(JSON.stringify(e.allTavernData,null,2)),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",XO,[(0,a.createVNode)((0,a.unref)(zq),{size:32}),n[0]||(n[0]=(0,a.createElementVNode)("p",null,"暂无原始数据",-1))]))])]))});var eP=t(600),nP={};nP.styleTagTransform=A(),nP.setAttributes=z(),nP.insert=V().bind(null,"head"),nP.domAPI=N(),nP.insertStyleElement=B(),k()(eP.A,nP),eP.A&&eP.A.locals&&eP.A.locals;const tP=(0,j.A)(ZO,[["__scopeId","data-v-0ef67458"]]),aP={class:"data-display"},oP={key:0,class:"loading-state"},rP={key:1,class:"no-connection"},lP={key:2,class:"data-content"},iP={key:0,class:"error-state"},cP=(0,a.defineComponent)({__name:"TavernDataDisplay",props:{isLoading:{type:Boolean},tavernConnected:{type:Boolean},selectedDataType:{},searchQuery:{},chatVariables:{},globalVariables:{},characterData:{},saveData:{},worldInfo:{},memoryData:{},allTavernData:{},filteredChatVariables:{},filteredGlobalVariables:{}},emits:["edit-variable","copy-variable","delete-variable","add-new-variable","debug-log"],setup(e){const n=e,t=(0,a.ref)(!1),o=()=>{t.value=!1},r=()=>{switch(n.selectedDataType){case"chat":case"global":default:return iO;case"character":return kO;case"saveData":return BO;case"worldInfo":return qO;case"memory":return WO;case"raw":return tP}},l=()=>{const e={searchQuery:n.searchQuery,chatVariables:n.chatVariables||{},globalVariables:n.globalVariables||{}};switch(n.selectedDataType){case"chat":default:return{...e,type:"chat",variables:n.filteredChatVariables||{}};case"global":return{...e,type:"global",variables:n.filteredGlobalVariables||{}};case"character":return{characterData:n.characterData};case"saveData":return{saveData:n.saveData};case"worldInfo":return{worldInfo:n.worldInfo};case"memory":return{memoryData:n.memoryData};case"raw":return{allTavernData:n.allTavernData}}};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",aP,[e.isLoading?((0,a.openBlock)(),(0,a.createElementBlock)("div",oP,[(0,a.createVNode)((0,a.unref)(Cv),{size:32,class:"animate-spin"}),n[5]||(n[5]=(0,a.createElementVNode)("p",null,"正在加载数据...",-1))])):e.tavernConnected?((0,a.openBlock)(),(0,a.createElementBlock)("div",lP,[t.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",iP,[(0,a.createVNode)((0,a.unref)(uf),{size:48}),n[8]||(n[8]=(0,a.createElementVNode)("p",null,"数据显示出错",-1)),n[9]||(n[9]=(0,a.createElementVNode)("p",{class:"hint"},"请尝试刷新数据",-1)),(0,a.createElementVNode)("button",{onClick:o,class:"retry-btn"},"重试")])):((0,a.openBlock)(),(0,a.createBlock)((0,a.resolveDynamicComponent)(r()),(0,a.mergeProps)({key:1},l(),{onEditVariable:n[0]||(n[0]=n=>e.$emit("edit-variable",n)),onCopyVariable:n[1]||(n[1]=n=>e.$emit("copy-variable",n)),onDeleteVariable:n[2]||(n[2]=n=>e.$emit("delete-variable",n)),onAddNewVariable:n[3]||(n[3]=n=>e.$emit("add-new-variable",n)),onDebugLog:n[4]||(n[4]=n=>e.$emit("debug-log"))}),null,16))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",rP,[(0,a.createVNode)((0,a.unref)(uf),{size:48}),n[6]||(n[6]=(0,a.createElementVNode)("p",null,"未检测到酒馆连接",-1)),n[7]||(n[7]=(0,a.createElementVNode)("p",{class:"hint"},"Make sure the SillyTavern extension is enabled",-1))]))]))}});var sP=t(4670),dP={};dP.styleTagTransform=A(),dP.setAttributes=z(),dP.insert=V().bind(null,"head"),dP.domAPI=N(),dP.insertStyleElement=B(),k()(sP.A,dP),sP.A&&sP.A.locals&&sP.A.locals;const mP=(0,j.A)(cP,[["__scopeId","data-v-62ba194a"]]),pP={class:"modal-header"},vP={class:"modal-body"},uP={class:"form-group"},gP=["disabled"],fP={key:0,class:"form-hint-text"},bP={class:"form-group"},hP={class:"value-type-selector"},yP=["onClick"],xP=["placeholder"],kP={key:0,class:"error-message"},wP={key:1,class:"form-hint"},NP={key:0,class:"preview-section"},EP={class:"preview-content"},VP={class:"modal-footer"},CP=["disabled"],zP=(0,a.defineComponent)({__name:"TavernEditModal",props:{editingItem:{}},emits:["close","save"],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)({type:"",key:"",value:""}),l=(0,a.ref)("string"),i=(0,a.ref)(""),c=[{value:"string",label:"字符串"},{value:"number",label:"数字"},{value:"boolean",label:"布尔值"},{value:"object",label:"对象"},{value:"array",label:"数组"}],s=(0,a.computed)({get:()=>{if(!r.value)return"";const e=r.value.value;return"object"==typeof e&&null!==e?JSON.stringify(e,null,2):String(e??"")},set:e=>{r.value&&(r.value.value=e,p())}}),d=(0,a.computed)(()=>{if(i.value||!s.value)return null;try{if("object"===l.value||"array"===l.value){const e=JSON.parse(s.value);return JSON.stringify(e,null,2)}return null}catch{return null}}),m=(0,a.computed)(()=>""!==r.value.key.trim()&&""!==s.value.trim()&&!i.value),p=()=>{if(i.value="",s.value.trim()&&("object"===l.value||"array"===l.value))try{const e=JSON.parse(s.value);"array"!==l.value||Array.isArray(e)?"object"!==l.value||!Array.isArray(e)&&"object"==typeof e||(i.value="期望是对象类型，但解析结果不是对象"):i.value="期望是数组类型，但解析结果不是数组"}catch(e){i.value="JSON 格式错误: "+(e instanceof Error?e.message:"未知错误")}},v=()=>{switch(l.value){case"string":return"请输入字符串值，例如: Hello World";case"number":return"请输入数字值，例如: 123 或 3.14";case"boolean":return"请输入 true 或 false";case"object":return'请输入 JSON 对象，例如: {"name": "张三", "age": 25}';case"array":return'请输入 JSON 数组，例如: [1, 2, 3] 或 ["a", "b", "c"]';default:return"请输入值"}},u=()=>{switch(l.value){case"string":return"✅ 直接输入文本内容即可";case"number":return"✅ 输入数字，支持整数和小数";case"boolean":return"✅ 输入 true 或 false";case"object":return'✅ 使用 JSON 格式，例如: {"key": "value"}';case"array":return"✅ 使用 JSON 数组格式，例如: [1, 2, 3]";default:return"支持字符串、数字、布尔值、对象和数组"}},g=()=>{if(m.value)try{let e=s.value;switch(l.value){case"number":if(e=Number(s.value),isNaN(e))return void(i.value="无效的数字格式");break;case"boolean":e="true"===s.value.toLowerCase();break;case"object":case"array":e=JSON.parse(s.value);break;default:e=s.value}r.value.value=e,o("save",r.value)}catch(e){i.value="保存失败: "+(e instanceof Error?e.message:"未知错误")}};return(0,a.watch)(()=>t.editingItem,e=>{var n;e&&(r.value={...e},l.value=null==(n=e.value)?"string":Array.isArray(n)?"array":"object"==typeof n?"object":"boolean"==typeof n?"boolean":"number"==typeof n?"number":"string",i.value="",p())},{immediate:!0}),(e,n)=>e.editingItem?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:"modal-overlay",onClick:n[5]||(n[5]=n=>e.$emit("close"))},[(0,a.createElementVNode)("div",{class:"modal-content",onClick:n[4]||(n[4]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",pP,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(r.value.key?"编辑变量":"新增变量"),1),(0,a.createElementVNode)("button",{onClick:n[0]||(n[0]=n=>e.$emit("close")),class:"close-btn"},[(0,a.createVNode)((0,a.unref)(Ne),{size:16})])]),(0,a.createElementVNode)("div",vP,[(0,a.createElementVNode)("div",uP,[n[6]||(n[6]=(0,a.createElementVNode)("label",null,"变量名 (Key)",-1)),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>r.value.key=e),class:"form-input",disabled:!!e.editingItem.key,placeholder:"请输入变量名"},null,8,gP),[[a.vModelText,r.value.key]]),e.editingItem.key?((0,a.openBlock)(),(0,a.createElementBlock)("p",fP," ℹ️ 编辑模式下无法修改变量名 ")):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",bP,[n[7]||(n[7]=(0,a.createElementVNode)("label",null,"变量值 (Value)",-1)),(0,a.createElementVNode)("div",hP,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c,e=>(0,a.createElementVNode)("button",{key:e.value,onClick:n=>(e=>{if(l.value=e,!s.value)switch(e){case"string":s.value="";break;case"number":s.value="0";break;case"boolean":s.value="true";break;case"object":s.value="{}";break;case"array":s.value="[]"}p()})(e.value),class:(0,a.normalizeClass)(["type-btn",{active:l.value===e.value}])},(0,a.toDisplayString)(e.label),11,yP)),64))]),(0,a.withDirectives)((0,a.createElementVNode)("textarea",{"onUpdate:modelValue":n[2]||(n[2]=e=>s.value=e),class:(0,a.normalizeClass)(["form-textarea",{"has-error":i.value}]),rows:"10",placeholder:v()},null,10,xP),[[a.vModelText,s.value]]),i.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",kP," ⚠️ "+(0,a.toDisplayString)(i.value),1)):((0,a.openBlock)(),(0,a.createElementBlock)("div",wP,[(0,a.createElementVNode)("p",null,(0,a.toDisplayString)(u()),1)]))]),d.value?((0,a.openBlock)(),(0,a.createElementBlock)("div",NP,[n[8]||(n[8]=(0,a.createElementVNode)("label",null,"预览",-1)),(0,a.createElementVNode)("pre",EP,(0,a.toDisplayString)(d.value),1)])):(0,a.createCommentVNode)("v-if",!0)]),(0,a.createElementVNode)("div",VP,[(0,a.createElementVNode)("button",{onClick:n[3]||(n[3]=n=>e.$emit("close")),class:"cancel-btn"},"取消"),(0,a.createElementVNode)("button",{onClick:g,class:"save-btn",disabled:!m.value},[(0,a.createVNode)((0,a.unref)(Ai),{size:14}),n[9]||(n[9]=(0,a.createElementVNode)("span",null,"保存",-1))],8,CP)])])])):(0,a.createCommentVNode)("v-if",!0)}});var SP=t(6164),BP={};BP.styleTagTransform=A(),BP.setAttributes=z(),BP.insert=V().bind(null,"head"),BP.domAPI=N(),BP.insertStyleElement=B(),k()(SP.A,BP),SP.A&&SP.A.locals&&SP.A.locals;const DP=(0,j.A)(zP,[["__scopeId","data-v-2ee8c39d"]]),AP={class:"modal-header"},_P={class:"modal-body"},$P={class:"stats-grid"},IP={class:"stat-card"},TP={class:"stat-icon chat"},jP={class:"stat-info"},MP={class:"stat-value"},qP={class:"stat-card"},OP={class:"stat-icon global"},PP={class:"stat-info"},FP={class:"stat-value"},LP={class:"stat-card"},YP={class:"stat-icon memory"},RP={class:"stat-info"},UP={class:"stat-value"},GP={class:"stat-card"},WP={class:"stat-icon world"},JP={class:"stat-info"},HP={class:"stat-value"},QP={class:"data-size-info"},KP={class:"size-list"},XP={class:"size-item"},ZP={class:"size-item"},eF={class:"size-item"},nF={class:"data-size-info",style:{"margin-top":"1rem"}},tF={class:"size-list"},aF={style:{"font-family":"monospace","font-size":"0.8rem"}},oF=(0,a.defineComponent)({__name:"TavernStatsModal",props:{chatVariables:{},globalVariables:{},allTavernData:{},getMemoryCount:{type:Function},getWorldItemCount:{type:Function}},emits:["close"],setup(e){const n=e,t=e=>new Blob([JSON.stringify(e)]).size,o=e=>{if(0===e)return"0 Bytes";const n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB"][n]};return(e,r)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"modal-overlay",onClick:r[2]||(r[2]=n=>e.$emit("close"))},[(0,a.createElementVNode)("div",{class:"modal-content stats-modal",onClick:r[1]||(r[1]=(0,a.withModifiers)(()=>{},["stop"]))},[(0,a.createElementVNode)("div",AP,[r[3]||(r[3]=(0,a.createElementVNode)("h3",null,"数据统计",-1)),(0,a.createElementVNode)("button",{onClick:r[0]||(r[0]=n=>e.$emit("close")),class:"close-btn"},[(0,a.createVNode)((0,a.unref)(Ne),{size:16})])]),(0,a.createElementVNode)("div",_P,[(0,a.createElementVNode)("div",$P,[(0,a.createElementVNode)("div",IP,[(0,a.createElementVNode)("div",TP,[(0,a.createVNode)((0,a.unref)(Vq),{size:24})]),(0,a.createElementVNode)("div",jP,[(0,a.createElementVNode)("div",MP,(0,a.toDisplayString)(Object.keys(e.chatVariables).length),1),r[4]||(r[4]=(0,a.createElementVNode)("div",{class:"stat-label"},"聊天变量",-1))])]),(0,a.createElementVNode)("div",qP,[(0,a.createElementVNode)("div",OP,[(0,a.createVNode)((0,a.unref)(lc),{size:24})]),(0,a.createElementVNode)("div",PP,[(0,a.createElementVNode)("div",FP,(0,a.toDisplayString)(Object.keys(e.globalVariables).length),1),r[5]||(r[5]=(0,a.createElementVNode)("div",{class:"stat-label"},"全局变量",-1))])]),(0,a.createElementVNode)("div",LP,[(0,a.createElementVNode)("div",YP,[(0,a.createVNode)((0,a.unref)(Ci),{size:24})]),(0,a.createElementVNode)("div",RP,[(0,a.createElementVNode)("div",UP,(0,a.toDisplayString)(e.getMemoryCount()),1),r[6]||(r[6]=(0,a.createElementVNode)("div",{class:"stat-label"},"记忆条目",-1))])]),(0,a.createElementVNode)("div",GP,[(0,a.createElementVNode)("div",WP,[(0,a.createVNode)((0,a.unref)(KT),{size:24})]),(0,a.createElementVNode)("div",JP,[(0,a.createElementVNode)("div",HP,(0,a.toDisplayString)(e.getWorldItemCount()),1),r[7]||(r[7]=(0,a.createElementVNode)("div",{class:"stat-label"},"世界元素",-1))])])]),(0,a.createElementVNode)("div",QP,[r[11]||(r[11]=(0,a.createElementVNode)("h4",null,"数据大小统计",-1)),(0,a.createElementVNode)("div",KP,[(0,a.createElementVNode)("div",XP,[r[8]||(r[8]=(0,a.createElementVNode)("span",null,"聊天变量大小:",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(o(t(e.chatVariables))),1)]),(0,a.createElementVNode)("div",ZP,[r[9]||(r[9]=(0,a.createElementVNode)("span",null,"全局变量大小:",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(o(t(e.globalVariables))),1)]),(0,a.createElementVNode)("div",eF,[r[10]||(r[10]=(0,a.createElementVNode)("span",null,"总数据大小:",-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(o(t(e.allTavernData))),1)])])]),(0,a.createElementVNode)("div",nF,[r[12]||(r[12]=(0,a.createElementVNode)("h4",null,"聊天变量详细大小（前10个最大的）",-1)),(0,a.createElementVNode)("div",tF,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Object.entries(n.chatVariables).map(([e,n])=>({key:e,size:t(n)})).sort((e,n)=>n.size-e.size).slice(0,10),e=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:e.key,class:"size-item"},[(0,a.createElementVNode)("span",aF,(0,a.toDisplayString)(e.key),1),(0,a.createElementVNode)("span",{style:(0,a.normalizeStyle)({color:e.size>5e4?"#ef4444":e.size>1e4?"#f59e0b":"inherit"})},(0,a.toDisplayString)(o(e.size)),5)]))),128))])])])])]))}});var rF=t(908),lF={};lF.styleTagTransform=A(),lF.setAttributes=z(),lF.insert=V().bind(null,"head"),lF.domAPI=N(),lF.insertStyleElement=B(),k()(rF.A,lF),rF.A&&rF.A.locals&&rF.A.locals;const iF=(0,j.A)(oF,[["__scopeId","data-v-57fafbc4"]]),cF={class:"tavern-data-panel"},sF=(0,a.defineComponent)({__name:"TavernDataPanel",setup(e){const n=(0,a.ref)(!1),o=(0,a.ref)(!1),r=(0,a.ref)(!1),l=(0,a.ref)(""),i=(0,a.ref)("chat"),c=(0,a.ref)(""),s=(0,a.ref)(!1),m=(0,a.ref)(null),p=(0,a.ref)(!1),{chatVariables:v,globalVariables:u,characterData:g,saveData:f,worldInfo:b,memoryData:h,allTavernData:y,refreshTavernData:x}=function(){const e=(0,a.ref)({}),n=(0,a.ref)({}),t=(0,a.ref)(null),o=(0,a.ref)({}),r=(0,a.ref)(null),l=(0,a.ref)(null),i=(0,a.computed)(()=>({chat:e.value,global:n.value,character:t.value,saveData:o.value,worldInfo:r.value,memory:l.value}));return{chatVariables:e,globalVariables:n,characterData:t,saveData:o,worldInfo:r,memoryData:l,allTavernData:i,refreshTavernData:async()=>{const a=(0,an.getTavernHelper)();if(!a)return;console.log("[酒馆数据] 开始获取变量数据...");const[i,c]=await Promise.all([Promise.resolve(a.getVariables({type:"chat"})).catch(e=>(console.error("[酒馆数据] 获取聊天变量失败:",e),{})),Promise.resolve(a.getVariables({type:"global"})).catch(e=>(console.error("[酒馆数据] 获取全局变量失败:",e),{}))]);if(e.value=i||{},n.value=c||{},i){const e=i||{};console.log("[酒馆数据] 正在从分片变量组装存档...");const n=e["属性"],a={角色基础信息:e["基础信息"],玩家角色状态:{境界:e["境界"],声望:e["声望"]||0,位置:e["位置"]||{描述:"未知",x:0,y:0},气血:n?.气血,灵气:n?.灵气,神识:n?.神识,寿命:n?.寿命,状态效果:e["状态效果"]||[]},修炼功法:e["修炼功法"],掌握技能:e["掌握技能"]||[],装备栏:e["装备栏"],背包:{灵石:e["背包_灵石"],物品:e["背包_物品"]},人物关系:e["人物关系"]||{},三千大道:e["三千大道"]||{已解锁大道:[],大道进度:{},大道路径定义:{}},世界信息:e["世界信息"],记忆:{短期记忆:e["记忆_短期"]||[],中期记忆:e["记忆_中期"]||[],长期记忆:e["记忆_长期"]||[],隐式中期记忆:e["记忆_隐式中期"]||[]},游戏时间:e["游戏时间"]};o.value=a,r.value=e["世界信息"]||null,l.value=a.记忆||null;const c=a.角色基础信息;t.value=c&&"object"==typeof c?{...c,name:c.名字}:null}}}}(),{filteredChatVariables:k,filteredGlobalVariables:w,getDataCount:N,getMemoryCount:E,getWorldItemCount:V}=function(e){const{chatVariables:n,globalVariables:t,characterData:o,saveData:r,worldInfo:l,memoryData:i,searchQuery:c}=e,s=(0,a.computed)(()=>{if(!c.value)return n.value;const e=c.value.toLowerCase(),t={};return Object.entries(n.value).forEach(([n,a])=>{(n.toLowerCase().includes(e)||JSON.stringify(a).toLowerCase().includes(e))&&(t[n]=a)}),t}),d=(0,a.computed)(()=>{if(!c.value)return t.value;const e=c.value.toLowerCase(),n={};return Object.entries(t.value).forEach(([t,a])=>{(t.toLowerCase().includes(e)||JSON.stringify(a).toLowerCase().includes(e))&&(n[t]=a)}),n}),m=(0,a.computed)(()=>{const e=i.value||{};return Array.isArray(e["短期记忆"])?e["短期记忆"]:Array.isArray(e.short_term)?e.short_term:[]}),p=(0,a.computed)(()=>{const e=i.value||{};return Array.isArray(e["中期记忆"])?e["中期记忆"]:Array.isArray(e.mid_term)?e.mid_term:[]}),v=(0,a.computed)(()=>{const e=i.value||{};return Array.isArray(e["长期记忆"])?e["长期记忆"]:Array.isArray(e.long_term)?e.long_term:[]});return{filteredChatVariables:s,filteredGlobalVariables:d,shortMem:m,midMem:p,longMem:v,getDataCount:e=>{switch(e){case"chat":return Object.keys(c.value?s.value:n.value).length;case"global":return Object.keys(c.value?d.value:t.value).length;case"character":{const e=o.value;return e&&"object"==typeof e?Object.keys(e).length:0}case"saveData":{const e=r.value;return e&&"object"==typeof e?Object.keys(e).length:0}case"worldInfo":{const e=l.value;if(e&&"object"==typeof e){const n=(Array.isArray(e["大陆信息"])?e["大陆信息"].length:0)+(Array.isArray(e["势力信息"])?e["势力信息"].length:0)+(Array.isArray(e["地点信息"])?e["地点信息"].length:0);return n>0?n:Object.keys(e).length}return 0}case"memory":return(m.value?.length||0)+(p.value?.length||0)+(v.value?.length||0);default:return 0}},getMemoryCount:()=>(m.value?.length||0)+(p.value?.length||0)+(v.value?.length||0),getWorldItemCount:()=>{if(!l.value)return 0;let e=0;const n=l.value;return Array.isArray(n["势力信息"])&&(e+=n["势力信息"].length),Array.isArray(n["地点信息"])&&(e+=n["地点信息"].length),Array.isArray(n["大陆信息"])&&(e+=n["大陆信息"].length),e}}}({chatVariables:v,globalVariables:u,characterData:g,saveData:f,worldInfo:b,memoryData:h,searchQuery:c}),C=[{key:"chat",label:"聊天变量",icon:"MessageSquare"},{key:"global",label:"全局变量",icon:"Globe"},{key:"character",label:"角色数据",icon:"Users"},{key:"saveData",label:"存档数据",icon:"Archive"},{key:"worldInfo",label:"世界信息",icon:"Book"},{key:"memory",label:"记忆数据",icon:"Brain"},{key:"raw",label:"原始数据",icon:"Code"}],z=async()=>{r.value=!0,o.value=!0;try{if(!(0,an.getTavernHelper)())return n.value=!1,void d.o.error("未连接到酒馆");n.value=!0,await x(),l.value=(new Date).toLocaleString("zh-CN")}catch(e){console.error("[酒馆数据] 刷新失败:",e),d.o.error("数据刷新失败: "+(e instanceof Error?e.message:"未知错误"))}finally{o.value=!1,r.value=!1}},S=()=>{try{const e=JSON.stringify(y.value,null,2),n=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(n),a=document.createElement("a");a.href=t,a.download=`tavern-data-${Date.now()}.json`,a.click(),URL.revokeObjectURL(t),d.o.success("数据导出成功")}catch(e){console.error("[酒馆数据] 导出失败:",e),d.o.error("数据导出失败")}},B=()=>{s.value=!0},D=e=>{m.value={type:e,key:"",value:""},p.value=!0},A=e=>{m.value={...e},p.value=!0},_=async(e,n)=>{try{const t="object"==typeof n?JSON.stringify(n,null,2):String(n);await navigator.clipboard.writeText(`${e}: ${t}`),d.o.success("已复制到剪贴板")}catch(e){console.error("[酒馆数据] 复制失败:",e),d.o.error("复制失败")}},$=async(e,n)=>{if(confirm(`确定要删除变量 "${n}" 吗？`))try{const t=(0,an.getTavernHelper)();if(!t)return void d.o.error("未连接到酒馆");await t.deleteVariable(n,{type:e}),"chat"===e?delete v.value[n]:delete u.value[n],d.o.success("变量删除成功")}catch(e){console.error("[酒馆数据] 删除失败:",e),d.o.error("删除失败: "+(e instanceof Error?e.message:"未知错误"))}},I=async e=>{if(e)try{const n=(0,an.getTavernHelper)();if(!n)return void d.o.error("未连接到酒馆");const{type:a,key:o,value:r}=e;if(!o||""===o.trim())return void d.o.error("变量名不能为空");const{deepCleanForClone:l}=await Promise.resolve().then(t.bind(t,3098)),i={[o]:l(r)};await n.insertOrAssignVariables(i,{type:a}),"chat"===a?v.value[o]=r:"global"===a&&(u.value[o]=r),T(),d.o.success("变量保存成功"),await z()}catch(e){console.error("[酒馆数据] 保存失败:",e),d.o.error("保存失败: "+(e instanceof Error?e.message:"未知错误"))}},T=()=>{p.value=!1,m.value=null},j=()=>{console.group("[酒馆数据] 详细调试信息"),console.log("基本统计:",{tavernConnected:n.value,chatVariablesCount:Object.keys(v.value).length,globalVariablesCount:Object.keys(u.value).length,lastUpdateTime:l.value}),console.log("聊天变量键名:",Object.keys(v.value)),console.log("全局变量键名:",Object.keys(u.value)),console.groupEnd(),d.o.success("调试信息已输出到控制台")};return(0,a.onMounted)(()=>{z(),Oi.on("refresh",()=>z()),Oi.on("export",()=>S()),Oi.on("stats",()=>B())}),(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",cF,[(0,a.createVNode)(fq,{isRefreshing:r.value,searchQuery:c.value,"onUpdate:searchQuery":t[0]||(t[0]=e=>c.value=e),onRefresh:z,onExport:S,onShowStats:B},null,8,["isRefreshing","searchQuery"]),(0,a.createVNode)(Eq,{tavernConnected:n.value,lastUpdateTime:l.value},null,8,["tavernConnected","lastUpdateTime"]),(0,a.createVNode)(Iq,{dataTypes:C,selectedType:i.value,getDataCount:(0,a.unref)(N),"onUpdate:selectedType":t[1]||(t[1]=e=>i.value=e)},null,8,["selectedType","getDataCount"]),(0,a.createVNode)(mP,{isLoading:o.value,tavernConnected:n.value,selectedDataType:i.value,searchQuery:c.value,chatVariables:(0,a.unref)(v),globalVariables:(0,a.unref)(u),characterData:(0,a.unref)(g),saveData:(0,a.unref)(f),worldInfo:(0,a.unref)(b),memoryData:(0,a.unref)(h),allTavernData:(0,a.unref)(y),filteredChatVariables:(0,a.unref)(k),filteredGlobalVariables:(0,a.unref)(w),onEditVariable:A,onCopyVariable:_,onDeleteVariable:$,onAddNewVariable:D,onDebugLog:j},null,8,["isLoading","tavernConnected","selectedDataType","searchQuery","chatVariables","globalVariables","characterData","saveData","worldInfo","memoryData","allTavernData","filteredChatVariables","filteredGlobalVariables"]),p.value?((0,a.openBlock)(),(0,a.createBlock)(DP,{key:0,editingItem:m.value,onClose:T,onSave:I},null,8,["editingItem"])):(0,a.createCommentVNode)("v-if",!0),s.value?((0,a.openBlock)(),(0,a.createBlock)(iF,{key:1,chatVariables:(0,a.unref)(v),globalVariables:(0,a.unref)(u),allTavernData:(0,a.unref)(y),getMemoryCount:(0,a.unref)(E),getWorldItemCount:(0,a.unref)(V),onClose:t[2]||(t[2]=e=>s.value=!1)},null,8,["chatVariables","globalVariables","allTavernData","getMemoryCount","getWorldItemCount"])):(0,a.createCommentVNode)("v-if",!0)]))}});var dF=t(3613),mF={};mF.styleTagTransform=A(),mF.setAttributes=z(),mF.insert=V().bind(null,"head"),mF.domAPI=N(),mF.insertStyleElement=B(),k()(dF.A,mF),dF.A&&dF.A.locals&&dF.A.locals;const pF=[{path:"/",name:"ModeSelection",component:Cn},{path:"/creation",name:"CharacterCreation",component:li},{path:"/login",name:"Login",component:Ni},{path:"/game",name:"Game",component:Nv,children:[{path:"",name:"GameMain",component:fg},{path:"memory",name:"Memory",component:mf},{path:"character-details",name:"CharacterDetails",component:Gk},{path:"inventory",name:"Inventory",component:pE},{path:"relationships",name:"Relationships",component:Uz},{path:"cultivation",name:"Cultivation",component:rB},{path:"techniques",name:"Techniques",component:_D},{path:"thousand-dao",name:"ThousandDao",component:AA},{path:"settings",name:"Settings",component:j_},{path:"save",name:"Save",component:F$},{path:"world-map",name:"WorldMap",component:KI},{path:"quests",name:"Quests",component:RT},{path:"sect",name:"Sect",component:lq},{path:"tavern-data",name:"TavernData",component:(0,j.A)(sF,[["__scopeId","data-v-525aaac2"]])}]},{path:"/management",name:"CharacterManagement",component:{setup(){const e=(0,r.useRouter)(),n=()=>{e.push("/")},t=n=>{e.push("/game")};return()=>(0,a.h)(Rp,{fullscreen:!0,onClose:n,onCharacterSelected:t})}}}],vF=(0,r.createRouter)({history:(0,r.createMemoryHistory)(),routes:pF});var uF=t(4096),gF={};gF.styleTagTransform=A(),gF.setAttributes=z(),gF.insert=V().bind(null,"head"),gF.domAPI=N(),gF.insertStyleElement=B(),k()(uF.A,gF),uF.A&&uF.A.locals&&uF.A.locals;var fF=t(1606),bF={};bF.styleTagTransform=A(),bF.setAttributes=z(),bF.insert=V().bind(null,"head"),bF.domAPI=N(),bF.insertStyleElement=B(),k()(fF.A,bF),fF.A&&fF.A.locals&&fF.A.locals;var hF=t(6627),yF={};yF.styleTagTransform=A(),yF.setAttributes=z(),yF.insert=V().bind(null,"head"),yF.domAPI=N(),yF.insertStyleElement=B(),k()(hF.A,yF),hF.A&&hF.A.locals&&hF.A.locals;const xF={log:console.log.bind(console),warn:console.warn.bind(console),info:console.info.bind(console),debug:console.debug?console.debug.bind(console):void 0,table:console.table?console.table.bind(console):void 0,group:console.group?console.group.bind(console):void 0,groupCollapsed:console.groupCollapsed?console.groupCollapsed.bind(console):void 0,groupEnd:console.groupEnd?console.groupEnd.bind(console):void 0,error:console.error.bind(console)},kF=()=>bg.w9.isConsoleDebugEnabled();console.log=(...e)=>{kF()&&xF.log(...e)},console.warn=(...e)=>{kF()&&xF.warn(...e)},console.info=(...e)=>{bg.w9.isDebugMode()&&xF.info(...e)},xF.debug&&(console.debug=(...e)=>{kF()&&xF.debug(...e)}),xF.table&&(console.table=(...e)=>{kF()&&xF.table(...e)}),xF.group&&(console.group=(...e)=>{kF()&&xF.group(...e)}),xF.groupCollapsed&&(console.groupCollapsed=(...e)=>{kF()&&xF.groupCollapsed(...e)}),xF.groupEnd&&(console.groupEnd=(...e)=>{kF()&&xF.groupEnd(...e)});const wF=(0,a.createApp)(un);wF.use((0,o.Ey)()),wF.use(vF),wF.mount("#app")})();